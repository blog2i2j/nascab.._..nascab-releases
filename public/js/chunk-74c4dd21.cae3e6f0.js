(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-74c4dd21"],{"293c":function(t,e,s){},"2ea0":function(t,e,s){"use strict";s.r(e);var a=s("7cfd"),i=(s("19cb"),s("14d9"),s("be3b")),o=s("ccdb"),l=s("e86f"),o={props:{},components:{fileSelect:o.default,fileSelectBar:l.a},computed:{},data(){return{uploadUrl:"",currentUploadFile:null,overMode:"over",uploadList:[],recordType:"all",targetPath:"nascab_torrentSavePath",lastUsePath:"",uploadSucCount:0,showChooseFolder:!1}},created(){},mounted(){this.lastUsePath=localStorage.getItem("lastUsePath")},methods:{onCloseUpload(){this.switchUpload()},retryUpload(e){for(let t=this.uploadList.length-1;0<=t;t--)this.uploadList[t]==e&&this.uploadList.splice(t,1);"error"==e.status&&e.uploadFile&&this.$refs.upload.addUploadFile(e.uploadFile)},clearRecord(){this.uploadList=[]},onRecordTypeSelect(t){this.recordType=t},onBeforeUpload(a){return new Promise((t,e)=>{if(!this.$store.state.token)return this.uploadList.unshift({status:"error",name:this.$t("common.tokenExpire")}),e();if(".DS_Store"==a.name)return e();if(120<a.name.length)return this.uploadList.unshift({status:"error",name:this.$t("upload.filenameTooLong")}),e();if(!this.targetPath)return this.uploadList.unshift({status:"error",name:this.$t("upload.noTargetPath")}),e();let s=i.a.uploadUrl()+(`&savePath=${i.a.encodePath(this.targetPath)}&overMode=`+this.overMode);return a.webkitRelativePath&&(s+="&relativePath="+i.a.encodePath(a.webkitRelativePath)),s+="&encodeFilename="+i.a.encodePath(a.name),this.uploadUrl=s,a.uploadUrl=s,t(a)})},handleRemove(e,t){let s=!1;if(e.uid&&"uploading"==e.status&&e.percentage<95)for(var a in this.$refs.upload.fileList)this.$refs.upload.fileList[a].uid==e.uid&&this.$refs.upload.fileList[a].xhr&&(this.$refs.upload.fileList[a].xhr.abort(),s=!0);if(this.uploadList.splice(t,1),s){let t=this.$t("common.cancelled");e.name&&(t+=":"+e.name),this.uploadList.unshift({status:"error",name:t})}},onUploadSuccess(t,e,s,a){for(var i in this.uploadList)if(this.uploadList[i].uid==e.uid){this.uploadList.splice(i,1);break}t.code?this.uploadList.unshift({status:"error",name:e.name+":"+t.message,uploadFile:a}):(this.$emit("fileUploaded",e),this.uploadList.unshift(e))},onUploadProgress(t,e,s){for(var a in this.uploadList)if(this.uploadList[a].uid==e.uid)return this.uploadList[a].percentage=e.percentage,void(this.uploadList[a].file=e);this.uploadList.unshift({status:"uploading",name:e.name,percentage:1,uid:e.uid,file:e})},onUploadError(t,e,s){for(var a in this.uploadList)if(this.uploadList[a].uid==s.uid){this.uploadList.splice(a,1);break}this.uploadList.unshift({status:"error",name:s?s.name+":"+this.$t("upload.uploadFail"):this.$t("upload.uploadFail"),uploadFile:s})},selectRecrentFolder(){this.api.post("/api/uploadApi/folderExist",{savePath:this.lastUsePath}).then(t=>{t.code||this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("upload.useRecentFolder",{recentFolder:this.lastUsePath}),()=>{this.onSelectPath(this.lastUsePath)})}).catch(t=>{})},selectPath(){this.showChooseFolder=!0},detectFileExist(t,e){this.api.post("/api/file/fileExist",{folderPath:i.a.encodePath(this.targetPath),fileName:t}).then(t=>{e&&e(1==t.code)}).catch(t=>{e&&e(1==t.code)})},onSelectPath(e){this.api.post("/api/file/checkFolderPower",{checkPath:i.a.encodePath(e),checkPower:"all"}).then(t=>{t.code||(t.access?(this.showChooseFolder=!1,this.targetPath=e,localStorage.setItem("lastUsePath",e)):this.showVsNotification(this.$t("file.noAccessPower")))}).catch(t=>{})}}},l=(s("d772"),s("2877")),o={components:{uploadTorrent:Object(l.a)(o,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"app-upload-root"},[i("Upload",{directives:[{name:"show",rawName:"v-show",value:a.targetPath,expression:"targetPath"}],ref:"upload",attrs:{action:a.uploadUrl,"show-upload-list":!1,format:["torrent"],accept:".torrent","on-error":a.onUploadError,"on-success":a.onUploadSuccess,"before-upload":a.onBeforeUpload,"on-progress":a.onUploadProgress,multiple:"",type:"drag",webkitdirectory:!1}},[i("div",{staticStyle:{padding:"20px 0",position:"relative"}},[i("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),i("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center",cursor:"pointer"}},[i("p",[a._v(a._s(this.$t("bt.uploadAlert")))]),0<a.uploadList.length?i("Button",{staticStyle:{"margin-left":"3px"},attrs:{size:"small"},on:{click:[function(t){t.stopPropagation(),a.uploadList=[]},function(t){a.uploadList=[]}]}},[a._v(a._s(a.$t("upload.clearRecord")))]):a._e()],1)],1)]),i("div",{staticStyle:{width:"100%","max-height":"300px",display:"flex","flex-direction":"column","align-items":"center"}},[a.uploadList&&0<a.uploadList.length?i("Menu",{staticStyle:{width:"100%",display:"flex","justify-content":"space-around"},attrs:{mode:"horizontal","active-name":"all"},on:{"on-select":a.onRecordTypeSelect}},[i("MenuItem",{attrs:{name:"all"}},[a._v(" "+a._s(a.$t("common.all"))+"["+a._s(a.uploadList.length)+"] ")]),i("MenuItem",{attrs:{name:"uploading"}},[a._v(" "+a._s(a.$t("common.uploading"))+" ")]),i("MenuItem",{attrs:{name:"finished"}},[a._v(" "+a._s(a.$t("common.succesed"))+" ")]),i("MenuItem",{attrs:{name:"error"}},[a._v(" "+a._s(a.$t("common.faild"))+" ")])],1):a._e(),i("div",{staticStyle:{overflow:"auto",height:"100%",width:"100%"}},a._l(a.uploadList,function(e,s){return e.status==a.recordType||"all"==a.recordType?i("div",{staticStyle:{padding:"10px",display:"flex","flex-direction":"column","border-bottom":"1px solid #eee",width:"100%"}},[i("div",{staticStyle:{display:"flex",width:"100%","align-items":"center","justify-content":"space-between"}},["finished"==e.status?i("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"md-checkmark-circle",size:"20",color:"green"}}):a._e(),"error"==e.status?i("Icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"ios-close-circle",size:"20",color:"red"}}):a._e(),i("div",{class:{uploadError:"error"==e.status},staticStyle:{"text-align":"left",flex:"1","word-break":"break-all"}},[a._v(a._s(e.name))]),"error"==e.status?i("Icon",{staticStyle:{"flex-shrink":"0",cursor:"pointer","margin-right":"5px"},attrs:{type:"md-refresh",size:"20"},on:{click:function(t){return a.retryUpload(e)}}}):a._e(),i("Icon",{staticStyle:{"flex-shrink":"0",cursor:"pointer"},attrs:{type:"md-trash",size:"20"},on:{click:function(t){return a.handleRemove(e,s)}}})],1),"uploading"==e.status?i("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):a._e()],1):a._e()}),0)],1),i("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":a.isMobile},scopedSlots:a._u([{key:"header",fn:function(){return[i("h4",{staticStyle:{"font-size":"16px"}},[a._v(" "+a._s(a.$t("file.chooseFolder")+"["+a.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[i("file-select-bar",{on:{back:function(t){return a.$refs.fileSelector.goBack()},select:function(t){return a.$refs.fileSelector.onSelect()},create:function(t){return a.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:a.showChooseFolder,callback:function(t){a.showChooseFolder=t},expression:"showChooseFolder"}},[a.showChooseFolder?i("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2},on:{onSelect:a.onSelectPath,onCancel:function(t){a.showChooseFolder=!1}}}):a._e()],1)],1)},[],!1,null,"c9dc6a46",null).exports},data(){return{showSavePathSelect:!1,magnet:"",httpUrl:"",taskType:"MAGNET",downloadPath:""}},mounted(){},beforeDestroy(){},methods:{onSelectPath(t){this.showSavePathSelect=!1,this.downloadPath=t},changeIndex(t){this.taskType=t},addDownloadTask(){var t=[];if("HTTP"==this.taskType&&!this.downloadPath)return this.showVsNotification(this.$t("bt.selectSavePath"));if("HTTP"==this.taskType){if(!this.httpUrl||!this.httpUrl.startsWith("http://")&&!this.httpUrl.startsWith("https://"))return this.showVsNotification(this.$t("bt.httpAlert"))}else if("MAGNET"==this.taskType){if(!this.magnet)return this.showVsNotification(this.$t("bt.magnetAlert"))}else if("TORRENT"==this.taskType){if(!this.$refs.torrentUpload.uploadList)return this.showVsNotification(this.$t("common.noPermission"));for(var e of this.$refs.torrentUpload.uploadList)t.push(e.name)}var s={taskType:this.taskType,httpUrl:this.httpUrl,magnet:this.magnet,torrentName:t,savePath:"HTTP"==this.taskType?this.downloadPath:""};this.api.post("/api/downloadApi/addDownloadTask",s).then(t=>{t.code||this.$emit("onSuccess")}).catch(t=>{2==t.code&&this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("bt.sameTaskExist")+"["+t.data.task_name+"]",()=>{t.data&&this.api.post("/api/downloadApi/deleteTask",{taskId:t.data.id}).then(t=>{this.addDownloadTask()})},null,this.$t("bt.restart"))})}}},o=Object(l.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bt-root"},["HTTP"==e.taskType?s("div",{staticStyle:{"margin-bottom":"15px"}},[s("div",{staticStyle:{"text-align":"left","margin-bottom":"5px"}},[e._v(e._s(e.$t("bt.downloadTo")))]),s("Input",{attrs:{search:"","enter-button":e.$t("common.select"),placeholder:e.$t("file.chooseFolder")},on:{"on-search":function(t){e.showSavePathSelect=!0}},model:{value:e.downloadPath,callback:function(t){e.downloadPath=t},expression:"downloadPath"}})],1):e._e(),"HTTP"==e.taskType?s("Divider",{staticStyle:{margin:"0"},attrs:{size:"small"}}):e._e(),s("div",{staticClass:"nas-mobile-none"},[s("Menu",{attrs:{mode:"horizontal",theme:"light","active-name":"MAGNET"},on:{"on-select":e.changeIndex}},[s("MenuItem",{attrs:{name:"MAGNET"}},[s("Icon",{attrs:{type:"ios-magnet"}}),e._v(" "+e._s(e.$t("bt.magnet"))+" ")],1),s("MenuItem",{attrs:{name:"TORRENT"}},[s("Icon",{attrs:{type:"ios-document"}}),e._v(" "+e._s(e.$t("bt.torrent"))+" ")],1),s("MenuItem",{attrs:{name:"HTTP"}},[s("Icon",{attrs:{type:"ios-link"}}),e._v(" http ")],1)],1)],1),s("div",{staticClass:"nas-mobile-show"},[s("vs-select",{staticStyle:{width:"100%"},model:{value:e.taskType,callback:function(t){e.taskType=t},expression:"taskType"}},[s("vs-option",{attrs:{label:e.$t("bt.magnet"),value:"MAGNET"}},[e._v(" "+e._s(e.$t("bt.magnet"))+" ")]),s("vs-option",{attrs:{label:e.$t("bt.torrent"),value:"TORRENT"}},[e._v(" "+e._s(e.$t("bt.torrent"))+" ")]),s("vs-option",{attrs:{label:"http",value:"HTTP"}},[e._v(" http ")])],1)],1),s("div",{staticStyle:{"margin-top":"15px"}},[s("Input",{directives:[{name:"show",rawName:"v-show",value:"MAGNET"==e.taskType,expression:"taskType == 'MAGNET'"}],attrs:{type:"textarea",rows:4,placeholder:e.$t("bt.magnetAlert")},model:{value:e.magnet,callback:function(t){e.magnet=t},expression:"magnet"}}),s("uploadTorrent",{directives:[{name:"show",rawName:"v-show",value:"TORRENT"==e.taskType,expression:"taskType == 'TORRENT'"}],ref:"torrentUpload",on:{fileUploaded:function(t){e.hasNewFileUploaded=!0}}}),s("Input",{directives:[{name:"show",rawName:"v-show",value:"HTTP"==e.taskType,expression:"taskType == 'HTTP'"}],attrs:{type:"textarea",rows:4,placeholder:e.$t("bt.httpAlert")},model:{value:e.httpUrl,callback:function(t){e.httpUrl=t},expression:"httpUrl"}})],1),s("Button",{staticStyle:{"border-radius":"10px","margin-top":"20px"},attrs:{type:"primary"},on:{click:e.addDownloadTask}},[e._v(e._s(e.$t("btAddTask")))]),s("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":e.isMobile},scopedSlots:e._u([{key:"header",fn:function(){return[s("h4",{staticStyle:{"font-size":"16px"}},[e._v(" "+e._s(e.$t("file.chooseFolder")+"["+e.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[s("file-select-bar",{on:{back:function(t){return e.$refs.fileSelector.goBack()},select:function(t){return e.$refs.fileSelector.onSelect()},create:function(t){return e.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:e.showSavePathSelect,callback:function(t){e.showSavePathSelect=t},expression:"showSavePathSelect"}},[e.showSavePathSelect?s("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2},on:{onSelect:e.onSelectPath,onCancel:function(t){e.showSavePathSelect=!1}}}):e._e()],1)],1)},[],!1,null,"37385ef5",null).exports,n=s("c220"),r=s("1bb5");s("d930");n={props:{selectedTask:{default:null,type:Object}},components:{myScrollBar:n.a},data(){return{savePath:this.selectedTask.save_path,showSavePathSelect:!1,selectedFileSize:0,selectedFileCount:0,allFileCount:0,sortType:"desc",sortField:"length",hasVideo:!1,hasImage:!1,selectedAll:!1,selectedImage:!1,selectedVideo:!1,taskFileList:[],taskFileTreeData:[],typeData:r.a}},mounted(){this.initTreeData()},beforeDestroy(){},methods:{selectFileApi(){var t,e={savePath:this.savePath,taskId:this.selectedTask.id,fileList:[]};if(!this.savePath)return this.showVsNotification(this.$t("bt.selectSavePath"));for(t of this.taskFileTreeData)if("folder"==t.type)for(var s of t.children)s.checked&&e.fileList.push({name:s.name,path:s.path});else"file"==t.type&&e.fileList.push({name:t.name,path:t.path});if(e.fileList.length<1)return this.showVsNotification(this.$t("bt.noFileSelected"));this.api.post("/api/downloadApi/selectTaskFile",e).then(t=>{t.code||(this.showVsNotification(this.$t("common.operationSuccess")),this.$emit("onFinish"))})},onSelectPath(t){this.showSavePathSelect=!1,this.savePath=t},setCountAndSize(){let t=0,e=0,s=0;for(var a in this.taskFileTreeData){var i;for(i of this.taskFileTreeData[a].children)t+=1,i.checked&&(e+=1,s+=i.length)}this.selectedFileSize=s,this.selectedFileCount=e,this.allFileCount=t},clickOrder(){for(var t of this.taskFileTreeData)t.children&&("asc"==this.sortType?"length"==this.sortField?t.children.sort((t,e)=>t.length-e.length):t.children.sort((t,e)=>t[this.sortField].localeCompare(e[this.sortField])):"length"==this.sortField?t.children.sort((t,e)=>e.length-t.length):t.children.sort((t,e)=>e[this.sortField].localeCompare(t[this.sortField])))},onCheckType(t,e){for(var s in this.taskFileTreeData){var a;for(a of this.taskFileTreeData[s].children)a.type==t&&(a.checked=e,this.onFileCkCheck(s))}this.setCheckAllState()},onCheckAll(t){for(var e of this.taskFileTreeData){e.checked=t,e.indeterminate=!1;for(var s of e.children)s.checked=t}this.selectedImage=this.selectedAll,this.selectedVideo=this.selectedAll,this.setCountAndSize()},setCheckAllState(){let t=!0;for(var e of this.taskFileTreeData)e.checked&&!e.indeterminate||(t=!1);this.selectedAll=t},onFileCkCheck(i,t,e){if("folder"==this.taskFileTreeData[i].type){let t=!0,e=!0,s=!0,a=!0;for(var o in this.taskFileTreeData[i].children){o=this.taskFileTreeData[i].children[o];o.checked?e=!1:(t=!1,"video"==o.type?s=!1:"image"==o.type&&(a=!1))}t&&(this.taskFileTreeData[i].checked=!0),e&&(this.taskFileTreeData[i].checked=!1),this.taskFileTreeData[i].indeterminate=!t&&!e,this.selectedImage=a,this.selectedVideo=s}this.setCheckAllState(),this.setCountAndSize()},onFolderCkCheck(t,e){if("folder"==this.taskFileTreeData[t].type)if(this.taskFileTreeData[t].indeterminate)for(var s in this.taskFileTreeData[t].indeterminate=!1,this.taskFileTreeData[t].checked=!1,this.taskFileTreeData[t].children)this.taskFileTreeData[t].children[s].checked=!1;else for(var a in this.taskFileTreeData[t].children)this.taskFileTreeData[t].children[a].checked=e;this.setCheckAllState(),this.setCountAndSize()},getFileType(t){let e=t.substring(t.lastIndexOf("."));switch(e=e&&e.toLowerCase(),this.typeData[e]){case 1:return"image";case 2:return"video";case 3:return"text";default:return"file"}},onPageScroll(t){this.$refs.scrollBar&&this.$refs.scrollBar.onScroll(t)},initTreeData(){this.selectedTask.task_file_list&&this.selectedTask.task_file_list.startsWith("[")&&(this.taskFileList=JSON.parse(this.selectedTask.task_file_list));var e,t,a,i=[],s=[];for(e of this.taskFileList)if(e.path){let t=e.path;(t=t.endsWith(e.name)?t.slice(0,t.lastIndexOf(e.name)):t).endsWith("\\")&&(t=t.slice(0,t.lastIndexOf("\\"))),s.includes(t)||s.push(t),e.pathNoFilename=t}for(t in s)i.push({type:"folder",title:s[t],expand:!0,children:[],checked:!1});for(a of this.taskFileList){let t=a.name.substring(a.name.lastIndexOf(".")),e=this.getFileType(a.name),s=!1;"image"==e?this.hasImage=!0:"video"==e&&(this.hasVideo=!0);for(var o of i)if(o.title==a.pathNoFilename){o.children.push({ext:t,type:this.getFileType(a.name),title:a.name,checked:!1,length:a.length,name:a.name,path:a.path}),s=!0;break}s||i.push({type:e,title:a.name,children:[],checked:!0,name:a.name,path:a.path})}this.taskFileTreeData=i,this.setCountAndSize()}}};s("9f11");var n=Object(l.a)(n,function(){var o=this,t=o.$createElement,l=o._self._c||t;return l("div",{staticClass:"bt-root"},[l("div",{staticClass:"top-root"},[l("img",{staticClass:"img-folder",attrs:{src:s("60b7")},on:{dragstart:function(t){t.preventDefault()}}}),l("div",{staticClass:"top-root-bottom"},[l("div",{staticClass:"max-line-two text-title"},[o._v(o._s(o.selectedTask.task_name))]),l("div",{staticClass:"text-count"},[o._v(o._s(o.selectedFileCount)+"/"+o._s(o.allFileCount)+" "+o._s(o.utils.getSizeStr(o.selectedFileSize)))])])]),l("div",{staticClass:"menu-root"},[l("Checkbox",{on:{"on-change":o.onCheckAll},model:{value:o.selectedAll,callback:function(t){o.selectedAll=t},expression:"selectedAll"}},[o._v(o._s(o.$t("common.selectAll")))]),l("div",{staticStyle:{display:"flex","align-items":"center"}},[o.hasVideo?l("Checkbox",{on:{"on-change":function(t){return o.onCheckType("video",t)}},model:{value:o.selectedVideo,callback:function(t){o.selectedVideo=t},expression:"selectedVideo"}},[o._v(o._s(o.$t("common.video")))]):o._e(),o.hasImage?l("Checkbox",{on:{"on-change":function(t){return o.onCheckType("image",t)}},model:{value:o.selectedImage,callback:function(t){o.selectedImage=t},expression:"selectedImage"}},[o._v(o._s(o.$t("photo.image")))]):o._e(),l("Poptip",{attrs:{placement:"bottom"},scopedSlots:o._u([{key:"content",fn:function(){return[l("div",{staticClass:"sort-root"},[l("div",[o._v(o._s(o.$t("common.sortField")))]),l("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":o.clickOrder},model:{value:o.sortField,callback:function(t){o.sortField=t},expression:"sortField"}},[l("Radio",{attrs:{label:"length"}},[l("span",[o._v(o._s(o.$t("file.size")))])]),l("Radio",{attrs:{label:"name"}},[l("span",[o._v(o._s(o.$t("movie.filename")))])]),l("Radio",{attrs:{label:"type"}},[l("span",[o._v(o._s(o.$t("type")))])])],1),l("div",{staticStyle:{"margin-top":"15px"}},[o._v(o._s(o.$t("common.sortType")))]),l("RadioGroup",{staticStyle:{"margin-top":"5px"},attrs:{vertical:""},on:{"on-change":o.clickOrder},model:{value:o.sortType,callback:function(t){o.sortType=t},expression:"sortType"}},[l("Radio",{attrs:{label:"asc"}},[l("span",[o._v(o._s(o.$t("common.asc")))])]),l("Radio",{attrs:{label:"desc"}},[l("span",[o._v(o._s(o.$t("common.desc")))])])],1)],1)]},proxy:!0}])},["asc"==o.sortType?l("span",{staticClass:"nasIcons icon-sort-alpha-up operation-icon"}):o._e(),"desc"==o.sortType?l("span",{staticClass:"nasIcons icon-sort-alpha-down-alt operation-icon"}):o._e()])],1)],1),l("Divider",{staticClass:"divider"}),l("div",{staticClass:"ck-wrapper"},o._l(o.taskFileTreeData,function(a,i){return l("div",{staticClass:"item-root"},[l("div",{staticClass:"flex-row"},[a.expand&&"folder"==a.type?l("Icon",{staticStyle:{"margin-right":"5px",cursor:"pointer"},attrs:{type:"ios-arrow-down"},on:{click:function(t){a.expand=!1}}}):o._e(),a.expand||"folder"!=a.type?o._e():l("Icon",{staticStyle:{"margin-right":"5px",cursor:"pointer"},attrs:{type:"ios-arrow-forward"},on:{click:function(t){a.expand=!0}}}),l("vs-tooltip",{attrs:{disabled:o.isMobile},scopedSlots:o._u([{key:"tooltip",fn:function(){return[o._v(" "+o._s(a.title)+" ")]},proxy:!0}],null,!0)},[l("Checkbox",{staticClass:"ck-folder",attrs:{indeterminate:a.indeterminate},on:{"on-change":function(t){o.onFolderCkCheck(i,t)}},model:{value:a.checked,callback:function(t){o.$set(a,"checked",t)},expression:"folderItem.checked"}},["folder"==a.type?l("Icon",{staticClass:"ck-folder-icon",attrs:{type:"ios-folder-open"}}):o._e(),l("span",{staticClass:"max-line-one"},[o._v(o._s(a.title))])],1)],1),l("span",[o._v(o._s(a.length))])],1),o._l(a.children,function(e,s){return a.expand?l("div",{staticClass:"item-root",staticStyle:{"margin-left":"30px"}},[l("vs-tooltip",{attrs:{disabled:o.isMobile},scopedSlots:o._u([{key:"tooltip",fn:function(){return[o._v(" "+o._s(e.title)+" ")]},proxy:!0}],null,!0)},[l("div",{staticClass:"flex-row"},[l("Checkbox",{staticClass:"ck-folder",on:{"on-change":function(t){o.onFileCkCheck(i,s,t)}},model:{value:e.checked,callback:function(t){o.$set(e,"checked",t)},expression:"treeFile.checked"}},["image"==e.type?l("Icon",{staticClass:"ck-folder-icon",attrs:{type:"ios-image"}}):o._e(),"video"==e.type?l("Icon",{staticClass:"ck-folder-icon",attrs:{type:"logo-youtube"}}):o._e(),"file"==e.type?l("Icon",{staticClass:"ck-folder-icon",attrs:{type:"md-document"}}):o._e(),"text"==e.type?l("Icon",{staticClass:"ck-folder-icon",attrs:{type:"ios-paper"}}):o._e(),l("span",{staticClass:"max-line-one"},[o._v(o._s(e.title))])],1),l("span",{staticStyle:{"flex-shrink":"0"}},[o._v(o._s(o.utils.getSizeStr(e.length))),l("span",{staticClass:"file-type"},[o._v("["+o._s(e.ext.replace(".",""))+"]")])])],1)])],1):o._e()})],2)}),0),l("Divider",{staticClass:"divider"}),l("div",{staticClass:"bottom-root"},[l("div",[o._v(o._s(o.$t("bt.downloadTo"))+":")]),l("div",{staticStyle:{"margin-bottom":"15px"}},[l("Input",{attrs:{search:"","enter-button":o.$t("common.select"),placeholder:o.$t("file.chooseFolder")},on:{"on-search":function(t){o.showSavePathSelect=!0}},model:{value:o.savePath,callback:function(t){o.savePath=t},expression:"savePath"}})],1),l("my-btn",{staticStyle:{width:"100%"},attrs:{title:o.$t("btStartDownload")},on:{click:function(t){return o.selectFileApi()}}})],1),l("vs-dialog",{attrs:{"prevent-close":"",scroll:"","full-screen":o.isMobile},scopedSlots:o._u([{key:"header",fn:function(){return[l("h4",{staticStyle:{"font-size":"16px"}},[o._v(" "+o._s(o.$t("file.chooseFolder")+"["+o.$t("file.doubleClickFolderEnter")+"]")+" ")])]},proxy:!0},{key:"footer",fn:function(){return[l("file-select-bar",{on:{back:function(t){return o.$refs.fileSelector.goBack()},select:function(t){return o.$refs.fileSelector.onSelect()},create:function(t){return o.$refs.fileSelector.createNewFolder(t)}}})]},proxy:!0}]),model:{value:o.showSavePathSelect,callback:function(t){o.showSavePathSelect=t},expression:"showSavePathSelect"}},[o.showSavePathSelect?l("file-select",{ref:"fileSelector",attrs:{parent:"root",type:2},on:{onSelect:o.onSelectPath,onCancel:function(t){o.showSavePathSelect=!1}}}):o._e()],1)],1)},[],!1,null,"56e193be",null).exports,c={STATE_PARSING:0,STATE_WAITING_SELECT_FILE:1,STATE_WAITING:2,STATE_DOWNLOADING:3,STATE_PAUSE:4,STATE_FAILD:5,STATE_COMPLETED:9,STATE_DELETED:10},n={components:{btSelectDownloadFile:n,btAddTask:o,myHeader:a.a},data(){return{selectedTask:null,showSelectFileDialog:!1,selectFileTreeData:[],refreshInterval:null,intervalTime:2e3,pageSize:1e3,loading:!1,hasMore:!0,showAddModal:!1,orderField:"create_time",orderType:"desc",taskStateConst:c,taskState:c.STATE_DOWNLOADING,taskList:[],statOptionList:[{title:this.$t("bt.downloading"),id:c.STATE_DOWNLOADING},{title:this.$t("bt.completed"),id:c.STATE_COMPLETED},{title:this.$t("file.trashBin"),id:c.STATE_DELETED}],rightMenuList:[{text:this.$t("file.check"),type:"CHECK"},{text:this.$t("common.delete"),type:"DELETE"}]}},mounted(){this.refreshInterval||(this.refreshInterval=setInterval(()=>{this.taskState==c.STATE_DOWNLOADING&&this.getTaskList()},this.intervalTime)),this.loadFirstPage()},beforeDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval)},methods:{onTaskClick(t,e){t.task_state==c.STATE_WAITING_SELECT_FILE?this.selectDownloadFile(t,e):t.task_state==c.STATE_DOWNLOADING?this.operationTask(t.id,"PAUSE"):t.task_state==c.STATE_PAUSE?this.operationTask(t.id,"START"):t.task_state==c.STATE_WAITING&&this.operationTask(t.id,"RESTART")},operationAllTask(t,e){this.showVsConfirmDialog(this.$t("common.confirm"),t,()=>{this.api.post("/api/downloadApi/operationAllTask",{operation:e,taskState:this.taskState}).then(t=>{if(!t.code)return this.showVsNotification(this.$t("common.operationSuccess"))}).catch(t=>{})})},operationTask(t,e){this.api.post("/api/downloadApi/operationTask",{taskId:t,operation:e}).then(t=>{t.code||this.showVsNotification(this.$t("common.operationSuccess"))})},selectDownloadFile(t,e){this.api.post("/api/downloadApi/getTaskDetail",{taskId:t.id}).then(t=>{t.code||(this.selectedTask=t.data,this.showSelectFileDialog=!0)})},onDeleteTask(s){this.showVsConfirmDialog(this.$t("common.confirm"),this.$t("common.deleteSure"),()=>{this.api.post("/api/downloadApi/deleteTask",{taskId:s.id}).then(t=>{if(!t.code){for(var e in this.taskList)this.taskList[e].id==s.id&&this.taskList.splice(e,1);return this.showVsNotification(this.$t("common.deleteSuccess"))}}).catch(t=>{})})},onChooseState(t){this.taskState=t,this.loadFirstPage()},loadFirstPage(){this.loading=!1,this.hasMore=!0,this.getTaskList()},getTaskStateStr(t){switch(t){case c.STATE_PARSING:return this.$t("bt.parsing");case c.STATE_WAITING_SELECT_FILE:return this.$t("bt.selectDownloadFile");case c.STATE_WAITING:return this.$t("bt.waitting");case c.STATE_DOWNLOADING:return this.$t("bt.downloading");case c.STATE_PAUSE:return this.$t("bt.pause");case c.STATE_FAILD:return this.$t("common.faild");case c.STATE_COMPLETED:return this.$t("bt.completed");case c.STATE_DELETED:return this.$t("bt.deleted")}},getTaskList(){var t;this.loading||(t={hideLoading:this.loading=!0,count:this.pageSize,offset:0,orderField:this.orderField,orderType:this.orderType,taskState:this.taskState},this.api.post("/api/downloadApi/getTaskList",t).then(t=>{t.code||JSON.stringify(this.taskList)!=JSON.stringify(t.data)&&(this.taskList=t.data,t.data.length<this.pageSize)&&(this.hasMore=!1),this.loading=!1}).catch(t=>{this.loading=!1}))},onAddSuccess(){this.taskState=c.STATE_DOWNLOADING,this.showAddModal=!1,this.loadFirstPage()}}},o=(s("a716"),Object(l.a)(n,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"bt-root"},[i("my-bg"),a._m(0),i("div",{staticClass:"nas-mobile-none"},[i("my-header")],1),a.isFromApp?a._e():i("my-btn-icon",{staticClass:"nas-mobile-show",staticStyle:{position:"fixed",bottom:"50px",left:"15px","z-index":"1000"},attrs:{type:"grey",iIcon:"md-home"},on:{click:a.goHome}}),a.taskList.length<1?i("my-nodata",{staticStyle:{position:"absolute",width:"100%","margin-top":"250px","z-index":"2"},attrs:{btnTitle:a.$t("btAddTask"),title:a.$t("btDownloadAlert")},on:{onBtnClick:function(t){a.showAddModal=!0}}}):a._e(),i("div",{staticClass:"main-layout  nas-padding-right-zero nas-padding-left-zero"},[i("div",{staticClass:"bt-list-parent"},[i("div",{staticClass:"header-root"},[i("div",{staticStyle:{display:"flex","white-space":"nowrap","align-items":"center"}},[i("Tooltip",{attrs:{content:a.$t("btAddTask"),disabled:a.isMobile}},[i("my-btn-icon",{staticStyle:{"margin-right":"10px"},attrs:{iIcon:"md-add"},on:{click:function(t){a.showAddModal=!0}}})],1),i("my-menu-select",{ref:"listTypeMenu",staticStyle:{"margin-left":"10px"},attrs:{shrinkModeTh:260,optionList:a.statOptionList},on:{onItemClick:a.onChooseState}})],1)]),i("div",{staticClass:"bt-list-root"},[0<a.taskList.length&&a.taskState==a.taskStateConst.STATE_DOWNLOADING?i("Card",{staticClass:"card-root",staticStyle:{"text-align":"left"}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[i("div",[i("a",{staticStyle:{"margin-right":"20px"},on:{click:function(t){a.operationAllTask(a.$t("bt.startAll")+"?","START_ALL")}}},[a._v(a._s(a.$t("bt.startAll")))]),i("a",{staticStyle:{"margin-right":"20px"},on:{click:function(t){a.operationAllTask(a.$t("bt.pauseAll")+"?","PAUSE_ALL")}}},[a._v(a._s(a.$t("bt.pauseAll")))])]),i("a",{staticClass:"delete-all",on:{click:function(t){a.operationAllTask(a.$t("bt.deleteAll")+"?","DELETE_ALL")}}},[a._v(a._s(a.$t("bt.deleteAll")))])])]):a._e(),i("div",{staticStyle:{width:"100%",height:"100%","overflow-y":"scroll","margin-top":"10px"}},[a._l(a.taskList,function(e,s){return i("Card",{staticClass:"card-root",style:{"margin-top":0==s?"0px":"10px"}},[i("div",{staticClass:"item-row"},[i("p",{staticClass:"max-line-one",staticStyle:{"text-align":"left","padding-right":"30px"}},["MAGNET"==e.task_type?i("span",{staticClass:"text-title"},[a._v(a._s(a.$t("bt.magnet"))+":")]):a._e(),"HTTP"==e.task_type?i("span",{staticClass:"text-title"},[a._v("HTTP:")]):a._e(),"TORRENT"==e.task_type?i("span",{staticClass:"text-title "},[a._v(a._s(a.$t("bt.torrent"))+":")]):a._e(),a._v(" "+a._s(e.torrent_path)+" ")])]),i("div",{staticClass:"item-row"},[i("vs-tooltip",{attrs:{disabled:a.isMobile},scopedSlots:a._u([{key:"tooltip",fn:function(){return[a._v(" "+a._s(e.task_name)+" ")]},proxy:!0}],null,!0)},[i("p",{staticClass:"max-line-one",staticStyle:{"text-align":"left","padding-right":"30px"}},[i("span",{staticClass:"text-title"},[a._v(a._s(a.$t("bt.taskName"))+":")]),a._v(" "+a._s(e.task_name)+" ")])])],1),i("div",{staticClass:"item-row"},[i("b",{staticClass:"item-title"},[a._v(a._s(a.$t("bt.taskState"))+":")]),i("div",{staticStyle:{cursor:"pointer",display:"flex","align-items":"center"},on:{click:function(t){return a.onTaskClick(e,s)}}},[i("span",{class:{state_normal:e.task_state==a.taskStateConst.STATE_COMPLETED,state_blue:e.task_state!=a.taskStateConst.STATE_COMPLETED}},[a._v(a._s(a.getTaskStateStr(e.task_state)))]),e.task_state==a.taskStateConst.STATE_PAUSE?i("Icon",{staticClass:"icon-start-download",attrs:{type:"md-play"}}):a._e(),e.task_state==a.taskStateConst.STATE_DOWNLOADING?i("Icon",{staticClass:"icon-start-download",attrs:{type:"md-pause"}}):a._e()],1)]),(e.download_speed||e.upload_speed)&&e.task_state==a.taskStateConst.STATE_DOWNLOADING?i("div",{staticClass:"item-row"},[i("b",{staticClass:"item-title"},[a._v(a._s(a.$t("bt.taskSpeed"))+":")]),i("p",{staticClass:"item-text"},[e.download_speed?i("span",{staticStyle:{"margin-right":"20px"}},[a._v(a._s(a.$t("common.download"))+":"+a._s(a.utils.getSizeStr(e.download_speed))+" /s")]):a._e(),e.upload_speed?i("span",[a._v(a._s(a.$t("common.upload"))+":"+a._s(a.utils.getSizeStr(e.upload_speed))+" /s")]):a._e()])]):a._e(),e.downloaded?i("div",{staticClass:"item-row"},[i("b",{staticClass:"item-title"},[a._v(a._s(a.$t("bt.taskProgress"))+":")]),i("p",{staticClass:"item-text"},[e.downloaded?i("span",[a._v(a._s(a.utils.getSizeStr(e.downloaded)))]):a._e(),e.total_size?i("span",[a._v("/")]):a._e(),e.total_size?i("span",[a._v(a._s(a.utils.getSizeStr(e.total_size)))]):a._e()])]):a._e(),e.save_path?i("div",{staticClass:"item-row"},[i("b",{staticClass:"item-title"},[a._v(a._s(a.$t("bt.downloadTo"))+":")]),i("p",{staticClass:"item-text"},[a._v(a._s(e.save_path))])]):a._e(),i("div",{staticClass:"operation-root"},[i("Tooltip",{attrs:{disabled:a.isMobile,content:a.$t("common.delete")}},[i("Icon",{staticClass:"operation-icon",attrs:{type:"ios-trash"},on:{click:function(t){return a.onDeleteTask(e)}}})],1)],1)])}),i("div",{staticStyle:{height:"50px"}})],2)],1)])]),i("vs-dialog",{attrs:{"prevent-close":"","mask-closable":!1,scrollable:"",mask:!1,title:a.$t("btAddTask"),"footer-hide":""},scopedSlots:a._u([{key:"header",fn:function(){return[i("h4",{staticStyle:{"font-size":"16px"}},[a._v(" "+a._s(a.$t("btAddTask"))+" ")])]},proxy:!0}]),model:{value:a.showAddModal,callback:function(t){a.showAddModal=t},expression:"showAddModal"}},[a.showAddModal?i("btAddTask",{on:{onSuccess:a.onAddSuccess}}):a._e()],1),i("vs-dialog",{attrs:{"prevent-close":"","mask-closable":!1,scrollable:"",mask:!1,"footer-hide":""},model:{value:a.showSelectFileDialog,callback:function(t){a.showSelectFileDialog=t},expression:"showSelectFileDialog"}},[a.selectedTask?i("btSelectDownloadFile",{attrs:{selectedTask:a.selectedTask},on:{onFinish:function(t){a.showSelectFileDialog=!1}}}):a._e()],1)],1)},[function(){var t=this.$createElement,t=this._self._c||t;return t("div",{staticClass:"nas-mobile-none"},[t("p",{staticClass:"my-header-position"})])}],!1,null,"b46d095e",null));e.default=o.exports},"2f4c":function(t,e,s){},"9f11":function(t,e,s){"use strict";s("a0c8")},a0c8:function(t,e,s){},a716:function(t,e,s){"use strict";s("293c")},d772:function(t,e,s){"use strict";s("2f4c")}}]);