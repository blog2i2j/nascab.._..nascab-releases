const _0x43f4d2=_0x4076;(function(_0x1b8982,_0x583265){const _0x59c870=_0x4076,_0x3ac694=_0x1b8982();while(!![]){try{const _0x53778c=parseInt(_0x59c870(0x1ac))/0x1*(parseInt(_0x59c870(0x1a8))/0x2)+-parseInt(_0x59c870(0x1a2))/0x3+-parseInt(_0x59c870(0x1b0))/0x4+-parseInt(_0x59c870(0x19c))/0x5*(-parseInt(_0x59c870(0x1be))/0x6)+parseInt(_0x59c870(0x1b8))/0x7+parseInt(_0x59c870(0x1af))/0x8+-parseInt(_0x59c870(0x1c2))/0x9;if(_0x53778c===_0x583265)break;else _0x3ac694['push'](_0x3ac694['shift']());}catch(_0x4d5b9c){_0x3ac694['push'](_0x3ac694['shift']());}}}(_0x1a59,0x99262));let dbConfigTable=require('../db/dbConfigTable'),updateUtil={};function _0x4076(_0x5d32cc,_0x87b95d){const _0x1a5962=_0x1a59();return _0x4076=function(_0x407624,_0x58c9e3){_0x407624=_0x407624-0x197;let _0x5db8ad=_0x1a5962[_0x407624];return _0x5db8ad;},_0x4076(_0x5d32cc,_0x87b95d);}const config=require('../myConfig/config'),Database=require(_0x43f4d2(0x1a3)),log=require(_0x43f4d2(0x19f)),os=require('os'),dbOther=new Database(config['dbOther'],{});let versionInfo='',bgTaskId='',app;try{app=require(_0x43f4d2(0x1a6))[_0x43f4d2(0x19d)];}catch(_0x273d8d){console[_0x43f4d2(0x1a0)](_0x43f4d2(0x1a9));}const dbNoticeCenterTable=require(_0x43f4d2(0x198));function saveMsg(_0x4a6c80,_0x3a2073,_0x398f77){dbNoticeCenterTable['create'](dbOther,{'title':_0x4a6c80,'level':_0x3a2073,'content':_0x398f77});}let {autoUpdater}=require('electron-updater');const globalInfoUtil=require(_0x43f4d2(0x1a7));function _0x1a59(){const _0x46a786=['platform','PACKAGE_UPDATE','6472340kUjvza','upDateUrl','downloading','parse','run','percent','48eYWsdD','setFeedURL','UPDATE\x20bg_task\x20SET\x20task_state=?\x20where\x20id=?','versionInfo','7718877ZQolsu','exports','../db/dbNoticeCenterTable','update-available','exit','done','294070aLymja','app','getVersionFromDb','electron-log','log','quitAndInstall','2769144vUUUgq','better-sqlite3','error','status','electron','./globalInfoUtil','10ptklMK','Clientless\x20service\x20mode','logger','update-downloaded','62221bqxVtZ','value','stringify','6762896rrULxs','574400lbQzwC','checkForUpdates','prepare','checking-for-update','removeAllListeners','started'];_0x1a59=function(){return _0x46a786;};return _0x1a59();}function saveStatus(_0x4b92c4,_0x55aa1a){const _0x578de3=_0x43f4d2;versionInfo[_0x578de3(0x1a5)]=_0x4b92c4,setVersionInfoToDb(),_0x4b92c4=='done'&&bgTaskId&&dbOther[_0x578de3(0x1b2)](_0x578de3(0x1c0))[_0x578de3(0x1bc)](_0x55aa1a?0x2:0x3,bgTaskId);}function getVersionFromDb(){const _0x306809=_0x43f4d2;let _0x2ac284=dbConfigTable['findByTitle'](dbOther,'versionInfo');if(_0x2ac284)try{return _0x2ac284=JSON[_0x306809(0x1bb)](_0x2ac284[_0x306809(0x1ad)]),_0x2ac284;}catch(_0x1484c8){return console[_0x306809(0x1a0)](_0x306809(0x1a4),_0x1484c8),'';}else return'';}updateUtil[_0x43f4d2(0x19e)]=getVersionFromDb;function setVersionInfoToDb(){const _0x2f921b=_0x43f4d2;let _0x27d34a={'title':_0x2f921b(0x1c1),'value':JSON[_0x2f921b(0x1ae)](versionInfo)};dbConfigTable['create'](dbOther,_0x27d34a);}updateUtil['startUpdate']=function(){const _0x5be21a=_0x43f4d2;try{versionInfo=getVersionFromDb();if(!versionInfo)return;if(versionInfo['status']&&versionInfo[_0x5be21a(0x1a5)]!=_0x5be21a(0x19b))return;saveStatus(_0x5be21a(0x1b5)),autoUpdater[_0x5be21a(0x1aa)]=log,autoUpdater[_0x5be21a(0x1bf)](versionInfo[_0x5be21a(0x1b9)]),autoUpdater[_0x5be21a(0x1b1)]()['catch'](_0x1d298e=>{const _0x515fe5=_0x5be21a;saveStatus(_0x515fe5(0x19b),![]);}),autoUpdater['on'](_0x5be21a(0x1a4),_0x526ae2=>{const _0x5398be=_0x5be21a;saveStatus(_0x5398be(0x19b),![]);}),autoUpdater['on'](_0x5be21a(0x1b3),()=>{}),autoUpdater['on'](_0x5be21a(0x199),()=>{const _0x2e55e3=_0x5be21a;let _0x136b1f=dbOther[_0x2e55e3(0x1b2)]('INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)')[_0x2e55e3(0x1bc)](_0x2e55e3(0x1b7));bgTaskId=_0x136b1f['lastInsertRowid'],dbOther[_0x2e55e3(0x1b2)]('UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id='+bgTaskId)[_0x2e55e3(0x1bc)]();}),autoUpdater['on']('update-not-available',()=>{const _0x57d869=_0x5be21a;saveStatus(_0x57d869(0x19b),!![]);}),autoUpdater['on']('download-progress',_0x12fc6a=>{const _0xcd53cf=_0x5be21a;saveStatus(_0xcd53cf(0x1ba)),bgTaskId&&dbOther['prepare']('UPDATE\x20bg_task\x20SET\x20progress_current=?,progress_all=?\x20where\x20id=?\x20and\x20task_state=1')['run'](_0x12fc6a[_0xcd53cf(0x1bd)],0x64,bgTaskId);}),autoUpdater['on'](_0x5be21a(0x1ab),()=>{const _0x1b749b=_0x5be21a;saveStatus('done',!![]),os[_0x1b749b(0x1b6)]()=='darwin'?setTimeout(()=>{const _0x3da209=_0x1b749b;if(app)app[_0x3da209(0x1b4)]('window-all-closed');autoUpdater[_0x3da209(0x1a1)]();if(app)app[_0x3da209(0x19a)]();},0x1f40):setTimeout(()=>{const _0x259562=_0x1b749b;autoUpdater[_0x259562(0x1a1)]();},0xbb8);});}catch(_0x5b6e9d){console['log'](_0x5b6e9d);}},module[_0x43f4d2(0x197)]=updateUtil;