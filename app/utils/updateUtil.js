const _0x53827e=_0x4fae;(function(_0x59afdf,_0x19e9ec){const _0xc3db94=_0x4fae,_0x300bb5=_0x59afdf();while(!![]){try{const _0x479599=parseInt(_0xc3db94(0x17b))/0x1*(parseInt(_0xc3db94(0x193))/0x2)+parseInt(_0xc3db94(0x199))/0x3+parseInt(_0xc3db94(0x18b))/0x4*(-parseInt(_0xc3db94(0x18a))/0x5)+-parseInt(_0xc3db94(0x18d))/0x6*(parseInt(_0xc3db94(0x174))/0x7)+-parseInt(_0xc3db94(0x16e))/0x8*(parseInt(_0xc3db94(0x170))/0x9)+parseInt(_0xc3db94(0x195))/0xa*(parseInt(_0xc3db94(0x192))/0xb)+-parseInt(_0xc3db94(0x181))/0xc*(-parseInt(_0xc3db94(0x173))/0xd);if(_0x479599===_0x19e9ec)break;else _0x300bb5['push'](_0x300bb5['shift']());}catch(_0x5573a1){_0x300bb5['push'](_0x300bb5['shift']());}}}(_0x426b,0xb6ac3));let dbConfigTable=require(_0x53827e(0x172)),updateUtil={};const config=require(_0x53827e(0x187)),Database=require(_0x53827e(0x17c)),log=require(_0x53827e(0x188)),os=require('os'),dbOther=new Database(config[_0x53827e(0x16b)],{});let versionInfo='',bgTaskId='',app;try{app=require(_0x53827e(0x190))[_0x53827e(0x19d)];}catch(_0x1ec635){console['log'](_0x53827e(0x18f));}const dbNoticeCenterTable=require(_0x53827e(0x19b));function saveMsg(_0x20754b,_0x10ba55,_0x225e71){dbNoticeCenterTable['create'](dbOther,{'title':_0x20754b,'level':_0x10ba55,'content':_0x225e71});}function _0x426b(){const _0x4b2d77=['UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','darwin','2975496XlWtZP','quitAndInstall','versionInfo','value','UPDATE\x20bg_task\x20SET\x20task_state=?\x20where\x20id=?','done','../myConfig/config','electron-log','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','45hRRNhU','595128ntuFyx','status','4014ddxnKm','logger','Clientless\x20service\x20mode','electron','exit','599269ShGlUf','8NPaJcR','checkForUpdates','10ufSQlS','exports','removeAllListeners','electron-updater','1627008fraSth','run','../db/dbNoticeCenterTable','checking-for-update','app','parse','error','UPDATE\x20bg_task\x20SET\x20progress_current=?,progress_all=?\x20where\x20id=?\x20and\x20task_state=1','catch','dbOther','lastInsertRowid','download-progress','600iFyFmz','setFeedURL','137232EpdCwP','update-not-available','../db/dbConfigTable','143ZHiIbj','1512HdwRdW','log','update-downloaded','getVersionFromDb','create','percent','startUpdate','12754dOFFcJ','better-sqlite3','findByTitle','prepare'];_0x426b=function(){return _0x4b2d77;};return _0x426b();}let {autoUpdater}=require(_0x53827e(0x198));const globalInfoUtil=require('./globalInfoUtil');function saveStatus(_0x541ef1,_0x187eda){const _0x38eec8=_0x53827e;versionInfo[_0x38eec8(0x18c)]=_0x541ef1,setVersionInfoToDb(),_0x541ef1==_0x38eec8(0x186)&&bgTaskId&&dbOther[_0x38eec8(0x17e)](_0x38eec8(0x185))[_0x38eec8(0x19a)](_0x187eda?0x2:0x3,bgTaskId);}function getVersionFromDb(){const _0x8f925=_0x53827e;let _0x576e06=dbConfigTable[_0x8f925(0x17d)](dbOther,_0x8f925(0x183));if(_0x576e06)try{return _0x576e06=JSON[_0x8f925(0x19e)](_0x576e06[_0x8f925(0x184)]),_0x576e06;}catch(_0x468f03){return console[_0x8f925(0x175)]('error',_0x468f03),'';}else return'';}function _0x4fae(_0xfe3070,_0x59a09f){const _0x426bc0=_0x426b();return _0x4fae=function(_0x4fae3e,_0x3774dc){_0x4fae3e=_0x4fae3e-0x16a;let _0x327599=_0x426bc0[_0x4fae3e];return _0x327599;},_0x4fae(_0xfe3070,_0x59a09f);}updateUtil[_0x53827e(0x177)]=getVersionFromDb;function setVersionInfoToDb(){const _0x407e61=_0x53827e;let _0x5876c3={'title':_0x407e61(0x183),'value':JSON['stringify'](versionInfo)};dbConfigTable[_0x407e61(0x178)](dbOther,_0x5876c3);}updateUtil[_0x53827e(0x17a)]=function(){const _0x1a2140=_0x53827e;try{versionInfo=getVersionFromDb();if(!versionInfo)return;if(versionInfo['status']&&versionInfo[_0x1a2140(0x18c)]!='done')return;saveStatus('started'),autoUpdater[_0x1a2140(0x18e)]=log,autoUpdater[_0x1a2140(0x16f)](versionInfo['upDateUrl']),autoUpdater[_0x1a2140(0x194)]()[_0x1a2140(0x16a)](_0x36f66e=>{saveStatus('done',![]);}),autoUpdater['on'](_0x1a2140(0x19f),_0x129ac2=>{const _0x58556f=_0x1a2140;saveStatus(_0x58556f(0x186),![]);}),autoUpdater['on'](_0x1a2140(0x19c),()=>{}),autoUpdater['on']('update-available',()=>{const _0x54171e=_0x1a2140;let _0x18909b=dbOther[_0x54171e(0x17e)](_0x54171e(0x189))['run']('PACKAGE_UPDATE');bgTaskId=_0x18909b[_0x54171e(0x16c)],dbOther['prepare'](_0x54171e(0x17f)+bgTaskId)[_0x54171e(0x19a)]();}),autoUpdater['on'](_0x1a2140(0x171),()=>{const _0x46326c=_0x1a2140;saveStatus(_0x46326c(0x186),!![]);}),autoUpdater['on'](_0x1a2140(0x16d),_0x1ba0c2=>{const _0x124cf3=_0x1a2140;saveStatus('downloading'),bgTaskId&&dbOther[_0x124cf3(0x17e)](_0x124cf3(0x1a0))[_0x124cf3(0x19a)](_0x1ba0c2[_0x124cf3(0x179)],0x64,bgTaskId);}),autoUpdater['on'](_0x1a2140(0x176),()=>{const _0x397c89=_0x1a2140;saveStatus(_0x397c89(0x186),!![]),os['platform']()==_0x397c89(0x180)?setTimeout(()=>{const _0x36d916=_0x397c89;if(app)app[_0x36d916(0x197)]('window-all-closed');autoUpdater[_0x36d916(0x182)]();if(app)app[_0x36d916(0x191)]();},0x1f40):setTimeout(()=>{const _0x29df46=_0x397c89;autoUpdater[_0x29df46(0x182)]();},0xbb8);});}catch(_0x398c50){console[_0x1a2140(0x175)](_0x398c50);}},module[_0x53827e(0x196)]=updateUtil;