const _0x2c43b0=_0x5512;(function(_0x32711a,_0x3f269b){const _0x18d1f8=_0x5512,_0x1c1aa8=_0x32711a();while(!![]){try{const _0x39187e=-parseInt(_0x18d1f8(0x12c))/0x1*(-parseInt(_0x18d1f8(0x13f))/0x2)+parseInt(_0x18d1f8(0x148))/0x3*(-parseInt(_0x18d1f8(0x13e))/0x4)+-parseInt(_0x18d1f8(0x12d))/0x5*(parseInt(_0x18d1f8(0x14d))/0x6)+-parseInt(_0x18d1f8(0x151))/0x7*(parseInt(_0x18d1f8(0x120))/0x8)+-parseInt(_0x18d1f8(0x12b))/0x9*(-parseInt(_0x18d1f8(0x14e))/0xa)+parseInt(_0x18d1f8(0x149))/0xb*(parseInt(_0x18d1f8(0x140))/0xc)+parseInt(_0x18d1f8(0x142))/0xd;if(_0x39187e===_0x3f269b)break;else _0x1c1aa8['push'](_0x1c1aa8['shift']());}catch(_0xbe5cb5){_0x1c1aa8['push'](_0x1c1aa8['shift']());}}}(_0x4e95,0x9275f));let FFmpeg=require(_0x2c43b0(0x155))[_0x2c43b0(0x13a)];function _0x4e95(){const _0x11fd3c=['length','saveLastMatchTime','codec_type','width','lastTimeStampMatchMovieInfo','indexOf','FFmpeg','getAllByWhere','getTime','trim','24SqHRmX','214GRKxST','5484QLfSTI','parseVideoWH','18533281FUrFGY','rotate','movie_genres','movie_language','../db/dbFileIndexTable','movie_regions','241527LdALdK','22429mQCKsG','includes','video','file_index_movie','102HivHDk','210HjsJDo','creation_time','rotation','35RdksAj','DURATION','prepare','N/A','../libs/nasTrans','getDurationFromStream','\x20WHERE\x20title=\x27lastTimeStampMatchMovieInfo\x27','REPLACE\x20INTO\x20\x20movie_keys(key_type,key_value,index_count)\x20VALUES(\x27','1154072DbVbni','tags','parseMovieKeys','duration','./transCodeUtil','REPLACE\x20INTO\x20config(title,value)\x20values(\x27lastTimeStampMatchMovieInfo\x27,','exports','height','push','split','run','76086ZLRNmq','4373vgljev','352545SpPwTI','\x27,\x20\x27','format','value','findByTitle','../db/dbConfigTable','com.apple.quicktime.creationdate'];_0x4e95=function(){return _0x11fd3c;};return _0x4e95();}const dbConfigTable=require(_0x2c43b0(0x132)),dbFileIndexTable=require(_0x2c43b0(0x146)),transCodeUtil=require(_0x2c43b0(0x124));let videoStreamUtil={};function timeToSec(_0x160d2d){const _0x2a616e=_0x2c43b0;var _0x1e6c81='',_0x4b1364=_0x160d2d[_0x2a616e(0x129)](':')[0x0],_0x381bdb=_0x160d2d[_0x2a616e(0x129)](':')[0x1],_0x580731=_0x160d2d[_0x2a616e(0x129)](':')[0x2];return _0x1e6c81=parseFloat(_0x4b1364*0xe10)+parseFloat(_0x381bdb*0x3c)+parseFloat(_0x580731),_0x1e6c81;};videoStreamUtil[_0x2c43b0(0x135)]=function(_0xea9d1){const _0x5c543a=_0x2c43b0;let _0x10bb81=dbConfigTable[_0x5c543a(0x131)](_0xea9d1,_0x5c543a(0x138));!_0x10bb81?_0xea9d1[_0x5c543a(0x153)](_0x5c543a(0x125)+new Date()[_0x5c543a(0x13c)]()+')')['run']():_0xea9d1[_0x5c543a(0x153)]('UPDATE\x20config\x20SET\x20value='+new Date()[_0x5c543a(0x13c)]()+_0x5c543a(0x157))['run']();};function _0x5512(_0x201daa,_0x112d7a){const _0x4e9529=_0x4e95();return _0x5512=function(_0x551253,_0x7279a3){_0x551253=_0x551253-0x11f;let _0x4a9268=_0x4e9529[_0x551253];return _0x4a9268;},_0x5512(_0x201daa,_0x112d7a);}let lastMovieInfoUpdateTime=0x0;videoStreamUtil['goParseMoviesKeys']=function(_0x544344,_0x32a7d4,_0x321f07){const _0x1a4732=_0x2c43b0;let _0x28a92e=dbConfigTable['findByTitle'](_0x544344,_0x1a4732(0x138));if(_0x321f07)videoStreamUtil[_0x1a4732(0x122)](_0x32a7d4);else _0x28a92e&&lastMovieInfoUpdateTime!=_0x28a92e[_0x1a4732(0x130)]&&(videoStreamUtil[_0x1a4732(0x122)](_0x32a7d4),lastMovieInfoUpdateTime=_0x28a92e['value']);};let isParsingMovie=![];videoStreamUtil[_0x2c43b0(0x122)]=function(_0x553c58){const _0x16dd9c=_0x2c43b0;if(isParsingMovie)return;let _0x3d1319={};isParsingMovie=!![];let _0x2d445b=dbFileIndexTable[_0x16dd9c(0x13b)](_0x553c58,'\x20movie_info_state=1\x20and\x20is_file=1\x20and\x20type=2','movie_regions,movie_language,movie_genres',_0x16dd9c(0x14c)),_0x30a295=[],_0xebecf5=[],_0x437fe7=[];function _0x1440c6(_0x519560,_0xee8e29,_0x3d07b2){const _0x493c26=_0x16dd9c;if(_0x519560){if(_0x519560[_0x493c26(0x139)]('/')!=-0x1){let _0x562d27=_0x519560[_0x493c26(0x129)]('/');for(let _0x5529ea in _0x562d27){_0x562d27[_0x5529ea]&&(!_0xee8e29[_0x493c26(0x14a)](_0x562d27[_0x5529ea][_0x493c26(0x13d)]())?(_0xee8e29[_0x493c26(0x128)](_0x562d27[_0x5529ea][_0x493c26(0x13d)]()),_0x3d1319[_0x3d07b2+_0x562d27[_0x5529ea][_0x493c26(0x13d)]()]=0x1):_0x3d1319[_0x3d07b2+_0x562d27[_0x5529ea]['trim']()]+=0x1);}}else!_0xee8e29[_0x493c26(0x14a)](_0x519560[_0x493c26(0x13d)]())?(_0xee8e29[_0x493c26(0x128)](_0x519560[_0x493c26(0x13d)]()),_0x3d1319[_0x3d07b2+_0x519560[_0x493c26(0x13d)]()]=0x1):_0x3d1319[_0x3d07b2+_0x519560[_0x493c26(0x13d)]()]+=0x1;}for(let _0x382461=0x0;_0x382461<_0xee8e29[_0x493c26(0x134)];_0x382461++){const _0x308c93=_0x493c26(0x11f)+_0x3d07b2+_0x493c26(0x12e)+_0xee8e29[_0x382461]+'\x27,'+_0x3d1319[_0x3d07b2+_0xee8e29[_0x382461]]+')';_0x553c58[_0x493c26(0x153)](_0x308c93)[_0x493c26(0x12a)]();}}if(_0x2d445b&&_0x2d445b[_0x16dd9c(0x134)]>0x0){_0x553c58[_0x16dd9c(0x153)]('UPDATE\x20movie_keys\x20SET\x20index_count=0\x20where\x201=1')[_0x16dd9c(0x12a)]();for(let _0x14445f=0x0;_0x14445f<_0x2d445b[_0x16dd9c(0x134)];_0x14445f++){let _0x27770d=_0x2d445b[_0x14445f],_0x54bdc2=_0x27770d[_0x16dd9c(0x144)],_0x47eb0b=_0x27770d['movie_language'],_0x307907=_0x27770d[_0x16dd9c(0x147)];_0x1440c6(_0x54bdc2,_0x437fe7,_0x16dd9c(0x144)),_0x1440c6(_0x47eb0b,_0x30a295,_0x16dd9c(0x145)),_0x1440c6(_0x307907,_0xebecf5,'movie_regions');}}else _0x553c58[_0x16dd9c(0x153)]('DELETE\x20FROM\x20movie_keys\x20where\x201=1')[_0x16dd9c(0x12a)]();isParsingMovie=![];},videoStreamUtil['getVideoOriginalTime']=function(_0x31e019){const _0x1c5ac6=_0x2c43b0;let _0x15f857=new Date()[_0x1c5ac6(0x13c)]();if(_0x31e019&&_0x31e019['format']&&_0x31e019[_0x1c5ac6(0x12f)][_0x1c5ac6(0x121)]){let _0x284f5a=_0x31e019[_0x1c5ac6(0x12f)][_0x1c5ac6(0x121)][_0x1c5ac6(0x133)],_0x3c4a68=null;_0x284f5a&&(_0x3c4a68=_0x284f5a,_0x15f857=new Date(_0x3c4a68)[_0x1c5ac6(0x13c)]()),!_0x3c4a68&&_0x31e019[_0x1c5ac6(0x12f)]['tags'][_0x1c5ac6(0x14f)]&&(_0x3c4a68=_0x31e019[_0x1c5ac6(0x12f)]['tags'][_0x1c5ac6(0x14f)],_0x15f857=new Date(_0x3c4a68)[_0x1c5ac6(0x13c)]());}return _0x15f857;},videoStreamUtil[_0x2c43b0(0x156)]=function(_0x32a21b){const _0x264018=_0x2c43b0;let _0x505b72=_0x32a21b['streams'];if(_0x32a21b&&_0x32a21b[_0x264018(0x12f)]&&_0x32a21b[_0x264018(0x12f)][_0x264018(0x123)]){let _0xbb98e1=_0x32a21b[_0x264018(0x12f)][_0x264018(0x123)];if(_0xbb98e1&&_0xbb98e1!=_0x264018(0x154)&&!isNaN(_0xbb98e1)&&_0xbb98e1>0x0)return _0xbb98e1;}for(let _0x60fc4a=0x0;_0x60fc4a<_0x505b72[_0x264018(0x134)];_0x60fc4a++){let _0x1d9576=_0x505b72[_0x60fc4a];if(_0x1d9576[_0x264018(0x123)]&&_0x1d9576[_0x264018(0x123)]!='N/A'&&!isNaN(_0x1d9576[_0x264018(0x123)])&&_0x1d9576[_0x264018(0x123)]>0x0)return _0x1d9576[_0x264018(0x123)];if(_0x1d9576['tags']){if(_0x1d9576[_0x264018(0x121)][_0x264018(0x152)]||_0x1d9576['tags'][_0x264018(0x123)]){let _0x51fb7b=_0x1d9576['tags'][_0x264018(0x152)]||_0x1d9576['tags'][_0x264018(0x123)];if(_0x51fb7b['indexOf'](':')!=-0x1)return timeToSec(_0x51fb7b);}}}return 0x0;},videoStreamUtil['getVideoMeta']=function(_0x55f601){return new Promise((_0x57a3bf,_0x46efd6)=>{FFmpeg(_0x55f601)['ffprobe']((_0x2c92ce,_0x2f4eed)=>{_0x2c92ce?_0x46efd6(_0x2c92ce):_0x57a3bf(_0x2f4eed);});});},videoStreamUtil[_0x2c43b0(0x141)]=function(_0x126ad5){const _0x2fea47=_0x2c43b0;let _0x38cc0b=0x0,_0x3ff159=0x0,_0x5c3180=0x0,_0x31f504=null;for(let _0x325c55=0x0;_0x325c55<_0x126ad5['length'];_0x325c55++){let _0x4f409d=_0x126ad5[_0x325c55];_0x4f409d[_0x2fea47(0x136)]==_0x2fea47(0x14b)&&(_0x31f504=_0x4f409d,_0x4f409d[_0x2fea47(0x150)]&&(_0x5c3180=_0x4f409d['rotation']),!_0x5c3180&&(_0x4f409d[_0x2fea47(0x121)]&&_0x4f409d['tags'][_0x2fea47(0x143)]&&(_0x5c3180=_0x4f409d['tags'][_0x2fea47(0x143)])));if(_0x4f409d[_0x2fea47(0x137)]&&_0x4f409d[_0x2fea47(0x127)]){if(_0x4f409d[_0x2fea47(0x137)]!='N/A'&&!isNaN(_0x4f409d['width'])&&_0x4f409d['width']>0x0){_0x38cc0b=_0x4f409d[_0x2fea47(0x137)],_0x3ff159=_0x4f409d[_0x2fea47(0x127)];break;}}}if((_0x5c3180==0x5a||_0x5c3180==-0x5a||_0x5c3180==0x10e)&&_0x38cc0b&&_0x3ff159){let _0x1037a3=_0x38cc0b,_0x2d5992=_0x3ff159;_0x38cc0b=_0x2d5992,_0x3ff159=_0x1037a3;}return{'videoHeight':_0x3ff159,'videoWidth':_0x38cc0b,'videoStream':_0x31f504};},module[_0x2c43b0(0x126)]=videoStreamUtil;