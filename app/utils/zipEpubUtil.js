const _0xf666c1=_0x3c45;function _0x3c45(_0x2570ff,_0x11f4ba){const _0x132eb1=_0x132e();return _0x3c45=function(_0x3c4577,_0x47eb80){_0x3c4577=_0x3c4577-0x137;let _0x3a99fe=_0x132eb1[_0x3c4577];return _0x3a99fe;},_0x3c45(_0x2570ff,_0x11f4ba);}(function(_0x59b86a,_0x3c161c){const _0x2955b5=_0x3c45,_0x3e6588=_0x59b86a();while(!![]){try{const _0x93f0c8=parseInt(_0x2955b5(0x14b))/0x1+parseInt(_0x2955b5(0x145))/0x2+parseInt(_0x2955b5(0x155))/0x3*(parseInt(_0x2955b5(0x13a))/0x4)+parseInt(_0x2955b5(0x13c))/0x5*(parseInt(_0x2955b5(0x14a))/0x6)+-parseInt(_0x2955b5(0x13d))/0x7*(parseInt(_0x2955b5(0x147))/0x8)+-parseInt(_0x2955b5(0x140))/0x9*(parseInt(_0x2955b5(0x153))/0xa)+parseInt(_0x2955b5(0x14e))/0xb*(-parseInt(_0x2955b5(0x141))/0xc);if(_0x93f0c8===_0x3c161c)break;else _0x3e6588['push'](_0x3e6588['shift']());}catch(_0x2befad){_0x3e6588['push'](_0x3e6588['shift']());}}}(_0x132e,0x47218));function _0x132e(){const _0x918e11=['endsWith','toLowerCase','hasOwnProperty','.jpg','10eLRBrq','flow','369813fqjsQw','path','getAttribute','getEpubFile','.html','window','12ZvyLRQ','exports','62955OyKvaR','14BZCzWe','replaceAll','img','3191247KvwJNu','10404zGXzch','manifest','href','getEpubImageList','891374qXWdpf','log','879800nmpfJN','querySelectorAll','sharp','42NKuITh','81894gBNxPO','getFile','end','1518sDEuXg'];_0x132e=function(){return _0x918e11;};return _0x132e();}const path=require(_0xf666c1(0x156));let zipEpubUtil={};const sharp=require(_0xf666c1(0x149)),fs=require('fs'),config=require('../myConfig/config'),EPub=require('epub'),{JSDOM}=require('jsdom');zipEpubUtil[_0xf666c1(0x137)]=(_0x5528f2,_0x3ee88e)=>{return new Promise((_0x3857c8,_0x10275e)=>{const _0x4e6d8f=_0x3c45;_0x5528f2[_0x4e6d8f(0x14c)](_0x3ee88e,(_0x3d64b7,_0x594fc7,_0x564776)=>{if(_0x3d64b7)return _0x3857c8(null);_0x3857c8(_0x594fc7,_0x564776);});});},zipEpubUtil[_0xf666c1(0x144)]=_0x12d927=>{return new Promise(async(_0x51bc2b,_0x3c5688)=>{const _0x361f83=_0x3c45;let _0x407ece=[],_0x4fc6f0=new EPub(_0x12d927);_0x4fc6f0['on'](_0x361f83(0x14d),async()=>{const _0x398b7e=_0x361f83;!_0x4fc6f0[_0x398b7e(0x154)]&&console[_0x398b7e(0x146)]('未找到epub清单文件');for(let _0x11fe86 of _0x4fc6f0[_0x398b7e(0x154)]){if(!_0x11fe86['href']||!_0x11fe86['id'])continue;let _0x3ae1b8=path['extname'](_0x11fe86['href']);if(!_0x3ae1b8)continue;_0x3ae1b8=_0x3ae1b8[_0x398b7e(0x150)]();if(_0x3ae1b8==_0x398b7e(0x138)){let _0x240e8a=await zipEpubUtil[_0x398b7e(0x137)](_0x4fc6f0,_0x11fe86['id']);try{const _0x6eaf6d=new JSDOM(_0x240e8a),_0x35a583=_0x6eaf6d[_0x398b7e(0x139)]['document'],_0x37d237=_0x35a583[_0x398b7e(0x148)](_0x398b7e(0x13f));_0x37d237['forEach'](_0x3c64a8=>{const _0x81e31f=_0x398b7e;let _0x4140c3=_0x3c64a8[_0x81e31f(0x157)]('src');_0x4140c3&&(_0x4140c3=_0x4140c3[_0x81e31f(0x13e)]('../',''),_0x407ece['push'](_0x4140c3));});}catch(_0xcd02d2){console[_0x398b7e(0x146)](_0xcd02d2);}}else{if(_0x3ae1b8==_0x398b7e(0x152)){let _0x5e9b8c=_0x11fe86[_0x398b7e(0x143)]['replaceAll']('../','');_0x407ece['push'](_0x5e9b8c);}}}let _0x26ffe5=[];if(_0x4fc6f0[_0x398b7e(0x142)]&&_0x4fc6f0[_0x398b7e(0x142)]instanceof Object)for(let _0x41a4d3 of _0x407ece){for(const _0x1bb1fd in _0x4fc6f0[_0x398b7e(0x142)]){if(_0x4fc6f0['manifest'][_0x398b7e(0x151)](_0x1bb1fd)){let _0x17f1d7=_0x4fc6f0['manifest'][_0x1bb1fd];if(_0x17f1d7['href']&&(_0x17f1d7[_0x398b7e(0x143)]==_0x41a4d3||_0x17f1d7['href'][_0x398b7e(0x14f)]('/'+_0x41a4d3))){_0x26ffe5['push'](_0x17f1d7[_0x398b7e(0x143)]);break;}}}}else _0x26ffe5=_0x407ece;_0x51bc2b(_0x26ffe5);}),_0x4fc6f0['parse']();});},module[_0xf666c1(0x13b)]=zipEpubUtil;