const _0x1984d8=_0x5cc8;(function(_0x441d79,_0x43fcd7){const _0x109067=_0x5cc8,_0x104f54=_0x441d79();while(!![]){try{const _0x221139=parseInt(_0x109067(0x13e))/0x1*(-parseInt(_0x109067(0x11c))/0x2)+parseInt(_0x109067(0x119))/0x3*(parseInt(_0x109067(0x117))/0x4)+-parseInt(_0x109067(0x111))/0x5+parseInt(_0x109067(0x116))/0x6+-parseInt(_0x109067(0x125))/0x7*(parseInt(_0x109067(0xdd))/0x8)+-parseInt(_0x109067(0xf8))/0x9+parseInt(_0x109067(0xdc))/0xa*(parseInt(_0x109067(0xfa))/0xb);if(_0x221139===_0x43fcd7)break;else _0x104f54['push'](_0x104f54['shift']());}catch(_0x50d1da){_0x104f54['push'](_0x104f54['shift']());}}}(_0x2d0d,0xd5c10));let app,BrowserWindow,Menu,Tray,protocol;try{let elec=require(_0x1984d8(0xca));app=elec['app'],BrowserWindow=elec[_0x1984d8(0x100)],Menu=elec[_0x1984d8(0xcd)],Tray=elec[_0x1984d8(0xd3)],protocol=elec[_0x1984d8(0x129)];}catch(_0x3a6efd){console[_0x1984d8(0x13b)]('Clientless\x20service\x20mode');}const {fork}=require(_0x1984d8(0xce));let path=require(_0x1984d8(0x110)),fs=require('fs'),os=require('os'),initUtil={},privateSpaceUtil=require(_0x1984d8(0x11f)),dbConfigTable=require(_0x1984d8(0xcc)),dbu='',mainWindow='';const config=require('../myConfig/config');let netUtils=require(_0x1984d8(0xf3)),appTray;const dbUserTable=require(_0x1984d8(0xe5));let axios=require(_0x1984d8(0x113));function _0x5cc8(_0x8da070,_0x292d6f){const _0x2d0d7e=_0x2d0d();return _0x5cc8=function(_0x5cc834,_0x5a747f){_0x5cc834=_0x5cc834-0xc6;let _0x585526=_0x2d0d7e[_0x5cc834];return _0x585526;},_0x5cc8(_0x8da070,_0x292d6f);}var package=require(_0x1984d8(0xf5));const compressing=require(_0x1984d8(0x101));let packageInfo=require('../../package.json');const dbSourceFolderTable=require(_0x1984d8(0xf2)),dbScanTaskTable=require(_0x1984d8(0x143));initUtil[_0x1984d8(0xea)]=function(_0x33c533){},initUtil[_0x1984d8(0x13a)]=function(){const _0x13fc3c=_0x1984d8;let _0x36d8a9='';return app&&app[_0x13fc3c(0xd0)]?(_0x36d8a9=path[_0x13fc3c(0x104)](app[_0x13fc3c(0x10f)](_0x13fc3c(0xd6))),os[_0x13fc3c(0x102)]()==_0x13fc3c(0x13d)&&(_0x36d8a9=path[_0x13fc3c(0x104)](_0x36d8a9))):_0x36d8a9=path['join'](__dirname,_0x13fc3c(0x112)),_0x36d8a9;},initUtil[_0x1984d8(0xde)]=function(){var _0x376750=require('../db/dbUtil');return dbu=new _0x376750(),dbu;},initUtil['addScanTaskWhenStart']=function(_0x30e9b2){const _0x3a01e2=_0x1984d8;let _0x3d8148=dbSourceFolderTable[_0x3a01e2(0xda)](_0x30e9b2);for(let _0x3d98d9 of _0x3d8148){_0x3d98d9[_0x3a01e2(0x105)]==0x1&&dbScanTaskTable['addScanTask'](_0x30e9b2,_0x3d98d9[_0x3a01e2(0x109)],_0x3d98d9[_0x3a01e2(0x110)]);}},initUtil[_0x1984d8(0xfe)]=function(_0x447314,_0x27ba5b){const _0x1b72dd=_0x1984d8;_0x447314['prepare']('REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)')[_0x1b72dd(0xdf)](_0x27ba5b+'');},initUtil[_0x1984d8(0x138)]=function(){const _0x4078ab=_0x1984d8;if(!app||!BrowserWindow)return;let _0x3a8a71=![],_0x2d24fb=dbConfigTable[_0x4078ab(0xf4)](dbu[_0x4078ab(0x131)],'autoShowWindow');return(!_0x2d24fb||_0x2d24fb[_0x4078ab(0xf9)]=='1')&&(_0x3a8a71=!![]),mainWindow=new BrowserWindow({'width':0x578,'height':0x3e8,'show':_0x3a8a71,'webPreferences':{'webSecurity':![],'nodeIntegration':!![],'contextIsolation':![],'nodeIntegrationInWorker':!![]}}),mainWindow;},initUtil[_0x1984d8(0x12f)]=function(){const _0x36fc74=_0x1984d8;function _0x5c2ad7(_0x113180){const _0x3b77c0=_0x5cc8;!fs[_0x3b77c0(0x10a)](_0x113180)&&fs[_0x3b77c0(0xc9)](_0x113180,{'recursive':!![]});}return fs['rm'](config[_0x36fc74(0x10e)],{'recursive':!![]},()=>{const _0x9e88f6=_0x36fc74;_0x5c2ad7(config[_0x9e88f6(0x10e)]);}),_0x5c2ad7(config['cachePath']),_0x5c2ad7(config[_0x36fc74(0x141)]),_0x5c2ad7(config[_0x36fc74(0xd1)]),_0x5c2ad7(config[_0x36fc74(0x13c)]),_0x5c2ad7(config[_0x36fc74(0x10c)]),_0x5c2ad7(config['subtitleUploadPath']),_0x5c2ad7(path['join'](config[_0x36fc74(0xeb)],_0x36fc74(0x124))),config[_0x36fc74(0xeb)];},initUtil['startUpdate']=function(){let _0x593156=require('../utils/updateUtil');_0x593156['startUpdate']();},initUtil[_0x1984d8(0xd8)]=function(_0x1be631){const _0x7a139b=_0x1984d8;if(Menu)Menu[_0x7a139b(0xef)](null);privateSpaceUtil['clearSpaceTempFiles'](_0x1be631['dbOther']),globalInfoUtil[_0x7a139b(0xd2)](_0x1be631['dbOther']);let _0x3cdcac=_0x1be631[_0x7a139b(0x131)]['prepare'](_0x7a139b(0x13f))[_0x7a139b(0xe9)]();for(let _0x5c9ddb in _0x3cdcac){try{process[_0x7a139b(0xd9)](_0x3cdcac[_0x5c9ddb][_0x7a139b(0xcb)],_0x7a139b(0xfc));}catch(_0x28b6dd){}}_0x1be631[_0x7a139b(0x131)][_0x7a139b(0x12c)](_0x7a139b(0xd7))[_0x7a139b(0xdf)](),clearM3u8File(_0x1be631);},initUtil[_0x1984d8(0x132)]=[];function clearM3u8File(_0x53d7da){const _0x4bff10=_0x1984d8;fs['rm'](config['m3u8TmpPath'],{'recursive':!![],'force':!![],'maxRetries':0xa},_0x100728=>{if(_0x100728)console['log'](_0x100728);}),_0x53d7da&&_0x53d7da[_0x4bff10(0x131)]&&_0x53d7da[_0x4bff10(0x131)][_0x4bff10(0x12c)](_0x4bff10(0xf6))[_0x4bff10(0xdf)]();}function exitApp(_0x3253a5){const _0x55ddea=_0x1984d8;if(app)app['quit']();if(mainWindow)mainWindow=null;for(let _0x387bbf in initUtil[_0x55ddea(0x132)]){initUtil['processList'][_0x387bbf]&&(initUtil[_0x55ddea(0x132)][_0x387bbf][_0x55ddea(0xd9)](),initUtil[_0x55ddea(0x132)][_0x387bbf]=null);}if(_0x3253a5[_0x55ddea(0x131)]){let _0x2d429c=_0x3253a5[_0x55ddea(0x131)][_0x55ddea(0x12c)](_0x55ddea(0xd7))[_0x55ddea(0xdf)]();}clearM3u8File(_0x3253a5),_0x3253a5&&(_0x3253a5[_0x55ddea(0x115)]&&(_0x3253a5[_0x55ddea(0x115)][_0x55ddea(0xfd)](),_0x3253a5[_0x55ddea(0x115)]=null),_0x3253a5['dbOther']&&(_0x3253a5[_0x55ddea(0x131)][_0x55ddea(0xfd)](),_0x3253a5[_0x55ddea(0x131)]=null),_0x3253a5[_0x55ddea(0x12a)]&&(_0x3253a5[_0x55ddea(0x12a)]['close'](),_0x3253a5[_0x55ddea(0x12a)]=null)),appTray&&appTray[_0x55ddea(0xee)](),process['kill'](process[_0x55ddea(0xf7)],_0x55ddea(0xfc));}initUtil['exitApp']=exitApp,initUtil[_0x1984d8(0x139)]=function(_0x16c75a,_0x48828c){const _0xd4af48=_0x1984d8;if(!app||!_0x48828c)return;_0x48828c['on'](_0xd4af48(0xfd),_0x378b75=>{const _0xd5fe2b=_0xd4af48;if(!_0x48828c)return;!_0x48828c['isVisible']()?exitApp(_0x16c75a):(_0x378b75[_0xd5fe2b(0xe3)](),os['platform']()==_0xd5fe2b(0xf0)?_0x48828c[_0xd5fe2b(0x11a)]():_0x48828c[_0xd5fe2b(0xe2)]());}),console[_0xd4af48(0x13b)](_0xd4af48(0x12b)),_0x48828c[_0xd4af48(0xe7)]('loading/loading.html');},initUtil[_0x1984d8(0x128)]=function(_0xf11529,_0x222aa9){const _0xa13cad=_0x1984d8;if(!app)return;var _0x2adfcc=[{'label':'Show/Hide','click':function(){const _0x3b4a12=_0x5cc8;_0x222aa9[_0x3b4a12(0xc8)]()?_0x222aa9[_0x3b4a12(0x11a)]():_0x222aa9['show']();}},{'label':_0xa13cad(0x126),'click':function(){if(app)app['relaunch']();exitApp(_0xf11529);}},{'label':_0xa13cad(0x122),'click':function(){if(app)app['quit']();exitApp(_0xf11529);}}];appTray=new Tray(path[_0xa13cad(0x10b)](initUtil[_0xa13cad(0x13a)](),'libs',_0xa13cad(0x140)));const _0x40bc48=Menu['buildFromTemplate'](_0x2adfcc);appTray['setToolTip'](_0xa13cad(0xe1)),appTray['setContextMenu'](_0x40bc48),appTray['on'](_0xa13cad(0x120),function(){const _0x2ac9cf=_0xa13cad;_0x222aa9[_0x2ac9cf(0x12e)]();});},initUtil[_0x1984d8(0x10d)]=function(){const _0x37e90c=_0x1984d8;if(!app)return;!app[_0x37e90c(0xd0)]&&mainWindow[_0x37e90c(0xfb)][_0x37e90c(0xdb)]();};function clearExpiredToken(){const _0x5c829d=_0x1984d8;let _0x315d68=dbConfigTable[_0x5c829d(0xf4)](dbu['dbOther'],_0x5c829d(0x137));if(!_0x315d68||!_0x315d68[_0x5c829d(0xf9)]||_0x315d68[_0x5c829d(0xf9)]<0x1)_0x315d68=0x18;else _0x315d68&&_0x315d68['value']&&(_0x315d68=_0x315d68[_0x5c829d(0xf9)]);let _0x3a490d=new Date()[_0x5c829d(0xed)](),_0x27c3fa=_0x3a490d-parseInt(_0x315d68)*0xe10*0x3e8;dbUserTable[_0x5c829d(0x136)](dbu[_0x5c829d(0x131)],_0x5c829d(0xe6),[_0x27c3fa]);}function _0x2d0d(){const _0x443455=['DELETE\x20FROM\x20process_record\x20WHERE\x201=1','init','kill','getAll','openDevTools','19030YAzrwD','48xdFfCu','initDbu','run','appRootPath','NasCab','minimize','preventDefault','Using\x20file\x20config\x20port','../db/dbUserTable','\x20WHERE\x20last_login_time\x20<?','loadFile','readFileSync','all','runNewVersionTask','userDataFolder','zh-CN','getTime','destroy','setApplicationMenu','win32','autoLaunch','../db/dbSourceFolderTable','../express-server/utils/netUtils','findByTitle','../../package.json','DELETE\x20FROM\x20play_record','pid','13795587shrqiX','value','13882aSQUVh','webContents','SIGTERM','close','addProcessRecord','setLanguage','BrowserWindow','compressing','platform','从配置文件读取端口设置[http\x20port\x20config\x20file]','dirname','scan_when_start','getLocale','resolve','getExpressApiCount','type','existsSync','join','subtitlePath','openDev','tempFilePath','getPath','path','2993070CgUAGD','../../','axios','./globalInfoUtil','dbFileIndex','2876982AxKmwm','8BSkYKb','cpus','1463895qKGNUn','hide','utf-8','6buqzGb','length','threadCount','../express-server/utils/privateSpaceUtils','click','../myWorkers/autoLaunchWorker.js','Exit(退出)','exports','database','980357kxGpha','Restart(重启应用)','expireTokenOnTime','initTray','protocol','dbCity','Loading...','prepare','apiServerCount','show','createUserFolder','language','dbOther','processList','create','apiPort','apiPortHttps','deleteUserTokenByWhere','tokenKeepHour','createMainWindow','initWindowEventAndLoadLoading','getRootPath','log','facesPath','darwin','3238bRvZIw','SELECT\x20*\x20FROM\x20process_record','logo-tray.png','posterPath','then','../db/dbScanTaskTable','startsWith','en-US','isVisible','mkdirSync','electron','process_id','../db/dbConfigTable','Menu','child_process','launchWithSys','isPackaged','musicCoverPath','getUpdateInfo','Tray','isPortFree','getFreePort','exe'];_0x2d0d=function(){return _0x443455;};return _0x2d0d();}initUtil[_0x1984d8(0x127)]=function(){setInterval(()=>{clearExpiredToken();},0xe10*0x3e8),clearExpiredToken();};const globalInfoUtil=require(_0x1984d8(0x114));initUtil[_0x1984d8(0xcf)]=function(){const _0x4a0295=_0x1984d8;if(!app)return;if(!app[_0x4a0295(0xd0)])return;let _0x55463a=dbConfigTable[_0x4a0295(0xf4)](dbu['dbOther'],_0x4a0295(0xf1)),_0x609a19=0x0;_0x55463a&&(_0x55463a[_0x4a0295(0xf9)]=='1'||_0x55463a[_0x4a0295(0xf9)]==0x1)&&(_0x609a19=0x1);try{fork(path[_0x4a0295(0x107)](__dirname,_0x4a0295(0x121)),[],{'env':{'enableAutoLaunch':_0x609a19},'detached':![],'killSignal':_0x4a0295(0xfc)});}catch(_0x11cbb7){console[_0x4a0295(0x13b)](_0x11cbb7);}},initUtil[_0x1984d8(0xff)]=function(){const _0x47b3c0=_0x1984d8;let _0x35fdb7=dbConfigTable[_0x47b3c0(0xf4)](dbu[_0x47b3c0(0x131)],_0x47b3c0(0x130));if(!_0x35fdb7){let _0x125dae=app?app[_0x47b3c0(0x106)]():'zh';_0x125dae[_0x47b3c0(0xc6)]('en')?dbConfigTable[_0x47b3c0(0x133)](dbu[_0x47b3c0(0x131)],{'title':_0x47b3c0(0x130),'value':_0x47b3c0(0xc7)}):dbConfigTable[_0x47b3c0(0x133)](dbu['dbOther'],{'title':_0x47b3c0(0x130),'value':_0x47b3c0(0xec)});}},initUtil['getFreePort']=function(_0x32ae73,_0x754521){const _0x5ce3c0=_0x1984d8;let _0x301623=path[_0x5ce3c0(0x10b)](config[_0x5ce3c0(0xe0)],'httpport.txt');try{if(fs[_0x5ce3c0(0x10a)](_0x301623)){console[_0x5ce3c0(0x13b)](_0x5ce3c0(0x103),_0x301623);let _0x5892c5=fs[_0x5ce3c0(0xe8)](_0x301623,_0x5ce3c0(0x11b));_0x5892c5&&(_0x5892c5=parseInt(_0x5892c5),_0x5892c5>0x0&&_0x5892c5<0xfff6&&(_0x32ae73=_0x5892c5,dbConfigTable[_0x5ce3c0(0x133)](dbu[_0x5ce3c0(0x131)],{'title':'apiPort','value':_0x32ae73+''}),console[_0x5ce3c0(0x13b)](_0x5ce3c0(0xe4),_0x32ae73)));}}catch(_0x775b3d){}_0x32ae73=parseInt(_0x32ae73),netUtils[_0x5ce3c0(0xd4)](_0x32ae73)[_0x5ce3c0(0x142)](_0xf1c0df=>{const _0x35e183=_0x5ce3c0;_0xf1c0df?_0x754521(_0x32ae73):(_0x32ae73+=0x1,initUtil[_0x35e183(0xd5)](_0x32ae73,_0x754521));});},initUtil['getConfigApiPort']=function(_0x2b84ec){const _0x28ba3f=_0x1984d8;let _0x5c8155=_0x2b84ec?config[_0x28ba3f(0x135)]:config[_0x28ba3f(0x134)],_0x5c83f7=dbConfigTable['findByTitle'](dbu['dbOther'],_0x2b84ec?_0x28ba3f(0x135):_0x28ba3f(0x134));if(_0x5c83f7){let _0xee40fc=parseInt(_0x5c83f7['value']);if(_0xee40fc<=0x0||_0xee40fc>0xffff){}else _0x5c8155=_0xee40fc;}return _0x5c8155;},initUtil[_0x1984d8(0x108)]=function(){const _0x3e63af=_0x1984d8;let _0x85f02=os[_0x3e63af(0x118)](),_0x53c92e=0x2,_0x407341=dbConfigTable[_0x3e63af(0xf4)](dbu[_0x3e63af(0x131)],_0x3e63af(0x11e));return _0x407341&&(_0x53c92e=_0x407341[_0x3e63af(0xf9)],_0x53c92e>_0x85f02[_0x3e63af(0x11d)]&&(_0x53c92e=_0x85f02[_0x3e63af(0x11d)])),(!_0x53c92e||_0x53c92e<0x2)&&(_0x53c92e=0x2),dbConfigTable[_0x3e63af(0x133)](dbu[_0x3e63af(0x131)],{'title':_0x3e63af(0x12d),'value':parseInt(_0x53c92e)+''}),_0x53c92e;},initUtil['checkWebClientAutoUpdate']=function(){},module[_0x1984d8(0x123)]=initUtil;