const _0x4dec23=_0x479b;(function(_0x3ce80b,_0x3924c3){const _0x59573e=_0x479b,_0x4a1cc2=_0x3ce80b();while(!![]){try{const _0x3c70bb=-parseInt(_0x59573e(0xe4))/0x1+parseInt(_0x59573e(0x9f))/0x2*(parseInt(_0x59573e(0xd3))/0x3)+-parseInt(_0x59573e(0xf7))/0x4*(-parseInt(_0x59573e(0x117))/0x5)+parseInt(_0x59573e(0xb8))/0x6*(parseInt(_0x59573e(0xc7))/0x7)+parseInt(_0x59573e(0xfc))/0x8+parseInt(_0x59573e(0xd1))/0x9*(-parseInt(_0x59573e(0x101))/0xa)+-parseInt(_0x59573e(0x106))/0xb*(parseInt(_0x59573e(0xf5))/0xc);if(_0x3c70bb===_0x3924c3)break;else _0x4a1cc2['push'](_0x4a1cc2['shift']());}catch(_0x293232){_0x4a1cc2['push'](_0x4a1cc2['shift']());}}}(_0x7907,0x49944));let app,BrowserWindow,Menu,Tray,protocol;try{let elec=require('electron');app=elec['app'],BrowserWindow=elec['BrowserWindow'],Menu=elec['Menu'],Tray=elec[_0x4dec23(0xdb)],protocol=elec[_0x4dec23(0xbf)];}catch(_0x5e6c35){console['log'](_0x4dec23(0xa5));}const {fork}=require(_0x4dec23(0xd5));let path=require(_0x4dec23(0xca)),fs=require('fs'),os=require('os'),initUtil={},privateSpaceUtil=require(_0x4dec23(0xa3)),dbConfigTable=require(_0x4dec23(0x9d)),dbu='',mainWindow='';const config=require(_0x4dec23(0xf1));let netUtils=require('../express-server/utils/netUtils'),appTray;const dbUserTable=require(_0x4dec23(0xe1));let axios=require(_0x4dec23(0xdd));var package=require(_0x4dec23(0x99));const compressing=require(_0x4dec23(0xde));let packageInfo=require(_0x4dec23(0x99));const dbSourceFolderTable=require(_0x4dec23(0xce)),dbScanTaskTable=require(_0x4dec23(0xba));initUtil[_0x4dec23(0xeb)]=function(_0x39d23b){},initUtil[_0x4dec23(0xcc)]=function(){const _0xd8cae1=_0x4dec23;let _0x37f578='';return app&&app[_0xd8cae1(0x10b)]?(_0x37f578=path[_0xd8cae1(0x119)](app[_0xd8cae1(0xb9)](_0xd8cae1(0x105))),os[_0xd8cae1(0xb7)]()==_0xd8cae1(0xac)&&(_0x37f578=path['dirname'](_0x37f578))):_0x37f578=path[_0xd8cae1(0x113)](__dirname,_0xd8cae1(0xfe)),_0x37f578;},initUtil[_0x4dec23(0x109)]=function(){const _0x4b79e1=_0x4dec23;var _0x39439c=require(_0x4b79e1(0x9e));return dbu=new _0x39439c(),dbu;},initUtil[_0x4dec23(0xd7)]=function(_0x2542af){const _0x5b7367=_0x4dec23;let _0x328883=dbSourceFolderTable[_0x5b7367(0xc4)](_0x2542af);for(let _0x42d9c7 of _0x328883){_0x42d9c7['scan_when_start']==0x1&&dbScanTaskTable[_0x5b7367(0xda)](_0x2542af,_0x42d9c7[_0x5b7367(0x9c)],_0x42d9c7[_0x5b7367(0xca)]);}},initUtil[_0x4dec23(0xaf)]=function(_0x2480b1,_0x4a0633){const _0x20552c=_0x4dec23;_0x2480b1[_0x20552c(0xc0)](_0x20552c(0xe3))[_0x20552c(0x9a)](_0x4a0633+'');},initUtil[_0x4dec23(0xab)]=function(){const _0x3c91a8=_0x4dec23;if(!app||!BrowserWindow)return;let _0x4c4106=![],_0xed95b8=dbConfigTable[_0x3c91a8(0xff)](dbu['dbOther'],'autoShowWindow');return(!_0xed95b8||_0xed95b8[_0x3c91a8(0x108)]=='1')&&(_0x4c4106=!![]),mainWindow=new BrowserWindow({'width':0x578,'height':0x3e8,'show':_0x4c4106,'webPreferences':{'webSecurity':![],'nodeIntegration':!![],'contextIsolation':![],'nodeIntegrationInWorker':!![]}}),mainWindow;},initUtil['createUserFolder']=function(){const _0x33e508=_0x4dec23;function _0x3873c7(_0xfb9d70){const _0x367ac9=_0x479b;!fs[_0x367ac9(0x118)](_0xfb9d70)&&fs[_0x367ac9(0xd2)](_0xfb9d70,{'recursive':!![]});}return fs['rm'](config[_0x33e508(0x10a)],{'recursive':!![]},()=>{const _0x180151=_0x33e508;_0x3873c7(config[_0x180151(0x10a)]);}),_0x3873c7(config['cachePath']),_0x3873c7(config[_0x33e508(0xc5)]),_0x3873c7(config[_0x33e508(0xb1)]),_0x3873c7(config['facesPath']),_0x3873c7(config[_0x33e508(0xb6)]),_0x3873c7(config[_0x33e508(0xf3)]),_0x3873c7(path[_0x33e508(0x113)](config[_0x33e508(0xae)],_0x33e508(0xc3))),config[_0x33e508(0xae)];},initUtil[_0x4dec23(0xc1)]=function(){const _0x17f526=_0x4dec23;let _0x582187=require(_0x17f526(0x102));_0x582187[_0x17f526(0xc1)]();},initUtil[_0x4dec23(0x100)]=function(_0x397857){const _0x541b4e=_0x4dec23;if(Menu)Menu['setApplicationMenu'](null);privateSpaceUtil[_0x541b4e(0xc2)](_0x397857['dbOther']),globalInfoUtil[_0x541b4e(0xd8)](_0x397857[_0x541b4e(0xed)]);let _0x4c509e=_0x397857[_0x541b4e(0xed)][_0x541b4e(0xc0)](_0x541b4e(0xdf))[_0x541b4e(0x10d)]();for(let _0x2cc733 in _0x4c509e){try{process[_0x541b4e(0xc8)](_0x4c509e[_0x2cc733]['process_id'],_0x541b4e(0x116));}catch(_0x224b08){}}_0x397857[_0x541b4e(0xed)][_0x541b4e(0xc0)]('DELETE\x20FROM\x20process_record\x20WHERE\x201=1')[_0x541b4e(0x9a)](),clearM3u8File(_0x397857);},initUtil[_0x4dec23(0xa4)]=[];function clearM3u8File(_0x4166ae){const _0xcda9ad=_0x4dec23;fs['rm'](config[_0xcda9ad(0x110)],{'recursive':!![],'force':!![],'maxRetries':0xa},_0x797cbf=>{const _0x11d3f2=_0xcda9ad;if(_0x797cbf)console[_0x11d3f2(0xb2)](_0x797cbf);}),_0x4166ae&&_0x4166ae['dbOther']&&_0x4166ae[_0xcda9ad(0xed)]['prepare'](_0xcda9ad(0xf4))['run']();}function exitApp(_0x121805){const _0x3a4b60=_0x4dec23;if(app)app[_0x3a4b60(0x10f)]();if(mainWindow)mainWindow=null;for(let _0x2a85eb in initUtil[_0x3a4b60(0xa4)]){initUtil[_0x3a4b60(0xa4)][_0x2a85eb]&&(initUtil[_0x3a4b60(0xa4)][_0x2a85eb][_0x3a4b60(0xc8)](),initUtil[_0x3a4b60(0xa4)][_0x2a85eb]=null);}if(_0x121805[_0x3a4b60(0xed)]){let _0x2b2398=_0x121805[_0x3a4b60(0xed)]['prepare'](_0x3a4b60(0xa6))[_0x3a4b60(0x9a)]();}clearM3u8File(_0x121805),_0x121805&&(_0x121805['dbFileIndex']&&(_0x121805[_0x3a4b60(0x112)][_0x3a4b60(0xdc)](),_0x121805[_0x3a4b60(0x112)]=null),_0x121805[_0x3a4b60(0xed)]&&(_0x121805[_0x3a4b60(0xed)][_0x3a4b60(0xdc)](),_0x121805['dbOther']=null),_0x121805[_0x3a4b60(0xb0)]&&(_0x121805[_0x3a4b60(0xb0)][_0x3a4b60(0xdc)](),_0x121805[_0x3a4b60(0xb0)]=null)),appTray&&appTray[_0x3a4b60(0xc6)](),process[_0x3a4b60(0xc8)](process[_0x3a4b60(0xe6)],'SIGTERM');}initUtil['exitApp']=exitApp,initUtil[_0x4dec23(0xf2)]=function(_0x4d777f,_0x5c3f43){const _0x8dd3ae=_0x4dec23;if(!app||!_0x5c3f43)return;_0x5c3f43['on'](_0x8dd3ae(0xdc),_0x46a46c=>{const _0x164a61=_0x8dd3ae;if(!_0x5c3f43)return;!_0x5c3f43[_0x164a61(0xb3)]()?exitApp(_0x4d777f):(_0x46a46c[_0x164a61(0xef)](),os[_0x164a61(0xb7)]()==_0x164a61(0xa1)?_0x5c3f43['hide']():_0x5c3f43[_0x164a61(0xf8)]());}),console['log'](_0x8dd3ae(0x115)),_0x5c3f43['loadFile'](_0x8dd3ae(0xbc));},initUtil['initTray']=function(_0x47437d,_0x8839ed){const _0x165489=_0x4dec23;if(!app)return;var _0x2fb0c6=[{'label':_0x165489(0x10e),'click':function(){const _0x4814d0=_0x165489;_0x8839ed[_0x4814d0(0xb3)]()?_0x8839ed[_0x4814d0(0x111)]():_0x8839ed[_0x4814d0(0xe8)]();}},{'label':_0x165489(0xcb),'click':function(){if(app)app['relaunch']();exitApp(_0x47437d);}},{'label':'Exit(退出)','click':function(){const _0xa84ce=_0x165489;if(app)app[_0xa84ce(0x10f)]();exitApp(_0x47437d);}}];appTray=new Tray(path['join'](initUtil[_0x165489(0xcc)](),_0x165489(0x107),'logo-tray.png'));const _0x143329=Menu[_0x165489(0xb5)](_0x2fb0c6);appTray[_0x165489(0x114)](_0x165489(0xf6)),appTray[_0x165489(0x104)](_0x143329),appTray['on'](_0x165489(0xbe),function(){const _0x100840=_0x165489;_0x8839ed[_0x100840(0xe8)]();});},initUtil[_0x4dec23(0xfb)]=function(){const _0x1a6071=_0x4dec23;if(!app)return;!app[_0x1a6071(0x10b)]&&mainWindow[_0x1a6071(0x10c)][_0x1a6071(0xa8)]();};function _0x479b(_0x1f56de,_0x2aafda){const _0x79078c=_0x7907();return _0x479b=function(_0x479b6d,_0x1220e1){_0x479b6d=_0x479b6d-0x99;let _0x51ba95=_0x79078c[_0x479b6d];return _0x51ba95;},_0x479b(_0x1f56de,_0x2aafda);}function _0x7907(){const _0x6bcd9e=['subtitleUploadPath','DELETE\x20FROM\x20play_record','8408292LmbQEF','NasCab','140DhkzpZ','minimize','autoLaunch','getConfigApiPort','openDev','3222616WCWzUb','length','../../','findByTitle','init','230HfLhuB','../utils/updateUtil','create','setContextMenu','exe','11esqcFd','libs','value','initDbu','tempFilePath','isPackaged','webContents','all','Show/Hide','quit','m3u8TmpPath','hide','dbFileIndex','join','setToolTip','Loading...','SIGTERM','59860VdgvNb','existsSync','dirname','../../package.json','run','apiServerCount','type','../db/dbConfigTable','../db/dbUtil','62680wjRwcq','readFileSync','win32','deleteUserTokenByWhere','../express-server/utils/privateSpaceUtils','processList','Clientless\x20service\x20mode','DELETE\x20FROM\x20process_record\x20WHERE\x201=1','language','openDevTools','apiPort','httpport.txt','createMainWindow','darwin','apiPortHttps','userDataFolder','addProcessRecord','dbCity','musicCoverPath','log','isVisible','resolve','buildFromTemplate','subtitlePath','platform','2082IoxQCf','getPath','../db/dbScanTaskTable','setLanguage','loading/loading.html','cpus','click','protocol','prepare','startUpdate','clearSpaceTempFiles','database','getAll','posterPath','destroy','7756yeCLAI','kill','startsWith','path','Restart(重启应用)','getRootPath','expireTokenOnTime','../db/dbSourceFolderTable','Using\x20file\x20config\x20port','getLocale','60111RZnmWh','mkdirSync','3cVSazI','从配置文件读取端口设置[http\x20port\x20config\x20file]','child_process','zh-CN','addScanTaskWhenStart','getUpdateInfo','then','addScanTask','Tray','close','axios','compressing','SELECT\x20*\x20FROM\x20process_record','getFreePort','../db/dbUserTable','./globalInfoUtil','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','81975IACCmj','utf-8','pid','getTime','show','isPortFree','exports','runNewVersionTask','threadCount','dbOther','../myWorkers/autoLaunchWorker.js','preventDefault','launchWithSys','../myConfig/config','initWindowEventAndLoadLoading'];_0x7907=function(){return _0x6bcd9e;};return _0x7907();}function clearExpiredToken(){const _0x73cfd0=_0x4dec23;let _0x51afab=dbConfigTable[_0x73cfd0(0xff)](dbu[_0x73cfd0(0xed)],'tokenKeepHour');if(!_0x51afab||!_0x51afab[_0x73cfd0(0x108)]||_0x51afab[_0x73cfd0(0x108)]<0x1)_0x51afab=0x18;else _0x51afab&&_0x51afab[_0x73cfd0(0x108)]&&(_0x51afab=_0x51afab[_0x73cfd0(0x108)]);let _0x4ac800=new Date()[_0x73cfd0(0xe7)](),_0xcbf9b5=_0x4ac800-parseInt(_0x51afab)*0xe10*0x3e8;dbUserTable[_0x73cfd0(0xa2)](dbu[_0x73cfd0(0xed)],'\x20WHERE\x20last_login_time\x20<?',[_0xcbf9b5]);}initUtil[_0x4dec23(0xcd)]=function(){setInterval(()=>{clearExpiredToken();},0xe10*0x3e8),clearExpiredToken();};const globalInfoUtil=require(_0x4dec23(0xe2));initUtil[_0x4dec23(0xf0)]=function(){const _0x2fdfe0=_0x4dec23;if(!app)return;if(!app[_0x2fdfe0(0x10b)])return;let _0x4444a9=dbConfigTable[_0x2fdfe0(0xff)](dbu['dbOther'],_0x2fdfe0(0xf9)),_0x564139=0x0;_0x4444a9&&(_0x4444a9[_0x2fdfe0(0x108)]=='1'||_0x4444a9['value']==0x1)&&(_0x564139=0x1);try{fork(path[_0x2fdfe0(0xb4)](__dirname,_0x2fdfe0(0xee)),[],{'env':{'enableAutoLaunch':_0x564139},'detached':![],'killSignal':_0x2fdfe0(0x116)});}catch(_0x1d79f3){console[_0x2fdfe0(0xb2)](_0x1d79f3);}},initUtil[_0x4dec23(0xbb)]=function(){const _0x20c4d2=_0x4dec23;let _0xe8ac17=dbConfigTable['findByTitle'](dbu[_0x20c4d2(0xed)],_0x20c4d2(0xa7));if(!_0xe8ac17){let _0x42c69d=app?app[_0x20c4d2(0xd0)]():'zh';_0x42c69d[_0x20c4d2(0xc9)]('en')?dbConfigTable['create'](dbu[_0x20c4d2(0xed)],{'title':'language','value':'en-US'}):dbConfigTable['create'](dbu['dbOther'],{'title':_0x20c4d2(0xa7),'value':_0x20c4d2(0xd6)});}},initUtil['getFreePort']=function(_0x58b9c9,_0x74545){const _0x520080=_0x4dec23;let _0x532a07=path['join'](config['appRootPath'],_0x520080(0xaa));try{if(fs[_0x520080(0x118)](_0x532a07)){console[_0x520080(0xb2)](_0x520080(0xd4),_0x532a07);let _0x32d464=fs[_0x520080(0xa0)](_0x532a07,_0x520080(0xe5));_0x32d464&&(_0x32d464=parseInt(_0x32d464),_0x32d464>0x0&&_0x32d464<0xfff6&&(_0x58b9c9=_0x32d464,dbConfigTable[_0x520080(0x103)](dbu[_0x520080(0xed)],{'title':_0x520080(0xa9),'value':_0x58b9c9+''}),console[_0x520080(0xb2)](_0x520080(0xcf),_0x58b9c9)));}}catch(_0x552fcc){}_0x58b9c9=parseInt(_0x58b9c9),netUtils[_0x520080(0xe9)](_0x58b9c9)[_0x520080(0xd9)](_0x4ea128=>{const _0x92ec50=_0x520080;_0x4ea128?_0x74545(_0x58b9c9):(_0x58b9c9+=0x1,initUtil[_0x92ec50(0xe0)](_0x58b9c9,_0x74545));});},initUtil[_0x4dec23(0xfa)]=function(_0x1f2e29){const _0x437d59=_0x4dec23;let _0x490b05=_0x1f2e29?config[_0x437d59(0xad)]:config[_0x437d59(0xa9)],_0xd0ddb4=dbConfigTable['findByTitle'](dbu[_0x437d59(0xed)],_0x1f2e29?_0x437d59(0xad):_0x437d59(0xa9));if(_0xd0ddb4){let _0x55c3ed=parseInt(_0xd0ddb4[_0x437d59(0x108)]);if(_0x55c3ed<=0x0||_0x55c3ed>0xffff){}else _0x490b05=_0x55c3ed;}return _0x490b05;},initUtil['getExpressApiCount']=function(){const _0x29b555=_0x4dec23;let _0x17c36a=os[_0x29b555(0xbd)](),_0x263ba9=0x2,_0x108aad=dbConfigTable[_0x29b555(0xff)](dbu[_0x29b555(0xed)],_0x29b555(0xec));return _0x108aad&&(_0x263ba9=_0x108aad[_0x29b555(0x108)],_0x263ba9>_0x17c36a[_0x29b555(0xfd)]&&(_0x263ba9=_0x17c36a['length'])),(!_0x263ba9||_0x263ba9<0x2)&&(_0x263ba9=0x2),dbConfigTable[_0x29b555(0x103)](dbu['dbOther'],{'title':_0x29b555(0x9b),'value':parseInt(_0x263ba9)+''}),_0x263ba9;},initUtil['checkWebClientAutoUpdate']=function(){},module[_0x4dec23(0xea)]=initUtil;