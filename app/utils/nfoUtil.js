const _0x2a8126=_0x15cd;function _0xc55c(){const _0x839b0=['customrating','guestactors','nfo缓存失败','isbn','language','biography','movie','movie_actor_array','8181486xGHHUh','filename','seasonNumber','fast-xml-parser','regions','publisher','stat','tvshow.nfo','log','showtitle','readFile','genres','artist','lastIndexOf','tag','build','publish_date','languages','3iRkmVN','storyline','imdbid','directorsOriginal','split','1268492bzMEuX','1373029AcwzWl','actors','vote_average','length','originalname','2627940AZbMBj','genre','writeFile','enddate','1487784qwZdBB','thumb','sortname','push','vote_count','path','book','rating','IMAGE_URL','../utils/movieSeasonUtil','parseNfoTvSeries','season.nfo','parse','introduction','tvshow','2809490OUNqxD','doubanid','restoreBookNfo','cover_url','exports','original_name','3290984FdXshW','actor','year','movie_imdb_id','season','tmdbid','substring','profile_path','director','\x20/\x20','readFileSync','episodedetails','getSeasonNumber','review','existsSync','country','join','name','title','../utils/movieInfoTmdbApi','movie_name','movie_alias','originaltitle','nfoInfo.vote_average','basename','actorsOriginal','is_tvplay','guestActorsOriginal','saveBookNfo','creator','tagline','.nfo','dirname','nfo读取失败','tmdb_id'];_0xc55c=function(){return _0x839b0;};return _0xc55c();}(function(_0x1ec3f1,_0x448809){const _0x1ce3ff=_0x15cd,_0x90b472=_0x1ec3f1();while(!![]){try{const _0x596048=-parseInt(_0x1ce3ff(0x1b0))/0x1+parseInt(_0x1ce3ff(0x1b6))/0x2+-parseInt(_0x1ce3ff(0x1ab))/0x3*(parseInt(_0x1ce3ff(0x1cf))/0x4)+parseInt(_0x1ce3ff(0x1c9))/0x5+parseInt(_0x1ce3ff(0x1fa))/0x6+-parseInt(_0x1ce3ff(0x1b1))/0x7+-parseInt(_0x1ce3ff(0x1ba))/0x8;if(_0x596048===_0x448809)break;else _0x90b472['push'](_0x90b472['shift']());}catch(_0x3a0318){_0x90b472['push'](_0x90b472['shift']());}}}(_0xc55c,0xbb08b));let fs=require('fs'),path=require(_0x2a8126(0x1bf)),nfoUtil={},movieSeasonUtil=require(_0x2a8126(0x1c3));const {XMLParser,XMLBuilder}=require(_0x2a8126(0x1fd));function _0x15cd(_0x421c1d,_0x3bdac6){const _0xc55c26=_0xc55c();return _0x15cd=function(_0x15cdb8,_0x599326){_0x15cdb8=_0x15cdb8-0x1a1;let _0x249f5b=_0xc55c26[_0x15cdb8];return _0x249f5b;},_0x15cd(_0x421c1d,_0x3bdac6);}let movieInfoTmdbApi=require(_0x2a8126(0x1e2));function doParse(_0xdb4cd2,_0x1a915f,_0x1cc9f4,_0x145c5e){const _0x30c282=_0x2a8126,_0x42faa1=new XMLParser();function _0x2a5400(_0x23fac5,_0x159823){const _0x1fb8e9=_0x15cd;function _0x14aafe(_0x31c4b5){const _0x40229d=_0x15cd;if(_0x31c4b5[_0x40229d(0x1b4)]>0x0&&_0x31c4b5[0x0]instanceof Object){let _0x1c27e2=[];for(let _0x3b9fe0 in _0x31c4b5){let _0x126d42=_0x31c4b5[_0x3b9fe0];_0x1c27e2[_0x40229d(0x1bd)](_0x126d42[_0x40229d(0x1e0)]||_0x126d42[_0x40229d(0x1e1)]);}return _0x1c27e2;}else return _0x31c4b5;}if(!_0x23fac5)return'';if(_0x23fac5 instanceof Array){let _0x5efbad=_0x14aafe(_0x23fac5);return _0x5efbad?_0x5efbad[_0x1fb8e9(0x1df)]('\x20/\x20'):'';}else{if(_0x23fac5 instanceof Object){let _0x10907a=_0x14aafe([_0x23fac5]);return _0x10907a?_0x10907a[_0x1fb8e9(0x1df)](_0x1fb8e9(0x1d8)):'';}}return _0x23fac5;}try{_0x1cc9f4['nfoFullPath']=_0x145c5e;let _0x30e494=_0x42faa1[_0x30c282(0x1c6)](fs[_0x30c282(0x1d9)](_0x145c5e));_0x30e494['movie']||_0x30e494[_0x30c282(0x1da)]||_0x30e494[_0x30c282(0x1c8)]?(_0x30e494=_0x30e494[_0x30c282(0x1f8)]||_0x30e494[_0x30c282(0x1da)]||_0x30e494['tvshow'],_0x1cc9f4={..._0x1cc9f4,'movie_info_name':_0x30e494[_0x30c282(0x1a2)]||_0x30e494[_0x30c282(0x1e0)]||_0x30e494[_0x30c282(0x1e1)]||_0x30e494[_0x30c282(0x1e5)]||_0x30e494['localtitle']||'','movie_alias':_0x30e494[_0x30c282(0x1bc)]||'','movie_regions':_0x2a5400(_0x30e494[_0x30c282(0x1de)]),'movie_language':_0x2a5400(_0x30e494['language']),'movie_imdb_id':_0x30e494[_0x30c282(0x1ad)]||'','movie_genres':_0x2a5400(_0x30e494[_0x30c282(0x1b7)]),'movie_release_date':_0x30e494['releasedate']||'','movie_end_date':_0x30e494['enddate']||'','movie_douban_id':_0x30e494[_0x30c282(0x1ca)]||'','movie_storyline':_0x30e494['plot']||_0x30e494[_0x30c282(0x1f7)]||_0x30e494[_0x30c282(0x1dc)]||'','movie_douban_score':_0x30e494['douban_score']||_0x30e494[_0x30c282(0x1c1)]||_0x30e494[_0x30c282(0x1f2)]||0x0,'movie_year':_0x30e494[_0x30c282(0x1d1)]||'','tagline':_0x30e494[_0x30c282(0x1ed)]||'','movie_actor':_0x2a5400(_0x30e494[_0x30c282(0x1d0)]),'movie_creator':_0x2a5400(_0x30e494['creator']),'movie_director':_0x2a5400(_0x30e494[_0x30c282(0x1d7)]),'movie_tags':_0x2a5400(_0x30e494[_0x30c282(0x1a7)]),'season_number':_0x30e494['season']||'','episode_number':_0x30e494['episode']||''},_0x30e494[_0x30c282(0x1d0)]instanceof Array&&_0x30e494[_0x30c282(0x1d0)][_0x30c282(0x1b4)]>0x0&&(_0x30e494[_0x30c282(0x1d0)][0x0]instanceof Object&&(_0x1cc9f4[_0x30c282(0x1f9)]=_0x30e494[_0x30c282(0x1d0)])),_0x30e494[_0x30c282(0x1d7)]instanceof Array&&_0x30e494[_0x30c282(0x1d7)][_0x30c282(0x1b4)]>0x0&&(_0x30e494['director'][0x0]instanceof Object&&(_0x1cc9f4['movie_director_array']=_0x30e494[_0x30c282(0x1d7)])),_0xdb4cd2(_0x1cc9f4)):_0x1a915f();}catch(_0x1ff95f){_0x1a915f(_0x1ff95f);}}nfoUtil['parseNfo']=function(_0x406a08,_0x4e71f7,_0x4c1957){return new Promise((_0x3410ce,_0x463127)=>{const _0x4cc767=_0x15cd;let _0x333be7=_0x406a08[_0x4cc767(0x1fb)];if(_0x4e71f7){let {name:_0x400214}=path[_0x4cc767(0x1c6)](_0x333be7);_0x333be7=_0x400214;}let _0x8fda30,_0x5f3d0b;if(_0x406a08[_0x4cc767(0x1e9)]==0x1&&!_0x4c1957){_0x8fda30=path[_0x4cc767(0x1df)](_0x406a08[_0x4cc767(0x1bf)],_0x4cc767(0x201)),_0x5f3d0b=fs['existsSync'](_0x8fda30);let _0x8a8852=path[_0x4cc767(0x1e7)](_0x406a08[_0x4cc767(0x1bf)]),_0x3cbcb1=movieSeasonUtil[_0x4cc767(0x1db)](_0x8a8852);_0x3cbcb1>0x0&&(_0x406a08[_0x4cc767(0x1fc)]=_0x3cbcb1,_0x8fda30=path[_0x4cc767(0x1df)](_0x406a08[_0x4cc767(0x1bf)],_0x4cc767(0x1c5)),_0x5f3d0b=fs[_0x4cc767(0x1dd)](_0x8fda30),!_0x5f3d0b&&(_0x8fda30=path['join'](path[_0x4cc767(0x1ef)](_0x406a08[_0x4cc767(0x1bf)]),_0x4cc767(0x201)),_0x5f3d0b=fs[_0x4cc767(0x1dd)](_0x8fda30)));}else _0x8fda30=path[_0x4cc767(0x1df)](_0x406a08[_0x4cc767(0x1bf)],_0x333be7+_0x4cc767(0x1ee)),_0x5f3d0b=fs[_0x4cc767(0x1dd)](_0x8fda30);if(!_0x5f3d0b)return _0x463127();doParse(_0x3410ce,_0x463127,_0x406a08,_0x8fda30);});},nfoUtil[_0x2a8126(0x1c4)]=function(_0x5a5bf6){return new Promise((_0x5f1549,_0x5a1060)=>{const _0x42f147=_0x15cd;let _0x3855b6,_0x48d4d3;if(_0x5a5bf6[_0x42f147(0x1e9)]==0x1){let _0x591763=path['basename'](_0x5a5bf6[_0x42f147(0x1bf)]),_0x1245ac=movieSeasonUtil[_0x42f147(0x1db)](_0x591763);_0x1245ac>0x0&&(_0x3855b6=path[_0x42f147(0x1df)](path[_0x42f147(0x1ef)](_0x5a5bf6[_0x42f147(0x1bf)]),_0x42f147(0x201)),_0x48d4d3=fs[_0x42f147(0x1dd)](_0x3855b6)),!_0x48d4d3&&(_0x3855b6=path[_0x42f147(0x1df)](_0x5a5bf6[_0x42f147(0x1bf)],'tvshow.nfo'),_0x48d4d3=fs['existsSync'](_0x3855b6));}if(!_0x48d4d3)return _0x5a1060();doParse(_0x5f1549,_0x5a1060,_0x5a5bf6,_0x3855b6);});},nfoUtil['saveNfoFile']=function(_0x5c4351,_0x132cc1,_0x3ffddc=_0x2a8126(0x1f8)){return new Promise((_0x522986,_0x1ce569)=>{const _0x56cc17=_0x15cd;try{let _0x4db3cc={'title':_0x5c4351[_0x56cc17(0x1e3)]||'','name':_0x5c4351[_0x56cc17(0x1e3)]||'','sortname':_0x5c4351[_0x56cc17(0x1e4)]||'','tmdbid':_0x5c4351[_0x56cc17(0x1f1)]||'','imdbid':_0x5c4351[_0x56cc17(0x1d2)]||'','releasedate':_0x5c4351['release_date']||'','enddate':_0x5c4351[_0x56cc17(0x1b9)]||'','biography':_0x5c4351[_0x56cc17(0x1ac)]||'','year':_0x5c4351[_0x56cc17(0x1d1)]||''};_0x4db3cc[_0x56cc17(0x1f6)]=_0x5c4351[_0x56cc17(0x1aa)]?_0x5c4351[_0x56cc17(0x1aa)][_0x56cc17(0x1af)]('/'):[],_0x4db3cc[_0x56cc17(0x1de)]=_0x5c4351[_0x56cc17(0x1fe)]?_0x5c4351[_0x56cc17(0x1fe)][_0x56cc17(0x1af)]('/'):[],_0x4db3cc[_0x56cc17(0x1b7)]=_0x5c4351[_0x56cc17(0x1a4)]?_0x5c4351['genres']['split']('/'):[];if(_0x5c4351[_0x56cc17(0x1e8)]&&_0x5c4351[_0x56cc17(0x1e8)][_0x56cc17(0x1b4)]>0x0){_0x4db3cc[_0x56cc17(0x1d0)]=[];for(let _0x3f38e1 of _0x5c4351[_0x56cc17(0x1e8)]){let _0x3a73ca={};_0x3f38e1[_0x56cc17(0x1e0)]&&(_0x3a73ca[_0x56cc17(0x1e0)]=_0x3f38e1[_0x56cc17(0x1e0)]),_0x3f38e1['original_name']&&(_0x3a73ca[_0x56cc17(0x1b5)]=_0x3f38e1[_0x56cc17(0x1ce)]),_0x3f38e1['profile_path']&&(_0x3a73ca[_0x56cc17(0x1bb)]=movieInfoTmdbApi[_0x56cc17(0x1c2)]+_0x3f38e1[_0x56cc17(0x1d6)]),_0x3f38e1['id']&&(_0x3a73ca[_0x56cc17(0x1d4)]=_0x3f38e1['id']),_0x4db3cc[_0x56cc17(0x1d0)][_0x56cc17(0x1bd)](_0x3a73ca);}}else _0x4db3cc['actor']=_0x5c4351[_0x56cc17(0x1b2)]?_0x5c4351[_0x56cc17(0x1b2)]['split']('/'):[];if(_0x5c4351[_0x56cc17(0x1ae)]&&_0x5c4351['directorsOriginal'][_0x56cc17(0x1b4)]>0x0){_0x4db3cc[_0x56cc17(0x1d7)]=[];for(let _0x1c2ced of _0x5c4351[_0x56cc17(0x1ae)]){let _0x40543e={};_0x1c2ced[_0x56cc17(0x1e0)]&&(_0x40543e[_0x56cc17(0x1e0)]=_0x1c2ced[_0x56cc17(0x1e0)]),_0x1c2ced[_0x56cc17(0x1ce)]&&(_0x40543e[_0x56cc17(0x1b5)]=_0x1c2ced[_0x56cc17(0x1ce)]),_0x1c2ced[_0x56cc17(0x1d6)]&&(_0x40543e[_0x56cc17(0x1bb)]=movieInfoTmdbApi[_0x56cc17(0x1c2)]+_0x1c2ced[_0x56cc17(0x1d6)]),_0x1c2ced['id']&&(_0x40543e['tmdbid']=_0x1c2ced['id']),_0x4db3cc['director'][_0x56cc17(0x1bd)](_0x40543e);}}else _0x4db3cc[_0x56cc17(0x1d7)]=_0x5c4351['directors']?_0x5c4351['directors']['split']('/'):[];if(_0x5c4351['creatorOriginal']&&_0x5c4351['creatorOriginal'][_0x56cc17(0x1b4)]>0x0){_0x4db3cc['creator']=[];for(let _0xb1f78a of _0x5c4351['creatorOriginal']){let _0x57b21b={};_0xb1f78a['name']&&(_0x57b21b[_0x56cc17(0x1e0)]=_0xb1f78a[_0x56cc17(0x1e0)]),_0xb1f78a[_0x56cc17(0x1ce)]&&(_0x57b21b[_0x56cc17(0x1b5)]=_0xb1f78a[_0x56cc17(0x1ce)]),_0xb1f78a['profile_path']&&(_0x57b21b[_0x56cc17(0x1bb)]=movieInfoTmdbApi[_0x56cc17(0x1c2)]+_0xb1f78a[_0x56cc17(0x1d6)]),_0xb1f78a['id']&&(_0x57b21b['tmdbid']=_0xb1f78a['id']),_0x4db3cc[_0x56cc17(0x1ec)][_0x56cc17(0x1bd)](_0x57b21b);}}else _0x4db3cc[_0x56cc17(0x1ec)]=_0x5c4351[_0x56cc17(0x1ec)]?_0x5c4351['creator']['split']('/'):[];if(_0x5c4351[_0x56cc17(0x1ea)]&&_0x5c4351[_0x56cc17(0x1ea)][_0x56cc17(0x1b4)]>0x0){_0x4db3cc[_0x56cc17(0x1f3)]=[];for(let _0x90004c of _0x5c4351[_0x56cc17(0x1ea)]){let _0x154691={};_0x90004c[_0x56cc17(0x1e0)]&&(_0x154691['name']=_0x90004c[_0x56cc17(0x1e0)]),_0x90004c[_0x56cc17(0x1ce)]&&(_0x154691['originalname']=_0x90004c[_0x56cc17(0x1ce)]),_0x90004c[_0x56cc17(0x1d6)]&&(_0x154691[_0x56cc17(0x1bb)]=movieInfoTmdbApi['IMAGE_URL']+_0x90004c[_0x56cc17(0x1d6)]),_0x90004c['id']&&(_0x154691[_0x56cc17(0x1d4)]=_0x90004c['id']),_0x4db3cc[_0x56cc17(0x1f3)][_0x56cc17(0x1bd)](_0x154691);}}else _0x4db3cc[_0x56cc17(0x1f3)]=_0x5c4351[_0x56cc17(0x1f3)]?_0x5c4351['guestactors'][_0x56cc17(0x1af)]('/'):[];_0x5c4351['episode']&&(_0x4db3cc['episode']=_0x5c4351['episode']);_0x5c4351['season']&&(_0x4db3cc[_0x56cc17(0x1d3)]=_0x5c4351[_0x56cc17(0x1d3)]);_0x5c4351[_0x56cc17(0x1a2)]&&(_0x4db3cc[_0x56cc17(0x1a2)]=_0x5c4351[_0x56cc17(0x1a2)]);_0x5c4351[_0x56cc17(0x1cc)]&&(_0x4db3cc[_0x56cc17(0x1bb)]=_0x5c4351['cover_url']);console[_0x56cc17(0x1a1)](_0x56cc17(0x1e6),_0x5c4351[_0x56cc17(0x1b3)]);_0x5c4351[_0x56cc17(0x1b3)]&&(_0x4db3cc[_0x56cc17(0x1c1)]=_0x5c4351[_0x56cc17(0x1b3)]);_0x5c4351[_0x56cc17(0x1ed)]&&(_0x4db3cc[_0x56cc17(0x1ed)]=_0x5c4351[_0x56cc17(0x1ed)]);_0x5c4351[_0x56cc17(0x1be)]&&(_0x4db3cc[_0x56cc17(0x1be)]=_0x5c4351[_0x56cc17(0x1be)]);const _0x16d1e5=new XMLBuilder();let _0x5e770c={};_0x5e770c[_0x3ffddc]=_0x4db3cc;const _0x4f5708=_0x16d1e5[_0x56cc17(0x1a8)](_0x5e770c);fs[_0x56cc17(0x1b8)](_0x132cc1,_0x4f5708,_0x380f46=>{_0x522986();});}catch(_0x785855){console[_0x56cc17(0x1a1)](_0x56cc17(0x1f4),_0x132cc1,_0x785855),_0x522986();}});},nfoUtil[_0x2a8126(0x1eb)]=function(_0x284991,_0x2a20ec){return new Promise((_0x233042,_0x1a50f1)=>{const _0x21e926=_0x15cd;try{let _0x167846={'title':_0x284991[_0x21e926(0x1e1)]?_0x284991[_0x21e926(0x1e1)]:'','publish_date':_0x284991[_0x21e926(0x1a9)]?_0x284991[_0x21e926(0x1a9)]:'','year':_0x284991['year']?_0x284991[_0x21e926(0x1d1)]:'','isbn':_0x284991['isbn']?_0x284991[_0x21e926(0x1f5)]:''};_0x167846[_0x21e926(0x1f6)]=_0x284991[_0x21e926(0x1f6)]?_0x284991[_0x21e926(0x1f6)]:'',_0x167846[_0x21e926(0x1b7)]=_0x284991['genre']?_0x284991[_0x21e926(0x1b7)]:'',_0x167846[_0x21e926(0x1a7)]=_0x284991[_0x21e926(0x1a7)]?_0x284991[_0x21e926(0x1a7)]:'',_0x167846['publisher']=_0x284991[_0x21e926(0x1ff)]?_0x284991['publisher']:'',_0x167846[_0x21e926(0x1a5)]=_0x284991[_0x21e926(0x1a5)]?_0x284991[_0x21e926(0x1a5)]:'',_0x167846['introduction']=_0x284991['introduction']?_0x284991[_0x21e926(0x1c7)]:'';const _0x12e444=new XMLBuilder(),_0x203acc=_0x12e444[_0x21e926(0x1a8)]({'book':_0x167846});fs[_0x21e926(0x1b8)](_0x2a20ec,_0x203acc,_0x170b74=>{_0x233042();});}catch(_0x53ba78){console['log'](_0x21e926(0x1f4),_0x2a20ec,_0x53ba78),_0x1a50f1();}});},nfoUtil[_0x2a8126(0x1cb)]=function(_0x281f48){return new Promise((_0x53eeaf,_0x9643b9)=>{const _0x14f785=_0x15cd;try{let _0x164429=path['join'](_0x281f48[_0x14f785(0x1bf)],_0x281f48['filename']),_0x424ea3=_0x164429[_0x14f785(0x1d5)](0x0,_0x164429[_0x14f785(0x1a6)]('.'))+_0x14f785(0x1ee);const _0x5214bd=require('fs'),_0x2a94c0=new XMLParser();_0x5214bd[_0x14f785(0x200)](_0x424ea3,(_0x4d4282,_0x24ffe6)=>{const _0x4b98bb=_0x14f785;if(_0x4d4282)return _0x9643b9();_0x5214bd[_0x4b98bb(0x1a3)](_0x424ea3,(_0x443e8d,_0x2095c3)=>{const _0x1b9b20=_0x4b98bb;if(_0x443e8d)return _0x9643b9();let _0x4979c3=_0x2a94c0[_0x1b9b20(0x1c6)](_0x2095c3);if(_0x4979c3[_0x1b9b20(0x1c0)]){let _0x392425=_0x4979c3[_0x1b9b20(0x1c0)];_0x392425[_0x1b9b20(0x1e1)]&&(_0x281f48[_0x1b9b20(0x1e1)]=_0x392425[_0x1b9b20(0x1e1)]),_0x392425[_0x1b9b20(0x1d1)]&&(_0x281f48[_0x1b9b20(0x1d1)]=_0x392425[_0x1b9b20(0x1d1)]),_0x392425[_0x1b9b20(0x1a9)]&&(_0x281f48[_0x1b9b20(0x1a9)]=_0x392425['publish_date']),_0x392425[_0x1b9b20(0x1f5)]&&(_0x281f48[_0x1b9b20(0x1f5)]=_0x392425[_0x1b9b20(0x1f5)]),_0x392425[_0x1b9b20(0x1f6)]&&(_0x281f48[_0x1b9b20(0x1f6)]=_0x392425['language']),_0x392425['tag']&&(_0x281f48['tag']=_0x392425['tag']),_0x392425[_0x1b9b20(0x1ff)]&&(_0x281f48[_0x1b9b20(0x1ff)]=_0x392425[_0x1b9b20(0x1ff)]),_0x392425[_0x1b9b20(0x1a5)]&&(_0x281f48[_0x1b9b20(0x1a5)]=_0x392425[_0x1b9b20(0x1a5)]),_0x392425[_0x1b9b20(0x1c7)]&&(_0x281f48[_0x1b9b20(0x1c7)]=_0x392425[_0x1b9b20(0x1c7)]);}_0x53eeaf(_0x281f48);});});}catch(_0x23ca30){console[_0x14f785(0x1a1)](_0x14f785(0x1f0),_0x23ca30),_0x9643b9();}});},module[_0x2a8126(0x1cd)]=nfoUtil;