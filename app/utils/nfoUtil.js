const _0x3ae0e3=_0x3787;(function(_0x13977e,_0x3198d8){const _0x333c65=_0x3787,_0x5ae30f=_0x13977e();while(!![]){try{const _0x41bc68=parseInt(_0x333c65(0x9e))/0x1*(parseInt(_0x333c65(0xa6))/0x2)+parseInt(_0x333c65(0xc1))/0x3*(-parseInt(_0x333c65(0xce))/0x4)+parseInt(_0x333c65(0xa9))/0x5+-parseInt(_0x333c65(0x7d))/0x6+-parseInt(_0x333c65(0xc2))/0x7+-parseInt(_0x333c65(0x7c))/0x8*(-parseInt(_0x333c65(0x81))/0x9)+-parseInt(_0x333c65(0x72))/0xa*(-parseInt(_0x333c65(0xc8))/0xb);if(_0x41bc68===_0x3198d8)break;else _0x5ae30f['push'](_0x5ae30f['shift']());}catch(_0x4e40a7){_0x5ae30f['push'](_0x5ae30f['shift']());}}}(_0xc82a,0x47874));function _0xc82a(){const _0x50a9b8=['parseNfoTvSeries','47wDRzcX','nfoFullPath','exports','actor','length','../utils/movieSeasonUtil','IMAGE_URL','actorsOriginal','604JdsBXb','movie_alias','introduction','572565UfyDTY','writeFile','localtitle','lastIndexOf','split','rating','originalname','biography','plot','parse','log','country','cover_url','review','path','actors','episodedetails','join','original_name','year','readFileSync','artist','genre','tag','214515OhJdPz','3237339YRXjkI','existsSync','profile_path','language','guestactors','vote_count','9086BSmoDa','.nfo','vote_average','season.nfo','enddate','stat','12xGDTrL','dirname','isbn','tmdb_id','saveBookNfo','tagline','title','originaltitle','publisher','movie','directorsOriginal','is_tvplay','8630gxDoIT','thumb','tvshow.nfo','filename','fast-xml-parser','releasedate','book','languages','directors','parseNfo','1361800NpzOCx','250788cbXoGR','storyline','genres','\x20/\x20','9HYLeMj','nfo缓存失败','showtitle','director','creatorOriginal','guestActorsOriginal','release_date','movie_imdb_id','movie_name','basename','tvshow','season','tmdbid','build','episode','nfo读取失败','getSeasonNumber','doubanid','douban_score','saveNfoFile','seasonNumber','movie_director_array','push','name','publish_date','creator','sortname','restoreBookNfo'];_0xc82a=function(){return _0x50a9b8;};return _0xc82a();}let fs=require('fs'),path=require('path'),nfoUtil={},movieSeasonUtil=require(_0x3ae0e3(0xa3));const {XMLParser,XMLBuilder}=require(_0x3ae0e3(0x76));function _0x3787(_0x3c5152,_0x1c25ab){const _0xc82a16=_0xc82a();return _0x3787=function(_0x37877e,_0x1fa109){_0x37877e=_0x37877e-0x67;let _0x5b5071=_0xc82a16[_0x37877e];return _0x5b5071;},_0x3787(_0x3c5152,_0x1c25ab);}let movieInfoTmdbApi=require('../utils/movieInfoTmdbApi');function doParse(_0x21b062,_0x27365e,_0x27d5f8,_0x5a749f){const _0xff2548=_0x3ae0e3,_0xb47401=new XMLParser();function _0x370da0(_0x59d055,_0x4f41c4){const _0x19af5a=_0x3787;function _0x57c9df(_0x47703b){const _0x2795f7=_0x3787;if(_0x47703b[_0x2795f7(0xa2)]>0x0&&_0x47703b[0x0]instanceof Object){let _0x59798a=[];for(let _0x541cf3 in _0x47703b){let _0x267e89=_0x47703b[_0x541cf3];_0x59798a['push'](_0x267e89[_0x2795f7(0x98)]||_0x267e89[_0x2795f7(0x6c)]);}return _0x59798a;}else return _0x47703b;}if(!_0x59d055)return'';if(_0x59d055 instanceof Array){let _0x471509=_0x57c9df(_0x59d055);return _0x471509?_0x471509[_0x19af5a(0xba)](_0x19af5a(0x80)):'';}else{if(_0x59d055 instanceof Object){let _0x4c9687=_0x57c9df([_0x59d055]);return _0x4c9687?_0x4c9687['join'](_0x19af5a(0x80)):'';}}return _0x59d055;}try{_0x27d5f8[_0xff2548(0x9f)]=_0x5a749f;let _0xd8de70=_0xb47401[_0xff2548(0xb2)](fs[_0xff2548(0xbd)](_0x5a749f));_0xd8de70[_0xff2548(0x6f)]||_0xd8de70[_0xff2548(0xb9)]||_0xd8de70[_0xff2548(0x8b)]?(_0xd8de70=_0xd8de70['movie']||_0xd8de70[_0xff2548(0xb9)]||_0xd8de70['tvshow'],_0x27d5f8={..._0x27d5f8,'movie_info_name':_0xd8de70[_0xff2548(0x83)]||_0xd8de70[_0xff2548(0x98)]||_0xd8de70[_0xff2548(0x6c)]||_0xd8de70[_0xff2548(0x6d)]||_0xd8de70[_0xff2548(0xab)]||'','movie_alias':_0xd8de70[_0xff2548(0x9b)]||'','movie_regions':_0x370da0(_0xd8de70[_0xff2548(0xb4)]),'movie_language':_0x370da0(_0xd8de70[_0xff2548(0xc5)]),'movie_imdb_id':_0xd8de70['imdbid']||'','movie_genres':_0x370da0(_0xd8de70[_0xff2548(0xbf)]),'movie_release_date':_0xd8de70[_0xff2548(0x77)]||'','movie_end_date':_0xd8de70[_0xff2548(0xcc)]||'','movie_douban_id':_0xd8de70[_0xff2548(0x92)]||'','movie_storyline':_0xd8de70[_0xff2548(0xb1)]||_0xd8de70[_0xff2548(0xb0)]||_0xd8de70[_0xff2548(0xb6)]||'','movie_douban_score':_0xd8de70[_0xff2548(0x93)]||_0xd8de70[_0xff2548(0xae)]||_0xd8de70['customrating']||0x0,'movie_year':_0xd8de70[_0xff2548(0xbc)]||'','tagline':_0xd8de70[_0xff2548(0x6b)]||'','movie_actor':_0x370da0(_0xd8de70[_0xff2548(0xa1)]),'movie_creator':_0x370da0(_0xd8de70[_0xff2548(0x9a)]),'movie_director':_0x370da0(_0xd8de70[_0xff2548(0x84)]),'movie_tags':_0x370da0(_0xd8de70[_0xff2548(0xc0)]),'season_number':_0xd8de70[_0xff2548(0x8c)]||'','episode_number':_0xd8de70[_0xff2548(0x8f)]||''},_0xd8de70['actor']instanceof Array&&_0xd8de70[_0xff2548(0xa1)][_0xff2548(0xa2)]>0x0&&(_0xd8de70[_0xff2548(0xa1)][0x0]instanceof Object&&(_0x27d5f8['movie_actor_array']=_0xd8de70[_0xff2548(0xa1)])),_0xd8de70[_0xff2548(0x84)]instanceof Array&&_0xd8de70['director']['length']>0x0&&(_0xd8de70[_0xff2548(0x84)][0x0]instanceof Object&&(_0x27d5f8[_0xff2548(0x96)]=_0xd8de70[_0xff2548(0x84)])),_0x21b062(_0x27d5f8)):_0x27365e();}catch(_0x250956){_0x27365e(_0x250956);}}nfoUtil[_0x3ae0e3(0x7b)]=function(_0x25d033,_0x3130e4,_0xa8b903){return new Promise((_0x2d489e,_0x4e8d67)=>{const _0x5bedaa=_0x3787;let _0x84d24d=_0x25d033['filename'];if(_0x3130e4){let {name:_0x2dadbf}=path['parse'](_0x84d24d);_0x84d24d=_0x2dadbf;}let _0x3d3027,_0x1ca388;if(_0x25d033[_0x5bedaa(0x71)]==0x1&&!_0xa8b903){_0x3d3027=path['join'](_0x25d033['path'],_0x5bedaa(0x74)),_0x1ca388=fs[_0x5bedaa(0xc3)](_0x3d3027);let _0x5668e5=path[_0x5bedaa(0x8a)](_0x25d033[_0x5bedaa(0xb7)]),_0x2c9b59=movieSeasonUtil[_0x5bedaa(0x91)](_0x5668e5);_0x2c9b59>0x0&&(_0x25d033[_0x5bedaa(0x95)]=_0x2c9b59,_0x3d3027=path[_0x5bedaa(0xba)](_0x25d033[_0x5bedaa(0xb7)],_0x5bedaa(0xcb)),_0x1ca388=fs['existsSync'](_0x3d3027),!_0x1ca388&&(_0x3d3027=path[_0x5bedaa(0xba)](path[_0x5bedaa(0x67)](_0x25d033[_0x5bedaa(0xb7)]),_0x5bedaa(0x74)),_0x1ca388=fs[_0x5bedaa(0xc3)](_0x3d3027)));}else _0x3d3027=path[_0x5bedaa(0xba)](_0x25d033[_0x5bedaa(0xb7)],_0x84d24d+'.nfo'),_0x1ca388=fs['existsSync'](_0x3d3027);if(!_0x1ca388)return _0x4e8d67();doParse(_0x2d489e,_0x4e8d67,_0x25d033,_0x3d3027);});},nfoUtil[_0x3ae0e3(0x9d)]=function(_0x143b7c){return new Promise((_0x598360,_0x4f7361)=>{const _0x100e35=_0x3787;let _0x3a3b9c,_0x4086b0;if(_0x143b7c[_0x100e35(0x71)]==0x1){let _0x56b591=path[_0x100e35(0x8a)](_0x143b7c[_0x100e35(0xb7)]),_0x1a0de0=movieSeasonUtil['getSeasonNumber'](_0x56b591);_0x1a0de0>0x0&&(_0x3a3b9c=path[_0x100e35(0xba)](path[_0x100e35(0x67)](_0x143b7c['path']),_0x100e35(0x74)),_0x4086b0=fs[_0x100e35(0xc3)](_0x3a3b9c)),!_0x4086b0&&(_0x3a3b9c=path[_0x100e35(0xba)](_0x143b7c[_0x100e35(0xb7)],_0x100e35(0x74)),_0x4086b0=fs[_0x100e35(0xc3)](_0x3a3b9c));}if(!_0x4086b0)return _0x4f7361();doParse(_0x598360,_0x4f7361,_0x143b7c,_0x3a3b9c);});},nfoUtil[_0x3ae0e3(0x94)]=function(_0x55fde6,_0x3c708a,_0x481112=_0x3ae0e3(0x6f)){return new Promise((_0x391c25,_0x2c7b53)=>{const _0x2d697=_0x3787;try{let _0x31903f={'title':_0x55fde6[_0x2d697(0x89)]||'','name':_0x55fde6[_0x2d697(0x89)]||'','sortname':_0x55fde6[_0x2d697(0xa7)]||'','tmdbid':_0x55fde6[_0x2d697(0x69)]||'','imdbid':_0x55fde6[_0x2d697(0x88)]||'','releasedate':_0x55fde6[_0x2d697(0x87)]||'','enddate':_0x55fde6['enddate']||'','biography':_0x55fde6[_0x2d697(0x7e)]||'','year':_0x55fde6['year']||''};_0x31903f[_0x2d697(0xc5)]=_0x55fde6[_0x2d697(0x79)]?_0x55fde6[_0x2d697(0x79)][_0x2d697(0xad)]('/'):[],_0x31903f[_0x2d697(0xb4)]=_0x55fde6['regions']?_0x55fde6['regions'][_0x2d697(0xad)]('/'):[],_0x31903f[_0x2d697(0xbf)]=_0x55fde6[_0x2d697(0x7f)]?_0x55fde6[_0x2d697(0x7f)][_0x2d697(0xad)]('/'):[];if(_0x55fde6[_0x2d697(0xa5)]&&_0x55fde6[_0x2d697(0xa5)][_0x2d697(0xa2)]>0x0){_0x31903f[_0x2d697(0xa1)]=[];for(let _0x360bb4 of _0x55fde6[_0x2d697(0xa5)]){let _0x15f25b={};_0x360bb4[_0x2d697(0x98)]&&(_0x15f25b[_0x2d697(0x98)]=_0x360bb4[_0x2d697(0x98)]),_0x360bb4[_0x2d697(0xbb)]&&(_0x15f25b[_0x2d697(0xaf)]=_0x360bb4[_0x2d697(0xbb)]),_0x360bb4['profile_path']&&(_0x15f25b[_0x2d697(0x73)]=movieInfoTmdbApi['IMAGE_URL']+_0x360bb4[_0x2d697(0xc4)]),_0x360bb4['id']&&(_0x15f25b[_0x2d697(0x8d)]=_0x360bb4['id']),_0x31903f['actor']['push'](_0x15f25b);}}else _0x31903f[_0x2d697(0xa1)]=_0x55fde6[_0x2d697(0xb8)]?_0x55fde6[_0x2d697(0xb8)][_0x2d697(0xad)]('/'):[];if(_0x55fde6['directorsOriginal']&&_0x55fde6[_0x2d697(0x70)][_0x2d697(0xa2)]>0x0){_0x31903f['director']=[];for(let _0xc8b2af of _0x55fde6[_0x2d697(0x70)]){let _0x21754e={};_0xc8b2af['name']&&(_0x21754e[_0x2d697(0x98)]=_0xc8b2af[_0x2d697(0x98)]),_0xc8b2af[_0x2d697(0xbb)]&&(_0x21754e['originalname']=_0xc8b2af[_0x2d697(0xbb)]),_0xc8b2af[_0x2d697(0xc4)]&&(_0x21754e[_0x2d697(0x73)]=movieInfoTmdbApi[_0x2d697(0xa4)]+_0xc8b2af[_0x2d697(0xc4)]),_0xc8b2af['id']&&(_0x21754e[_0x2d697(0x8d)]=_0xc8b2af['id']),_0x31903f[_0x2d697(0x84)][_0x2d697(0x97)](_0x21754e);}}else _0x31903f[_0x2d697(0x84)]=_0x55fde6[_0x2d697(0x7a)]?_0x55fde6[_0x2d697(0x7a)][_0x2d697(0xad)]('/'):[];if(_0x55fde6[_0x2d697(0x85)]&&_0x55fde6[_0x2d697(0x85)][_0x2d697(0xa2)]>0x0){_0x31903f['creator']=[];for(let _0x528d95 of _0x55fde6[_0x2d697(0x85)]){let _0x19696e={};_0x528d95[_0x2d697(0x98)]&&(_0x19696e['name']=_0x528d95[_0x2d697(0x98)]),_0x528d95[_0x2d697(0xbb)]&&(_0x19696e['originalname']=_0x528d95[_0x2d697(0xbb)]),_0x528d95['profile_path']&&(_0x19696e[_0x2d697(0x73)]=movieInfoTmdbApi[_0x2d697(0xa4)]+_0x528d95['profile_path']),_0x528d95['id']&&(_0x19696e[_0x2d697(0x8d)]=_0x528d95['id']),_0x31903f[_0x2d697(0x9a)][_0x2d697(0x97)](_0x19696e);}}else _0x31903f[_0x2d697(0x9a)]=_0x55fde6['creator']?_0x55fde6[_0x2d697(0x9a)][_0x2d697(0xad)]('/'):[];if(_0x55fde6[_0x2d697(0x86)]&&_0x55fde6[_0x2d697(0x86)][_0x2d697(0xa2)]>0x0){_0x31903f['guestactors']=[];for(let _0x1fd37a of _0x55fde6[_0x2d697(0x86)]){let _0xeccb21={};_0x1fd37a['name']&&(_0xeccb21[_0x2d697(0x98)]=_0x1fd37a['name']),_0x1fd37a[_0x2d697(0xbb)]&&(_0xeccb21[_0x2d697(0xaf)]=_0x1fd37a[_0x2d697(0xbb)]),_0x1fd37a[_0x2d697(0xc4)]&&(_0xeccb21[_0x2d697(0x73)]=movieInfoTmdbApi[_0x2d697(0xa4)]+_0x1fd37a[_0x2d697(0xc4)]),_0x1fd37a['id']&&(_0xeccb21[_0x2d697(0x8d)]=_0x1fd37a['id']),_0x31903f[_0x2d697(0xc6)][_0x2d697(0x97)](_0xeccb21);}}else _0x31903f[_0x2d697(0xc6)]=_0x55fde6[_0x2d697(0xc6)]?_0x55fde6['guestactors'][_0x2d697(0xad)]('/'):[];_0x55fde6['episode']&&(_0x31903f[_0x2d697(0x8f)]=_0x55fde6[_0x2d697(0x8f)]);_0x55fde6['season']&&(_0x31903f['season']=_0x55fde6[_0x2d697(0x8c)]);_0x55fde6['showtitle']&&(_0x31903f[_0x2d697(0x83)]=_0x55fde6[_0x2d697(0x83)]);_0x55fde6[_0x2d697(0xb5)]&&(_0x31903f[_0x2d697(0x73)]=_0x55fde6[_0x2d697(0xb5)]);console['log']('nfoInfo.vote_average',_0x55fde6[_0x2d697(0xca)]);_0x55fde6[_0x2d697(0xca)]&&(_0x31903f[_0x2d697(0xae)]=_0x55fde6['vote_average']);_0x55fde6[_0x2d697(0x6b)]&&(_0x31903f[_0x2d697(0x6b)]=_0x55fde6[_0x2d697(0x6b)]);_0x55fde6[_0x2d697(0xc7)]&&(_0x31903f[_0x2d697(0xc7)]=_0x55fde6[_0x2d697(0xc7)]);const _0x1dfd47=new XMLBuilder();let _0x4197cc={};_0x4197cc[_0x481112]=_0x31903f;const _0x4e8a77=_0x1dfd47[_0x2d697(0x8e)](_0x4197cc);fs[_0x2d697(0xaa)](_0x3c708a,_0x4e8a77,_0xb9433=>{_0x391c25();});}catch(_0x481331){console[_0x2d697(0xb3)]('nfo缓存失败',_0x3c708a,_0x481331),_0x391c25();}});},nfoUtil[_0x3ae0e3(0x6a)]=function(_0x2280e8,_0x6fcc8b){return new Promise((_0x44affa,_0x288860)=>{const _0x2fdf7e=_0x3787;try{let _0x2b1816={'title':_0x2280e8[_0x2fdf7e(0x6c)]?_0x2280e8['title']:'','publish_date':_0x2280e8[_0x2fdf7e(0x99)]?_0x2280e8[_0x2fdf7e(0x99)]:'','year':_0x2280e8['year']?_0x2280e8[_0x2fdf7e(0xbc)]:'','isbn':_0x2280e8[_0x2fdf7e(0x68)]?_0x2280e8[_0x2fdf7e(0x68)]:''};_0x2b1816[_0x2fdf7e(0xc5)]=_0x2280e8[_0x2fdf7e(0xc5)]?_0x2280e8[_0x2fdf7e(0xc5)]:'',_0x2b1816['genre']=_0x2280e8[_0x2fdf7e(0xbf)]?_0x2280e8[_0x2fdf7e(0xbf)]:'',_0x2b1816[_0x2fdf7e(0xc0)]=_0x2280e8[_0x2fdf7e(0xc0)]?_0x2280e8[_0x2fdf7e(0xc0)]:'',_0x2b1816[_0x2fdf7e(0x6e)]=_0x2280e8[_0x2fdf7e(0x6e)]?_0x2280e8[_0x2fdf7e(0x6e)]:'',_0x2b1816[_0x2fdf7e(0xbe)]=_0x2280e8[_0x2fdf7e(0xbe)]?_0x2280e8[_0x2fdf7e(0xbe)]:'',_0x2b1816[_0x2fdf7e(0xa8)]=_0x2280e8['introduction']?_0x2280e8['introduction']:'';const _0x352b3c=new XMLBuilder(),_0x43ec3a=_0x352b3c[_0x2fdf7e(0x8e)]({'book':_0x2b1816});fs['writeFile'](_0x6fcc8b,_0x43ec3a,_0x4872e0=>{_0x44affa();});}catch(_0x1b67c5){console['log'](_0x2fdf7e(0x82),_0x6fcc8b,_0x1b67c5),_0x288860();}});},nfoUtil[_0x3ae0e3(0x9c)]=function(_0x3250ba){return new Promise((_0x202b37,_0x411a00)=>{const _0x196f97=_0x3787;try{let _0xe796e8=path[_0x196f97(0xba)](_0x3250ba['path'],_0x3250ba[_0x196f97(0x75)]),_0x4c488e=_0xe796e8['substring'](0x0,_0xe796e8[_0x196f97(0xac)]('.'))+_0x196f97(0xc9);const _0x34e632=require('fs'),_0x37fcb5=new XMLParser();_0x34e632[_0x196f97(0xcd)](_0x4c488e,(_0x445117,_0x5e39bd)=>{if(_0x445117)return _0x411a00();_0x34e632['readFile'](_0x4c488e,(_0xff0dd1,_0x563def)=>{const _0x512fca=_0x3787;if(_0xff0dd1)return _0x411a00();let _0x3c9ff9=_0x37fcb5[_0x512fca(0xb2)](_0x563def);if(_0x3c9ff9[_0x512fca(0x78)]){let _0x252881=_0x3c9ff9[_0x512fca(0x78)];_0x252881[_0x512fca(0x6c)]&&(_0x3250ba['title']=_0x252881[_0x512fca(0x6c)]),_0x252881[_0x512fca(0xbc)]&&(_0x3250ba[_0x512fca(0xbc)]=_0x252881[_0x512fca(0xbc)]),_0x252881[_0x512fca(0x99)]&&(_0x3250ba[_0x512fca(0x99)]=_0x252881[_0x512fca(0x99)]),_0x252881[_0x512fca(0x68)]&&(_0x3250ba[_0x512fca(0x68)]=_0x252881[_0x512fca(0x68)]),_0x252881[_0x512fca(0xc5)]&&(_0x3250ba['language']=_0x252881[_0x512fca(0xc5)]),_0x252881[_0x512fca(0xc0)]&&(_0x3250ba[_0x512fca(0xc0)]=_0x252881[_0x512fca(0xc0)]),_0x252881[_0x512fca(0x6e)]&&(_0x3250ba[_0x512fca(0x6e)]=_0x252881['publisher']),_0x252881[_0x512fca(0xbe)]&&(_0x3250ba[_0x512fca(0xbe)]=_0x252881[_0x512fca(0xbe)]),_0x252881[_0x512fca(0xa8)]&&(_0x3250ba[_0x512fca(0xa8)]=_0x252881['introduction']);}_0x202b37(_0x3250ba);});});}catch(_0x15287f){console['log'](_0x196f97(0x90),_0x15287f),_0x411a00();}});},module[_0x3ae0e3(0xa0)]=nfoUtil;