const _0x170279=_0x51fb;(function(_0x5637a9,_0x16743e){const _0xb74933=_0x51fb,_0x255bb9=_0x5637a9();while(!![]){try{const _0x548358=parseInt(_0xb74933(0x1d8))/0x1+-parseInt(_0xb74933(0x1cc))/0x2+-parseInt(_0xb74933(0x1b2))/0x3*(-parseInt(_0xb74933(0x1b7))/0x4)+-parseInt(_0xb74933(0x1d6))/0x5+-parseInt(_0xb74933(0x1d4))/0x6*(parseInt(_0xb74933(0x1b9))/0x7)+parseInt(_0xb74933(0x1c6))/0x8*(parseInt(_0xb74933(0x1c8))/0x9)+parseInt(_0xb74933(0x1b5))/0xa*(parseInt(_0xb74933(0x1c3))/0xb);if(_0x548358===_0x16743e)break;else _0x255bb9['push'](_0x255bb9['shift']());}catch(_0x25172b){_0x255bb9['push'](_0x255bb9['shift']());}}}(_0x1c90,0xcc25d));function _0x51fb(_0xc0a61,_0x2cd4b8){const _0x1c900e=_0x1c90();return _0x51fb=function(_0x51fbd3,_0x2d6937){_0x51fbd3=_0x51fbd3-0x1a9;let _0x57691a=_0x1c900e[_0x51fbd3];return _0x57691a;},_0x51fb(_0xc0a61,_0x2cd4b8);}const path=require(_0x170279(0x1ae));let zipUtil={};const sharp=require(_0x170279(0x1b1)),AdmZip=require(_0x170279(0x1ca)),unrar=require(_0x170279(0x1bf)),fs=require('fs'),config=require(_0x170279(0x1af)),EPub=require(_0x170279(0x1be)),zipEpubUtil=require(_0x170279(0x1d3)),arrayUtil=require(_0x170279(0x1c2));function _0x1c90(){const _0x494d37=['catch','sharp','4887039QmcuFE','toLowerCase','extract','671310ZZWZmT','extname','4CxjHzu','extraction','119QqdSwS','name','.zip','readFile','getInnerFileContent','epub','node-unrar-js','imgTypeList','fileHeaders','./arrayUtil','88eTZNoJ','.cbz','.rar','104xyFXsb','includes','8559NIxBOh','from','adm-zip','then','2827346KcLpod','sortFileNamesByNumber','length','getEpubImageList','jpeg','getFileList','push','./zipEpubUtil','327162trEhrW','.cbr','2106530zpNHBN','log','1419703ONBfVZ','getZipInnerFileList','createExtractorFromData','不支持的压缩文件格式','files','.epub','getSharpDealedBuffer','path','../myConfig/config'];_0x1c90=function(){return _0x494d37;};return _0x1c90();}zipUtil[_0x170279(0x1d9)]=(_0x134923,_0x3c0bb5)=>{return new Promise((_0x1b1796,_0x552a7f)=>{const _0x1d5681=_0x51fb;let _0x1e1c2d=[];try{let _0x1cc1d8=path['extname'](_0x134923);_0x1cc1d8&&(_0x1cc1d8=_0x1cc1d8['toLowerCase']());if(_0x1cc1d8==_0x1d5681(0x1bb)||_0x1cc1d8==_0x1d5681(0x1c4)){const _0x27d227=new AdmZip(_0x134923);_0x27d227['getEntries']()['forEach'](_0x311bcc=>{const _0x4287e2=_0x1d5681;let _0x4eafd5=!![],_0x599220=path['extname'](_0x311bcc['entryName']);_0x3c0bb5&&(_0x4eafd5=![],_0x599220&&config[_0x4287e2(0x1c0)][_0x4287e2(0x1c7)](_0x599220[_0x4287e2(0x1b3)]())&&(_0x4eafd5=!![])),_0x4eafd5&&_0x1e1c2d[_0x4287e2(0x1d2)]({'isDir':_0x311bcc['isDirectory'],'name':_0x311bcc['entryName']});}),_0x1b1796(arrayUtil[_0x1d5681(0x1cd)](_0x1e1c2d,_0x1d5681(0x1ba)));}else{if(_0x1cc1d8==_0x1d5681(0x1c5)||_0x1cc1d8==_0x1d5681(0x1d5))fs['readFile'](_0x134923,(_0x48e7d9,_0x81f8a6)=>{const _0xefa28f=_0x1d5681;unrar[_0xefa28f(0x1a9)]({'data':_0x81f8a6})[_0xefa28f(0x1cb)](_0x73e308=>{const _0x284b15=_0xefa28f,_0x34bc10=_0x73e308[_0x284b15(0x1d1)](),_0x3d1ea9=[..._0x34bc10[_0x284b15(0x1c1)]];for(let _0x2453a4 of _0x3d1ea9){let _0x52cf72=!![],_0x56d524=path['extname'](_0x2453a4['name']);_0x3c0bb5&&(_0x52cf72=![],_0x56d524&&config[_0x284b15(0x1c0)][_0x284b15(0x1c7)](_0x56d524[_0x284b15(0x1b3)]())&&(_0x52cf72=!![])),_0x52cf72&&_0x1e1c2d[_0x284b15(0x1d2)]({'isDir':![],'name':_0x2453a4[_0x284b15(0x1ba)]});}_0x1b1796(arrayUtil[_0x284b15(0x1cd)](_0x1e1c2d,_0x284b15(0x1ba)));});});else _0x1cc1d8==_0x1d5681(0x1ac)?zipEpubUtil[_0x1d5681(0x1cf)](_0x134923)[_0x1d5681(0x1cb)](_0x2e7f29=>{const _0x55b50f=_0x1d5681;for(let _0x5749a6 of _0x2e7f29){_0x1e1c2d[_0x55b50f(0x1d2)]({'isDir':![],'name':_0x5749a6});}_0x1b1796(_0x1e1c2d);}):(console[_0x1d5681(0x1d7)](_0x1d5681(0x1aa),_0x134923),_0x1b1796([]));}}catch(_0x8673ee){console[_0x1d5681(0x1d7)](_0x8673ee),_0x1b1796([]);}});},zipUtil[_0x170279(0x1ad)]=(_0x343110,_0x2520ee)=>{return new Promise((_0x1bb1fe,_0x529c01)=>{const _0x1fd13d=_0x51fb;let _0x37117f=path[_0x1fd13d(0x1b6)](_0x2520ee);_0x37117f&&config[_0x1fd13d(0x1c0)][_0x1fd13d(0x1c7)](_0x37117f[_0x1fd13d(0x1b3)]())?sharp(_0x343110,{'failOnError':![]})[_0x1fd13d(0x1d0)]({'quality':0x4d})['toBuffer']()[_0x1fd13d(0x1cb)](_0xe1efa2=>{_0x1bb1fe(_0xe1efa2);})[_0x1fd13d(0x1b0)](_0x19b35e=>{const _0x518d9c=_0x1fd13d;console[_0x518d9c(0x1d7)](_0x19b35e),_0x1bb1fe(_0x343110);}):_0x1bb1fe(_0x343110);});},zipUtil[_0x170279(0x1bd)]=(_0x2fc1d7,_0x1d44e5)=>{return new Promise((_0x18d8bb,_0x154d36)=>{const _0x2c9896=_0x51fb;try{let _0x478670=path['extname'](_0x2fc1d7);_0x478670&&(_0x478670=_0x478670['toLowerCase']());if(_0x478670=='.zip'||_0x478670==_0x2c9896(0x1c4)||_0x478670==_0x2c9896(0x1ac)){const _0x30bb05=new AdmZip(_0x2fc1d7);let _0x423974=_0x30bb05[_0x2c9896(0x1bc)](_0x1d44e5);zipUtil[_0x2c9896(0x1ad)](_0x423974,_0x1d44e5)[_0x2c9896(0x1cb)](_0x91b5db=>{_0x18d8bb(_0x91b5db);});}else _0x478670==_0x2c9896(0x1c5)||_0x478670=='.cbr'?fs[_0x2c9896(0x1bc)](_0x2fc1d7,(_0x1553a4,_0x2ce48d)=>{const _0x1eeaf1=_0x2c9896;if(_0x1553a4)return console[_0x1eeaf1(0x1d7)](_0x1553a4),_0x18d8bb(null);unrar['createExtractorFromData']({'data':_0x2ce48d})[_0x1eeaf1(0x1cb)](_0x398433=>{const _0x17903e=_0x1eeaf1;try{const _0x3b01ec=_0x398433[_0x17903e(0x1b4)]({'files':[_0x1d44e5]}),_0x20c187=[..._0x3b01ec[_0x17903e(0x1ab)]];if(_0x20c187&&_0x20c187['length']>0x0){let _0x608fcc=Buffer[_0x17903e(0x1c9)](_0x20c187[0x0][_0x17903e(0x1b8)]);zipUtil['getSharpDealedBuffer'](_0x608fcc,_0x1d44e5)[_0x17903e(0x1cb)](_0x3dfcde=>{_0x18d8bb(_0x3dfcde);});}else _0x18d8bb(null);}catch(_0x2a3ba3){_0x18d8bb(null);}});}):(console[_0x2c9896(0x1d7)](_0x2c9896(0x1aa),_0x2fc1d7),_0x18d8bb(null));}catch(_0x19e6d0){console[_0x2c9896(0x1d7)](_0x19e6d0),_0x18d8bb(null);}});},zipUtil['getZipCover']=_0x13b0ec=>{return new Promise((_0x17e79b,_0x5c2820)=>{const _0x2a1a7e=_0x51fb;try{zipUtil['getZipInnerFileList'](_0x13b0ec,!![])[_0x2a1a7e(0x1cb)](_0x3dcbf3=>{const _0x856f2e=_0x2a1a7e;if(_0x3dcbf3[_0x856f2e(0x1ce)]>0x0){let _0x5d0f57=_0x3dcbf3[0x0];zipUtil['getInnerFileContent'](_0x13b0ec,_0x5d0f57[_0x856f2e(0x1ba)])[_0x856f2e(0x1cb)](_0x4724b8=>{_0x17e79b({'dealedBuffer':_0x4724b8,'fileCount':_0x3dcbf3['length']});});}else _0x17e79b(null);});}catch(_0x1b9a3f){_0x17e79b(null);}});},module['exports']=zipUtil;