'use strict';const _0x3d6ddb=_0xbf33;(function(_0x3622e7,_0x4d2b0e){const _0x185711=_0xbf33,_0x235ee8=_0x3622e7();while(!![]){try{const _0x47657b=parseInt(_0x185711(0xde))/0x1*(parseInt(_0x185711(0xc0))/0x2)+-parseInt(_0x185711(0xf0))/0x3+parseInt(_0x185711(0xc3))/0x4+-parseInt(_0x185711(0x87))/0x5*(-parseInt(_0x185711(0x96))/0x6)+parseInt(_0x185711(0xf8))/0x7*(-parseInt(_0x185711(0x12c))/0x8)+parseInt(_0x185711(0xaf))/0x9*(parseInt(_0x185711(0xe0))/0xa)+parseInt(_0x185711(0xb4))/0xb*(-parseInt(_0x185711(0x108))/0xc);if(_0x47657b===_0x4d2b0e)break;else _0x235ee8['push'](_0x235ee8['shift']());}catch(_0x2e6cfb){_0x235ee8['push'](_0x235ee8['shift']());}}}(_0x360d,0xaa8e5));let app,shell,ipcMain;try{app=require(_0x3d6ddb(0x120))[_0x3d6ddb(0x97)],shell=require(_0x3d6ddb(0x120))['shell'],ipcMain=require(_0x3d6ddb(0x120))[_0x3d6ddb(0xff)];}catch(_0x15180e){console['log']('Clientless\x20service\x20mode');}let mainWindow,sha256=require('sha256');const dbFileShare=require(_0x3d6ddb(0xea)),dbUserTable=require('./db/dbUserTable');let nasAccountUtil=require(_0x3d6ddb(0xfa));const {fork}=require(_0x3d6ddb(0x10d));let bgTaskWorkerIsRunning=![],tinyImgWorkerIsRunning=![],getMovieInfoWorkerIsRunning=![],aiFacesWorkerIsRunning=![],aiClassesWorkerIsRunning=![],aiSimilarPhotoWorker=![],globalInfoWorkerIsRunning=![],photoIndexWorkerIsRunning=![],movieIndexWorkerIsRunning=![],musicIndexWorkerIsRunning=![],bookIndexWorkerIsRunning=![],watchWorkerIsRunning=![];const messageUtil=require(_0x3d6ddb(0x7e));function _0x360d(){const _0x144954=['second-instance','getIpv4Address','expressStartedHttps','length','addScanTaskWhenStart','error','http://localhost/#/','myWorkers/bg/bgTaskWorker.js','myWorkers/ddnsWorker.js','movie','book','myWorkers/index/bookIndexWorker.js','aiFaceEnable','shareType','apiServer','./db/dbConfigTable','关闭\x20proxyWorker','FTP','进程出错了','init','nasCabLogout','myWorkers/index/musicIndexWorker.js','setupPrimary','log','dbOther','169adAmCg','catch','50xlEziz','initTray','getConfigApiPort','nasDdnsRestart','HTTPS\x20服务正在运行[HTTPS\x20server\x20is\x20running]\x20:','------Watch\x20worker\x20is\x20stopped------','stopIndexWorker','startUpdate','pid','\x20server_type=\x27FTP\x27','./db/dbFileShare','isVip','saveMsg','myWorkers/tinyImgWorker.js','main\x20err','killed','627270CJxiBa','nasRemoteState','Relaunch\x20Restart','startSimilarPhotoWork','worker\x20send\x20msg\x20error','ddnsIpv6Address','path','username','3495695LglGKz','kill','./express-server/utils/nasAccountUtils','webDavServer','checkWebClientAutoUpdate','myWorkers/globalInfoWorker.js','myWorkers/ai/aiFaceUtil.js','ipcMain','HTTPS\x20服务运行端口[HTTPS\x20server\x20running\x20on\x20port]:','source_type','页面加载失败','restartWatcher','音乐索引线程已退出[Music\x20indexing\x20worker\x20exited]','Closing\x20NasCab\x20ddns','then','stringify','984012ysjmpG','nasDdnsEnable','initBackupWorker','Webdav\x20worker\x20is\x20stopped','isMinimized','child_process','fail','createToken','aiSimilarPhotoEnable','打开路径失败','focus','myWorkers/subtitlesGenWorker.js','https://','getAllByWhere','close','webContents','getTime','photo','Start\x20checking\x20for\x20updates','HTTP\x20服务运行端口[HTTP\x20server\x20running\x20on\x20port]:','?token=','expressEnded','createMainWindow','SELECT\x20count(*)\x20as\x20count\x20FROM\x20backup_task','electron','myWorkers/shareFolder/shareWebDav.js','message','启用\x20frp','setLanguage','myWorkers/index/movieIndexWorker.js','FRP\x20OFF','refresh','myWorkers/expressWorker.js','isVisible','value','start','16TIzRrK','getExpressApiCount','myWorkers/index/fileWatcherWorker.js','myWorkers/ai/aiClassify.js','nasDdnsState','restore','findByTitle','myWorkers/m3u8Worker.js','isPackaged','create','proxyWorker\x20exit','trashItem','downloadTaskChange','prepare','./utils/messageUtil','localhost','uncaughtException','music','http://','M3u8Transcode','照片索引线程已退出[Photos\x20indexing\x20worker\x20exited]','trash','quit','3035zfdueC','myWorkers/bg/fileOperationWorker.js','myWorkers/proxy/proxyWorker.js','START_WORKER_FILE_OPERATION','ddnsIpv4Address','startScanPath','launchWithSys','START_WORKER_BG_TASK','showItemInFolder','shellType','DDNS\x20worker\x20is\x20stopped','main\x20error:','放入回收站失败','myWorkers/bg/backupWorker.js','push','8592OybBnQ','app','startClassesAiWork','nasAccountLogin','openDev','NEW_MOVIE_INDEX','startFaceAiWork','send','getGlobalInfo','createUserFolder','expressStarted','nasRemoteEnable','START_PRE_GEN_SUBTITLE','NEW_TINY_IMAGE','get','exressPort','initDbu','count','run','reset','./utils/globalInfoUtil','aiClassesEnable','openPath','电影索引线程已退出[Movies\x20indexing\x20worker\x20exited]','stop','1553778hAbuPQ','type','getRootPath','deleteByTitle','已打开路径','209kNWbpN','图书索引线程已退出[Books\x20indexing\x20worker\x20exited]','NEW_PHOTO_INDEX','./utils/initUtil','WebDav','myWorkers/movieInfoWorker.js','OFF','show','resolve','stack','/#/','myWorkers/index/photoIndexWorker.js','13430IQrRbx','initWindowEventAndLoadLoading','刷新页面','2388828SAHGQI','exit'];_0x360d=function(){return _0x144954;};return _0x360d();}let accountIsVip=![],backupWorkerIsRunning=![],m3u8WorkerIsRunning=![],subtitleGenWorkerIsRunning=![],loadUrl='';function workerSendMsg(_0x79c8b8,_0x5eba4e){const _0x401779=_0x3d6ddb;try{_0x79c8b8&&!_0x79c8b8[_0x401779(0xef)]&&_0x79c8b8[_0x401779(0x9d)](_0x5eba4e,undefined,undefined,_0x2bf20a=>{const _0x2f3879=_0x401779;_0x2bf20a&&console[_0x2f3879(0xdc)]('send\x20message\x20callback\x20',_0x2bf20a);});}catch(_0x31399e){console[_0x401779(0xdc)](_0x401779(0xf4),_0x31399e);}}let dbu;function _0xbf33(_0x5e3342,_0x269e43){const _0x360da4=_0x360d();return _0xbf33=function(_0xbf3398,_0x13541d){_0xbf3398=_0xbf3398-0x76;let _0x20c4a6=_0x360da4[_0xbf3398];return _0x20c4a6;},_0xbf33(_0x5e3342,_0x269e43);}function init(){const _0x26d2e1=_0x3d6ddb;var _0xc5caff=require('cluster');let _0x495272=require(_0x26d2e1(0xf6)),_0x17224b=require(_0x26d2e1(0xb7)),_0xbe3eb2=require(_0x26d2e1(0xd4)),_0x2c07ea=_0x17224b[_0x26d2e1(0x9f)]();dbu=_0x17224b[_0x26d2e1(0xa6)]();function _0x3b1d44(_0x3a1bde,_0x53a338){function _0x144324(){const _0x3129bb=_0xbf33;_0x3a1bde[_0x3129bb(0xd8)]();if(app)_0x17224b[_0x3129bb(0x8d)]();_0x17224b[_0x3129bb(0x124)]();if(app)mainWindow=_0x17224b[_0x3129bb(0x11e)]();_0x17224b[_0x3129bb(0xd8)](_0x3a1bde);if(app)_0x17224b[_0x3129bb(0xe1)](_0x3a1bde,mainWindow);if(app)_0x17224b[_0x3129bb(0xc1)](_0x3a1bde,mainWindow);_0x17224b['expireTokenOnTime'](),_0x17224b['runNewVersionTask'](_0x3a1bde);if(app)_0x17224b[_0x3129bb(0x9a)]();_0x17224b[_0x3129bb(0xfc)](),_0x53a338(mainWindow);}app?app['on']('ready',()=>{_0x144324();}):_0x144324();}_0x3b1d44(dbu,_0x45c718=>{const _0x12221d=_0x26d2e1,_0x41bc14=_0x17224b[_0x12221d(0xb1)]();let _0x31f538=_0x17224b[_0x12221d(0xe2)]();_0x17224b['getFreePort'](_0x31f538,_0x32bac3=>{const _0x14ec39=_0x12221d;function _0x22a4ae(_0x416dc9){const _0x128489=_0xbf33,_0x1a8046=fork(_0x495272[_0x128489(0xbc)](__dirname,_0x416dc9),[],{'env':{'userDataFolder':_0x2c07ea,'appRootPath':_0x41bc14},'detached':![],'killSignal':'SIGTERM'});return _0x17224b['processList'][_0x128489(0x95)](_0x1a8046),_0x17224b['addProcessRecord'](dbu[_0x128489(0xdd)],_0x1a8046[_0x128489(0xe8)]),_0x1a8046['on'](_0x128489(0xc4),function(_0x1bf9bc,_0x38e291){}),_0x1a8046['on'](_0x128489(0xca),function(_0x6e9164){const _0x3d423b=_0x128489;console[_0x3d423b(0xdc)](_0x3d423b(0xd7),_0x6e9164);}),_0x1a8046;}function _0x10fb3b(_0x3fe9ba){const _0x483427=_0xbf33;nasAccountUtil[_0x483427(0xeb)](null,dbu['dbOther'])[_0x483427(0x106)](_0x534830=>{accountIsVip=_0x534830;if(_0x3fe9ba)_0x3fe9ba();})[_0x483427(0xdf)](_0x365b20=>{const _0x4537da=_0x483427;console[_0x4537da(0xdc)](_0x365b20);});}dbu[_0x14ec39(0xdd)]['prepare']('UPDATE\x20bg_task\x20SET\x20task_state=3\x20where\x20task_state=1')[_0x14ec39(0xa8)](),_0x10fb3b(),setInterval(()=>{_0x212204();},0x258*0x3e8),setTimeout(()=>{const _0x1b07cc=_0x14ec39;_0x17224b[_0x1b07cc(0xc9)](dbu[_0x1b07cc(0xdd)]),_0x4353bd(),_0x289fda(),_0x4917b5(),_0x45f844(),_0x47b5dd(),_0x304fa4(),_0x3d022d(),_0xa8c2c8(),_0xf536cb();},0x1388);let _0x45b2f7;function _0x45f844(){const _0x526a5a=_0x14ec39;if(bookIndexWorkerIsRunning)return;bookIndexWorkerIsRunning=!![],_0x45b2f7=_0x22a4ae(_0x526a5a(0xd0)),_0x45b2f7['on'](_0x526a5a(0x122),function(_0x43eb52){const _0x682d1e=_0x526a5a;_0x43eb52[_0x682d1e(0xb0)]==_0x682d1e(0x116)&&(bookIndexWorkerIsRunning=![]);}),_0x45b2f7['on'](_0x526a5a(0xc4),function(_0x259d52,_0x3fbbbd,_0x4eeee6){const _0x532b52=_0x526a5a;console[_0x532b52(0xdc)](_0x532b52(0xb5),_0x3fbbbd||'',_0x4eeee6||''),bookIndexWorkerIsRunning=![];});}let _0x5e8acc;function _0x4917b5(){const _0x18fa01=_0x14ec39;if(musicIndexWorkerIsRunning)return;musicIndexWorkerIsRunning=!![],_0x5e8acc=_0x22a4ae(_0x18fa01(0xda)),_0x5e8acc['on'](_0x18fa01(0x122),function(_0x5c334b){const _0x44c529=_0x18fa01;_0x5c334b[_0x44c529(0xb0)]==_0x44c529(0x116)&&(musicIndexWorkerIsRunning=![]);}),_0x5e8acc['on'](_0x18fa01(0xc4),function(_0x5ee4fd,_0x23a288,_0x18ac66){const _0x43bcfa=_0x18fa01;console['log'](_0x43bcfa(0x104),_0x23a288||'',_0x18ac66||''),musicIndexWorkerIsRunning=![];});}let _0xcee599;function _0x5665a7(){const _0x2b4d54=_0x14ec39;if(watchWorkerIsRunning)return;watchWorkerIsRunning=!![],_0xcee599=_0x22a4ae(_0x2b4d54(0x12e)),_0xcee599['on'](_0x2b4d54(0x122),function(_0x55adf0){const _0x68c6a0=_0x2b4d54;if(_0x55adf0['type']==_0x68c6a0(0x116))watchWorkerIsRunning=![];else{if(_0x55adf0[_0x68c6a0(0xb0)]==_0x68c6a0(0xb6))_0x47b5dd(),_0xa8c2c8();else _0x55adf0[_0x68c6a0(0xb0)]==_0x68c6a0(0x9b)&&(_0x47b5dd(),_0xf536cb(),_0x4fe45b());}}),_0xcee599['on'](_0x2b4d54(0xc4),function(_0x4f8cdc,_0x1a4f82,_0x4737e2){const _0x457bd5=_0x2b4d54;console[_0x457bd5(0xdc)](_0x457bd5(0xe5),_0x1a4f82,_0x4737e2),watchWorkerIsRunning=![];});}_0x5665a7();let _0x57321d;function _0x4353bd(){const _0x6b486b=_0x14ec39;if(photoIndexWorkerIsRunning)return;photoIndexWorkerIsRunning=!![],_0x57321d=_0x22a4ae(_0x6b486b(0xbf)),_0x57321d['on'](_0x6b486b(0x122),function(_0x365992){const _0x5bcc03=_0x6b486b;_0x365992[_0x5bcc03(0xb0)]==_0x5bcc03(0x116)&&(photoIndexWorkerIsRunning=![]),_0x365992[_0x5bcc03(0xb0)]==_0x5bcc03(0xb6)&&(_0x47b5dd(),_0xa8c2c8());}),_0x57321d['on'](_0x6b486b(0xc4),function(_0x37b524,_0x2a4640,_0x3cc425){const _0x4a6646=_0x6b486b;console[_0x4a6646(0xdc)](_0x4a6646(0x84),_0x2a4640||'',_0x3cc425||''),photoIndexWorkerIsRunning=![];});}let _0x393e69;function _0x289fda(){const _0x35bd7a=_0x14ec39;if(movieIndexWorkerIsRunning)return;movieIndexWorkerIsRunning=!![],_0x393e69=_0x22a4ae(_0x35bd7a(0x125)),_0x393e69['on']('message',function(_0x5aabab){const _0x6f16e6=_0x35bd7a;if(_0x5aabab[_0x6f16e6(0xb0)]==_0x6f16e6(0x116))movieIndexWorkerIsRunning=![];else _0x5aabab[_0x6f16e6(0xb0)]==_0x6f16e6(0x9b)&&(_0x47b5dd(),_0xf536cb(),_0x4fe45b());}),_0x393e69['on'](_0x35bd7a(0xc4),function(_0x5e99a1,_0x51f39b,_0x2c4b8f){const _0x1bf823=_0x35bd7a;console[_0x1bf823(0xdc)](_0x1bf823(0xad),_0x51f39b||'',_0x2c4b8f||''),movieIndexWorkerIsRunning=![];});}function _0xf536cb(){const _0x45705b=_0x14ec39;if(getMovieInfoWorkerIsRunning)return;getMovieInfoWorkerIsRunning=!![];let _0x39e662=_0x22a4ae(_0x45705b(0xb9));_0x39e662['on'](_0x45705b(0x122),function(_0x5014bf){const _0x3653f5=_0x45705b;_0x5014bf['type']==_0x3653f5(0x116)&&(getMovieInfoWorkerIsRunning=![]);}),_0x39e662['on']('exit',function(){getMovieInfoWorkerIsRunning=![];});}function _0x47b5dd(){const _0x16ca16=_0x14ec39;if(tinyImgWorkerIsRunning)return;tinyImgWorkerIsRunning=!![];let _0x12eeb8=_0x22a4ae(_0x16ca16(0xed));_0x12eeb8['on'](_0x16ca16(0x122),function(_0x2e4931){const _0xc72a48=_0x16ca16;if(_0x2e4931[_0xc72a48(0xb0)]==_0xc72a48(0x116))tinyImgWorkerIsRunning=![];else _0x2e4931[_0xc72a48(0xb0)]==_0xc72a48(0xa3)&&(_0x304fa4(),_0x3d022d());}),_0x12eeb8['on'](_0x16ca16(0xc4),function(){tinyImgWorkerIsRunning=![];});}let _0x31de04,_0x215b2f;function _0x35cf93(){const _0x33fa6f=_0x14ec39;let _0x1aa4ed=dbFileShare['getAllByWhere'](dbu['dbOther'],_0x33fa6f(0xe9),[]);if(_0x1aa4ed&&_0x1aa4ed[_0x33fa6f(0xc8)]>0x0)!_0x31de04&&(_0x31de04=_0x22a4ae('myWorkers/shareFolder/shareFtp.js'),_0x31de04['on'](_0x33fa6f(0xc4),function(){console['log']('Ftp\x20worker\x20is\x20stopped'),_0x31de04=null;}));else{_0xbe3eb2['create'](dbu[_0x33fa6f(0xdd)],{'title':'FTPServer','value':JSON[_0x33fa6f(0x107)]({'state':'stop'})});if(_0x31de04){let _0x1955ee=_0x31de04[_0x33fa6f(0xf9)]();_0x1955ee&&(_0x31de04=null,console[_0x33fa6f(0xdc)]('Closing\x20FTP'));}}}function _0xe5ae3e(){const _0x12f6db=_0x14ec39;let _0x13dce2=dbFileShare[_0x12f6db(0x115)](dbu['dbOther'],'\x20server_type=\x27WebDav\x27',[]);if(_0x13dce2&&_0x13dce2[_0x12f6db(0xc8)]>0x0)!_0x215b2f&&(_0x215b2f=_0x22a4ae(_0x12f6db(0x121)),_0x215b2f['on'](_0x12f6db(0xc4),function(){const _0x5c85c6=_0x12f6db;console[_0x5c85c6(0xdc)](_0x5c85c6(0x10b)),_0x215b2f=null;}));else{_0xbe3eb2['create'](dbu[_0x12f6db(0xdd)],{'title':_0x12f6db(0xfb),'value':JSON[_0x12f6db(0x107)]({'state':_0x12f6db(0xae)})});if(_0x215b2f){let _0x3fbe78=_0x215b2f[_0x12f6db(0xf9)]();_0x3fbe78&&(_0x215b2f=null);}}}let _0x187773;function _0x415ca0(){const _0x234cf6=_0x14ec39;let _0x486102=![],_0x482e78=_0xbe3eb2[_0x234cf6(0x76)](dbu[_0x234cf6(0xdd)],_0x234cf6(0x109));_0x482e78&&_0x482e78['value']==0x1&&(_0x486102=!![]);if(_0x486102)!_0x187773&&(_0x187773=_0x22a4ae(_0x234cf6(0xcd)),_0x187773['on'](_0x234cf6(0x122),function(_0x2356ec){const _0x50b36f=_0x234cf6;_0x2356ec['type']==_0x50b36f(0x116)&&(_0x187773=null);}),_0x187773['on']('exit',function(){const _0x3ab4ba=_0x234cf6;console[_0x3ab4ba(0xdc)](_0x3ab4ba(0x91)),_0x187773=null;}));else{if(_0x187773){let _0x2e3260=_0x187773['kill']();_0x2e3260&&(_0x187773=null,console[_0x234cf6(0xdc)](_0x234cf6(0x105)));}_0xbe3eb2[_0x234cf6(0xb2)](dbu['dbOther'],_0x234cf6(0xf5)),_0xbe3eb2['deleteByTitle'](dbu[_0x234cf6(0xdd)],_0x234cf6(0x8b)),_0xbe3eb2['create'](dbu[_0x234cf6(0xdd)],{'title':_0x234cf6(0x130),'value':JSON[_0x234cf6(0x107)]({'status':_0x234cf6(0x10e),'ddnsIp':'','error':_0x234cf6(0xba)})});}}_0x415ca0();let _0x5c566a;function _0xa982bb(){const _0x2a4a6c=_0x14ec39;if(globalInfoWorkerIsRunning)return;globalInfoWorkerIsRunning=!![],_0x5c566a=_0x22a4ae(_0x2a4a6c(0xfd)),_0x5c566a['on'](_0x2a4a6c(0x122),function(_0x4dbcaf){const _0x4c8164=_0x2a4a6c;if(_0x4dbcaf['type']==_0x4c8164(0x116))globalInfoWorkerIsRunning=![];else _0x4dbcaf[_0x4c8164(0xb0)]==_0x4c8164(0x8c)&&_0x1aa95f(_0x4dbcaf);}),_0x5c566a['on'](_0x2a4a6c(0xc4),function(){globalInfoWorkerIsRunning=![];});}_0xa982bb();function _0x3d022d(){const _0x3a798a=_0x14ec39;let _0x3076dd=_0xbe3eb2[_0x3a798a(0x76)](dbu['dbOther'],_0x3a798a(0xd1));if(_0x3076dd&&_0x3076dd[_0x3a798a(0x12a)]=='1'){if(aiFacesWorkerIsRunning)return;aiFacesWorkerIsRunning=!![];let _0xada9f2=_0x22a4ae(_0x3a798a(0xfe));_0xada9f2['on'](_0x3a798a(0x122),function(_0x2ad70a){const _0x4ad053=_0x3a798a;_0x2ad70a[_0x4ad053(0xb0)]==_0x4ad053(0x116)&&(aiFacesWorkerIsRunning=![]);}),_0xada9f2['on'](_0x3a798a(0xc4),function(_0x15f94e,_0x50cfd0,_0x335349){aiFacesWorkerIsRunning=![],_0xada9f2=null;});}else{}}function _0xa8c2c8(){const _0x1598ca=_0x14ec39;let _0x2413b7=_0xbe3eb2[_0x1598ca(0x76)](dbu[_0x1598ca(0xdd)],_0x1598ca(0x110));if(_0x2413b7&&_0x2413b7[_0x1598ca(0x12a)]=='1'){if(aiSimilarPhotoWorker)return;aiSimilarPhotoWorker=!![];let _0x5380b6=_0x22a4ae('myWorkers/ai/aiSimilarPhotos.js');_0x5380b6['on'](_0x1598ca(0x122),function(_0x1abbd6){const _0x5c311e=_0x1598ca;_0x1abbd6['type']==_0x5c311e(0x116)&&(aiSimilarPhotoWorker=![]);}),_0x5380b6['on']('exit',()=>{_0x5380b6=![];});}else{}}function _0x304fa4(){const _0x429b9e=_0x14ec39;let _0x557160=_0xbe3eb2[_0x429b9e(0x76)](dbu[_0x429b9e(0xdd)],_0x429b9e(0xab));if(_0x557160&&_0x557160[_0x429b9e(0x12a)]=='1'){if(aiClassesWorkerIsRunning)return;aiClassesWorkerIsRunning=!![];let _0xc0037c=_0x22a4ae(_0x429b9e(0x12f));_0xc0037c['on']('message',function(_0x31fe82){const _0x1c248d=_0x429b9e;_0x31fe82[_0x1c248d(0xb0)]=='close'&&(aiClassesWorkerIsRunning=![]);}),_0xc0037c['on'](_0x429b9e(0xc4),()=>{aiClassesWorkerIsRunning=![];});}else{}}let _0x2c0f3b;function _0x5970f9(){const _0x13ec55=_0x14ec39;let _0x89e84=dbu[_0x13ec55(0xdd)][_0x13ec55(0x7d)](_0x13ec55(0x11f))[_0x13ec55(0xa4)]();if(_0x89e84[_0x13ec55(0xa7)]>0x0){if(backupWorkerIsRunning)return;backupWorkerIsRunning=!![],_0x2c0f3b=_0x22a4ae(_0x13ec55(0x94)),_0x2c0f3b['on'](_0x13ec55(0x122),function(_0x365d45){const _0x15acd4=_0x13ec55;_0x365d45[_0x15acd4(0xb0)]==_0x15acd4(0x116)&&(backupWorkerIsRunning=![]);}),_0x2c0f3b['on'](_0x13ec55(0xc4),()=>{backupWorkerIsRunning=![];});}else{if(_0x2c0f3b){let _0x4783e8=_0x2c0f3b[_0x13ec55(0xf9)]();_0x4783e8&&(_0x2c0f3b=null);}}}_0x5970f9();let _0x205bb8;function _0x9d9609(){const _0x2025ca=_0x14ec39;if(m3u8WorkerIsRunning)return;m3u8WorkerIsRunning=!![],_0x205bb8=_0x22a4ae(_0x2025ca(0x77)),_0x205bb8['on'](_0x2025ca(0x122),function(_0x464b0c){const _0x20b42a=_0x2025ca;_0x464b0c[_0x20b42a(0xb0)]==_0x20b42a(0x116)&&(m3u8WorkerIsRunning=![]);}),_0x205bb8['on'](_0x2025ca(0xc4),function(_0x233766){m3u8WorkerIsRunning=![];});}let _0x596e25,_0x598b69=![];function _0x212204(){const _0x35c599=_0x14ec39;_0x598b69&&(!_0x596e25&&(_0x596e25=_0x22a4ae(_0x35c599(0x89)),_0x596e25['on'](_0x35c599(0xc4),_0x25f23f=>{const _0x337940=_0x35c599;console[_0x337940(0xdc)](_0x337940(0x7a),_0x25f23f),_0x596e25=null;}),console['log'](_0x35c599(0x123))));}function _0x54e08c(){const _0x5c4550=_0x14ec39;let _0x19c1cf=_0xbe3eb2[_0x5c4550(0x76)](dbu['dbOther'],_0x5c4550(0xa1));!_0x19c1cf||_0x19c1cf&&_0x19c1cf[_0x5c4550(0x12a)]!=0x1&&_0x19c1cf['value']!='1'?(_0x598b69=![],_0x596e25&&(_0x596e25['kill'](),_0x596e25=null,console[_0x5c4550(0xdc)](_0x5c4550(0xd5))),_0xbe3eb2[_0x5c4550(0x79)](dbu[_0x5c4550(0xdd)],{'title':_0x5c4550(0xf1),'value':JSON[_0x5c4550(0x107)]({'status':_0x5c4550(0x10e),'time':new Date()[_0x5c4550(0x118)]()+'','error':_0x5c4550(0x126)})})):(_0x598b69=!![],_0x212204());}_0x54e08c();let _0x699b7d;function _0x4fe45b(){const _0x184838=_0x14ec39;if(subtitleGenWorkerIsRunning)return;subtitleGenWorkerIsRunning=!![],_0x699b7d=_0x22a4ae(_0x184838(0x113)),_0x699b7d['on'](_0x184838(0x122),function(_0x1d3529){const _0x3fe3cd=_0x184838;_0x1d3529[_0x3fe3cd(0xb0)]==_0x3fe3cd(0x116)&&(subtitleGenWorkerIsRunning=![]);}),_0x699b7d['on']('exit',function(_0x5b13dd){subtitleGenWorkerIsRunning=![];});}setTimeout(()=>{_0x4fe45b();},0x1388);let _0x48a50=![],_0x13678f=![],_0x920671=![];function _0xefdba8(_0x4950e8){const _0xc26307=_0x14ec39;try{!_0x920671&&(_0x920671=!![],setTimeout(()=>{const _0x35efe9=_0xbf33;let _0x441910=require(_0x35efe9(0xaa)),_0x51409d=_0x441910['getIpv4Address'](dbu[_0x35efe9(0xdd)]);_0x51409d?console[_0x35efe9(0xdc)](_0x35efe9(0xe4),_0x35efe9(0x114)+_0x51409d+':'+_0x4950e8):console[_0x35efe9(0xdc)](_0x35efe9(0x100),_0x4950e8);},0x3a98));}catch(_0x19025c){console[_0xc26307(0xdc)](_0x19025c);}}function _0x5b8f5c(_0x1322e8){const _0x4bb2e1=_0x14ec39;_0xe5ae3e(),setTimeout(()=>{_0x35cf93();},0x1388);!_0x13678f&&(_0x13678f=!![],setTimeout(()=>{const _0x2df485=_0xbf33;let _0x2d5f40=require(_0x2df485(0xaa)),_0x56bfee=_0x2d5f40[_0x2df485(0xc6)](dbu[_0x2df485(0xdd)]);_0x56bfee?console[_0x2df485(0xdc)]('HTTP\x20服务正在运行[HTTP\x20server\x20is\x20running]\x20:',_0x2df485(0x82)+_0x56bfee+':'+_0x1322e8):console['log'](_0x2df485(0x11b),_0x1322e8);},0x3a98));_0xbe3eb2[_0x4bb2e1(0x79)](dbu[_0x4bb2e1(0xdd)],{'title':_0x4bb2e1(0xd3),'value':JSON[_0x4bb2e1(0x107)]({'state':'run','port':_0x1322e8})});if(!_0x48a50){_0x48a50=!![];if(app){app[_0x4bb2e1(0x78)]?loadUrl=_0x1322e8=='80'?_0x4bb2e1(0xcb):'http://localhost:'+_0x1322e8+_0x4bb2e1(0xbe):loadUrl='http://localhost:8081/#/';let _0x54506c=_0xbe3eb2[_0x4bb2e1(0x76)](dbu[_0x4bb2e1(0xdd)],'autoLoginClient');if(!_0x54506c||_0x54506c['value']=='1'){let _0x1a0b5c=dbUserTable['getAdmin'](dbu['dbOther']);if(_0x1a0b5c){let _0x4763f5=sha256(new Date()[_0x4bb2e1(0x118)]()+_0x1a0b5c[_0x4bb2e1(0xf7)]);dbUserTable[_0x4bb2e1(0x10f)](dbu['dbOther'],_0x1a0b5c['id'],_0x4763f5,_0x4bb2e1(0x7f)),loadUrl+=_0x4bb2e1(0x11c)+_0x4763f5;}}_0x45c718['loadURL'](loadUrl),_0x45c718[_0x4bb2e1(0x117)]['on']('did-fail-load',function(){const _0xa49803=_0x4bb2e1;console[_0xa49803(0xdc)](_0xa49803(0x102),loadUrl);}),ipcMain['on'](_0x4bb2e1(0x127),(_0x4ceb2c,_0x592378)=>{const _0x144ca4=_0x4bb2e1;console['log'](_0x144ca4(0xc2),loadUrl),loadUrl&&_0x45c718['loadURL'](loadUrl);});}workerSendMsg(_0x596e25,{'type':_0x4bb2e1(0x12b)});}}let _0x20839f=_0x17224b[_0x14ec39(0x12d)]();console['log']('NasCab\x20Api\x20进程数量\x20[NasCab\x20api\x20thread\x20count]:',_0x20839f),_0xc5caff[_0x14ec39(0xdb)]({'exec':_0x495272['resolve'](__dirname,_0x14ec39(0x128))}),_0xc5caff['on'](_0x14ec39(0xc4),function(_0x3572d0,_0x23b8fd,_0x10cc86){const _0x54fc8c=_0x14ec39;console[_0x54fc8c(0xdc)]('NasCab\x20api\x20server\x20restarting\x20',_0x23b8fd,_0x10cc86),setTimeout(()=>{_0x27478d();},0x1388);});for(let _0x2f1fd8=0x0;_0x2f1fd8<_0x20839f;_0x2f1fd8++){_0x27478d();}function _0x1aa95f(_0xb81d5e){const _0x26e7c5=_0x14ec39;if(_0xb81d5e[_0x26e7c5(0x101)]==_0x26e7c5(0xce))_0x289fda();else{if(_0xb81d5e[_0x26e7c5(0x101)]==_0x26e7c5(0x119))_0x4353bd();else{if(_0xb81d5e[_0x26e7c5(0x101)]=='music')_0x4917b5();else _0xb81d5e['source_type']==_0x26e7c5(0xcf)&&_0x45f844();}}_0xb81d5e[_0x26e7c5(0x103)]&&(_0x5665a7(),workerSendMsg(_0xcee599,_0xb81d5e));}function _0x27478d(){const _0x138ed3=_0x14ec39,_0x48681d=_0xc5caff['fork']({'usePort':_0x32bac3,'userDataFolder':_0x2c07ea,'appRootPath':_0x41bc14});_0x48681d['on'](_0x138ed3(0x122),function(_0x286eed){const _0x2085ff=_0x138ed3;try{switch(_0x286eed[_0x2085ff(0xb0)]){case _0x2085ff(0x8a):let _0x32ba57=_0x22a4ae(_0x2085ff(0x88));workerSendMsg(_0x32ba57,_0x286eed);break;case _0x2085ff(0x8e):if(!bgTaskWorkerIsRunning){bgTaskWorkerIsRunning=!![];let _0x16b711=_0x22a4ae(_0x2085ff(0xcc));_0x16b711['on'](_0x2085ff(0x122),function(_0x1d254f){const _0x372e94=_0x2085ff;_0x1d254f[_0x372e94(0xb0)]==_0x372e94(0x116)&&(bgTaskWorkerIsRunning=![]);});}break;case'SWITCH_MOVIE_INFO':_0xf536cb();break;case _0x2085ff(0xa2):_0x4fe45b();break;case _0x2085ff(0x83):_0x9d9609(),workerSendMsg(_0x205bb8,_0x286eed);break;case'nasProxyRestart':_0x54e08c(),workerSendMsg(_0x596e25,{'type':_0x2085ff(0xa9),'msg':_0x286eed});break;case _0x2085ff(0xd9):_0x54e08c(),workerSendMsg(_0x596e25,{'type':_0x2085ff(0xae)}),setTimeout(()=>{_0x10fb3b(()=>{_0xf536cb();});},0x3e8);break;case _0x2085ff(0x9e):_0xa982bb(),workerSendMsg(_0x5c566a,_0x286eed);break;case _0x2085ff(0xe7):console[_0x2085ff(0xdc)](_0x2085ff(0x11a)),_0x17224b['startUpdate']();break;case _0x2085ff(0x10a):_0x5970f9();break;case _0x2085ff(0xe6):if(_0x286eed[_0x2085ff(0x101)]==_0x2085ff(0x119))_0x57321d&&(_0x57321d['kill'](),_0x57321d=null,photoIndexWorkerIsRunning=![]);else{if(_0x286eed[_0x2085ff(0x101)]==_0x2085ff(0xce))_0x393e69&&(_0x393e69['kill'](),_0x393e69=null,movieIndexWorkerIsRunning=![]);else{if(_0x286eed[_0x2085ff(0x101)]==_0x2085ff(0x81))_0x5e8acc&&(_0x5e8acc[_0x2085ff(0xf9)](),_0x5e8acc=null,musicIndexWorkerIsRunning=![]);else _0x286eed[_0x2085ff(0x101)]==_0x2085ff(0xcf)&&(_0x45b2f7&&(_0x45b2f7['kill'](),_0x45b2f7=null,bookIndexWorkerIsRunning=![]));}}break;case'startScanPath':_0x1aa95f(_0x286eed);break;case'fileShareRestart':if(_0x286eed[_0x2085ff(0xd2)]==_0x2085ff(0xb8))_0xe5ae3e(),workerSendMsg(_0x215b2f,_0x286eed);else _0x286eed[_0x2085ff(0xd2)]==_0x2085ff(0xd6)&&(_0x35cf93(),workerSendMsg(_0x31de04,_0x286eed));break;case _0x2085ff(0xe3):_0x415ca0(),workerSendMsg(_0x187773,{'type':_0x2085ff(0x12b),'force':0x1});break;case _0x2085ff(0xd9):_0x415ca0(),setTimeout(()=>{_0x10fb3b(()=>{_0xf536cb();});},0x3e8);break;case _0x2085ff(0x99):_0x54e08c(),workerSendMsg(_0x596e25,{'type':_0x2085ff(0xa9)}),_0x415ca0(),setTimeout(()=>{_0x10fb3b(()=>{_0xf536cb();});},0x3e8);break;case'createUserFolder':_0x17224b[_0x2085ff(0x9f)]();break;case _0x2085ff(0x98):_0x304fa4();break;case _0x2085ff(0x9c):_0x3d022d();break;case _0x2085ff(0xf3):_0xa8c2c8();break;case _0x2085ff(0xa0):_0x5b8f5c(_0x286eed[_0x2085ff(0xa5)]);break;case _0x2085ff(0xc7):_0xefdba8(_0x286eed['exressPort']);break;case'Relaunch':console[_0x2085ff(0xdc)](_0x2085ff(0xf2));if(app)app['relaunch']();_0x17224b['exitApp'](dbu);break;case _0x2085ff(0x11d):break;case'shell':if(shell){if(_0x286eed[_0x2085ff(0x90)]==_0x2085ff(0x8f))_0x286eed[_0x2085ff(0xf6)]&&shell[_0x2085ff(0x8f)](_0x286eed['path']);else{if(_0x286eed[_0x2085ff(0x90)]==_0x2085ff(0xac))_0x286eed[_0x2085ff(0xf6)]&&shell[_0x2085ff(0xac)](_0x286eed[_0x2085ff(0xf6)])[_0x2085ff(0x106)](_0x1b52c7=>{const _0x3f3b9a=_0x2085ff;console['log'](_0x3f3b9a(0xb3));})[_0x2085ff(0xdf)](_0x4b60b8=>{const _0x44988c=_0x2085ff;console['log'](_0x44988c(0x111),_0x4b60b8);});else _0x286eed[_0x2085ff(0x90)]==_0x2085ff(0x85)&&(_0x286eed[_0x2085ff(0xf6)]&&shell[_0x2085ff(0x7b)](_0x286eed[_0x2085ff(0xf6)])['then'](_0x497968=>{const _0x50300d=_0x2085ff;console[_0x50300d(0xdc)]('已经放入回收站');})['catch'](_0x4eaf38=>{const _0x5c41a1=_0x2085ff;console[_0x5c41a1(0xdc)](_0x5c41a1(0x93),_0x4eaf38);}));}}break;case _0x2085ff(0x7c):}}catch(_0x1bd7ce){console['log'](_0x2085ff(0xee),_0x1bd7ce);}});}});});}if(app){const gotTheLock=app['requestSingleInstanceLock']();!gotTheLock?(app[_0x3d6ddb(0x86)](),process[_0x3d6ddb(0xf9)](process['pid'],'SIGTERM')):(app['on'](_0x3d6ddb(0xc5),(_0x5907f1,_0xd58c63,_0x19d5a6)=>{const _0x5aad9b=_0x3d6ddb;if(mainWindow){if(mainWindow[_0x5aad9b(0x10c)]())mainWindow[_0x5aad9b(0x131)]();!mainWindow[_0x5aad9b(0x129)]()&&mainWindow[_0x5aad9b(0xbb)](),mainWindow[_0x5aad9b(0x112)]();}}),init());}else init();process['on'](_0x3d6ddb(0x80),(_0x48cdcb,_0x3d56d6)=>{const _0x277368=_0x3d6ddb;console[_0x277368(0xdc)](_0x277368(0x92),_0x48cdcb),dbu&&messageUtil[_0x277368(0xec)](dbu[_0x277368(0xdd)],'Error\x20occurred\x20in\x20main\x20process',_0x277368(0xca),_0x48cdcb[_0x277368(0xbd)]||_0x48cdcb[_0x277368(0x122)]);});