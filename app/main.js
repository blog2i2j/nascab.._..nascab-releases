'use strict';const _0x1db0e1=_0x18ca;(function(_0x2b734c,_0xd868d1){const _0x680d96=_0x18ca,_0x5c411e=_0x2b734c();while(!![]){try{const _0x32a811=-parseInt(_0x680d96(0x1e1))/0x1*(parseInt(_0x680d96(0x248))/0x2)+-parseInt(_0x680d96(0x1bc))/0x3+-parseInt(_0x680d96(0x23e))/0x4+-parseInt(_0x680d96(0x221))/0x5*(parseInt(_0x680d96(0x255))/0x6)+-parseInt(_0x680d96(0x254))/0x7*(parseInt(_0x680d96(0x1de))/0x8)+parseInt(_0x680d96(0x26d))/0x9+parseInt(_0x680d96(0x1ec))/0xa*(parseInt(_0x680d96(0x1f1))/0xb);if(_0x32a811===_0xd868d1)break;else _0x5c411e['push'](_0x5c411e['shift']());}catch(_0x22f9ae){_0x5c411e['push'](_0x5c411e['shift']());}}}(_0x4ec3,0x559ec));let app,shell,ipcMain;try{app=require(_0x1db0e1(0x24d))[_0x1db0e1(0x262)],shell=require(_0x1db0e1(0x24d))[_0x1db0e1(0x1c5)],ipcMain=require('electron')[_0x1db0e1(0x245)];}catch(_0x3781cc){console['log']('Clientless\x20service\x20mode');}function _0x4ec3(){const _0x1ef05d=['aiFaceEnable','deleteByTitle','startSimilarPhotoWork','页面加载失败','nasRemoteState','nasRemoteEnable','nasAccountLogin','message','\x20server_type=\x27FTP\x27','initDbu','child_process','dbOther','isVip','FRP\x20OFF','then','OFF','./db/dbConfigTable','trashItem','M3u8Transcode','nasDdnsEnable','./db/dbUserTable','startFaceAiWork','993008NQZyrH','nasProxyRestart','path','getGlobalInfo','已打开路径','openPath','music','ipcMain','isVisible','HTTPS\x20服务运行端口[HTTPS\x20server\x20running\x20on\x20port]:','44438VTYrgJ','webContents','myWorkers/index/photoIndexWorker.js','HTTP\x20服务运行端口[HTTP\x20server\x20running\x20on\x20port]:','relaunch','electron','放入回收站失败','START_WORKER_FILE_OPERATION','worker\x20send\x20msg\x20error','myWorkers/shareFolder/shareFtp.js','apiServer','findByTitle','91651wTOhCf','258120jtWiMo','run','http://localhost:8081/#/','kill','SIGTERM','myWorkers/index/musicIndexWorker.js','图书索引线程已退出[Books\x20indexing\x20worker\x20exited]','setupPrimary','second-instance','localhost','autoLoginClient','focus','loadURL','app','?token=','downloadTaskChange','main\x20error:','stringify','push','error','ddnsIpv6Address','uncaughtException','startScanPath','checkWebClientAutoUpdate','1168272XkCxPt','start','stopIndexWorker','proxyWorker\x20exit','http://localhost/#/','nasDdnsState','myWorkers/ddnsWorker.js','1240668ALfiLW','fork','已经放入回收站','addProcessRecord','myWorkers/tinyImgWorker.js','fileShareRestart','getTime','Webdav\x20worker\x20is\x20stopped','quit','shell','myWorkers/ai/aiClassify.js','Relaunch','shareType','myWorkers/index/fileWatcherWorker.js','getIpv4Address','username','Relaunch\x20Restart','aiClassesEnable','restore','create','send','requestSingleInstanceLock','expressEnded','START_WORKER_BG_TASK','expressStarted','\x20server_type=\x27WebDav\x27','myWorkers/bg/backupWorker.js','refresh','initTray','movie','createToken','initWindowEventAndLoadLoading','processList','main\x20err','248VRdIsP','./express-server/utils/nasAccountUtils','getExpressApiCount','15XQzdnA','getAllByWhere','Ftp\x20worker\x20is\x20stopped','./db/dbFileShare','HTTP\x20服务正在运行[HTTP\x20server\x20is\x20running]\x20:','webDavServer','saveMsg','openDev','prepare','getConfigApiPort','sha256','70xPkwMm','log','count','刷新页面','addScanTaskWhenStart','2886664kfMDlw','myWorkers/expressWorker.js','type','UPDATE\x20bg_task\x20SET\x20task_state=3\x20where\x20task_state=1','nasDdnsRestart','myWorkers/globalInfoWorker.js','myWorkers/bg/fileOperationWorker.js','/#/','myWorkers/movieInfoWorker.js','photo','fail','exitApp','source_type','showItemInFolder','createMainWindow','exit','exressPort','HTTPS\x20服务正在运行[HTTPS\x20server\x20is\x20running]\x20:','Error\x20occurred\x20in\x20main\x20process','did-fail-load','shellType','SELECT\x20count(*)\x20as\x20count\x20FROM\x20backup_task','show','http://','NEW_MOVIE_INDEX','Closing\x20FTP','catch','createUserFolder','ddnsIpv4Address','myWorkers/shareFolder/shareWebDav.js','NEW_TINY_IMAGE','myWorkers/index/bookIndexWorker.js','launchWithSys','启用\x20frp','DDNS\x20worker\x20is\x20stopped','isMinimized','init','resolve','pid','value','./utils/globalInfoUtil','关闭\x20proxyWorker','isPackaged','NasCab\x20api\x20server\x20restarting\x20','close','照片索引线程已退出[Photos\x20indexing\x20worker\x20exited]','startUpdate','trash','25nURjPN','Closing\x20NasCab\x20ddns','runNewVersionTask','aiSimilarPhotoEnable','expireTokenOnTime','stop','reset'];_0x4ec3=function(){return _0x1ef05d;};return _0x4ec3();}let mainWindow,sha256=require(_0x1db0e1(0x1eb));const dbFileShare=require(_0x1db0e1(0x1e4)),dbUserTable=require(_0x1db0e1(0x23c));function _0x18ca(_0x3008a0,_0x3068c9){const _0x4ec3f3=_0x4ec3();return _0x18ca=function(_0x18cab1,_0x4ea143){_0x18cab1=_0x18cab1-0x1b7;let _0x20715a=_0x4ec3f3[_0x18cab1];return _0x20715a;},_0x18ca(_0x3008a0,_0x3068c9);}let nasAccountUtil=require(_0x1db0e1(0x1df));const {fork}=require(_0x1db0e1(0x232));let bgTaskWorkerIsRunning=![],tinyImgWorkerIsRunning=![],getMovieInfoWorkerIsRunning=![],aiFacesWorkerIsRunning=![],aiClassesWorkerIsRunning=![],aiSimilarPhotoWorker=![],globalInfoWorkerIsRunning=![],photoIndexWorkerIsRunning=![],movieIndexWorkerIsRunning=![],musicIndexWorkerIsRunning=![],bookIndexWorkerIsRunning=![],watchWorkerIsRunning=![];const messageUtil=require('./utils/messageUtil');let accountIsVip=![],backupWorkerIsRunning=![],m3u8WorkerIsRunning=![],subtitleGenWorkerIsRunning=![],loadUrl='';function workerSendMsg(_0xc67df8,_0x11177d){const _0x344556=_0x1db0e1;try{_0xc67df8&&!_0xc67df8['killed']&&_0xc67df8[_0x344556(0x1d0)](_0x11177d,undefined,undefined,_0x46dbbd=>{const _0x570349=_0x344556;_0x46dbbd&&console[_0x570349(0x1ed)]('send\x20message\x20callback\x20',_0x46dbbd);});}catch(_0x34a132){console[_0x344556(0x1ed)](_0x344556(0x250),_0x34a132);}}let dbu;function init(){const _0x557a40=_0x1db0e1;var _0xa66094=require('cluster');let _0x59ab2c=require(_0x557a40(0x240)),_0x328546=require('./utils/initUtil'),_0x5ed8e3=require(_0x557a40(0x238)),_0x41461e=_0x328546[_0x557a40(0x20c)]();dbu=_0x328546[_0x557a40(0x231)]();function _0x3d98f2(_0x5cfb03,_0x568e0e){function _0x3d359b(){const _0xe61a2b=_0x18ca;_0x5cfb03[_0xe61a2b(0x215)]();if(app)_0x328546[_0xe61a2b(0x211)]();_0x328546['setLanguage']();if(app)mainWindow=_0x328546[_0xe61a2b(0x1ff)]();_0x328546['init'](_0x5cfb03);if(app)_0x328546[_0xe61a2b(0x1d8)](_0x5cfb03,mainWindow);if(app)_0x328546[_0xe61a2b(0x1db)](_0x5cfb03,mainWindow);_0x328546[_0xe61a2b(0x225)](),_0x328546[_0xe61a2b(0x223)](_0x5cfb03);if(app)_0x328546[_0xe61a2b(0x1e8)]();_0x328546[_0xe61a2b(0x26c)](),_0x568e0e(mainWindow);}app?app['on']('ready',()=>{_0x3d359b();}):_0x3d359b();}_0x3d98f2(dbu,_0x315575=>{const _0x519039=_0x557a40,_0x253829=_0x328546['getRootPath']();let _0x8d5ec7=_0x328546[_0x519039(0x1ea)]();_0x328546['getFreePort'](_0x8d5ec7,_0x521e6c=>{const _0x3827de=_0x519039;function _0xcbb20(_0x131780){const _0x1c1d99=_0x18ca,_0x23e150=fork(_0x59ab2c['resolve'](__dirname,_0x131780),[],{'env':{'userDataFolder':_0x41461e,'appRootPath':_0x253829},'detached':![],'killSignal':_0x1c1d99(0x259)});return _0x328546[_0x1c1d99(0x1dc)][_0x1c1d99(0x267)](_0x23e150),_0x328546[_0x1c1d99(0x1bf)](dbu[_0x1c1d99(0x233)],_0x23e150[_0x1c1d99(0x217)]),_0x23e150['on'](_0x1c1d99(0x200),function(_0x2ab88a,_0x476149){}),_0x23e150['on'](_0x1c1d99(0x268),function(_0x15244c){const _0xa513aa=_0x1c1d99;console[_0xa513aa(0x1ed)]('进程出错了',_0x15244c);}),_0x23e150;}function _0x4540a4(_0x4f3196){const _0x219dc9=_0x18ca;nasAccountUtil[_0x219dc9(0x234)](null,dbu[_0x219dc9(0x233)])[_0x219dc9(0x236)](_0x42ced7=>{accountIsVip=_0x42ced7;if(_0x4f3196)_0x4f3196();})['catch'](_0x1abeea=>{const _0x1dccf7=_0x219dc9;console[_0x1dccf7(0x1ed)](_0x1abeea);});}dbu[_0x3827de(0x233)][_0x3827de(0x1e9)](_0x3827de(0x1f4))[_0x3827de(0x256)](),_0x4540a4(),setInterval(()=>{_0x277ffc();},0x258*0x3e8),setTimeout(()=>{const _0x3fffeb=_0x3827de;_0x328546[_0x3fffeb(0x1f0)](dbu[_0x3fffeb(0x233)]),_0xad5382(),_0x3b7c6f(),_0x284430(),_0x2ce922(),_0x20340d(),_0xb70f7b(),_0x307591(),_0x56968e(),_0x52fbc7();},0x1388);let _0x138a69;function _0x2ce922(){const _0x6b3b3a=_0x3827de;if(bookIndexWorkerIsRunning)return;bookIndexWorkerIsRunning=!![],_0x138a69=_0xcbb20(_0x6b3b3a(0x210)),_0x138a69['on'](_0x6b3b3a(0x22f),function(_0x241352){const _0x1acb04=_0x6b3b3a;_0x241352[_0x1acb04(0x1f3)]=='close'&&(bookIndexWorkerIsRunning=![]);}),_0x138a69['on'](_0x6b3b3a(0x200),function(_0x195233,_0x4f3e02,_0x1c1996){const _0x2d34a3=_0x6b3b3a;console[_0x2d34a3(0x1ed)](_0x2d34a3(0x25b),_0x4f3e02||'',_0x1c1996||''),bookIndexWorkerIsRunning=![];});}let _0x2a8580;function _0x284430(){const _0x296845=_0x3827de;if(musicIndexWorkerIsRunning)return;musicIndexWorkerIsRunning=!![],_0x2a8580=_0xcbb20(_0x296845(0x25a)),_0x2a8580['on'](_0x296845(0x22f),function(_0x234a7b){const _0x4c3dd9=_0x296845;_0x234a7b[_0x4c3dd9(0x1f3)]=='close'&&(musicIndexWorkerIsRunning=![]);}),_0x2a8580['on'](_0x296845(0x200),function(_0x46fd17,_0x1fa2f3,_0x54935a){const _0x1a2fd8=_0x296845;console[_0x1a2fd8(0x1ed)]('音乐索引线程已退出[Music\x20indexing\x20worker\x20exited]',_0x1fa2f3||'',_0x54935a||''),musicIndexWorkerIsRunning=![];});}let _0x7b5d9;function _0x465fd4(){const _0x1bd353=_0x3827de;if(watchWorkerIsRunning)return;watchWorkerIsRunning=!![],_0x7b5d9=_0xcbb20(_0x1bd353(0x1c9)),_0x7b5d9['on'](_0x1bd353(0x22f),function(_0x18d3cb){const _0x3f7bf3=_0x1bd353;if(_0x18d3cb['type']=='close')watchWorkerIsRunning=![];else{if(_0x18d3cb['type']=='NEW_PHOTO_INDEX')_0x20340d(),_0x56968e();else _0x18d3cb[_0x3f7bf3(0x1f3)]==_0x3f7bf3(0x209)&&(_0x20340d(),_0x52fbc7(),_0x16b782());}}),_0x7b5d9['on']('exit',function(_0x282600,_0x171108,_0x3813c3){const _0x215cab=_0x1bd353;console[_0x215cab(0x1ed)]('------Watch\x20worker\x20is\x20stopped------',_0x171108,_0x3813c3),watchWorkerIsRunning=![];});}_0x465fd4();let _0x1ccd5a;function _0xad5382(){const _0xa2616=_0x3827de;if(photoIndexWorkerIsRunning)return;photoIndexWorkerIsRunning=!![],_0x1ccd5a=_0xcbb20(_0xa2616(0x24a)),_0x1ccd5a['on'](_0xa2616(0x22f),function(_0x51cc40){const _0x44be3c=_0xa2616;_0x51cc40[_0x44be3c(0x1f3)]==_0x44be3c(0x21d)&&(photoIndexWorkerIsRunning=![]),_0x51cc40['type']=='NEW_PHOTO_INDEX'&&(_0x20340d(),_0x56968e());}),_0x1ccd5a['on']('exit',function(_0x5ca7e7,_0x38aeb5,_0x4e8528){const _0xccc833=_0xa2616;console[_0xccc833(0x1ed)](_0xccc833(0x21e),_0x38aeb5||'',_0x4e8528||''),photoIndexWorkerIsRunning=![];});}let _0x2b85ff;function _0x3b7c6f(){const _0x2f2eb9=_0x3827de;if(movieIndexWorkerIsRunning)return;movieIndexWorkerIsRunning=!![],_0x2b85ff=_0xcbb20('myWorkers/index/movieIndexWorker.js'),_0x2b85ff['on'](_0x2f2eb9(0x22f),function(_0x522e15){const _0x23bfb0=_0x2f2eb9;if(_0x522e15[_0x23bfb0(0x1f3)]==_0x23bfb0(0x21d))movieIndexWorkerIsRunning=![];else _0x522e15[_0x23bfb0(0x1f3)]==_0x23bfb0(0x209)&&(_0x20340d(),_0x52fbc7(),_0x16b782());}),_0x2b85ff['on'](_0x2f2eb9(0x200),function(_0x311c29,_0x510745,_0x3fed76){const _0x457ba7=_0x2f2eb9;console[_0x457ba7(0x1ed)]('电影索引线程已退出[Movies\x20indexing\x20worker\x20exited]',_0x510745||'',_0x3fed76||''),movieIndexWorkerIsRunning=![];});}function _0x52fbc7(){const _0x160a9d=_0x3827de;if(getMovieInfoWorkerIsRunning)return;getMovieInfoWorkerIsRunning=!![];let _0x590370=_0xcbb20(_0x160a9d(0x1f9));_0x590370['on'](_0x160a9d(0x22f),function(_0x2c401c){const _0x59e90e=_0x160a9d;_0x2c401c[_0x59e90e(0x1f3)]==_0x59e90e(0x21d)&&(getMovieInfoWorkerIsRunning=![]);}),_0x590370['on'](_0x160a9d(0x200),function(){getMovieInfoWorkerIsRunning=![];});}function _0x20340d(){const _0x38d257=_0x3827de;if(tinyImgWorkerIsRunning)return;tinyImgWorkerIsRunning=!![];let _0x1f4912=_0xcbb20(_0x38d257(0x1c0));_0x1f4912['on'](_0x38d257(0x22f),function(_0x4b7661){const _0x3249da=_0x38d257;if(_0x4b7661[_0x3249da(0x1f3)]==_0x3249da(0x21d))tinyImgWorkerIsRunning=![];else _0x4b7661[_0x3249da(0x1f3)]==_0x3249da(0x20f)&&(_0xb70f7b(),_0x307591());}),_0x1f4912['on'](_0x38d257(0x200),function(){tinyImgWorkerIsRunning=![];});}let _0x212615,_0xfbea28;function _0x3c10d6(){const _0x4528f0=_0x3827de;let _0x1ea581=dbFileShare[_0x4528f0(0x1e2)](dbu[_0x4528f0(0x233)],_0x4528f0(0x230),[]);if(_0x1ea581&&_0x1ea581['length']>0x0)!_0x212615&&(_0x212615=_0xcbb20(_0x4528f0(0x251)),_0x212615['on'](_0x4528f0(0x200),function(){const _0x5a6dcd=_0x4528f0;console['log'](_0x5a6dcd(0x1e3)),_0x212615=null;}));else{_0x5ed8e3[_0x4528f0(0x1cf)](dbu[_0x4528f0(0x233)],{'title':'FTPServer','value':JSON['stringify']({'state':_0x4528f0(0x226)})});if(_0x212615){let _0x534ce2=_0x212615[_0x4528f0(0x258)]();_0x534ce2&&(_0x212615=null,console[_0x4528f0(0x1ed)](_0x4528f0(0x20a)));}}}function _0x6b5bcf(){const _0x129c85=_0x3827de;let _0x5d51b1=dbFileShare[_0x129c85(0x1e2)](dbu[_0x129c85(0x233)],_0x129c85(0x1d5),[]);if(_0x5d51b1&&_0x5d51b1['length']>0x0)!_0xfbea28&&(_0xfbea28=_0xcbb20(_0x129c85(0x20e)),_0xfbea28['on']('exit',function(){const _0x2d1801=_0x129c85;console[_0x2d1801(0x1ed)](_0x2d1801(0x1c3)),_0xfbea28=null;}));else{_0x5ed8e3[_0x129c85(0x1cf)](dbu[_0x129c85(0x233)],{'title':_0x129c85(0x1e6),'value':JSON[_0x129c85(0x266)]({'state':'stop'})});if(_0xfbea28){let _0x11fae3=_0xfbea28[_0x129c85(0x258)]();_0x11fae3&&(_0xfbea28=null);}}}let _0x270bb0;function _0x4b3176(){const _0x2864c7=_0x3827de;let _0x2e59b1=![],_0x59acd6=_0x5ed8e3['findByTitle'](dbu[_0x2864c7(0x233)],_0x2864c7(0x23b));_0x59acd6&&_0x59acd6[_0x2864c7(0x218)]==0x1&&(_0x2e59b1=!![]);if(_0x2e59b1)!_0x270bb0&&(_0x270bb0=_0xcbb20(_0x2864c7(0x1bb)),_0x270bb0['on'](_0x2864c7(0x22f),function(_0xe10431){const _0x254ca5=_0x2864c7;_0xe10431['type']==_0x254ca5(0x21d)&&(_0x270bb0=null);}),_0x270bb0['on']('exit',function(){const _0x4da1cb=_0x2864c7;console['log'](_0x4da1cb(0x213)),_0x270bb0=null;}));else{if(_0x270bb0){let _0x45e442=_0x270bb0[_0x2864c7(0x258)]();_0x45e442&&(_0x270bb0=null,console[_0x2864c7(0x1ed)](_0x2864c7(0x222)));}_0x5ed8e3[_0x2864c7(0x229)](dbu['dbOther'],_0x2864c7(0x269)),_0x5ed8e3['deleteByTitle'](dbu[_0x2864c7(0x233)],_0x2864c7(0x20d)),_0x5ed8e3['create'](dbu[_0x2864c7(0x233)],{'title':_0x2864c7(0x1ba),'value':JSON[_0x2864c7(0x266)]({'status':'fail','ddnsIp':'','error':_0x2864c7(0x237)})});}}_0x4b3176();let _0x236861;function _0xb6924f(){const _0xb00651=_0x3827de;if(globalInfoWorkerIsRunning)return;globalInfoWorkerIsRunning=!![],_0x236861=_0xcbb20(_0xb00651(0x1f6)),_0x236861['on'](_0xb00651(0x22f),function(_0x3c67e6){const _0x64c1f0=_0xb00651;if(_0x3c67e6[_0x64c1f0(0x1f3)]==_0x64c1f0(0x21d))globalInfoWorkerIsRunning=![];else _0x3c67e6['type']=='startScanPath'&&_0x5cb6f8(_0x3c67e6);}),_0x236861['on'](_0xb00651(0x200),function(){globalInfoWorkerIsRunning=![];});}_0xb6924f();function _0x307591(){const _0xc15882=_0x3827de;let _0x3233f4=_0x5ed8e3[_0xc15882(0x253)](dbu[_0xc15882(0x233)],_0xc15882(0x228));if(_0x3233f4&&_0x3233f4['value']=='1'){if(aiFacesWorkerIsRunning)return;aiFacesWorkerIsRunning=!![];let _0x1f08bb=_0xcbb20('myWorkers/ai/aiFaceUtil.js');_0x1f08bb['on'](_0xc15882(0x22f),function(_0x143acf){const _0x3326e6=_0xc15882;_0x143acf['type']==_0x3326e6(0x21d)&&(aiFacesWorkerIsRunning=![]);}),_0x1f08bb['on'](_0xc15882(0x200),function(_0x1c7b3d,_0x4bce3a,_0x30a8b5){aiFacesWorkerIsRunning=![],_0x1f08bb=null;});}else{}}function _0x56968e(){const _0x104078=_0x3827de;let _0x481580=_0x5ed8e3[_0x104078(0x253)](dbu['dbOther'],_0x104078(0x224));if(_0x481580&&_0x481580[_0x104078(0x218)]=='1'){if(aiSimilarPhotoWorker)return;aiSimilarPhotoWorker=!![];let _0x5be998=_0xcbb20('myWorkers/ai/aiSimilarPhotos.js');_0x5be998['on'](_0x104078(0x22f),function(_0x15bf6f){const _0x338d3a=_0x104078;_0x15bf6f['type']==_0x338d3a(0x21d)&&(aiSimilarPhotoWorker=![]);}),_0x5be998['on']('exit',()=>{_0x5be998=![];});}else{}}function _0xb70f7b(){const _0x3a2383=_0x3827de;let _0x32403b=_0x5ed8e3[_0x3a2383(0x253)](dbu[_0x3a2383(0x233)],_0x3a2383(0x1cd));if(_0x32403b&&_0x32403b[_0x3a2383(0x218)]=='1'){if(aiClassesWorkerIsRunning)return;aiClassesWorkerIsRunning=!![];let _0x44f9e2=_0xcbb20(_0x3a2383(0x1c6));_0x44f9e2['on']('message',function(_0x383642){const _0x191131=_0x3a2383;_0x383642[_0x191131(0x1f3)]==_0x191131(0x21d)&&(aiClassesWorkerIsRunning=![]);}),_0x44f9e2['on']('exit',()=>{aiClassesWorkerIsRunning=![];});}else{}}let _0x33ca63;function _0x174c88(){const _0x42cddb=_0x3827de;let _0x562999=dbu['dbOther'][_0x42cddb(0x1e9)](_0x42cddb(0x206))['get']();if(_0x562999[_0x42cddb(0x1ee)]>0x0){if(backupWorkerIsRunning)return;backupWorkerIsRunning=!![],_0x33ca63=_0xcbb20(_0x42cddb(0x1d6)),_0x33ca63['on'](_0x42cddb(0x22f),function(_0x1ba658){const _0xbfc5c5=_0x42cddb;_0x1ba658[_0xbfc5c5(0x1f3)]==_0xbfc5c5(0x21d)&&(backupWorkerIsRunning=![]);}),_0x33ca63['on'](_0x42cddb(0x200),()=>{backupWorkerIsRunning=![];});}else{if(_0x33ca63){let _0x4677af=_0x33ca63[_0x42cddb(0x258)]();_0x4677af&&(_0x33ca63=null);}}}_0x174c88();let _0x34350e;function _0x916c5a(){const _0x1c3a57=_0x3827de;if(m3u8WorkerIsRunning)return;m3u8WorkerIsRunning=!![],_0x34350e=_0xcbb20('myWorkers/m3u8Worker.js'),_0x34350e['on'](_0x1c3a57(0x22f),function(_0x439c87){const _0x64448b=_0x1c3a57;_0x439c87[_0x64448b(0x1f3)]=='close'&&(m3u8WorkerIsRunning=![]);}),_0x34350e['on'](_0x1c3a57(0x200),function(_0x167d43){m3u8WorkerIsRunning=![];});}let _0x341f56,_0x1f202b=![];function _0x277ffc(){const _0xf0e8b5=_0x3827de;_0x1f202b&&(!_0x341f56&&(_0x341f56=_0xcbb20('myWorkers/proxy/proxyWorker.js'),_0x341f56['on']('exit',_0x25b5f1=>{const _0x5c54cf=_0x18ca;console[_0x5c54cf(0x1ed)](_0x5c54cf(0x1b8),_0x25b5f1),_0x341f56=null;}),console[_0xf0e8b5(0x1ed)](_0xf0e8b5(0x212))));}function _0x17e545(){const _0xfcf5c3=_0x3827de;let _0xc7ae80=_0x5ed8e3[_0xfcf5c3(0x253)](dbu[_0xfcf5c3(0x233)],_0xfcf5c3(0x22d));!_0xc7ae80||_0xc7ae80&&_0xc7ae80['value']!=0x1&&_0xc7ae80[_0xfcf5c3(0x218)]!='1'?(_0x1f202b=![],_0x341f56&&(_0x341f56[_0xfcf5c3(0x258)](),_0x341f56=null,console['log'](_0xfcf5c3(0x21a))),_0x5ed8e3[_0xfcf5c3(0x1cf)](dbu[_0xfcf5c3(0x233)],{'title':_0xfcf5c3(0x22c),'value':JSON['stringify']({'status':_0xfcf5c3(0x1fb),'time':new Date()[_0xfcf5c3(0x1c2)]()+'','error':_0xfcf5c3(0x235)})})):(_0x1f202b=!![],_0x277ffc());}_0x17e545();let _0x5c4cd7;function _0x16b782(){const _0x1fabd8=_0x3827de;if(subtitleGenWorkerIsRunning)return;subtitleGenWorkerIsRunning=!![],_0x5c4cd7=_0xcbb20('myWorkers/subtitlesGenWorker.js'),_0x5c4cd7['on']('message',function(_0x2761d0){const _0x3c91e9=_0x18ca;_0x2761d0['type']==_0x3c91e9(0x21d)&&(subtitleGenWorkerIsRunning=![]);}),_0x5c4cd7['on'](_0x1fabd8(0x200),function(_0x3e6302){subtitleGenWorkerIsRunning=![];});}setTimeout(()=>{_0x16b782();},0x1388);let _0x14a213=![],_0x18e2f3=![],_0x1beb69=![];function _0x4dd864(_0x330eaa){const _0x42fc49=_0x3827de;try{!_0x1beb69&&(_0x1beb69=!![],setTimeout(()=>{const _0xc15537=_0x18ca;let _0x5ae1c2=require(_0xc15537(0x219)),_0x5d3624=_0x5ae1c2[_0xc15537(0x1ca)](dbu[_0xc15537(0x233)]);_0x5d3624?console[_0xc15537(0x1ed)](_0xc15537(0x202),'https://'+_0x5d3624+':'+_0x330eaa):console['log'](_0xc15537(0x247),_0x330eaa);},0x3a98));}catch(_0x9c9a97){console[_0x42fc49(0x1ed)](_0x9c9a97);}}function _0xdb1943(_0x458e68){const _0x4a5b54=_0x3827de;_0x6b5bcf(),setTimeout(()=>{_0x3c10d6();},0x1388);!_0x18e2f3&&(_0x18e2f3=!![],setTimeout(()=>{const _0x5d775b=_0x18ca;let _0x2e06a8=require(_0x5d775b(0x219)),_0x5d1e58=_0x2e06a8[_0x5d775b(0x1ca)](dbu[_0x5d775b(0x233)]);_0x5d1e58?console[_0x5d775b(0x1ed)](_0x5d775b(0x1e5),_0x5d775b(0x208)+_0x5d1e58+':'+_0x458e68):console[_0x5d775b(0x1ed)](_0x5d775b(0x24b),_0x458e68);},0x3a98));_0x5ed8e3['create'](dbu[_0x4a5b54(0x233)],{'title':_0x4a5b54(0x252),'value':JSON[_0x4a5b54(0x266)]({'state':_0x4a5b54(0x256),'port':_0x458e68})});if(!_0x14a213){_0x14a213=!![];if(app){app[_0x4a5b54(0x21b)]?loadUrl=_0x458e68=='80'?_0x4a5b54(0x1b9):'http://localhost:'+_0x458e68+_0x4a5b54(0x1f8):loadUrl=_0x4a5b54(0x257);let _0x2fd600=_0x5ed8e3[_0x4a5b54(0x253)](dbu[_0x4a5b54(0x233)],_0x4a5b54(0x25f));if(!_0x2fd600||_0x2fd600[_0x4a5b54(0x218)]=='1'){let _0x46c9a6=dbUserTable['getAdmin'](dbu['dbOther']);if(_0x46c9a6){let _0x2f0d9a=sha256(new Date()['getTime']()+_0x46c9a6[_0x4a5b54(0x1cb)]);dbUserTable[_0x4a5b54(0x1da)](dbu[_0x4a5b54(0x233)],_0x46c9a6['id'],_0x2f0d9a,_0x4a5b54(0x25e)),loadUrl+=_0x4a5b54(0x263)+_0x2f0d9a;}}_0x315575[_0x4a5b54(0x261)](loadUrl),_0x315575[_0x4a5b54(0x249)]['on'](_0x4a5b54(0x204),function(){const _0x11defc=_0x4a5b54;console['log'](_0x11defc(0x22b),loadUrl);}),ipcMain['on'](_0x4a5b54(0x1d7),(_0x86b421,_0x3abe76)=>{const _0x43f11c=_0x4a5b54;console[_0x43f11c(0x1ed)](_0x43f11c(0x1ef),loadUrl),loadUrl&&_0x315575[_0x43f11c(0x261)](loadUrl);});}workerSendMsg(_0x341f56,{'type':_0x4a5b54(0x26e)});}}let _0x54ae87=_0x328546[_0x3827de(0x1e0)]();console[_0x3827de(0x1ed)]('NasCab\x20Api\x20进程数量\x20[NasCab\x20api\x20thread\x20count]:',_0x54ae87),_0xa66094[_0x3827de(0x25c)]({'exec':_0x59ab2c[_0x3827de(0x216)](__dirname,_0x3827de(0x1f2))}),_0xa66094['on'](_0x3827de(0x200),function(_0x2c59d2,_0x542e1a,_0x1ddd74){const _0x36b0e6=_0x3827de;console['log'](_0x36b0e6(0x21c),_0x542e1a,_0x1ddd74),setTimeout(()=>{_0x2ea56d();},0x1388);});for(let _0x2900e8=0x0;_0x2900e8<_0x54ae87;_0x2900e8++){_0x2ea56d();}function _0x5cb6f8(_0x5df662){const _0x38f7af=_0x3827de;if(_0x5df662['source_type']==_0x38f7af(0x1d9))_0x3b7c6f();else{if(_0x5df662['source_type']==_0x38f7af(0x1fa))_0xad5382();else{if(_0x5df662[_0x38f7af(0x1fd)]==_0x38f7af(0x244))_0x284430();else _0x5df662[_0x38f7af(0x1fd)]=='book'&&_0x2ce922();}}_0x5df662['restartWatcher']&&(_0x465fd4(),workerSendMsg(_0x7b5d9,_0x5df662));}function _0x2ea56d(){const _0x23d542=_0x3827de,_0x2437c7=_0xa66094[_0x23d542(0x1bd)]({'usePort':_0x521e6c,'userDataFolder':_0x41461e,'appRootPath':_0x253829});_0x2437c7['on']('message',function(_0x3e3c9d){const _0x29610d=_0x23d542;try{switch(_0x3e3c9d[_0x29610d(0x1f3)]){case _0x29610d(0x24f):let _0x393a43=_0xcbb20(_0x29610d(0x1f7));workerSendMsg(_0x393a43,_0x3e3c9d);break;case _0x29610d(0x1d3):if(!bgTaskWorkerIsRunning){bgTaskWorkerIsRunning=!![];let _0x1c34c6=_0xcbb20('myWorkers/bg/bgTaskWorker.js');_0x1c34c6['on'](_0x29610d(0x22f),function(_0x141f63){const _0x194fc5=_0x29610d;_0x141f63['type']==_0x194fc5(0x21d)&&(bgTaskWorkerIsRunning=![]);});}break;case'SWITCH_MOVIE_INFO':_0x52fbc7();break;case'START_PRE_GEN_SUBTITLE':_0x16b782();break;case _0x29610d(0x23a):_0x916c5a(),workerSendMsg(_0x34350e,_0x3e3c9d);break;case _0x29610d(0x23f):_0x17e545(),workerSendMsg(_0x341f56,{'type':_0x29610d(0x227),'msg':_0x3e3c9d});break;case'nasCabLogout':_0x17e545(),workerSendMsg(_0x341f56,{'type':_0x29610d(0x226)}),setTimeout(()=>{_0x4540a4(()=>{_0x52fbc7();});},0x3e8);break;case _0x29610d(0x241):_0xb6924f(),workerSendMsg(_0x236861,_0x3e3c9d);break;case _0x29610d(0x21f):console[_0x29610d(0x1ed)]('Start\x20checking\x20for\x20updates'),_0x328546['startUpdate']();break;case'initBackupWorker':_0x174c88();break;case _0x29610d(0x1b7):if(_0x3e3c9d[_0x29610d(0x1fd)]==_0x29610d(0x1fa))_0x1ccd5a&&(_0x1ccd5a[_0x29610d(0x258)](),_0x1ccd5a=null,photoIndexWorkerIsRunning=![]);else{if(_0x3e3c9d['source_type']=='movie')_0x2b85ff&&(_0x2b85ff[_0x29610d(0x258)](),_0x2b85ff=null,movieIndexWorkerIsRunning=![]);else{if(_0x3e3c9d[_0x29610d(0x1fd)]==_0x29610d(0x244))_0x2a8580&&(_0x2a8580[_0x29610d(0x258)](),_0x2a8580=null,musicIndexWorkerIsRunning=![]);else _0x3e3c9d[_0x29610d(0x1fd)]=='book'&&(_0x138a69&&(_0x138a69[_0x29610d(0x258)](),_0x138a69=null,bookIndexWorkerIsRunning=![]));}}break;case _0x29610d(0x26b):_0x5cb6f8(_0x3e3c9d);break;case _0x29610d(0x1c1):if(_0x3e3c9d[_0x29610d(0x1c8)]=='WebDav')_0x6b5bcf(),workerSendMsg(_0xfbea28,_0x3e3c9d);else _0x3e3c9d['shareType']=='FTP'&&(_0x3c10d6(),workerSendMsg(_0x212615,_0x3e3c9d));break;case _0x29610d(0x1f5):_0x4b3176(),workerSendMsg(_0x270bb0,{'type':_0x29610d(0x26e),'force':0x1});break;case'nasCabLogout':_0x4b3176(),setTimeout(()=>{_0x4540a4(()=>{_0x52fbc7();});},0x3e8);break;case _0x29610d(0x22e):_0x17e545(),workerSendMsg(_0x341f56,{'type':_0x29610d(0x227)}),_0x4b3176(),setTimeout(()=>{_0x4540a4(()=>{_0x52fbc7();});},0x3e8);break;case _0x29610d(0x20c):_0x328546[_0x29610d(0x20c)]();break;case'startClassesAiWork':_0xb70f7b();break;case _0x29610d(0x23d):_0x307591();break;case _0x29610d(0x22a):_0x56968e();break;case _0x29610d(0x1d4):_0xdb1943(_0x3e3c9d[_0x29610d(0x201)]);break;case'expressStartedHttps':_0x4dd864(_0x3e3c9d['exressPort']);break;case _0x29610d(0x1c7):console['log'](_0x29610d(0x1cc));if(app)app[_0x29610d(0x24c)]();_0x328546[_0x29610d(0x1fc)](dbu);break;case _0x29610d(0x1d2):break;case _0x29610d(0x1c5):if(shell){if(_0x3e3c9d[_0x29610d(0x205)]==_0x29610d(0x1fe))_0x3e3c9d[_0x29610d(0x240)]&&shell[_0x29610d(0x1fe)](_0x3e3c9d[_0x29610d(0x240)]);else{if(_0x3e3c9d[_0x29610d(0x205)]==_0x29610d(0x243))_0x3e3c9d[_0x29610d(0x240)]&&shell[_0x29610d(0x243)](_0x3e3c9d[_0x29610d(0x240)])[_0x29610d(0x236)](_0x44b1d0=>{const _0x383a54=_0x29610d;console[_0x383a54(0x1ed)](_0x383a54(0x242));})[_0x29610d(0x20b)](_0x134553=>{console['log']('打开路径失败',_0x134553);});else _0x3e3c9d[_0x29610d(0x205)]==_0x29610d(0x220)&&(_0x3e3c9d[_0x29610d(0x240)]&&shell[_0x29610d(0x239)](_0x3e3c9d[_0x29610d(0x240)])['then'](_0x3d616b=>{const _0x387028=_0x29610d;console[_0x387028(0x1ed)](_0x387028(0x1be));})[_0x29610d(0x20b)](_0x307b84=>{const _0xe1b559=_0x29610d;console[_0xe1b559(0x1ed)](_0xe1b559(0x24e),_0x307b84);}));}}break;case _0x29610d(0x264):}}catch(_0x37bd8f){console['log'](_0x29610d(0x1dd),_0x37bd8f);}});}});});}if(app){const gotTheLock=app[_0x1db0e1(0x1d1)]();!gotTheLock?(app[_0x1db0e1(0x1c4)](),process[_0x1db0e1(0x258)](process[_0x1db0e1(0x217)],_0x1db0e1(0x259))):(app['on'](_0x1db0e1(0x25d),(_0x1ea77a,_0xf529b9,_0x32da69)=>{const _0x374f26=_0x1db0e1;if(mainWindow){if(mainWindow[_0x374f26(0x214)]())mainWindow[_0x374f26(0x1ce)]();!mainWindow[_0x374f26(0x246)]()&&mainWindow[_0x374f26(0x207)](),mainWindow[_0x374f26(0x260)]();}}),init());}else init();process['on'](_0x1db0e1(0x26a),(_0x94951,_0x1d7c20)=>{const _0x243802=_0x1db0e1;console[_0x243802(0x1ed)](_0x243802(0x265),_0x94951),dbu&&messageUtil[_0x243802(0x1e7)](dbu['dbOther'],_0x243802(0x203),_0x243802(0x268),_0x94951['stack']||_0x94951[_0x243802(0x22f)]);});