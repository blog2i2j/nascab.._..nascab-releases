'use strict';const _0x3ae2fd=_0x221c;(function(_0x40ed9b,_0x2c2a33){const _0x413c4f=_0x221c,_0x2e2235=_0x40ed9b();while(!![]){try{const _0x259c66=-parseInt(_0x413c4f(0x1b5))/0x1*(parseInt(_0x413c4f(0x204))/0x2)+parseInt(_0x413c4f(0x239))/0x3+-parseInt(_0x413c4f(0x219))/0x4*(parseInt(_0x413c4f(0x230))/0x5)+-parseInt(_0x413c4f(0x1cc))/0x6+-parseInt(_0x413c4f(0x21f))/0x7*(parseInt(_0x413c4f(0x1f2))/0x8)+parseInt(_0x413c4f(0x235))/0x9+parseInt(_0x413c4f(0x226))/0xa*(parseInt(_0x413c4f(0x1e3))/0xb);if(_0x259c66===_0x2c2a33)break;else _0x2e2235['push'](_0x2e2235['shift']());}catch(_0x23f97e){_0x2e2235['push'](_0x2e2235['shift']());}}}(_0xe704,0x24c45));let app,shell,ipcMain;try{app=require(_0x3ae2fd(0x1b6))['app'],shell=require('electron')['shell'],ipcMain=require('electron')[_0x3ae2fd(0x1ea)];}catch(_0x5410b4){console[_0x3ae2fd(0x240)](_0x3ae2fd(0x208));}let mainWindow,sha256=require(_0x3ae2fd(0x237));function _0x221c(_0x1edfce,_0x3cca8e){const _0xe70460=_0xe704();return _0x221c=function(_0x221c89,_0x6629a6){_0x221c89=_0x221c89-0x195;let _0x224e20=_0xe70460[_0x221c89];return _0x224e20;},_0x221c(_0x1edfce,_0x3cca8e);}const dbFileShare=require(_0x3ae2fd(0x1f6)),dbUserTable=require(_0x3ae2fd(0x22f));let nasAccountUtil=require(_0x3ae2fd(0x213));const {fork}=require(_0x3ae2fd(0x1e0));let bgTaskWorkerIsRunning=![],tinyImgWorkerIsRunning=![],getMovieInfoWorkerIsRunning=![],aiFacesWorkerIsRunning=![],aiClassesWorkerIsRunning=![],aiSimilarPhotoWorker=![],globalInfoWorkerIsRunning=![],photoIndexWorkerIsRunning=![],movieIndexWorkerIsRunning=![],musicIndexWorkerIsRunning=![],bookIndexWorkerIsRunning=![],watchWorkerIsRunning=![];const messageUtil=require(_0x3ae2fd(0x228));function _0xe704(){const _0x3a5f1d=['pid','loadURL','getTime','ready','myWorkers/proxy/proxyWorker.js','https://','expressEnded','HTTPS\x20服务正在运行[HTTPS\x20server\x20is\x20running]\x20:','START_WORKER_BG_TASK','stop','openPath','139749VazQQB','electron','getIpv4Address','FTPServer','myWorkers/shareFolder/shareWebDav.js','exit','NEW_PHOTO_INDEX','stack','myWorkers/ai/aiClassify.js','proxyWorker\x20exit','DDNS\x20worker\x20is\x20stopped','startClassesAiWork','isMinimized','music','http://localhost/#/','myWorkers/shareFolder/shareFtp.js','音乐索引线程已退出[Music\x20indexing\x20worker\x20exited]','exitApp','count','photo','Ftp\x20worker\x20is\x20stopped','OFF','nasDdnsState','1321542YhhJof','send','ddnsIpv6Address','expireTokenOnTime','shareType','start','Start\x20checking\x20for\x20updates','START_WORKER_FILE_OPERATION','shellType','myWorkers/bg/bgTaskWorker.js','myWorkers/index/bookIndexWorker.js','startScanPath','HTTPS\x20服务运行端口[HTTPS\x20server\x20running\x20on\x20port]:','run','SELECT\x20count(*)\x20as\x20count\x20FROM\x20backup_task','trash','autoLoginClient','myWorkers/ai/aiFaceUtil.js','did-fail-load','nasDdnsRestart','child_process','addProcessRecord','aiSimilarPhotoEnable','22SRMxbN','webDavServer','init','launchWithSys','kill','getExpressApiCount','get','ipcMain','restore','dbOther','NEW_MOVIE_INDEX','getAllByWhere','getFreePort','isPackaged','close','5744XXRMKp','Relaunch','isVip','apiServer','./db/dbFileShare','stringify','启用\x20frp','SWITCH_MOVIE_INFO','expressStartedHttps','createUserFolder','关闭\x20proxyWorker','main\x20err','http://','push','processList','进程出错了','book','./utils/initUtil','2HiQjEP','nasRemoteEnable','findByTitle','照片索引线程已退出[Photos\x20indexing\x20worker\x20exited]','Clientless\x20service\x20mode','showItemInFolder','myWorkers/m3u8Worker.js','放入回收站失败','myWorkers/movieInfoWorker.js','downloadTaskChange','createToken','resolve','/#/','saveMsg','WebDav','./express-server/utils/nasAccountUtils','requestSingleInstanceLock','nasCabLogout','exressPort','myWorkers/bg/backupWorker.js','Webdav\x20worker\x20is\x20stopped','72NAjTzi','FTP','reset','cluster','worker\x20send\x20msg\x20error','getConfigApiPort','1771OBnRMX','type','catch','myWorkers/expressWorker.js','username','\x20server_type=\x27FTP\x27','myWorkers/subtitlesGenWorker.js','2213560oFwQEA','restartWatcher','./utils/messageUtil','fail','UPDATE\x20bg_task\x20SET\x20task_state=3\x20where\x20task_state=1','isVisible','myWorkers/ddnsWorker.js','myWorkers/index/movieIndexWorker.js','myWorkers/bg/fileOperationWorker.js','./db/dbUserTable','16840rbmCLH','value','myWorkers/index/musicIndexWorker.js','killed','Closing\x20NasCab\x20ddns','92313gVluMf','create','sha256','initWindowEventAndLoadLoading','899736lZwVOc','ddnsIpv4Address','startUpdate','START_PRE_GEN_SUBTITLE','HTTP\x20服务运行端口[HTTP\x20server\x20running\x20on\x20port]:','webContents','then','log','source_type','prepare','SIGTERM','length','deleteByTitle','M3u8Transcode','./db/dbConfigTable','refresh','localhost','Closing\x20FTP','http://localhost:','movie','startFaceAiWork','initTray','send\x20message\x20callback\x20','path','error','message','show','nasProxyRestart','shell','setupPrimary','已经放入回收站','nasAccountLogin','已打开路径'];_0xe704=function(){return _0x3a5f1d;};return _0xe704();}let accountIsVip=![],backupWorkerIsRunning=![],m3u8WorkerIsRunning=![],subtitleGenWorkerIsRunning=![],loadUrl='';function workerSendMsg(_0x4ca868,_0x252deb){const _0x594afb=_0x3ae2fd;try{_0x4ca868&&!_0x4ca868[_0x594afb(0x233)]&&_0x4ca868[_0x594afb(0x1cd)](_0x252deb,undefined,undefined,_0x507bc8=>{const _0x55055b=_0x594afb;_0x507bc8&&console[_0x55055b(0x240)](_0x55055b(0x19f),_0x507bc8);});}catch(_0x8fd110){console[_0x594afb(0x240)](_0x594afb(0x21d),_0x8fd110);}}let dbu;function init(){const _0x1615c0=_0x3ae2fd;var _0x1995d0=require(_0x1615c0(0x21c));let _0x165d9b=require('path'),_0x2c7ab0=require(_0x1615c0(0x203)),_0x12b1bc=require(_0x1615c0(0x197)),_0x3fb990=_0x2c7ab0['createUserFolder']();dbu=_0x2c7ab0['initDbu']();function _0x165063(_0x4f489a,_0x3e18a6){const _0x1a7979=_0x1615c0;function _0x3355d5(){const _0x37dbc1=_0x221c;_0x4f489a[_0x37dbc1(0x1e5)]();if(app)_0x2c7ab0[_0x37dbc1(0x1e6)]();_0x2c7ab0['setLanguage']();if(app)mainWindow=_0x2c7ab0['createMainWindow']();_0x2c7ab0[_0x37dbc1(0x1e5)](_0x4f489a);if(app)_0x2c7ab0[_0x37dbc1(0x19e)](_0x4f489a,mainWindow);if(app)_0x2c7ab0[_0x37dbc1(0x238)](_0x4f489a,mainWindow);_0x2c7ab0[_0x37dbc1(0x1cf)](),_0x2c7ab0['runNewVersionTask'](_0x4f489a);if(app)_0x2c7ab0['openDev']();_0x2c7ab0['checkWebClientAutoUpdate'](),_0x3e18a6(mainWindow);}app?app['on'](_0x1a7979(0x1ad),()=>{_0x3355d5();}):_0x3355d5();}_0x165063(dbu,_0x2f5afd=>{const _0x33a426=_0x1615c0,_0x4632a9=_0x2c7ab0['getRootPath']();let _0x5e692b=_0x2c7ab0[_0x33a426(0x21e)]();_0x2c7ab0[_0x33a426(0x1ef)](_0x5e692b,_0x3e2113=>{const _0x3ce901=_0x33a426;function _0x20766c(_0xd54e17){const _0xb4a734=_0x221c,_0x578100=fork(_0x165d9b['resolve'](__dirname,_0xd54e17),[],{'env':{'userDataFolder':_0x3fb990,'appRootPath':_0x4632a9},'detached':![],'killSignal':_0xb4a734(0x243)});return _0x2c7ab0[_0xb4a734(0x200)][_0xb4a734(0x1ff)](_0x578100),_0x2c7ab0[_0xb4a734(0x1e1)](dbu['dbOther'],_0x578100[_0xb4a734(0x1aa)]),_0x578100['on']('exit',function(_0x282517,_0x3c201a){}),_0x578100['on'](_0xb4a734(0x1a1),function(_0x1f4cb2){const _0x23dda1=_0xb4a734;console[_0x23dda1(0x240)](_0x23dda1(0x201),_0x1f4cb2);}),_0x578100;}function _0x23b8b4(_0x3cd3e7){const _0x351894=_0x221c;nasAccountUtil[_0x351894(0x1f4)](null,dbu[_0x351894(0x1ec)])[_0x351894(0x23f)](_0x24fde8=>{accountIsVip=_0x24fde8;if(_0x3cd3e7)_0x3cd3e7();})[_0x351894(0x221)](_0x5ae4b3=>{console['log'](_0x5ae4b3);});}dbu[_0x3ce901(0x1ec)][_0x3ce901(0x242)](_0x3ce901(0x22a))[_0x3ce901(0x1d9)](),_0x23b8b4(),setInterval(()=>{_0x301447();},0x258*0x3e8),setTimeout(()=>{const _0x406410=_0x3ce901;_0x2c7ab0['addScanTaskWhenStart'](dbu[_0x406410(0x1ec)]),_0x52bb23(),_0x59f929(),_0x3ce031(),_0x432a98(),_0x3876ad(),_0x3d0956(),_0x8b01bd(),_0x5a507f(),_0x354350();},0x1388);let _0x124050;function _0x432a98(){const _0x49b41b=_0x3ce901;if(bookIndexWorkerIsRunning)return;bookIndexWorkerIsRunning=!![],_0x124050=_0x20766c(_0x49b41b(0x1d6)),_0x124050['on'](_0x49b41b(0x1a2),function(_0x49cef8){const _0x53d58a=_0x49b41b;_0x49cef8[_0x53d58a(0x220)]==_0x53d58a(0x1f1)&&(bookIndexWorkerIsRunning=![]);}),_0x124050['on'](_0x49b41b(0x1ba),function(_0x4ef744,_0x102657,_0x37d384){const _0x53f5b9=_0x49b41b;console[_0x53f5b9(0x240)]('图书索引线程已退出[Books\x20indexing\x20worker\x20exited]',_0x102657||'',_0x37d384||''),bookIndexWorkerIsRunning=![];});}let _0x3f4400;function _0x3ce031(){const _0x281ac3=_0x3ce901;if(musicIndexWorkerIsRunning)return;musicIndexWorkerIsRunning=!![],_0x3f4400=_0x20766c(_0x281ac3(0x232)),_0x3f4400['on'](_0x281ac3(0x1a2),function(_0x31af41){const _0x293ae5=_0x281ac3;_0x31af41['type']==_0x293ae5(0x1f1)&&(musicIndexWorkerIsRunning=![]);}),_0x3f4400['on']('exit',function(_0x306db7,_0x4e0479,_0x497e72){const _0x59a62d=_0x281ac3;console['log'](_0x59a62d(0x1c5),_0x4e0479||'',_0x497e72||''),musicIndexWorkerIsRunning=![];});}let _0x12969f;function _0x471e69(){const _0xdeb7bf=_0x3ce901;if(watchWorkerIsRunning)return;watchWorkerIsRunning=!![],_0x12969f=_0x20766c('myWorkers/index/fileWatcherWorker.js'),_0x12969f['on'](_0xdeb7bf(0x1a2),function(_0x4f72b2){const _0x4a6245=_0xdeb7bf;if(_0x4f72b2[_0x4a6245(0x220)]==_0x4a6245(0x1f1))watchWorkerIsRunning=![];else{if(_0x4f72b2[_0x4a6245(0x220)]==_0x4a6245(0x1bb))_0x3876ad(),_0x5a507f();else _0x4f72b2[_0x4a6245(0x220)]==_0x4a6245(0x1ed)&&(_0x3876ad(),_0x354350(),_0x255269());}}),_0x12969f['on']('exit',function(_0x574c05,_0xa180b3,_0x37cf85){const _0x4058d3=_0xdeb7bf;console[_0x4058d3(0x240)]('------Watch\x20worker\x20is\x20stopped------',_0xa180b3,_0x37cf85),watchWorkerIsRunning=![];});}_0x471e69();let _0xb01c2f;function _0x52bb23(){const _0x3caa0c=_0x3ce901;if(photoIndexWorkerIsRunning)return;photoIndexWorkerIsRunning=!![],_0xb01c2f=_0x20766c('myWorkers/index/photoIndexWorker.js'),_0xb01c2f['on'](_0x3caa0c(0x1a2),function(_0x3ee22b){const _0x2bdf7a=_0x3caa0c;_0x3ee22b['type']=='close'&&(photoIndexWorkerIsRunning=![]),_0x3ee22b[_0x2bdf7a(0x220)]==_0x2bdf7a(0x1bb)&&(_0x3876ad(),_0x5a507f());}),_0xb01c2f['on'](_0x3caa0c(0x1ba),function(_0x3bdba7,_0x57aea4,_0x2753d6){const _0x4cfc8b=_0x3caa0c;console[_0x4cfc8b(0x240)](_0x4cfc8b(0x207),_0x57aea4||'',_0x2753d6||''),photoIndexWorkerIsRunning=![];});}let _0x37d8cd;function _0x59f929(){const _0x5db00a=_0x3ce901;if(movieIndexWorkerIsRunning)return;movieIndexWorkerIsRunning=!![],_0x37d8cd=_0x20766c(_0x5db00a(0x22d)),_0x37d8cd['on'](_0x5db00a(0x1a2),function(_0x540688){const _0x2a08df=_0x5db00a;if(_0x540688[_0x2a08df(0x220)]==_0x2a08df(0x1f1))movieIndexWorkerIsRunning=![];else _0x540688[_0x2a08df(0x220)]==_0x2a08df(0x1ed)&&(_0x3876ad(),_0x354350(),_0x255269());}),_0x37d8cd['on'](_0x5db00a(0x1ba),function(_0x501ffc,_0x5c871e,_0x1c5ff6){console['log']('电影索引线程已退出[Movies\x20indexing\x20worker\x20exited]',_0x5c871e||'',_0x1c5ff6||''),movieIndexWorkerIsRunning=![];});}function _0x354350(){const _0x5b43fe=_0x3ce901;if(getMovieInfoWorkerIsRunning)return;getMovieInfoWorkerIsRunning=!![];let _0x58b1d2=_0x20766c(_0x5b43fe(0x20c));_0x58b1d2['on'](_0x5b43fe(0x1a2),function(_0x13fb89){const _0x150c94=_0x5b43fe;_0x13fb89[_0x150c94(0x220)]==_0x150c94(0x1f1)&&(getMovieInfoWorkerIsRunning=![]);}),_0x58b1d2['on'](_0x5b43fe(0x1ba),function(){getMovieInfoWorkerIsRunning=![];});}function _0x3876ad(){const _0x575a0d=_0x3ce901;if(tinyImgWorkerIsRunning)return;tinyImgWorkerIsRunning=!![];let _0x367c18=_0x20766c('myWorkers/tinyImgWorker.js');_0x367c18['on'](_0x575a0d(0x1a2),function(_0x5be2bd){const _0x5d2579=_0x575a0d;if(_0x5be2bd['type']==_0x5d2579(0x1f1))tinyImgWorkerIsRunning=![];else _0x5be2bd[_0x5d2579(0x220)]=='NEW_TINY_IMAGE'&&(_0x3d0956(),_0x8b01bd());}),_0x367c18['on'](_0x575a0d(0x1ba),function(){tinyImgWorkerIsRunning=![];});}let _0x54ee7d,_0x57f93a;function _0x10168f(){const _0x3b2d0c=_0x3ce901;let _0x101b19=dbFileShare[_0x3b2d0c(0x1ee)](dbu[_0x3b2d0c(0x1ec)],_0x3b2d0c(0x224),[]);if(_0x101b19&&_0x101b19['length']>0x0)!_0x54ee7d&&(_0x54ee7d=_0x20766c(_0x3b2d0c(0x1c4)),_0x54ee7d['on'](_0x3b2d0c(0x1ba),function(){const _0x4646f5=_0x3b2d0c;console[_0x4646f5(0x240)](_0x4646f5(0x1c9)),_0x54ee7d=null;}));else{_0x12b1bc[_0x3b2d0c(0x236)](dbu[_0x3b2d0c(0x1ec)],{'title':_0x3b2d0c(0x1b8),'value':JSON['stringify']({'state':_0x3b2d0c(0x1b3)})});if(_0x54ee7d){let _0xee4aed=_0x54ee7d[_0x3b2d0c(0x1e7)]();_0xee4aed&&(_0x54ee7d=null,console['log'](_0x3b2d0c(0x19a)));}}}function _0x25a0fd(){const _0x56be3d=_0x3ce901;let _0x20e35b=dbFileShare[_0x56be3d(0x1ee)](dbu[_0x56be3d(0x1ec)],'\x20server_type=\x27WebDav\x27',[]);if(_0x20e35b&&_0x20e35b[_0x56be3d(0x244)]>0x0)!_0x57f93a&&(_0x57f93a=_0x20766c(_0x56be3d(0x1b9)),_0x57f93a['on']('exit',function(){const _0x4b8598=_0x56be3d;console[_0x4b8598(0x240)](_0x4b8598(0x218)),_0x57f93a=null;}));else{_0x12b1bc[_0x56be3d(0x236)](dbu[_0x56be3d(0x1ec)],{'title':_0x56be3d(0x1e4),'value':JSON[_0x56be3d(0x1f7)]({'state':_0x56be3d(0x1b3)})});if(_0x57f93a){let _0x40b5e4=_0x57f93a['kill']();_0x40b5e4&&(_0x57f93a=null);}}}let _0xc38a37;function _0x364b3b(){const _0x35d53c=_0x3ce901;let _0x4226ed=![],_0x3f5107=_0x12b1bc[_0x35d53c(0x206)](dbu[_0x35d53c(0x1ec)],'nasDdnsEnable');_0x3f5107&&_0x3f5107[_0x35d53c(0x231)]==0x1&&(_0x4226ed=!![]);if(_0x4226ed)!_0xc38a37&&(_0xc38a37=_0x20766c(_0x35d53c(0x22c)),_0xc38a37['on']('message',function(_0x5eb411){const _0x548d9c=_0x35d53c;_0x5eb411[_0x548d9c(0x220)]=='close'&&(_0xc38a37=null);}),_0xc38a37['on'](_0x35d53c(0x1ba),function(){const _0x484176=_0x35d53c;console[_0x484176(0x240)](_0x484176(0x1bf)),_0xc38a37=null;}));else{if(_0xc38a37){let _0x245c27=_0xc38a37['kill']();_0x245c27&&(_0xc38a37=null,console[_0x35d53c(0x240)](_0x35d53c(0x234)));}_0x12b1bc['deleteByTitle'](dbu[_0x35d53c(0x1ec)],_0x35d53c(0x1ce)),_0x12b1bc[_0x35d53c(0x195)](dbu['dbOther'],_0x35d53c(0x23a)),_0x12b1bc['create'](dbu[_0x35d53c(0x1ec)],{'title':_0x35d53c(0x1cb),'value':JSON[_0x35d53c(0x1f7)]({'status':'fail','ddnsIp':'','error':_0x35d53c(0x1ca)})});}}_0x364b3b();let _0x16e663;function _0x1b9c82(){const _0x5bfe49=_0x3ce901;if(globalInfoWorkerIsRunning)return;globalInfoWorkerIsRunning=!![],_0x16e663=_0x20766c('myWorkers/globalInfoWorker.js'),_0x16e663['on'](_0x5bfe49(0x1a2),function(_0x982740){const _0x2cf331=_0x5bfe49;if(_0x982740['type']==_0x2cf331(0x1f1))globalInfoWorkerIsRunning=![];else _0x982740[_0x2cf331(0x220)]==_0x2cf331(0x1d7)&&_0x46b198(_0x982740);}),_0x16e663['on'](_0x5bfe49(0x1ba),function(){globalInfoWorkerIsRunning=![];});}_0x1b9c82();function _0x8b01bd(){const _0x1adab9=_0x3ce901;let _0x2b2cc6=_0x12b1bc['findByTitle'](dbu[_0x1adab9(0x1ec)],'aiFaceEnable');if(_0x2b2cc6&&_0x2b2cc6[_0x1adab9(0x231)]=='1'){if(aiFacesWorkerIsRunning)return;aiFacesWorkerIsRunning=!![];let _0x359eae=_0x20766c(_0x1adab9(0x1dd));_0x359eae['on'](_0x1adab9(0x1a2),function(_0x36ae0b){const _0x139049=_0x1adab9;_0x36ae0b[_0x139049(0x220)]==_0x139049(0x1f1)&&(aiFacesWorkerIsRunning=![]);}),_0x359eae['on']('exit',function(_0x2bf6c8,_0x1d2495,_0x475ea2){aiFacesWorkerIsRunning=![],_0x359eae=null;});}else{}}function _0x5a507f(){const _0x37dd14=_0x3ce901;let _0x126a30=_0x12b1bc[_0x37dd14(0x206)](dbu[_0x37dd14(0x1ec)],_0x37dd14(0x1e2));if(_0x126a30&&_0x126a30[_0x37dd14(0x231)]=='1'){if(aiSimilarPhotoWorker)return;aiSimilarPhotoWorker=!![];let _0xecd559=_0x20766c('myWorkers/ai/aiSimilarPhotos.js');_0xecd559['on'](_0x37dd14(0x1a2),function(_0x2b4714){const _0x3ddb1d=_0x37dd14;_0x2b4714[_0x3ddb1d(0x220)]==_0x3ddb1d(0x1f1)&&(aiSimilarPhotoWorker=![]);}),_0xecd559['on'](_0x37dd14(0x1ba),()=>{_0xecd559=![];});}else{}}function _0x3d0956(){const _0x584cf3=_0x3ce901;let _0x19367d=_0x12b1bc[_0x584cf3(0x206)](dbu['dbOther'],'aiClassesEnable');if(_0x19367d&&_0x19367d[_0x584cf3(0x231)]=='1'){if(aiClassesWorkerIsRunning)return;aiClassesWorkerIsRunning=!![];let _0x2f7598=_0x20766c(_0x584cf3(0x1bd));_0x2f7598['on']('message',function(_0x76706d){const _0x26ff90=_0x584cf3;_0x76706d['type']==_0x26ff90(0x1f1)&&(aiClassesWorkerIsRunning=![]);}),_0x2f7598['on'](_0x584cf3(0x1ba),()=>{aiClassesWorkerIsRunning=![];});}else{}}let _0x53d861;function _0x30e197(){const _0x156d87=_0x3ce901;let _0x2cd461=dbu[_0x156d87(0x1ec)]['prepare'](_0x156d87(0x1da))[_0x156d87(0x1e9)]();if(_0x2cd461[_0x156d87(0x1c7)]>0x0){if(backupWorkerIsRunning)return;backupWorkerIsRunning=!![],_0x53d861=_0x20766c(_0x156d87(0x217)),_0x53d861['on']('message',function(_0x1db481){const _0x75c3f3=_0x156d87;_0x1db481['type']==_0x75c3f3(0x1f1)&&(backupWorkerIsRunning=![]);}),_0x53d861['on']('exit',()=>{backupWorkerIsRunning=![];});}else{if(_0x53d861){let _0x3c2a99=_0x53d861['kill']();_0x3c2a99&&(_0x53d861=null);}}}_0x30e197();let _0x54862b;function _0x2a4648(){const _0x3a3fd6=_0x3ce901;if(m3u8WorkerIsRunning)return;m3u8WorkerIsRunning=!![],_0x54862b=_0x20766c(_0x3a3fd6(0x20a)),_0x54862b['on']('message',function(_0x1c95a4){const _0xbb26d8=_0x3a3fd6;_0x1c95a4[_0xbb26d8(0x220)]=='close'&&(m3u8WorkerIsRunning=![]);}),_0x54862b['on'](_0x3a3fd6(0x1ba),function(_0x1949ec){m3u8WorkerIsRunning=![];});}let _0x1566a7,_0x575449=![];function _0x301447(){const _0x110269=_0x3ce901;_0x575449&&(!_0x1566a7&&(_0x1566a7=_0x20766c(_0x110269(0x1ae)),_0x1566a7['on'](_0x110269(0x1ba),_0x48c530=>{const _0x304732=_0x110269;console[_0x304732(0x240)](_0x304732(0x1be),_0x48c530),_0x1566a7=null;}),console[_0x110269(0x240)](_0x110269(0x1f8))));}function _0x1564f2(){const _0x4e566e=_0x3ce901;let _0x9f6a02=_0x12b1bc[_0x4e566e(0x206)](dbu[_0x4e566e(0x1ec)],_0x4e566e(0x205));!_0x9f6a02||_0x9f6a02&&_0x9f6a02[_0x4e566e(0x231)]!=0x1&&_0x9f6a02[_0x4e566e(0x231)]!='1'?(_0x575449=![],_0x1566a7&&(_0x1566a7[_0x4e566e(0x1e7)](),_0x1566a7=null,console['log'](_0x4e566e(0x1fc))),_0x12b1bc['create'](dbu[_0x4e566e(0x1ec)],{'title':'nasRemoteState','value':JSON[_0x4e566e(0x1f7)]({'status':_0x4e566e(0x229),'time':new Date()['getTime']()+'','error':'FRP\x20OFF'})})):(_0x575449=!![],_0x301447());}_0x1564f2();let _0x10f297;function _0x255269(){const _0x2aabba=_0x3ce901;if(subtitleGenWorkerIsRunning)return;subtitleGenWorkerIsRunning=!![],_0x10f297=_0x20766c(_0x2aabba(0x225)),_0x10f297['on'](_0x2aabba(0x1a2),function(_0x59f149){const _0xf95c34=_0x2aabba;_0x59f149[_0xf95c34(0x220)]==_0xf95c34(0x1f1)&&(subtitleGenWorkerIsRunning=![]);}),_0x10f297['on'](_0x2aabba(0x1ba),function(_0x4d844e){subtitleGenWorkerIsRunning=![];});}setTimeout(()=>{_0x255269();},0x1388);let _0x2c64df=![],_0x358f8d=![],_0x2d72f1=![];function _0x20f1d8(_0x2dc961){const _0x34a7df=_0x3ce901;try{!_0x2d72f1&&(_0x2d72f1=!![],setTimeout(()=>{const _0x315979=_0x221c;let _0xad46a9=require('./utils/globalInfoUtil'),_0x1ff930=_0xad46a9[_0x315979(0x1b7)](dbu[_0x315979(0x1ec)]);_0x1ff930?console[_0x315979(0x240)](_0x315979(0x1b1),_0x315979(0x1af)+_0x1ff930+':'+_0x2dc961):console['log'](_0x315979(0x1d8),_0x2dc961);},0x3a98));}catch(_0x3b394a){console[_0x34a7df(0x240)](_0x3b394a);}}function _0x49a48a(_0x295a76){const _0x18bd9a=_0x3ce901;_0x25a0fd(),setTimeout(()=>{_0x10168f();},0x1388);!_0x358f8d&&(_0x358f8d=!![],setTimeout(()=>{const _0x337b50=_0x221c;let _0x4bcbb7=require('./utils/globalInfoUtil'),_0x4336fc=_0x4bcbb7[_0x337b50(0x1b7)](dbu[_0x337b50(0x1ec)]);_0x4336fc?console[_0x337b50(0x240)]('HTTP\x20服务正在运行[HTTP\x20server\x20is\x20running]\x20:',_0x337b50(0x1fe)+_0x4336fc+':'+_0x295a76):console['log'](_0x337b50(0x23d),_0x295a76);},0x3a98));_0x12b1bc[_0x18bd9a(0x236)](dbu['dbOther'],{'title':_0x18bd9a(0x1f5),'value':JSON[_0x18bd9a(0x1f7)]({'state':_0x18bd9a(0x1d9),'port':_0x295a76})});if(!_0x2c64df){_0x2c64df=!![];if(app){app[_0x18bd9a(0x1f0)]?loadUrl=_0x295a76=='80'?_0x18bd9a(0x1c3):_0x18bd9a(0x19b)+_0x295a76+_0x18bd9a(0x210):loadUrl='http://localhost:8081/#/';let _0x12d91e=_0x12b1bc['findByTitle'](dbu[_0x18bd9a(0x1ec)],_0x18bd9a(0x1dc));if(!_0x12d91e||_0x12d91e['value']=='1'){let _0x16caac=dbUserTable['getAdmin'](dbu[_0x18bd9a(0x1ec)]);if(_0x16caac){let _0x4044b4=sha256(new Date()[_0x18bd9a(0x1ac)]()+_0x16caac[_0x18bd9a(0x223)]);dbUserTable[_0x18bd9a(0x20e)](dbu[_0x18bd9a(0x1ec)],_0x16caac['id'],_0x4044b4,_0x18bd9a(0x199)),loadUrl+='?token='+_0x4044b4;}}_0x2f5afd['loadURL'](loadUrl),_0x2f5afd[_0x18bd9a(0x23e)]['on'](_0x18bd9a(0x1de),function(){const _0x84e4dc=_0x18bd9a;console[_0x84e4dc(0x240)]('页面加载失败',loadUrl);}),ipcMain['on'](_0x18bd9a(0x198),(_0x463838,_0x5c8a2d)=>{const _0x494a6d=_0x18bd9a;console[_0x494a6d(0x240)]('刷新页面',loadUrl),loadUrl&&_0x2f5afd[_0x494a6d(0x1ab)](loadUrl);});}workerSendMsg(_0x1566a7,{'type':_0x18bd9a(0x1d1)});}}let _0x36d966=_0x2c7ab0[_0x3ce901(0x1e8)]();console[_0x3ce901(0x240)]('NasCab\x20Api\x20进程数量\x20[NasCab\x20api\x20thread\x20count]:',_0x36d966),_0x1995d0[_0x3ce901(0x1a6)]({'exec':_0x165d9b[_0x3ce901(0x20f)](__dirname,_0x3ce901(0x222))}),_0x1995d0['on'](_0x3ce901(0x1ba),function(_0x1962d4,_0xe2a371,_0xe22269){const _0x7eb615=_0x3ce901;console[_0x7eb615(0x240)]('NasCab\x20api\x20server\x20restarting\x20',_0xe2a371,_0xe22269),setTimeout(()=>{_0x3c238c();},0x1388);});for(let _0x5cf2b5=0x0;_0x5cf2b5<_0x36d966;_0x5cf2b5++){_0x3c238c();}function _0x46b198(_0x40840a){const _0x15fdc3=_0x3ce901;if(_0x40840a['source_type']==_0x15fdc3(0x19c))_0x59f929();else{if(_0x40840a[_0x15fdc3(0x241)]==_0x15fdc3(0x1c8))_0x52bb23();else{if(_0x40840a[_0x15fdc3(0x241)]=='music')_0x3ce031();else _0x40840a['source_type']=='book'&&_0x432a98();}}_0x40840a[_0x15fdc3(0x227)]&&(_0x471e69(),workerSendMsg(_0x12969f,_0x40840a));}function _0x3c238c(){const _0xab4e4e=_0x3ce901,_0x31f328=_0x1995d0['fork']({'usePort':_0x3e2113,'userDataFolder':_0x3fb990,'appRootPath':_0x4632a9});_0x31f328['on'](_0xab4e4e(0x1a2),function(_0xea1ec){const _0x41e557=_0xab4e4e;try{switch(_0xea1ec[_0x41e557(0x220)]){case _0x41e557(0x1d3):let _0x430bf4=_0x20766c(_0x41e557(0x22e));workerSendMsg(_0x430bf4,_0xea1ec);break;case _0x41e557(0x1b2):if(!bgTaskWorkerIsRunning){bgTaskWorkerIsRunning=!![];let _0xf7e303=_0x20766c(_0x41e557(0x1d5));_0xf7e303['on'](_0x41e557(0x1a2),function(_0x2389ba){const _0x4013b7=_0x41e557;_0x2389ba['type']==_0x4013b7(0x1f1)&&(bgTaskWorkerIsRunning=![]);});}break;case _0x41e557(0x1f9):_0x354350();break;case _0x41e557(0x23c):_0x255269();break;case _0x41e557(0x196):_0x2a4648(),workerSendMsg(_0x54862b,_0xea1ec);break;case _0x41e557(0x1a4):_0x1564f2(),workerSendMsg(_0x1566a7,{'type':_0x41e557(0x21b),'msg':_0xea1ec});break;case _0x41e557(0x215):_0x1564f2(),workerSendMsg(_0x1566a7,{'type':'stop'}),setTimeout(()=>{_0x23b8b4(()=>{_0x354350();});},0x3e8);break;case'getGlobalInfo':_0x1b9c82(),workerSendMsg(_0x16e663,_0xea1ec);break;case _0x41e557(0x23b):console[_0x41e557(0x240)](_0x41e557(0x1d2)),_0x2c7ab0['startUpdate']();break;case'initBackupWorker':_0x30e197();break;case'stopIndexWorker':if(_0xea1ec[_0x41e557(0x241)]==_0x41e557(0x1c8))_0xb01c2f&&(_0xb01c2f['kill'](),_0xb01c2f=null,photoIndexWorkerIsRunning=![]);else{if(_0xea1ec['source_type']==_0x41e557(0x19c))_0x37d8cd&&(_0x37d8cd['kill'](),_0x37d8cd=null,movieIndexWorkerIsRunning=![]);else{if(_0xea1ec[_0x41e557(0x241)]==_0x41e557(0x1c2))_0x3f4400&&(_0x3f4400[_0x41e557(0x1e7)](),_0x3f4400=null,musicIndexWorkerIsRunning=![]);else _0xea1ec[_0x41e557(0x241)]==_0x41e557(0x202)&&(_0x124050&&(_0x124050['kill'](),_0x124050=null,bookIndexWorkerIsRunning=![]));}}break;case'startScanPath':_0x46b198(_0xea1ec);break;case'fileShareRestart':if(_0xea1ec[_0x41e557(0x1d0)]==_0x41e557(0x212))_0x25a0fd(),workerSendMsg(_0x57f93a,_0xea1ec);else _0xea1ec[_0x41e557(0x1d0)]==_0x41e557(0x21a)&&(_0x10168f(),workerSendMsg(_0x54ee7d,_0xea1ec));break;case _0x41e557(0x1df):_0x364b3b(),workerSendMsg(_0xc38a37,{'type':'start','force':0x1});break;case _0x41e557(0x215):_0x364b3b(),setTimeout(()=>{_0x23b8b4(()=>{_0x354350();});},0x3e8);break;case _0x41e557(0x1a8):_0x1564f2(),workerSendMsg(_0x1566a7,{'type':_0x41e557(0x21b)}),_0x364b3b(),setTimeout(()=>{_0x23b8b4(()=>{_0x354350();});},0x3e8);break;case'createUserFolder':_0x2c7ab0[_0x41e557(0x1fb)]();break;case _0x41e557(0x1c0):_0x3d0956();break;case _0x41e557(0x19d):_0x8b01bd();break;case'startSimilarPhotoWork':_0x5a507f();break;case'expressStarted':_0x49a48a(_0xea1ec[_0x41e557(0x216)]);break;case _0x41e557(0x1fa):_0x20f1d8(_0xea1ec['exressPort']);break;case _0x41e557(0x1f3):console[_0x41e557(0x240)]('Relaunch\x20Restart');if(app)app['relaunch']();_0x2c7ab0[_0x41e557(0x1c6)](dbu);break;case _0x41e557(0x1b0):break;case _0x41e557(0x1a5):if(shell){if(_0xea1ec['shellType']=='showItemInFolder')_0xea1ec[_0x41e557(0x1a0)]&&shell[_0x41e557(0x209)](_0xea1ec[_0x41e557(0x1a0)]);else{if(_0xea1ec[_0x41e557(0x1d4)]==_0x41e557(0x1b4))_0xea1ec[_0x41e557(0x1a0)]&&shell[_0x41e557(0x1b4)](_0xea1ec[_0x41e557(0x1a0)])[_0x41e557(0x23f)](_0x3c4e7f=>{const _0x38e207=_0x41e557;console[_0x38e207(0x240)](_0x38e207(0x1a9));})[_0x41e557(0x221)](_0x25efe9=>{const _0x2e668e=_0x41e557;console[_0x2e668e(0x240)]('打开路径失败',_0x25efe9);});else _0xea1ec['shellType']==_0x41e557(0x1db)&&(_0xea1ec[_0x41e557(0x1a0)]&&shell['trashItem'](_0xea1ec[_0x41e557(0x1a0)])[_0x41e557(0x23f)](_0x1c18ee=>{const _0x5f378c=_0x41e557;console[_0x5f378c(0x240)](_0x5f378c(0x1a7));})[_0x41e557(0x221)](_0x119c54=>{const _0x4b431b=_0x41e557;console[_0x4b431b(0x240)](_0x4b431b(0x20b),_0x119c54);}));}}break;case _0x41e557(0x20d):}}catch(_0x40501a){console[_0x41e557(0x240)](_0x41e557(0x1fd),_0x40501a);}});}});});}if(app){const gotTheLock=app[_0x3ae2fd(0x214)]();!gotTheLock?(app['quit'](),process[_0x3ae2fd(0x1e7)](process[_0x3ae2fd(0x1aa)],_0x3ae2fd(0x243))):(app['on']('second-instance',(_0x1a3881,_0x5bc673,_0x270393)=>{const _0x3edd92=_0x3ae2fd;if(mainWindow){if(mainWindow[_0x3edd92(0x1c1)]())mainWindow[_0x3edd92(0x1eb)]();!mainWindow[_0x3edd92(0x22b)]()&&mainWindow[_0x3edd92(0x1a3)](),mainWindow['focus']();}}),init());}else init();process['on']('uncaughtException',(_0x44e85f,_0x7a1218)=>{const _0x1f376d=_0x3ae2fd;console['log']('main\x20error:',_0x44e85f),dbu&&messageUtil[_0x1f376d(0x211)](dbu[_0x1f376d(0x1ec)],'Error\x20occurred\x20in\x20main\x20process','error',_0x44e85f[_0x1f376d(0x1bc)]||_0x44e85f[_0x1f376d(0x1a2)]);});