const _0x5c1587=_0x9ff8;function _0x9ff8(_0x1b2ce9,_0x1a586c){const _0x5e43c7=_0x5e43();return _0x9ff8=function(_0x9ff87c,_0x1186db){_0x9ff87c=_0x9ff87c-0x113;let _0x4ad87b=_0x5e43c7[_0x9ff87c];return _0x4ad87b;},_0x9ff8(_0x1b2ce9,_0x1a586c);}(function(_0x8d3ac6,_0x40c733){const _0x6ecacf=_0x9ff8,_0x553d8c=_0x8d3ac6();while(!![]){try{const _0x31aae9=-parseInt(_0x6ecacf(0x14e))/0x1*(parseInt(_0x6ecacf(0x119))/0x2)+-parseInt(_0x6ecacf(0x14f))/0x3+-parseInt(_0x6ecacf(0x151))/0x4*(parseInt(_0x6ecacf(0x182))/0x5)+-parseInt(_0x6ecacf(0x128))/0x6+-parseInt(_0x6ecacf(0x136))/0x7+-parseInt(_0x6ecacf(0x161))/0x8*(-parseInt(_0x6ecacf(0x143))/0x9)+parseInt(_0x6ecacf(0x117))/0xa*(parseInt(_0x6ecacf(0x150))/0xb);if(_0x31aae9===_0x40c733)break;else _0x553d8c['push'](_0x553d8c['shift']());}catch(_0x589874){_0x553d8c['push'](_0x553d8c['shift']());}}}(_0x5e43,0xe4bed));const fs=require('fs'),path=require(_0x5c1587(0x13f)),tfjs=require(_0x5c1587(0x12c)),wasm=require('@tensorflow/tfjs-backend-wasm'),sharpUtil=require('../../express-server/utils/sharpUtils'),exifUtils=require(_0x5c1587(0x11c)),faceapi=require('../../libs/faceapi/face-api.node-wasm'),config=require('../../myConfig/config'),Database=require(_0x5c1587(0x17d)),https=require(_0x5c1587(0x18f)),dbConfigTable=require(_0x5c1587(0x123));process[_0x5c1587(0x149)]=_0x5c1587(0x118);let dbFileIndex=new Database(config[_0x5c1587(0x15c)],{}),dbOther=new Database(config[_0x5c1587(0x15a)],{});dbOther[_0x5c1587(0x134)]('journal_mode\x20=\x20WAL'),dbFileIndex[_0x5c1587(0x134)](_0x5c1587(0x17b)),process['on'](_0x5c1587(0x11d),()=>{const _0x3b1e1c=_0x5c1587;dbOther[_0x3b1e1c(0x122)](),dbFileIndex['close']();});const sharp=require('sharp'),DEAL_GAP=0x7530;let TABLE_NAME_FACE2INDEX='photo_faces2index',TABLE_NAME_PHOTO_FACES=_0x5c1587(0x160),modelInit=![],modelSavePath=path['join'](config[_0x5c1587(0x167)],_0x5c1587(0x115),'faceapi_models');!fs[_0x5c1587(0x155)](modelSavePath)&&fs[_0x5c1587(0x124)](modelSavePath,{'recursive':!![]});let modelBaseUrl='https://down.nascab.cn/tfModel/face_api/',modelFileUrlList=[],modelFileList=[_0x5c1587(0x189),'face_landmark_68_tiny_model-weights_manifest.json',_0x5c1587(0x170),_0x5c1587(0x141),_0x5c1587(0x129),_0x5c1587(0x158),_0x5c1587(0x171),_0x5c1587(0x13b)];for(let i=0x0;i<modelFileList['length'];i++){modelFileUrlList[_0x5c1587(0x145)](modelBaseUrl+modelFileList[i]);}function httpDownload(_0x2fe273,_0x3bfcad,_0x5c15f4){return new Promise((_0xe9c014,_0x44fb8f)=>{const _0x2873a3=_0x9ff8;https['get'](_0x2fe273,_0x13e5cb=>{const _0x2c541c=_0x9ff8,_0x2f7e91=fs[_0x2c541c(0x173)](_0x3bfcad);_0x13e5cb[_0x2c541c(0x186)](_0x2f7e91),_0x2f7e91['on'](_0x2c541c(0x135),()=>{const _0x37ed29=_0x2c541c;_0x2f7e91[_0x37ed29(0x122)](),fs[_0x37ed29(0x16d)](_0x3bfcad,_0x5c15f4),_0xe9c014();})['on'](_0x2c541c(0x16a),_0x5d8ce9=>{});})['on'](_0x2873a3(0x16a),_0x229c1f=>{const _0x34fe3d=_0x2873a3;_0x44fb8f(_0x229c1f[_0x34fe3d(0x15b)]);});});}function downloadModelFile(){return new Promise(async(_0x1887cb,_0x297cae)=>{const _0x392564=_0x9ff8;try{for(let _0x31e853=0x0;_0x31e853<modelFileList[_0x392564(0x177)];_0x31e853++){let _0x473027=path[_0x392564(0x126)](modelSavePath,modelFileList[_0x31e853]),_0x5579fa=path[_0x392564(0x126)](modelSavePath,'tmp_'+modelFileList[_0x31e853]);if(!fs[_0x392564(0x155)](_0x473027)){let _0x43e9a1=modelFileUrlList[_0x31e853];await httpDownload(_0x43e9a1,_0x5579fa,_0x473027);}else{}}_0x1887cb();}catch(_0x10005b){_0x297cae(_0x10005b);}});}async function initFaceAPI(){return new Promise(async(_0x507e40,_0x4ef923)=>{const _0x4508e1=_0x9ff8;try{!modelInit&&(await downloadModelFile(),await tfjs[_0x4508e1(0x188)](_0x4508e1(0x113)),await tfjs[_0x4508e1(0x144)](),await faceapi[_0x4508e1(0x18c)][_0x4508e1(0x164)][_0x4508e1(0x130)](modelSavePath),await faceapi[_0x4508e1(0x18c)]['faceLandmark68Net'][_0x4508e1(0x130)](modelSavePath),await faceapi[_0x4508e1(0x18c)]['faceRecognitionNet'][_0x4508e1(0x130)](modelSavePath),modelInit=!![]),_0x507e40();}catch(_0x3652fb){console[_0x4508e1(0x16e)](_0x3652fb),_0x4ef923(_0x3652fb);}});}let currentDetectIndex=null;function runInfinitDetectFaces(){return new Promise(async _0x2afc1d=>{const _0x3dd71e=_0x9ff8;let _0x1d2cc6;try{let _0x24e28e=0x32*0x400;dbFileIndex[_0x3dd71e(0x157)](_0x3dd71e(0x114)+_0x24e28e)[_0x3dd71e(0x121)](),_0x1d2cc6=dbFileIndex[_0x3dd71e(0x157)](_0x3dd71e(0x18e)+_0x24e28e+'\x20AND\x20(type=1\x20OR\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20ai_face_detect_state=0\x20\x20AND\x20is_raw!=1\x20LIMIT\x201')[_0x3dd71e(0x169)]();if(!_0x1d2cc6)return setTimeout(()=>{_0x2afc1d();},DEAL_GAP);currentDetectIndex=_0x1d2cc6,await initFaceAPI();try{bgTaskId&&dbOther[_0x3dd71e(0x157)](_0x3dd71e(0x176)+bgTaskId)[_0x3dd71e(0x121)]();}catch(_0x1c58c0){}function _0x8c0af1(){const _0x113b3e=_0x3dd71e;dbFileIndex[_0x113b3e(0x157)](_0x113b3e(0x133)+_0x1d2cc6['id'])[_0x113b3e(0x121)](),currentDetectIndex=null,_0x2afc1d();}let _0x82e27a=path['join'](_0x1d2cc6[_0x3dd71e(0x13f)],_0x1d2cc6['filename']);parseInt(_0x1d2cc6['type'])==0x2&&(_0x82e27a=path[_0x3dd71e(0x126)](_0x1d2cc6['tiny_path']));let _0x1d1e79=0x7d0;fs[_0x3dd71e(0x142)](_0x82e27a,async(_0x21ba85,_0xc60ec6)=>{const _0x217839=_0x3dd71e;if(_0x21ba85)return _0x8c0af1();sharpUtil[_0x217839(0x12b)](_0x82e27a,(_0x3546e9,_0x13b15c,_0x20bd44)=>{const _0xecec8a=_0x217839;let _0x3db5d1=sharpUtil[_0xecec8a(0x159)](_0x3546e9),_0x4ca0ae=exifUtils[_0xecec8a(0x11f)](_0x20bd44);_0x4ca0ae?_0x3db5d1=_0x3db5d1[_0xecec8a(0x185)](_0x4ca0ae):_0x3db5d1=_0x3db5d1[_0xecec8a(0x185)](),_0x3db5d1['resize']({'width':_0x1d1e79,'height':_0x1d1e79,'withoutEnlargement':!![]})['jpeg']()[_0xecec8a(0x17c)]()[_0xecec8a(0x16b)](async(_0x546af6,_0x656fc0,_0x5b51cd)=>{const _0x2fdc9c=_0xecec8a;_0x13b15c&&sharpUtil[_0x2fdc9c(0x14b)](_0x3546e9);if(_0x546af6)return _0x656fc0=null,_0x8c0af1();let _0x2a109e;try{faceapi['tf'][_0x2fdc9c(0x11a)]()[_0x2fdc9c(0x14a)](),temp=tfjs[_0x2fdc9c(0x175)](_0x656fc0,[_0x5b51cd[_0x2fdc9c(0x17f)],_0x5b51cd[_0x2fdc9c(0x125)],_0x5b51cd['channels']]),_0x2a109e=tfjs[_0x2fdc9c(0x13c)](temp,[0x0,0x0,0x0],[-0x1,-0x1,0x3]),faceapi['tf']['dispose'](temp);}catch(_0x2e735d){if(_0x2a109e)faceapi['tf'][_0x2fdc9c(0x183)](_0x2a109e);if(temp)faceapi['tf']['dispose'](temp);return faceapi['tf'][_0x2fdc9c(0x11a)]()[_0x2fdc9c(0x187)](),_0x8c0af1();}_0x656fc0=null,faceapi[_0x2fdc9c(0x184)](_0x2a109e)[_0x2fdc9c(0x137)]()[_0x2fdc9c(0x12e)]()['then'](_0x5b577e=>{const _0x54ddfa=_0x2fdc9c;faceapi['tf'][_0x54ddfa(0x183)](_0x2a109e),faceapi['tf']['engine']()[_0x54ddfa(0x187)]();if(!_0x5b577e['length'])return _0x8c0af1();let _0x2d753a=[];for(let _0x190429 of _0x5b577e){let _0x4ef4c1=_0x190429['detection']['_box'][_0x54ddfa(0x166)],_0x2ae6b5=_0x190429['detection'][_0x54ddfa(0x181)][_0x54ddfa(0x148)];if(_0x4ef4c1>_0x1d1e79||_0x2ae6b5>_0x1d1e79)continue;let _0x24e5cc=_0x190429[_0x54ddfa(0x12a)][_0x54ddfa(0x14d)];if(_0x4ef4c1<0x50||_0x2ae6b5<0x50||_0x24e5cc<0.8)continue;_0x2d753a[_0x54ddfa(0x145)](_0x190429);}if(!_0x2d753a[_0x54ddfa(0x177)])return _0x8c0af1();for(let _0x2b41bb=0x0;_0x2b41bb<_0x2d753a[_0x54ddfa(0x177)];_0x2b41bb++){let _0x3be382=_0x2d753a[_0x2b41bb],_0x505d3b=_0x3be382[_0x54ddfa(0x12a)][_0x54ddfa(0x181)];dbFileIndex[_0x54ddfa(0x157)]('REPLACE\x20INTO\x20\x20'+TABLE_NAME_FACE2INDEX+_0x54ddfa(0x162))[_0x54ddfa(0x121)](_0x1d2cc6['id'],_0x3be382[_0x54ddfa(0x12a)][_0x54ddfa(0x14d)],_0x505d3b['_x'],_0x505d3b['_y'],_0x505d3b['_width'],_0x505d3b['_height'],JSON[_0x54ddfa(0x16c)](_0x3be382['descriptor']));}return _0x5b577e=null,_0x8c0af1();})[_0x2fdc9c(0x132)](_0x55f756=>{const _0x3cdd01=_0x2fdc9c;return _0x13b15c&&sharpUtil[_0x3cdd01(0x14b)](_0x3546e9),faceapi['tf'][_0x3cdd01(0x183)](_0x2a109e),faceapi['tf'][_0x3cdd01(0x11a)]()[_0x3cdd01(0x187)](),_0x8c0af1();});});});});}catch(_0x483f58){_0x1d2cc6&&dbFileIndex[_0x3dd71e(0x157)](_0x3dd71e(0x133)+_0x1d2cc6['id'])[_0x3dd71e(0x121)](),_0x2afc1d();}});}function exitProcess(){const _0x634849=_0x5c1587;try{bgTaskId&&dbOther[_0x634849(0x157)](_0x634849(0x14c)+bgTaskId)['run']();}catch(_0x4c5643){}return process[_0x634849(0x168)]({'type':_0x634849(0x122)}),statisticFacePhotoCount(),process[_0x634849(0x11d)]();}function runInfinitCompareFaces(){let _0xc0d3dd=0.35;return new Promise(async _0x4c45f0=>{const _0x2603fd=_0x9ff8;let _0xf646a3=dbFileIndex['prepare'](_0x2603fd(0x127))[_0x2603fd(0x169)]();if(_0xf646a3)return setTimeout(()=>{_0x4c45f0();},DEAL_GAP);let _0x6286a4;try{try{bgTaskId&&dbOther['prepare'](_0x2603fd(0x176)+bgTaskId)['run']();}catch(_0x29f5b8){}_0x6286a4=dbFileIndex[_0x2603fd(0x157)](_0x2603fd(0x11b)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x146))[_0x2603fd(0x169)]();if(!_0x6286a4)return exitProcess();await initFaceAPI();function _0x3dfe15(){const _0x4db96f=_0x2603fd;dbFileIndex['prepare'](_0x4db96f(0x17e)+TABLE_NAME_FACE2INDEX+_0x4db96f(0x15e)+_0x6286a4['id'])[_0x4db96f(0x121)](),_0x4c45f0();}let _0x17605f=new Float32Array(Object[_0x2603fd(0x16f)](JSON[_0x2603fd(0x153)](_0x6286a4['face_descriptor'])));const _0x59adb6=new faceapi[(_0x2603fd(0x180))]([_0x17605f]);let _0xee068f=[_0x6286a4],_0x487935=dbFileIndex[_0x2603fd(0x157)](_0x2603fd(0x140)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x178)+_0x6286a4['id'])[_0x2603fd(0x156)](),_0x436002=0x1,_0x319ecd=null;for(let _0x5c20b7=0x0;_0x5c20b7<_0x487935[_0x2603fd(0x177)];_0x5c20b7++){let _0x2f9907=dbFileIndex[_0x2603fd(0x157)](_0x2603fd(0x11b)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x13d)+_0x487935[_0x5c20b7]['id'])['get']();if(!_0x2f9907)continue;const _0x1f1c8b=_0x59adb6[_0x2603fd(0x165)](new Float32Array(Object[_0x2603fd(0x16f)](JSON[_0x2603fd(0x153)](_0x2f9907[_0x2603fd(0x120)]))));_0x1f1c8b[_0x2603fd(0x15d)]<_0xc0d3dd&&(_0x1f1c8b[_0x2603fd(0x15d)]<_0x436002&&_0x2f9907[_0x2603fd(0x172)]&&(_0x436002=_0x1f1c8b[_0x2603fd(0x15d)],_0x319ecd=_0x2f9907[_0x2603fd(0x172)]),_0x1f1c8b['_distance']<_0x2f9907[_0x2603fd(0x163)]&&(_0x2f9907[_0x2603fd(0x163)]=_0x1f1c8b[_0x2603fd(0x15d)],_0xee068f[_0x2603fd(0x145)](_0x2f9907)));}if(_0xee068f[_0x2603fd(0x177)]<0x2){if(_0x319ecd&&!_0x6286a4[_0x2603fd(0x172)]){let _0x2e8624='UPDATE\x20'+TABLE_NAME_FACE2INDEX+_0x2603fd(0x131)+_0x319ecd+'\x20,min_similar_score='+_0x436002+_0x2603fd(0x13e)+_0x6286a4['id'];dbFileIndex['prepare'](_0x2e8624)[_0x2603fd(0x121)]();}else{}return _0x3dfe15();}let _0x2c9e6d={};for(let _0x5e3058=0x0;_0x5e3058<_0xee068f[_0x2603fd(0x177)];_0x5e3058++){let _0x591001=_0xee068f[_0x5e3058][_0x2603fd(0x172)];_0x591001&&(_0x2c9e6d[_0x591001]?_0x2c9e6d[_0x591001]+=0x1:_0x2c9e6d[_0x591001]=0x1);}if(Object['keys'](_0x2c9e6d)[_0x2603fd(0x177)]>0x0){let _0x32cba8=0x0,_0x168432=0x0;for(let _0xfa5035 in _0x2c9e6d){_0x2c9e6d[_0xfa5035]>_0x168432&&(_0x168432=_0x2c9e6d[_0xfa5035],_0x32cba8=_0xfa5035);}if(_0x168432>0x0&&_0x168432>=(_0xee068f[_0x2603fd(0x177)]-0x1)/0x6){for(let _0x46060b in _0xee068f){let _0x1e7b78=_0x2603fd(0x17e)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x131)+_0x32cba8+'\x20,min_similar_score='+_0xee068f[_0x46060b][_0x2603fd(0x163)]+',\x20compare_state=1\x20where\x20id\x20=\x20'+_0xee068f[_0x46060b]['id'];dbFileIndex[_0x2603fd(0x157)](_0x1e7b78)[_0x2603fd(0x121)]();}return _0x3dfe15();}else{let _0x3070c2=dbFileIndex[_0x2603fd(0x157)](_0x2603fd(0x179)+TABLE_NAME_PHOTO_FACES+'(face_descriptor)\x20VALUES(?)')[_0x2603fd(0x121)](JSON[_0x2603fd(0x16c)](_0x17605f));for(let _0x58d0f9 in _0xee068f){let _0x10ddc=_0x2603fd(0x17e)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x131)+_0x3070c2[_0x2603fd(0x154)]+_0x2603fd(0x152)+_0xee068f[_0x58d0f9][_0x2603fd(0x163)]+_0x2603fd(0x13e)+_0xee068f[_0x58d0f9]['id'];dbFileIndex[_0x2603fd(0x157)](_0x10ddc)['run']();}return _0x3dfe15();}}else{let _0x3ad3eb=dbFileIndex[_0x2603fd(0x157)](_0x2603fd(0x179)+TABLE_NAME_PHOTO_FACES+'(face_descriptor)\x20VALUES(?)')[_0x2603fd(0x121)](JSON[_0x2603fd(0x16c)](_0x17605f));for(let _0xdf0e7a in _0xee068f){let _0x157035=_0x2603fd(0x17e)+TABLE_NAME_FACE2INDEX+_0x2603fd(0x131)+_0x3ad3eb[_0x2603fd(0x154)]+'\x20,min_similar_score='+_0xee068f[_0xdf0e7a][_0x2603fd(0x163)]+_0x2603fd(0x13e)+_0xee068f[_0xdf0e7a]['id'];dbFileIndex['prepare'](_0x157035)[_0x2603fd(0x121)]();}return _0x3dfe15();}}catch(_0x237425){console[_0x2603fd(0x16e)](_0x237425),_0x6286a4&&dbFileIndex['prepare']('UPDATE\x20'+TABLE_NAME_FACE2INDEX+'\x20SET\x20compare_state=1\x20where\x20id='+_0x6286a4['id'])['run'](),_0x4c45f0();}});}async function runFaceDetect(){const _0x24ee5f=_0x5c1587;let _0x374f6f=dbConfigTable['findByTitle'](dbOther,_0x24ee5f(0x138));_0x374f6f&&_0x374f6f['value']=='1'?runInfinitDetectFaces()[_0x24ee5f(0x17a)](()=>{runFaceDetect();}):exitProcess();}async function runFaceCompare(){const _0x7446f4=_0x5c1587;runInfinitCompareFaces()[_0x7446f4(0x17a)](()=>{runFaceCompare();});}function statisticFacePhotoCount(){const _0x141734=_0x5c1587;try{let _0x216a20=dbFileIndex[_0x141734(0x157)](_0x141734(0x140)+TABLE_NAME_PHOTO_FACES+_0x141734(0x139))[_0x141734(0x156)]();for(let _0x394aae of _0x216a20){let _0x36050b=dbFileIndex['prepare'](_0x141734(0x140)+TABLE_NAME_PHOTO_FACES+'\x20where\x20belong_face_id='+_0x394aae['id'])['all']();_0x36050b[_0x141734(0x145)](_0x394aae);let _0x1f6c96='(';for(let _0x5126ff in _0x36050b){_0x1f6c96+=_0x36050b[_0x5126ff]['id'],_0x5126ff!=_0x36050b['length']-0x1&&(_0x1f6c96+=',');}_0x1f6c96+=')';let _0x3607c0=dbFileIndex[_0x141734(0x157)](_0x141734(0x18a)+TABLE_NAME_FACE2INDEX+_0x141734(0x174)+_0x1f6c96+_0x141734(0x18b))[_0x141734(0x169)]();dbFileIndex[_0x141734(0x157)]('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+'\x20SET\x20face_photo_count='+_0x3607c0[_0x141734(0x116)]+_0x141734(0x13a)+_0x394aae['id'])[_0x141734(0x121)]();}dbFileIndex[_0x141734(0x157)]('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+_0x141734(0x18d))[_0x141734(0x121)](),dbFileIndex[_0x141734(0x157)](_0x141734(0x12d)+TABLE_NAME_PHOTO_FACES+_0x141734(0x11e))['run']();}catch(_0x37429e){console[_0x141734(0x16e)](_0x37429e);}}let bgTaskId;try{let info=dbOther[_0x5c1587(0x157)](_0x5c1587(0x12f))[_0x5c1587(0x121)](_0x5c1587(0x15f));bgTaskId=info[_0x5c1587(0x154)];}catch(_0x442ba9){}function _0x5e43(){const _0x9c957d=['mkdirSync','width','join','SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20(type=1\x20OR\x20type=2)\x20AND\x20ai_face_detect_state=0\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20is_raw!=1\x20\x20LIMIT\x201','5682054XBVQtr','ssd_mobilenetv1_model.bin','detection','transSpcielFormat','@tensorflow/tfjs','DELETE\x20FROM\x20','withFaceDescriptors','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','loadFromDisk','\x20SET\x20face_id=','catch','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id=','pragma','finish','11937037UdnrKW','withFaceLandmarks','aiFaceEnable','\x20where\x20belong_face_id\x20is\x20null','\x20where\x20id=','face_landmark_68_model-weights_manifest.json','slice','\x20WHERE\x20id=',',\x20compare_state=1\x20where\x20id\x20=\x20','path','SELECT\x20id\x20from\x20','face_recognition_model-weights_manifest.json','stat','867501EndkuJ','ready','push','\x20WHERE\x20\x20compare_state=0\x20\x20and\x20face_id\x20is\x20null\x20LIMIT\x201','uncaughtException','_height','title','startScope','deleteRawTempFile','UPDATE\x20bg_task\x20SET\x20task_state=2\x20where\x20id=','_score','2CoVfcX','3770508FKXhhK','5544vQNnXm','141424SVhYdy','\x20,min_similar_score=','parse','lastInsertRowid','existsSync','all','prepare','ssd_mobilenetv1_model-weights_manifest.json','getSharpInstanceFromInput','dbOther','message','dbFileIndex','_distance','\x20SET\x20compare_state=1\x20where\x20id=','AI_FACES','photo_faces','88SwYnka','(photo_index_id,score,x,y,width,height,face_descriptor)\x20\x20VALUES(?,?,?,?,?,?,?)','min_similar_score','ssdMobilenetv1','findBestMatch','_width','userDataFolder','send','get','error','toBuffer','stringify','renameSync','log','values','face_recognition_model.bin','face_landmark_68_model.bin','face_id','createWriteStream','\x20where\x20face_id\x20in\x20','tensor','UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id=','length','\x20where\x20id!=','REPLACE\x20INTO\x20','then','journal_mode\x20=\x20WAL','raw','better-sqlite3','UPDATE\x20','height','FaceMatcher','_box','65YkrpZp','dispose','detectAllFaces','rotate','pipe','endScope','setBackend','face_landmark_68_tiny_model.bin','SELECT\x20COUNT(photo_index_id)\x20as\x20count\x20FROM\x20','\x20and\x20disabled=0','nets','\x20SET\x20face_photo_count=0\x20where\x20belong_face_id\x20is\x20not\x20null','SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20size>','https','wasm','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20WHERE\x20ai_face_detect_state=0\x20and\x20size<=','tfModel','count','119150sxYqsY','NasCabAiFace','1759734ZCcSvQ','engine','SELECT\x20*\x20from\x20','../../utils/exifUtils','exit','\x20where\x20face_photo_count<1\x20and\x20belong_face_id\x20is\x20null','getRotateFromTags','face_descriptor','run','close','../../db/dbConfigTable'];_0x5e43=function(){return _0x9c957d;};return _0x5e43();}async function main(){setTimeout(async()=>{runFaceDetect();},0x7d0),setTimeout(async()=>{runFaceCompare();},0x1388);}main(),process['on'](_0x5c1587(0x147),(_0x100b18,_0x1c7c54)=>{const _0x86b1b9=_0x5c1587;currentDetectIndex&&dbFileIndex[_0x86b1b9(0x157)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id='+currentDetectIndex['id'])['run'](),process[_0x86b1b9(0x168)]({'type':'close'}),process[_0x86b1b9(0x11d)]();});