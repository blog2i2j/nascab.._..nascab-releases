const _0x556b6a=_0x36eb;(function(_0x1dd678,_0x4a9caf){const _0x125c4d=_0x36eb,_0x37b963=_0x1dd678();while(!![]){try{const _0x54eeb1=parseInt(_0x125c4d(0x1c2))/0x1+parseInt(_0x125c4d(0x1bd))/0x2*(parseInt(_0x125c4d(0x190))/0x3)+parseInt(_0x125c4d(0x1e7))/0x4+parseInt(_0x125c4d(0x196))/0x5+parseInt(_0x125c4d(0x1fa))/0x6+parseInt(_0x125c4d(0x1f9))/0x7+-parseInt(_0x125c4d(0x197))/0x8;if(_0x54eeb1===_0x4a9caf)break;else _0x37b963['push'](_0x37b963['shift']());}catch(_0x4bb40e){_0x37b963['push'](_0x37b963['shift']());}}}(_0x131d,0xda6b7));const fs=require('fs'),path=require('path'),tfjs=require(_0x556b6a(0x1f1)),wasm=require('@tensorflow/tfjs-backend-wasm'),sharpUtil=require(_0x556b6a(0x1f5)),exifUtils=require('../../utils/exifUtils'),faceapi=require('../../libs/faceapi/face-api.node-wasm'),config=require(_0x556b6a(0x19d)),Database=require('better-sqlite3'),https=require(_0x556b6a(0x1df)),dbConfigTable=require('../../db/dbConfigTable');process[_0x556b6a(0x1f6)]='NasCabAiFace';let dbFileIndex=new Database(config['dbFileIndex'],{}),dbOther=new Database(config[_0x556b6a(0x1d7)],{});dbOther[_0x556b6a(0x1ca)](_0x556b6a(0x1ed)),dbFileIndex[_0x556b6a(0x1ca)](_0x556b6a(0x1ed)),process['on'](_0x556b6a(0x1b3),()=>{const _0x34137d=_0x556b6a;dbOther[_0x34137d(0x194)](),dbFileIndex[_0x34137d(0x194)]();});const sharp=require(_0x556b6a(0x1a8)),DEAL_GAP=0x7530;let TABLE_NAME_FACE2INDEX='photo_faces2index',TABLE_NAME_PHOTO_FACES=_0x556b6a(0x1c8),modelInit=![],modelSavePath=path[_0x556b6a(0x1ee)](config[_0x556b6a(0x1b2)],'tfModel',_0x556b6a(0x1f2));!fs['existsSync'](modelSavePath)&&fs['mkdirSync'](modelSavePath,{'recursive':!![]});let modelBaseUrl=_0x556b6a(0x1e0),modelFileUrlList=[],modelFileList=[_0x556b6a(0x1f3),_0x556b6a(0x1d6),_0x556b6a(0x1af),_0x556b6a(0x1e8),_0x556b6a(0x1b1),'ssd_mobilenetv1_model-weights_manifest.json',_0x556b6a(0x1b5),_0x556b6a(0x1eb)];for(let i=0x0;i<modelFileList[_0x556b6a(0x1bb)];i++){modelFileUrlList[_0x556b6a(0x195)](modelBaseUrl+modelFileList[i]);}function httpDownload(_0x586b74,_0x4cb06f,_0x24e572){return new Promise((_0x2d6c3b,_0x2d4550)=>{const _0x1f35f9=_0x36eb;https[_0x1f35f9(0x198)](_0x586b74,_0x5b12a1=>{const _0x288ca4=_0x1f35f9,_0x5eac36=fs[_0x288ca4(0x1c4)](_0x4cb06f);_0x5b12a1['pipe'](_0x5eac36),_0x5eac36['on']('finish',()=>{const _0x200e3c=_0x288ca4;_0x5eac36[_0x200e3c(0x194)](),fs['renameSync'](_0x4cb06f,_0x24e572),_0x2d6c3b();})['on']('error',_0x2840a3=>{});})['on'](_0x1f35f9(0x1ac),_0x168eba=>{_0x2d4550(_0x168eba['message']);});});}function downloadModelFile(){return new Promise(async(_0xc436e2,_0x47f90d)=>{const _0x1c47a3=_0x36eb;try{for(let _0x2e0c06=0x0;_0x2e0c06<modelFileList[_0x1c47a3(0x1bb)];_0x2e0c06++){let _0x3c7932=path[_0x1c47a3(0x1ee)](modelSavePath,modelFileList[_0x2e0c06]),_0x478373=path[_0x1c47a3(0x1ee)](modelSavePath,_0x1c47a3(0x1dc)+modelFileList[_0x2e0c06]);if(!fs['existsSync'](_0x3c7932)){let _0x315e18=modelFileUrlList[_0x2e0c06];await httpDownload(_0x315e18,_0x478373,_0x3c7932);}else{}}_0xc436e2();}catch(_0x158ac8){_0x47f90d(_0x158ac8);}});}async function initFaceAPI(){return new Promise(async(_0x144869,_0x2d21e8)=>{const _0x510485=_0x36eb;try{!modelInit&&(await downloadModelFile(),await tfjs[_0x510485(0x1b4)](_0x510485(0x1c7)),await tfjs[_0x510485(0x1ec)](),await faceapi[_0x510485(0x1be)][_0x510485(0x1de)][_0x510485(0x1e6)](modelSavePath),await faceapi[_0x510485(0x1be)][_0x510485(0x1d0)][_0x510485(0x1e6)](modelSavePath),await faceapi[_0x510485(0x1be)][_0x510485(0x1a7)]['loadFromDisk'](modelSavePath),modelInit=!![]),_0x144869();}catch(_0x8ab062){console[_0x510485(0x1b9)](_0x8ab062),_0x2d21e8(_0x8ab062);}});}let currentDetectIndex=null;function _0x36eb(_0x281570,_0x14e3ee){const _0x131d75=_0x131d();return _0x36eb=function(_0x36eb3e,_0x1a9f83){_0x36eb3e=_0x36eb3e-0x190;let _0x45f84f=_0x131d75[_0x36eb3e];return _0x45f84f;},_0x36eb(_0x281570,_0x14e3ee);}function runInfinitDetectFaces(){return new Promise(async _0x5cffb1=>{const _0x6dd475=_0x36eb;let _0x30f261;try{let _0x2fd50f=0x32*0x400;dbFileIndex[_0x6dd475(0x1e3)]('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20WHERE\x20ai_face_detect_state=0\x20and\x20size<='+_0x2fd50f)[_0x6dd475(0x1ad)](),_0x30f261=dbFileIndex[_0x6dd475(0x1e3)]('SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20size>'+_0x2fd50f+_0x6dd475(0x1a3))['get']();if(!_0x30f261)return setTimeout(()=>{_0x5cffb1();},DEAL_GAP);currentDetectIndex=_0x30f261,await initFaceAPI();try{bgTaskId&&dbOther[_0x6dd475(0x1e3)]('UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id='+bgTaskId)[_0x6dd475(0x1ad)]();}catch(_0x235784){}function _0x5b38f3(){const _0x1112b0=_0x6dd475;dbFileIndex['prepare']('UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id='+_0x30f261['id'])[_0x1112b0(0x1ad)](),currentDetectIndex=null,_0x5cffb1();}let _0xc65c35=path[_0x6dd475(0x1ee)](_0x30f261['path'],_0x30f261[_0x6dd475(0x1c6)]);parseInt(_0x30f261[_0x6dd475(0x1bc)])==0x2&&(_0xc65c35=path[_0x6dd475(0x1ee)](_0x30f261[_0x6dd475(0x1a0)]));let _0x2f3a63=0x7d0;fs['stat'](_0xc65c35,async(_0x1e4bff,_0x2d1702)=>{if(_0x1e4bff)return _0x5b38f3();sharpUtil['transSpcielFormat'](_0xc65c35,(_0x44d264,_0x1bc508,_0x50f528)=>{const _0x266f49=_0x36eb;let _0x25c48a=sharpUtil[_0x266f49(0x1a5)](_0x44d264),_0x56c3f9=exifUtils['getRotateFromTags'](_0x50f528);_0x56c3f9?_0x25c48a=_0x25c48a[_0x266f49(0x1a9)](_0x56c3f9):_0x25c48a=_0x25c48a[_0x266f49(0x1a9)](),_0x25c48a[_0x266f49(0x1d3)]({'width':_0x2f3a63,'height':_0x2f3a63,'withoutEnlargement':!![]})[_0x266f49(0x1ae)]()[_0x266f49(0x1dd)]()['toBuffer'](async(_0x26eca3,_0x34ba6a,_0x3568b8)=>{const _0x4d03ba=_0x266f49;_0x1bc508&&sharpUtil['deleteRawTempFile'](_0x44d264);if(_0x26eca3)return _0x34ba6a=null,_0x5b38f3();let _0x461653;try{faceapi['tf'][_0x4d03ba(0x1d5)]()[_0x4d03ba(0x1c5)](),temp=tfjs['tensor'](_0x34ba6a,[_0x3568b8[_0x4d03ba(0x1f0)],_0x3568b8['width'],_0x3568b8['channels']]),_0x461653=tfjs['slice'](temp,[0x0,0x0,0x0],[-0x1,-0x1,0x3]),faceapi['tf']['dispose'](temp);}catch(_0x516776){if(_0x461653)faceapi['tf'][_0x4d03ba(0x199)](_0x461653);if(temp)faceapi['tf'][_0x4d03ba(0x199)](temp);return faceapi['tf']['engine']()[_0x4d03ba(0x1cf)](),_0x5b38f3();}_0x34ba6a=null,faceapi[_0x4d03ba(0x19b)](_0x461653)[_0x4d03ba(0x19f)]()[_0x4d03ba(0x1c3)]()[_0x4d03ba(0x1b7)](_0x12a1df=>{const _0x524911=_0x4d03ba;faceapi['tf'][_0x524911(0x199)](_0x461653),faceapi['tf'][_0x524911(0x1d5)]()[_0x524911(0x1cf)]();if(!_0x12a1df[_0x524911(0x1bb)])return _0x5b38f3();let _0x2c6fdc=[];for(let _0x129428 of _0x12a1df){let _0x367e47=_0x129428[_0x524911(0x1cb)]['_box'][_0x524911(0x1c1)],_0x4524f2=_0x129428[_0x524911(0x1cb)][_0x524911(0x1b0)][_0x524911(0x1bf)];if(_0x367e47>_0x2f3a63||_0x4524f2>_0x2f3a63)continue;let _0xac9d39=_0x129428['detection'][_0x524911(0x1e4)];if(_0x367e47<0x50||_0x4524f2<0x50||_0xac9d39<0.8)continue;_0x2c6fdc[_0x524911(0x195)](_0x129428);}if(!_0x2c6fdc['length'])return _0x5b38f3();for(let _0x228fcc=0x0;_0x228fcc<_0x2c6fdc['length'];_0x228fcc++){let _0xd0f7d8=_0x2c6fdc[_0x228fcc],_0x12ddb1=_0xd0f7d8[_0x524911(0x1cb)][_0x524911(0x1b0)];dbFileIndex[_0x524911(0x1e3)]('REPLACE\x20INTO\x20\x20'+TABLE_NAME_FACE2INDEX+_0x524911(0x1c0))[_0x524911(0x1ad)](_0x30f261['id'],_0xd0f7d8[_0x524911(0x1cb)][_0x524911(0x1e4)],_0x12ddb1['_x'],_0x12ddb1['_y'],_0x12ddb1['_width'],_0x12ddb1['_height'],JSON[_0x524911(0x1f8)](_0xd0f7d8[_0x524911(0x1ab)]));}return _0x12a1df=null,_0x5b38f3();})['catch'](_0x4bec74=>{const _0x5d3ea3=_0x4d03ba;return _0x1bc508&&sharpUtil['deleteRawTempFile'](_0x44d264),faceapi['tf'][_0x5d3ea3(0x199)](_0x461653),faceapi['tf'][_0x5d3ea3(0x1d5)]()[_0x5d3ea3(0x1cf)](),_0x5b38f3();});});});});}catch(_0x1304d5){_0x30f261&&dbFileIndex[_0x6dd475(0x1e3)](_0x6dd475(0x1e5)+_0x30f261['id'])[_0x6dd475(0x1ad)](),_0x5cffb1();}});}function exitProcess(){const _0x4724c9=_0x556b6a;try{bgTaskId&&dbOther[_0x4724c9(0x1e3)](_0x4724c9(0x1e2)+bgTaskId)[_0x4724c9(0x1ad)]();}catch(_0x26ada4){}return process[_0x4724c9(0x1e9)]({'type':_0x4724c9(0x194)}),statisticFacePhotoCount(),process[_0x4724c9(0x1b3)]();}function runInfinitCompareFaces(){let _0x1b292e=0.35;return new Promise(async _0x73fa15=>{const _0x2790c7=_0x36eb;let _0x4535df=dbFileIndex[_0x2790c7(0x1e3)](_0x2790c7(0x1a4))[_0x2790c7(0x198)]();if(_0x4535df)return setTimeout(()=>{_0x73fa15();},DEAL_GAP);let _0x5579bf;try{try{bgTaskId&&dbOther[_0x2790c7(0x1e3)]('UPDATE\x20bg_task\x20SET\x20task_state=1\x20where\x20id='+bgTaskId)['run']();}catch(_0x36ac9f){}_0x5579bf=dbFileIndex[_0x2790c7(0x1e3)](_0x2790c7(0x192)+TABLE_NAME_FACE2INDEX+_0x2790c7(0x1da))[_0x2790c7(0x198)]();if(!_0x5579bf)return exitProcess();await initFaceAPI();function _0x41ecf9(){const _0x11a410=_0x2790c7;dbFileIndex['prepare'](_0x11a410(0x1ea)+TABLE_NAME_FACE2INDEX+_0x11a410(0x1ef)+_0x5579bf['id'])[_0x11a410(0x1ad)](),_0x73fa15();}let _0x31d90c=new Float32Array(Object[_0x2790c7(0x1cd)](JSON['parse'](_0x5579bf['face_descriptor'])));const _0xde7252=new faceapi[(_0x2790c7(0x1ba))]([_0x31d90c]);let _0x36715a=[_0x5579bf],_0x9a3471=dbFileIndex['prepare'](_0x2790c7(0x1f4)+TABLE_NAME_FACE2INDEX+'\x20where\x20id!='+_0x5579bf['id'])['all'](),_0x2e9382=0x1,_0xa31f10=null;for(let _0x572606=0x0;_0x572606<_0x9a3471[_0x2790c7(0x1bb)];_0x572606++){let _0x1a1d63=dbFileIndex[_0x2790c7(0x1e3)](_0x2790c7(0x192)+TABLE_NAME_FACE2INDEX+_0x2790c7(0x1ce)+_0x9a3471[_0x572606]['id'])[_0x2790c7(0x198)]();if(!_0x1a1d63)continue;const _0x317f63=_0xde7252['findBestMatch'](new Float32Array(Object[_0x2790c7(0x1cd)](JSON[_0x2790c7(0x1b6)](_0x1a1d63['face_descriptor']))));_0x317f63[_0x2790c7(0x193)]<_0x1b292e&&(_0x317f63['_distance']<_0x2e9382&&_0x1a1d63[_0x2790c7(0x1a2)]&&(_0x2e9382=_0x317f63[_0x2790c7(0x193)],_0xa31f10=_0x1a1d63[_0x2790c7(0x1a2)]),_0x317f63[_0x2790c7(0x193)]<_0x1a1d63['min_similar_score']&&(_0x1a1d63[_0x2790c7(0x19c)]=_0x317f63['_distance'],_0x36715a['push'](_0x1a1d63)));}if(_0x36715a['length']<0x2){if(_0xa31f10&&!_0x5579bf[_0x2790c7(0x1a2)]){let _0x4534b2=_0x2790c7(0x1ea)+TABLE_NAME_FACE2INDEX+_0x2790c7(0x1aa)+_0xa31f10+_0x2790c7(0x1a6)+_0x2e9382+_0x2790c7(0x1cc)+_0x5579bf['id'];dbFileIndex[_0x2790c7(0x1e3)](_0x4534b2)[_0x2790c7(0x1ad)]();}else{}return _0x41ecf9();}let _0x12f6cf={};for(let _0x33952f=0x0;_0x33952f<_0x36715a[_0x2790c7(0x1bb)];_0x33952f++){let _0x2f1e57=_0x36715a[_0x33952f]['face_id'];_0x2f1e57&&(_0x12f6cf[_0x2f1e57]?_0x12f6cf[_0x2f1e57]+=0x1:_0x12f6cf[_0x2f1e57]=0x1);}if(Object['keys'](_0x12f6cf)[_0x2790c7(0x1bb)]>0x0){let _0x387ef9=0x0,_0x3cc4f6=0x0;for(let _0x491ee3 in _0x12f6cf){_0x12f6cf[_0x491ee3]>_0x3cc4f6&&(_0x3cc4f6=_0x12f6cf[_0x491ee3],_0x387ef9=_0x491ee3);}if(_0x3cc4f6>0x0&&_0x3cc4f6>=(_0x36715a[_0x2790c7(0x1bb)]-0x1)/0x6){for(let _0x4b0b7f in _0x36715a){let _0x1a8df1=_0x2790c7(0x1ea)+TABLE_NAME_FACE2INDEX+_0x2790c7(0x1aa)+_0x387ef9+'\x20,min_similar_score='+_0x36715a[_0x4b0b7f][_0x2790c7(0x19c)]+_0x2790c7(0x1cc)+_0x36715a[_0x4b0b7f]['id'];dbFileIndex[_0x2790c7(0x1e3)](_0x1a8df1)[_0x2790c7(0x1ad)]();}return _0x41ecf9();}else{let _0x185bcb=dbFileIndex[_0x2790c7(0x1e3)]('REPLACE\x20INTO\x20'+TABLE_NAME_PHOTO_FACES+_0x2790c7(0x1d2))[_0x2790c7(0x1ad)](JSON[_0x2790c7(0x1f8)](_0x31d90c));for(let _0x3ac153 in _0x36715a){let _0xfe512a=_0x2790c7(0x1ea)+TABLE_NAME_FACE2INDEX+'\x20SET\x20face_id='+_0x185bcb[_0x2790c7(0x1d1)]+_0x2790c7(0x1a6)+_0x36715a[_0x3ac153][_0x2790c7(0x19c)]+_0x2790c7(0x1cc)+_0x36715a[_0x3ac153]['id'];dbFileIndex[_0x2790c7(0x1e3)](_0xfe512a)[_0x2790c7(0x1ad)]();}return _0x41ecf9();}}else{let _0x471159=dbFileIndex[_0x2790c7(0x1e3)](_0x2790c7(0x19a)+TABLE_NAME_PHOTO_FACES+_0x2790c7(0x1d2))[_0x2790c7(0x1ad)](JSON[_0x2790c7(0x1f8)](_0x31d90c));for(let _0x17cd65 in _0x36715a){let _0x1727f8=_0x2790c7(0x1ea)+TABLE_NAME_FACE2INDEX+_0x2790c7(0x1aa)+_0x471159[_0x2790c7(0x1d1)]+_0x2790c7(0x1a6)+_0x36715a[_0x17cd65][_0x2790c7(0x19c)]+_0x2790c7(0x1cc)+_0x36715a[_0x17cd65]['id'];dbFileIndex['prepare'](_0x1727f8)[_0x2790c7(0x1ad)]();}return _0x41ecf9();}}catch(_0x2f2523){console['log'](_0x2f2523),_0x5579bf&&dbFileIndex[_0x2790c7(0x1e3)](_0x2790c7(0x1ea)+TABLE_NAME_FACE2INDEX+'\x20SET\x20compare_state=1\x20where\x20id='+_0x5579bf['id'])['run'](),_0x73fa15();}});}async function runFaceDetect(){const _0x380139=_0x556b6a;let _0x211230=dbConfigTable[_0x380139(0x1d4)](dbOther,'aiFaceEnable');_0x211230&&_0x211230['value']=='1'?runInfinitDetectFaces()['then'](()=>{runFaceDetect();}):exitProcess();}async function runFaceCompare(){runInfinitCompareFaces()['then'](()=>{runFaceCompare();});}function statisticFacePhotoCount(){const _0x29de90=_0x556b6a;try{let _0x3de969=dbFileIndex[_0x29de90(0x1e3)](_0x29de90(0x1f4)+TABLE_NAME_PHOTO_FACES+_0x29de90(0x1a1))[_0x29de90(0x1db)]();for(let _0x2ea08e of _0x3de969){let _0x598a33=dbFileIndex['prepare'](_0x29de90(0x1f4)+TABLE_NAME_PHOTO_FACES+_0x29de90(0x191)+_0x2ea08e['id'])[_0x29de90(0x1db)]();_0x598a33[_0x29de90(0x195)](_0x2ea08e);let _0x527998='(';for(let _0x12871a in _0x598a33){_0x527998+=_0x598a33[_0x12871a]['id'],_0x12871a!=_0x598a33[_0x29de90(0x1bb)]-0x1&&(_0x527998+=',');}_0x527998+=')';let _0x4b317e=dbFileIndex[_0x29de90(0x1e3)]('SELECT\x20COUNT(photo_index_id)\x20as\x20count\x20FROM\x20'+TABLE_NAME_FACE2INDEX+_0x29de90(0x1b8)+_0x527998+'\x20and\x20disabled=0')[_0x29de90(0x198)]();dbFileIndex['prepare']('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+'\x20SET\x20face_photo_count='+_0x4b317e[_0x29de90(0x19e)]+_0x29de90(0x1e1)+_0x2ea08e['id'])['run']();}dbFileIndex[_0x29de90(0x1e3)]('UPDATE\x20'+TABLE_NAME_PHOTO_FACES+_0x29de90(0x1d8))[_0x29de90(0x1ad)](),dbFileIndex['prepare']('DELETE\x20FROM\x20'+TABLE_NAME_PHOTO_FACES+_0x29de90(0x1d9))[_0x29de90(0x1ad)]();}catch(_0x3cde9e){console[_0x29de90(0x1b9)](_0x3cde9e);}}let bgTaskId;try{let info=dbOther[_0x556b6a(0x1e3)](_0x556b6a(0x1f7))[_0x556b6a(0x1ad)]('AI_FACES');bgTaskId=info[_0x556b6a(0x1d1)];}catch(_0x3ebe6f){}async function main(){setTimeout(async()=>{runFaceDetect();},0x7d0),setTimeout(async()=>{runFaceCompare();},0x1388);}function _0x131d(){const _0x597aa9=['ready','journal_mode\x20=\x20WAL','join','\x20SET\x20compare_state=1\x20where\x20id=','height','@tensorflow/tfjs','faceapi_models','face_landmark_68_tiny_model.bin','SELECT\x20id\x20from\x20','../../express-server/utils/sharpUtils','title','INSERT\x20INTO\x20bg_task(task_type)\x20VALUES(?)','stringify','792407efrmgx','7787514FsnBfL','309rXKdjQ','\x20where\x20belong_face_id=','SELECT\x20*\x20from\x20','_distance','close','push','5572060YdUJro','27070184rCptHN','get','dispose','REPLACE\x20INTO\x20','detectAllFaces','min_similar_score','../../myConfig/config','count','withFaceLandmarks','tiny_path','\x20where\x20belong_face_id\x20is\x20null','face_id','\x20AND\x20(type=1\x20OR\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20ai_face_detect_state=0\x20\x20AND\x20is_raw!=1\x20LIMIT\x201','SELECT\x20*\x20from\x20file_index_photo\x20WHERE\x20is_file=1\x20AND\x20(type=1\x20OR\x20type=2)\x20AND\x20ai_face_detect_state=0\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20\x20AND\x20is_raw!=1\x20\x20LIMIT\x201','getSharpInstanceFromInput','\x20,min_similar_score=','faceRecognitionNet','sharp','rotate','\x20SET\x20face_id=','descriptor','error','run','jpeg','face_recognition_model.bin','_box','ssd_mobilenetv1_model.bin','userDataFolder','exit','setBackend','face_landmark_68_model.bin','parse','then','\x20where\x20face_id\x20in\x20','log','FaceMatcher','length','type','11882fVMwEJ','nets','_height','(photo_index_id,score,x,y,width,height,face_descriptor)\x20\x20VALUES(?,?,?,?,?,?,?)','_width','878119GimsnH','withFaceDescriptors','createWriteStream','startScope','filename','wasm','photo_faces','uncaughtException','pragma','detection',',\x20compare_state=1\x20where\x20id\x20=\x20','values','\x20WHERE\x20id=','endScope','faceLandmark68Net','lastInsertRowid','(face_descriptor)\x20VALUES(?)','resize','findByTitle','engine','face_landmark_68_tiny_model-weights_manifest.json','dbOther','\x20SET\x20face_photo_count=0\x20where\x20belong_face_id\x20is\x20not\x20null','\x20where\x20face_photo_count<1\x20and\x20belong_face_id\x20is\x20null','\x20WHERE\x20\x20compare_state=0\x20\x20and\x20face_id\x20is\x20null\x20LIMIT\x201','all','tmp_','raw','ssdMobilenetv1','https','https://down.nascab.cn/tfModel/face_api/','\x20where\x20id=','UPDATE\x20bg_task\x20SET\x20task_state=2\x20where\x20id=','prepare','_score','UPDATE\x20file_index_photo\x20SET\x20ai_face_detect_state=1\x20where\x20id=','loadFromDisk','1051384umbiUu','face_recognition_model-weights_manifest.json','send','UPDATE\x20','face_landmark_68_model-weights_manifest.json'];_0x131d=function(){return _0x597aa9;};return _0x131d();}main(),process['on'](_0x556b6a(0x1c9),(_0x59558f,_0x19c9fb)=>{const _0x3789af=_0x556b6a;currentDetectIndex&&dbFileIndex[_0x3789af(0x1e3)](_0x3789af(0x1e5)+currentDetectIndex['id'])[_0x3789af(0x1ad)](),process[_0x3789af(0x1e9)]({'type':_0x3789af(0x194)}),process['exit']();});