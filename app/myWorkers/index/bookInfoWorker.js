function _0x608d(){const _0xb0b2fc=['Worker\x20stopped.','fileCount','readFileSync','1452840uFoIKZ','open','.zip','EPUB写入书籍封面缓存：','join','.azw3','end','getCover','publisher','./bookFflate','434505OGMDED','book-type','catch','unzlibSync','title','344zmxLXW','没有找到需要处理的书籍目录','11DUUIJu','total_page','.rar','parse','close','8536OQjIFJ','bookCoverCachePath','6ZGRRGL','toLowerCase','metadata','.mobi','log','from','mobi','epub','.epub','language','coverPath','1186594yYrzfv','未找到封面','1437tIRFDL','.azw','path','ext','creator','81873wFWUjt','worker_threads','epub解析失败','error','44370JRcyAz','getTime','date','cover','artist','exit','existsSync','2640827ROorka','getImage','indexObj','filename','.cbz','getZipCover','../../utils/zipUtil','封面缓存已经存在','.cbr'];_0x608d=function(){return _0xb0b2fc;};return _0x608d();}const _0x2745a0=_0x5e47;(function(_0x14c2f5,_0x2b398e){const _0xed02b2=_0x5e47,_0x57c805=_0x14c2f5();while(!![]){try{const _0x456bdf=parseInt(_0xed02b2(0x170))/0x1+parseInt(_0xed02b2(0x14d))/0x2+parseInt(_0xed02b2(0x172))/0x3*(-parseInt(_0xed02b2(0x163))/0x4)+-parseInt(_0xed02b2(0x157))/0x5+-parseInt(_0xed02b2(0x165))/0x6*(parseInt(_0xed02b2(0x182))/0x7)+parseInt(_0xed02b2(0x15c))/0x8*(parseInt(_0xed02b2(0x177))/0x9)+parseInt(_0xed02b2(0x17b))/0xa*(-parseInt(_0xed02b2(0x15e))/0xb);if(_0x456bdf===_0x2b398e)break;else _0x57c805['push'](_0x57c805['shift']());}catch(_0x206ba){_0x57c805['push'](_0x57c805['shift']());}}}(_0x608d,0xc6958));const {parentPort,workerData}=require(_0x2745a0(0x178)),EPub=require(_0x2745a0(0x16c)),mobiNode=require('./bookMobiNode'),mobiJs=require(_0x2745a0(0x16b)),fflate=require(_0x2745a0(0x156)),fs=require('fs'),path=require(_0x2745a0(0x174));let originalTime=null,coverData=null,zipUtil=require(_0x2745a0(0x147));function returnResult(){const _0x190a4d=_0x2745a0;parentPort['postMessage']({'code':0x0,'indexObj':workerData[_0x190a4d(0x184)],'originalTime':originalTime,'coverData':coverData}),process[_0x190a4d(0x180)](0x0);}function _0x5e47(_0xb58a0a,_0x307140){const _0x608d8b=_0x608d();return _0x5e47=function(_0x5e478d,_0x285ec6){_0x5e478d=_0x5e478d-0x145;let _0x156ad7=_0x608d8b[_0x5e478d];return _0x156ad7;},_0x5e47(_0xb58a0a,_0x307140);}async function genBookInfoMobi(_0x51f13a){const _0x2754bd=_0x2745a0;if(!workerData['onlyGenCover'])try{let _0x39c3be=new mobiJs(_0x51f13a);_0x39c3be[_0x2754bd(0x15b)]&&(workerData[_0x2754bd(0x184)][_0x2754bd(0x15b)]=_0x39c3be['title']),workerData[_0x2754bd(0x184)]['metadata_state']=0x1;}catch(_0x199ba0){}try{if(fs[_0x2754bd(0x181)](workerData['bookCoverCachePath']))return console[_0x2754bd(0x169)](_0x2754bd(0x148),workerData[_0x2754bd(0x184)][_0x2754bd(0x185)]),workerData['indexObj'][_0x2754bd(0x16f)]=workerData[_0x2754bd(0x164)],returnResult();let _0xaa0a9=fs[_0x2754bd(0x14c)](_0x51f13a),_0x1dc5c6=await new mobiNode['MOBI']({'unzlib':fflate[_0x2754bd(0x15a)]})[_0x2754bd(0x14e)](new Uint8Array(_0xaa0a9)),_0x13f8ad=await _0x1dc5c6[_0x2754bd(0x154)]();if(!_0x13f8ad)return returnResult();return console[_0x2754bd(0x169)]('MOBI写入书籍封面缓存：',workerData[_0x2754bd(0x184)][_0x2754bd(0x185)]),coverData=Buffer[_0x2754bd(0x16a)](_0x13f8ad),returnResult();}catch(_0x489140){return console['log']('err2',_0x489140),returnResult();}}async function genBookInfoEpub(_0x55aa6c){const _0x438152=_0x2745a0;let _0x42e034=new EPub(_0x55aa6c);_0x42e034['on'](_0x438152(0x153),function(){const _0xaafc87=_0x438152;if(_0x42e034[_0xaafc87(0x167)]){let _0x25bb78=_0x42e034['metadata'];_0x25bb78[_0xaafc87(0x176)]&&(workerData[_0xaafc87(0x184)][_0xaafc87(0x17f)]=_0x25bb78[_0xaafc87(0x176)]);_0x25bb78['publisher']&&(workerData[_0xaafc87(0x184)][_0xaafc87(0x155)]=_0x25bb78[_0xaafc87(0x155)]);_0x25bb78[_0xaafc87(0x16e)]&&(workerData[_0xaafc87(0x184)][_0xaafc87(0x16e)]=_0x25bb78[_0xaafc87(0x16e)]);_0x25bb78[_0xaafc87(0x15b)]&&(workerData['indexObj']['title']=_0x25bb78[_0xaafc87(0x15b)]);_0x25bb78['book-type']&&(console[_0xaafc87(0x169)](_0xaafc87(0x158),_0x25bb78[_0xaafc87(0x158)]),_0x25bb78['book-type']=='comic'&&(workerData['indexObj']['type']=0x2));if(_0x25bb78[_0xaafc87(0x17d)])try{originalTime=new Date(_0x25bb78[_0xaafc87(0x17d)])[_0xaafc87(0x17c)]();}catch(_0x22b3bd){console[_0xaafc87(0x169)](_0x22b3bd);}workerData[_0xaafc87(0x184)]['metadata_state']=0x1;if(fs[_0xaafc87(0x181)](workerData[_0xaafc87(0x164)]))return console[_0xaafc87(0x169)]('封面缓存已经存在',workerData[_0xaafc87(0x184)][_0xaafc87(0x185)]),workerData['indexObj'][_0xaafc87(0x16f)]=workerData['bookCoverCachePath'],returnResult();_0x42e034['metadata'][_0xaafc87(0x17e)]?_0x42e034[_0xaafc87(0x183)](_0x42e034['metadata'][_0xaafc87(0x17e)],async(_0x741526,_0x2d634f,_0x2744b2)=>{const _0xdc8f29=_0xaafc87;return console[_0xdc8f29(0x169)](_0xdc8f29(0x150),workerData['bookCoverCachePath']),coverData=_0x2d634f,returnResult();}):returnResult();}else returnResult();}),_0x42e034['on']('error',()=>{const _0x529a46=_0x438152;console[_0x529a46(0x169)](_0x529a46(0x179),_0x55aa6c),returnResult();}),_0x42e034[_0x438152(0x161)]();}async function genBookInfoZip(_0x54e561){const _0x57fe13=_0x2745a0;zipUtil[_0x57fe13(0x146)](_0x54e561)['then'](_0x1f436d=>{const _0x241dc0=_0x57fe13;if(!_0x1f436d)return console['log'](_0x241dc0(0x171),_0x54e561),returnResult();let _0x328dcd=_0x1f436d['dealedBuffer'],_0xf07c54=_0x1f436d[_0x241dc0(0x14b)];_0x328dcd&&(coverData=_0x328dcd),_0xf07c54&&(workerData[_0x241dc0(0x184)][_0x241dc0(0x15f)]=_0xf07c54),returnResult();})[_0x57fe13(0x159)](_0x3aec41=>{const _0x145502=_0x57fe13;console[_0x145502(0x169)](_0x3aec41);});}if(workerData&&workerData[_0x2745a0(0x184)]&&workerData[_0x2745a0(0x164)]){let bookFullPath=path[_0x2745a0(0x151)](workerData[_0x2745a0(0x184)][_0x2745a0(0x174)],workerData[_0x2745a0(0x184)][_0x2745a0(0x185)]),lowerExt=workerData[_0x2745a0(0x184)][_0x2745a0(0x175)][_0x2745a0(0x166)]();if(fs[_0x2745a0(0x181)](bookFullPath)){if(lowerExt==_0x2745a0(0x16d))genBookInfoEpub(bookFullPath);else{if(lowerExt==_0x2745a0(0x168)||lowerExt==_0x2745a0(0x152)||lowerExt==_0x2745a0(0x173))genBookInfoMobi(bookFullPath);else lowerExt==_0x2745a0(0x145)||lowerExt==_0x2745a0(0x14f)||lowerExt==_0x2745a0(0x149)||lowerExt==_0x2745a0(0x160)?genBookInfoZip(bookFullPath):returnResult();}}else returnResult();}else console[_0x2745a0(0x169)](_0x2745a0(0x15d)),returnResult();parentPort['on'](_0x2745a0(0x17a),_0x5e9a8b=>{const _0x56aa64=_0x2745a0;console[_0x56aa64(0x17a)]('Worker\x20error:',_0x5e9a8b),returnResult();}),parentPort['on'](_0x2745a0(0x162),()=>{const _0x358d9c=_0x2745a0;console['log'](_0x358d9c(0x14a));});