function _0x577a(){const _0x5b0740=['exit','postMessage','epub','language','metadata','cover','../../utils/zipUtil','mobi','8720943PQHWSj','metadata_state','close','.azw3','Worker\x20error:','epub解析失败','coverPath','from','creator','log','没有找到需要处理的书籍目录','getTime','path','toLowerCase','bookCoverCachePath','fileCount','未找到封面','readFileSync','then','join','book-type','unzlibSync','324712maAmSD','getZipCover','date','onlyGenCover','.mobi','144588tYhMwc','total_page','getCover','MOBI写入书籍封面缓存：','.cbz','error','.epub','54VlZcbP','35405960uiqDkn','680614lZycCz','existsSync','parse','indexObj','filename','catch','.cbr','4236070oaKfyt','title','artist','ext','Worker\x20stopped.','err2','736650nRjQIU','comic','open'];_0x577a=function(){return _0x5b0740;};return _0x577a();}const _0x3866dd=_0x1567;(function(_0x2b86ba,_0xb4f81f){const _0x5f1908=_0x1567,_0x19f3be=_0x2b86ba();while(!![]){try{const _0x3c4f73=-parseInt(_0x5f1908(0xd1))/0x1+-parseInt(_0x5f1908(0xc3))/0x2+-parseInt(_0x5f1908(0xcf))/0x3*(parseInt(_0x5f1908(0xc8))/0x4)+-parseInt(_0x5f1908(0xd8))/0x5+-parseInt(_0x5f1908(0xde))/0x6+-parseInt(_0x5f1908(0xe9))/0x7+parseInt(_0x5f1908(0xd0))/0x8;if(_0x3c4f73===_0xb4f81f)break;else _0x19f3be['push'](_0x19f3be['shift']());}catch(_0x661320){_0x19f3be['push'](_0x19f3be['shift']());}}}(_0x577a,0xaee03));const {parentPort,workerData}=require('worker_threads'),EPub=require(_0x3866dd(0xe3)),mobiNode=require('./bookMobiNode'),mobiJs=require(_0x3866dd(0xe8)),fflate=require('./bookFflate'),fs=require('fs'),path=require(_0x3866dd(0xb9));function _0x1567(_0x16c784,_0x511a8b){const _0x577adb=_0x577a();return _0x1567=function(_0x15671e,_0x3c49c0){_0x15671e=_0x15671e-0xb9;let _0x45cf9c=_0x577adb[_0x15671e];return _0x45cf9c;},_0x1567(_0x16c784,_0x511a8b);}let originalTime=null,coverData=null,zipUtil=require(_0x3866dd(0xe7));function returnResult(){const _0xd4b86d=_0x3866dd;parentPort[_0xd4b86d(0xe2)]({'code':0x0,'indexObj':workerData[_0xd4b86d(0xd4)],'originalTime':originalTime,'coverData':coverData}),process[_0xd4b86d(0xe1)](0x0);}async function genBookInfoMobi(_0x18dc83){const _0x8e0b2b=_0x3866dd;if(!workerData[_0x8e0b2b(0xc6)])try{let _0x200a3e=new mobiJs(_0x18dc83);_0x200a3e[_0x8e0b2b(0xd9)]&&(workerData[_0x8e0b2b(0xd4)]['title']=_0x200a3e[_0x8e0b2b(0xd9)]),workerData[_0x8e0b2b(0xd4)]['metadata_state']=0x1;}catch(_0x5a2226){}try{if(fs[_0x8e0b2b(0xd2)](workerData[_0x8e0b2b(0xbb)]))return console[_0x8e0b2b(0xf2)]('封面缓存已经存在',workerData[_0x8e0b2b(0xd4)][_0x8e0b2b(0xd5)]),workerData[_0x8e0b2b(0xd4)][_0x8e0b2b(0xef)]=workerData[_0x8e0b2b(0xbb)],returnResult();let _0x583c80=fs[_0x8e0b2b(0xbe)](_0x18dc83),_0x7b28d1=await new mobiNode['MOBI']({'unzlib':fflate[_0x8e0b2b(0xc2)]})[_0x8e0b2b(0xe0)](new Uint8Array(_0x583c80)),_0x39d346=await _0x7b28d1[_0x8e0b2b(0xca)]();if(!_0x39d346)return returnResult();return console[_0x8e0b2b(0xf2)](_0x8e0b2b(0xcb),workerData[_0x8e0b2b(0xd4)]['filename']),coverData=Buffer[_0x8e0b2b(0xf0)](_0x39d346),returnResult();}catch(_0x4a466c){return console[_0x8e0b2b(0xf2)](_0x8e0b2b(0xdd),_0x4a466c),returnResult();}}async function genBookInfoEpub(_0x5c4d05){const _0x574d64=_0x3866dd;let _0x3e80bc=new EPub(_0x5c4d05);_0x3e80bc['on']('end',function(){const _0x2825d5=_0x1567;if(_0x3e80bc['metadata']){let _0x1a505f=_0x3e80bc[_0x2825d5(0xe5)];_0x1a505f[_0x2825d5(0xf1)]&&(workerData[_0x2825d5(0xd4)][_0x2825d5(0xda)]=_0x1a505f['creator']);_0x1a505f['publisher']&&(workerData[_0x2825d5(0xd4)]['publisher']=_0x1a505f['publisher']);_0x1a505f['language']&&(workerData[_0x2825d5(0xd4)][_0x2825d5(0xe4)]=_0x1a505f[_0x2825d5(0xe4)]);_0x1a505f['title']&&(workerData[_0x2825d5(0xd4)][_0x2825d5(0xd9)]=_0x1a505f[_0x2825d5(0xd9)]);_0x1a505f[_0x2825d5(0xc1)]&&(console[_0x2825d5(0xf2)](_0x2825d5(0xc1),_0x1a505f[_0x2825d5(0xc1)]),_0x1a505f[_0x2825d5(0xc1)]==_0x2825d5(0xdf)&&(workerData['indexObj']['type']=0x2));if(_0x1a505f[_0x2825d5(0xc5)])try{originalTime=new Date(_0x1a505f[_0x2825d5(0xc5)])[_0x2825d5(0xf4)]();}catch(_0x4ebfe3){console[_0x2825d5(0xf2)](_0x4ebfe3);}workerData[_0x2825d5(0xd4)][_0x2825d5(0xea)]=0x1;if(fs['existsSync'](workerData[_0x2825d5(0xbb)]))return console[_0x2825d5(0xf2)]('封面缓存已经存在',workerData[_0x2825d5(0xd4)][_0x2825d5(0xd5)]),workerData[_0x2825d5(0xd4)][_0x2825d5(0xef)]=workerData[_0x2825d5(0xbb)],returnResult();_0x3e80bc['metadata'][_0x2825d5(0xe6)]?_0x3e80bc['getImage'](_0x3e80bc[_0x2825d5(0xe5)][_0x2825d5(0xe6)],async(_0x81ede9,_0x627ce5,_0x2ffc56)=>{const _0x50013b=_0x2825d5;return console[_0x50013b(0xf2)]('EPUB写入书籍封面缓存：',workerData[_0x50013b(0xbb)]),coverData=_0x627ce5,returnResult();}):returnResult();}else returnResult();}),_0x3e80bc['on'](_0x574d64(0xcd),()=>{const _0x3ff2ba=_0x574d64;console['log'](_0x3ff2ba(0xee),_0x5c4d05),returnResult();}),_0x3e80bc[_0x574d64(0xd3)]();}async function genBookInfoZip(_0x5c790e){const _0x46bf29=_0x3866dd;zipUtil[_0x46bf29(0xc4)](_0x5c790e)[_0x46bf29(0xbf)](_0x1cc9c8=>{const _0x149aa6=_0x46bf29;if(!_0x1cc9c8)return console['log'](_0x149aa6(0xbd),_0x5c790e),returnResult();let _0x285bc5=_0x1cc9c8['dealedBuffer'],_0x34fa68=_0x1cc9c8[_0x149aa6(0xbc)];_0x285bc5&&(coverData=_0x285bc5),_0x34fa68&&(workerData['indexObj'][_0x149aa6(0xc9)]=_0x34fa68),returnResult();})[_0x46bf29(0xd6)](_0x580754=>{const _0x3a0138=_0x46bf29;console[_0x3a0138(0xf2)](_0x580754);});}if(workerData&&workerData[_0x3866dd(0xd4)]&&workerData[_0x3866dd(0xbb)]){let bookFullPath=path[_0x3866dd(0xc0)](workerData[_0x3866dd(0xd4)][_0x3866dd(0xb9)],workerData['indexObj'][_0x3866dd(0xd5)]),lowerExt=workerData[_0x3866dd(0xd4)][_0x3866dd(0xdb)][_0x3866dd(0xba)]();if(fs[_0x3866dd(0xd2)](bookFullPath)){if(lowerExt==_0x3866dd(0xce))genBookInfoEpub(bookFullPath);else{if(lowerExt==_0x3866dd(0xc7)||lowerExt==_0x3866dd(0xec)||lowerExt=='.azw')genBookInfoMobi(bookFullPath);else lowerExt==_0x3866dd(0xcc)||lowerExt=='.zip'||lowerExt==_0x3866dd(0xd7)||lowerExt=='.rar'?genBookInfoZip(bookFullPath):returnResult();}}else returnResult();}else console['log'](_0x3866dd(0xf3)),returnResult();parentPort['on']('error',_0x56a87e=>{const _0x4a88a1=_0x3866dd;console[_0x4a88a1(0xcd)](_0x4a88a1(0xed),_0x56a87e),returnResult();}),parentPort['on'](_0x3866dd(0xeb),()=>{const _0x470939=_0x3866dd;console[_0x470939(0xf2)](_0x470939(0xdc));});