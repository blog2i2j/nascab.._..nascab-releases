const _0xdaa158=_0x5bdc;function _0x5bdc(_0x27eef6,_0x31fcde){const _0x28abe5=_0x28ab();return _0x5bdc=function(_0x5bdcd7,_0x1e9c3d){_0x5bdcd7=_0x5bdcd7-0x171;let _0x299285=_0x28abe5[_0x5bdcd7];return _0x299285;},_0x5bdc(_0x27eef6,_0x31fcde);}(function(_0x3ca928,_0x2e7d72){const _0x12e8d5=_0x5bdc,_0x3bc156=_0x3ca928();while(!![]){try{const _0x2c123e=-parseInt(_0x12e8d5(0x1c5))/0x1*(-parseInt(_0x12e8d5(0x18a))/0x2)+parseInt(_0x12e8d5(0x1a1))/0x3+parseInt(_0x12e8d5(0x1ae))/0x4+parseInt(_0x12e8d5(0x198))/0x5*(-parseInt(_0x12e8d5(0x172))/0x6)+parseInt(_0x12e8d5(0x199))/0x7*(parseInt(_0x12e8d5(0x19e))/0x8)+parseInt(_0x12e8d5(0x19b))/0x9+parseInt(_0x12e8d5(0x1ab))/0xa*(-parseInt(_0x12e8d5(0x1c2))/0xb);if(_0x2c123e===_0x2e7d72)break;else _0x3bc156['push'](_0x3bc156['shift']());}catch(_0x3307fd){_0x3bc156['push'](_0x3bc156['shift']());}}}(_0x28ab,0xc8c87));const path=require(_0xdaa158(0x17c)),fs=require('fs'),dbFileIndexTable=require(_0xdaa158(0x186)),config=require(_0xdaa158(0x1af)),videoStreamUtil=require(_0xdaa158(0x176)),indexUtil=require(_0xdaa158(0x196));let musicUtils=require(_0xdaa158(0x1a5));const indexTableName=dbFileIndexTable['INDEX_TABLE_NAME_MUSIC'],musicIndexUtil={},sharpUtil=require(_0xdaa158(0x1ac));let jsmediatags=require(_0xdaa158(0x1ca)),musicTypeList=config[_0xdaa158(0x1b4)];function _0x28ab(){const _0x4e1fc=['ceil','APIC','11961024OXSDhO','getDurationFromStream','original_time','2479239NzwnFq','ctimeMs','lyrics','year','../../utils/musicUtil','mtimeMs','lastInsertRowid','data','addFileIndexToDb','basename','6652630rWIdrQ','../../express-server/utils/sharpUtils','dealFirstLetterSingle','3329264qYuBmk','../../myConfig/config','stream_info','Nan','birthtimeMs','tags','musicTypeList','getFullYear','length','coverPath','dealFileChange','NaN','toLowerCase','addFinalIndexToDB','writeFile','string','Null','transStringToUtf8','title','TPE1','88ArQKWL','music','atimeMs','2EqMQoq','genre','addOriginalDate','is_file','artist','jsmediatags','includes','14898UGkvRo','ctime','fileCoverPath','log','../../utils/videoStreamUtil','dealMediaInfo','type','getTime','temp.','streams','path','format','stringify','getDate','size','image','TIT2','getMediaCoverCachePath','dirname','extname','../../db/dbFileIndexTable','getMusicSameNameCover','description','exports','1513124kCsFFX','picture','join','base64','album','duration','performer','TYER','genTinyFile','recursionFilesAddIndex','read','parseAudioTags','./indexUtil','ffprobeSync','195cvWjRD','7KPzYFw','ext','14169303KgTaEh'];_0x28ab=function(){return _0x4e1fc;};return _0x28ab();}musicIndexUtil[_0xdaa158(0x1b8)]=async function(_0xadfecb,_0x64d972,_0x5abac7){const _0x33cd40=_0xdaa158;await indexUtil['dealFileChange'](_0xadfecb,_0x64d972,_0x5abac7,indexTableName,musicIndexUtil[_0x33cd40(0x1a9)],musicIndexUtil['recursionFilesAddIndex']);return;},musicIndexUtil['recursionFilesAddIndex']=async function(_0x2d96ec,_0x308f38,_0x1ab17c){const _0x3f2e2f=_0xdaa158;return await indexUtil[_0x3f2e2f(0x193)](_0x2d96ec,_0x308f38,indexTableName,_0x3f2e2f(0x1c3),_0x1ab17c,musicIndexUtil['addFileIndexToDb']);},musicIndexUtil[_0xdaa158(0x1a9)]=async function(_0x52078a,_0x49e59a,_0x4f12bd,_0x5d54c1,_0x11d035,_0x17b165){const _0x1a0604=_0xdaa158;let _0x295c54=indexUtil['doesPathCanAddToDb'](_0x52078a,_0x1a0604(0x1c3),config,_0x4f12bd,_0x5d54c1);if(!_0x295c54)return;let _0xf6cc2e=_0x17b165[_0x1a0604(0x1b2)];_0x17b165[_0x1a0604(0x1a6)]<_0xf6cc2e&&(_0xf6cc2e=_0x17b165[_0x1a0604(0x1a6)]);_0x17b165[_0x1a0604(0x1c4)]<_0xf6cc2e&&(_0xf6cc2e=_0x17b165['atimeMs']);_0x17b165[_0x1a0604(0x1a2)]<_0xf6cc2e&&(_0xf6cc2e=_0x17b165[_0x1a0604(0x1a2)]);let _0x481127={'path':_0x4f12bd,'filename':_0x5d54c1,'is_file':_0x11d035,'ctime':_0x17b165[_0x1a0604(0x1a2)],'mtime':_0x17b165['mtimeMs'],'ext':path[_0x1a0604(0x185)](_0x5d54c1),'birthtime':Math[_0x1a0604(0x19c)](_0xf6cc2e),'size':_0x17b165[_0x1a0604(0x180)],'check_time':new Date()['getTime']()};_0x481127=await musicIndexUtil[_0x1a0604(0x177)](_0x49e59a,_0x481127);},musicIndexUtil[_0xdaa158(0x177)]=async function(_0x3f1592,_0x401ad2){const _0x2dc266=_0xdaa158;let _0x3f80ce=![],_0x4c2424=path[_0x2dc266(0x18c)](_0x401ad2[_0x2dc266(0x17c)],_0x401ad2['filename']);if(_0x401ad2['is_file']==0x1&&_0x401ad2[_0x2dc266(0x19a)]&&musicTypeList[_0x2dc266(0x171)](_0x401ad2[_0x2dc266(0x19a)][_0x2dc266(0x1ba)]())){_0x401ad2[_0x2dc266(0x178)]=0x3;try{let _0x1ba273=await indexUtil[_0x2dc266(0x197)](_0x4c2424);if(_0x1ba273&&_0x1ba273[_0x2dc266(0x17b)]&&_0x1ba273[_0x2dc266(0x17b)][_0x2dc266(0x1b6)]>0x0){_0x401ad2[_0x2dc266(0x1b0)]=JSON[_0x2dc266(0x17e)](_0x1ba273[_0x2dc266(0x17b)]);let _0x1b5027=videoStreamUtil[_0x2dc266(0x19f)](_0x1ba273);_0x1b5027&&(_0x401ad2[_0x2dc266(0x18f)]=_0x1b5027);}if(_0x1ba273&&_0x1ba273[_0x2dc266(0x17d)]&&_0x1ba273[_0x2dc266(0x17d)]['tags']){let _0x5bf9a9=_0x1ba273[_0x2dc266(0x17d)][_0x2dc266(0x1b3)][_0x2dc266(0x18e)];_0x5bf9a9&&(_0x401ad2['album']=_0x5bf9a9),_0x1ba273[_0x2dc266(0x17d)]['duration']&&!_0x401ad2[_0x2dc266(0x18f)]&&(_0x401ad2[_0x2dc266(0x18f)]=_0x1ba273[_0x2dc266(0x17d)]['duration']);}musicIndexUtil['parseAudioTags'](_0x4c2424,_0x401ad2,_0x239a28=>{const _0x38f51b=_0x2dc266;return _0x239a28[_0x38f51b(0x18e)]&&(_0x239a28[_0x38f51b(0x18e)]=musicUtils[_0x38f51b(0x1bf)](_0x239a28[_0x38f51b(0x18e)])),_0x239a28['artist']&&(_0x239a28[_0x38f51b(0x1c9)]=musicUtils[_0x38f51b(0x1bf)](_0x239a28[_0x38f51b(0x1c9)])),_0x239a28['title']&&(_0x239a28['title']=musicUtils['transStringToUtf8'](_0x239a28[_0x38f51b(0x1c0)])),_0x239a28[_0x38f51b(0x1a3)]&&(_0x239a28[_0x38f51b(0x1a3)]=musicUtils[_0x38f51b(0x1bf)](_0x239a28[_0x38f51b(0x1a3)])),musicIndexUtil[_0x38f51b(0x1c7)](_0x3f1592,_0x3f80ce,_0x239a28);});}catch(_0x274846){return console['log'](_0x274846),musicIndexUtil[_0x2dc266(0x1c7)](_0x3f1592,_0x3f80ce,_0x401ad2);}}else{if(_0x401ad2[_0x2dc266(0x1c8)]==0x1)return;return musicIndexUtil[_0x2dc266(0x1c7)](_0x3f1592,_0x3f80ce,_0x401ad2);}},musicIndexUtil[_0xdaa158(0x1c7)]=function(_0x55402d,_0x45b0e9,_0x57dbac){const _0x5ec0e7=_0xdaa158;_0x45b0e9&&_0x45b0e9<config['exifMinTimeStamp']&&(_0x45b0e9=![]);(!_0x45b0e9||_0x45b0e9=='NaN'||_0x45b0e9==_0x5ec0e7(0x1b1)||_0x45b0e9==_0x5ec0e7(0x1b9)||_0x45b0e9==_0x5ec0e7(0x1be))&&(_0x45b0e9=_0x57dbac['birthtime']||_0x57dbac[_0x5ec0e7(0x173)]);let _0x328420=new Date(_0x45b0e9);_0x57dbac[_0x5ec0e7(0x1a0)]=_0x328420[_0x5ec0e7(0x179)]();let _0x32c548=_0x328420[_0x5ec0e7(0x1b5)](),_0x3fa3ff=_0x328420['getMonth']()+0x1;_0x3fa3ff=_0x3fa3ff>=0xa?_0x3fa3ff:'0'+_0x3fa3ff;let _0x4d1cd8=_0x328420[_0x5ec0e7(0x17f)]();_0x4d1cd8=_0x4d1cd8>=0xa?_0x4d1cd8:'0'+_0x4d1cd8,_0x57dbac['original_date']=_0x32c548+'-'+_0x3fa3ff+'-'+_0x4d1cd8,musicIndexUtil[_0x5ec0e7(0x1bb)](_0x55402d,_0x57dbac);},musicIndexUtil[_0xdaa158(0x1bb)]=function(_0x302a50,_0x2c9ba9){const _0x1fe59a=_0xdaa158;!_0x2c9ba9[_0x1fe59a(0x18e)]&&(_0x2c9ba9[_0x1fe59a(0x18e)]=path[_0x1fe59a(0x1aa)](_0x2c9ba9['path']));let _0x2e45af=musicUtils[_0x1fe59a(0x187)](_0x302a50,_0x2c9ba9);_0x2c9ba9[_0x1fe59a(0x174)]=_0x2e45af?_0x2e45af:'';let _0x2be290=dbFileIndexTable['create'](_0x302a50,_0x2c9ba9,indexTableName);if(_0x2be290&&_0x2be290[_0x1fe59a(0x1a7)]){let _0x53eac1=dbFileIndexTable['getById'](_0x302a50,_0x2be290[_0x1fe59a(0x1a7)],dbFileIndexTable['INDEX_TABLE_NAME_MUSIC']);_0x53eac1&&musicUtils[_0x1fe59a(0x1ad)](_0x302a50,_0x53eac1);}},musicIndexUtil[_0xdaa158(0x195)]=function(_0x37919d,_0x53525e,_0x2013d3){const _0x2eeb95=_0xdaa158;function _0x2f0719(_0x597260,_0x4b539f,_0x7253f6,_0x1ca496,_0x5964bf){const _0xd3b841=_0x5bdc;try{!_0x53525e[_0x4b539f]&&(_0x597260[_0x7253f6]&&typeof _0x597260[_0x7253f6]==_0xd3b841(0x1bd)&&(_0x53525e[_0x7253f6]=_0x597260[_0x7253f6]),!_0x53525e[_0x4b539f]&&_0x1ca496&&_0x597260[_0x1ca496]&&_0x597260[_0x1ca496][_0xd3b841(0x1a8)]&&typeof _0x597260[_0x1ca496][_0xd3b841(0x1a8)]==_0xd3b841(0x1bd)&&_0x597260[_0x1ca496]['description']&&typeof _0x597260[_0x1ca496][_0xd3b841(0x188)]==_0xd3b841(0x1bd)&&_0x597260[_0x1ca496][_0xd3b841(0x188)]['toLowerCase']()['indexOf'](_0x5964bf)!=-0x1&&(_0x53525e[_0x4b539f]=_0x597260[_0x1ca496][_0xd3b841(0x1a8)]));}catch(_0x1c32e5){console[_0xd3b841(0x175)](_0x1c32e5);}}jsmediatags[_0x2eeb95(0x194)](_0x37919d,{'onSuccess':function(_0x4a0fce){const _0x19fe1b=_0x2eeb95;let _0x2dab15=_0x4a0fce['tags'];_0x2f0719(_0x2dab15,_0x19fe1b(0x18e),_0x19fe1b(0x18e),'TALB',_0x19fe1b(0x18e)),_0x2f0719(_0x2dab15,_0x19fe1b(0x1c0),_0x19fe1b(0x1c0),_0x19fe1b(0x182),_0x19fe1b(0x1c0)),_0x2f0719(_0x2dab15,_0x19fe1b(0x1c9),_0x19fe1b(0x1c9),_0x19fe1b(0x1c1),_0x19fe1b(0x190)),_0x2f0719(_0x2dab15,_0x19fe1b(0x1a4),_0x19fe1b(0x1a4),'TYER',_0x19fe1b(0x1a4)),_0x2f0719(_0x2dab15,_0x19fe1b(0x1c6),_0x19fe1b(0x1c6),_0x19fe1b(0x191),'content\x20type');try{_0x2dab15[_0x19fe1b(0x1a3)]&&(_0x2dab15[_0x19fe1b(0x1a3)]=JSON[_0x19fe1b(0x17e)](_0x2dab15[_0x19fe1b(0x1a3)])),_0x2f0719(_0x2dab15,'lyrics','lyrics','','');}catch(_0x186b70){console[_0x19fe1b(0x175)](_0x186b70);}var _0x50592e;_0x2dab15[_0x19fe1b(0x18b)]&&_0x2dab15[_0x19fe1b(0x18b)]['data']&&(_0x50592e=_0x2dab15[_0x19fe1b(0x18b)][_0x19fe1b(0x1a8)]);!_0x50592e&&_0x2dab15[_0x19fe1b(0x19d)]&&_0x2dab15[_0x19fe1b(0x19d)][_0x19fe1b(0x1a8)]&&_0x2dab15[_0x19fe1b(0x19d)][_0x19fe1b(0x1a8)][_0x19fe1b(0x1a8)]&&(_0x50592e=_0x2dab15[_0x19fe1b(0x19d)]['data']['data']);let _0x13de1a='';if(_0x50592e){let _0x1fab4f=0x200;_0x13de1a=config[_0x19fe1b(0x183)](_0x53525e,_0x1fab4f);let _0x2e9641=path['join'](path[_0x19fe1b(0x184)](_0x13de1a),_0x19fe1b(0x17a)+path['basename'](_0x13de1a));fs[_0x19fe1b(0x1bc)](_0x2e9641,Buffer['from'](_0x50592e),{'encoding':_0x19fe1b(0x18d)},function(_0x118723){const _0x19f9ba=_0x19fe1b;_0x118723?console[_0x19f9ba(0x175)](_0x118723):sharpUtil[_0x19f9ba(0x192)](_0x2e9641,path[_0x19f9ba(0x184)](_0x13de1a),path[_0x19f9ba(0x1aa)](_0x13de1a),_0x19f9ba(0x181),null,_0x3abe7d=>{const _0x2abcd7=_0x19f9ba;_0x53525e[_0x2abcd7(0x1b7)]=_0x13de1a,fs['rm'](_0x2e9641,_0x5907f5=>{}),_0x2013d3(_0x53525e);},_0x34aaf6=>{_0x2013d3(_0x53525e);},_0x1fab4f);});}else _0x2013d3(_0x53525e);},'onError':function(_0x56ffd8){const _0x214085=_0x2eeb95;console[_0x214085(0x175)](_0x56ffd8),_0x2013d3(_0x53525e);}});},module[_0xdaa158(0x189)]=musicIndexUtil;