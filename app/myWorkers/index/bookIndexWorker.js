const _0x1cad07=_0x2fbe;(function(_0x577008,_0x4129e3){const _0x2e17ca=_0x2fbe,_0x1f1adc=_0x577008();while(!![]){try{const _0x590337=parseInt(_0x2e17ca(0x207))/0x1*(parseInt(_0x2e17ca(0x1f3))/0x2)+-parseInt(_0x2e17ca(0x210))/0x3*(parseInt(_0x2e17ca(0x20d))/0x4)+parseInt(_0x2e17ca(0x1ee))/0x5+parseInt(_0x2e17ca(0x201))/0x6+parseInt(_0x2e17ca(0x208))/0x7+parseInt(_0x2e17ca(0x1f2))/0x8*(parseInt(_0x2e17ca(0x219))/0x9)+-parseInt(_0x2e17ca(0x218))/0xa;if(_0x590337===_0x4129e3)break;else _0x1f1adc['push'](_0x1f1adc['shift']());}catch(_0x58a5ae){_0x1f1adc['push'](_0x1f1adc['shift']());}}}(_0x12c4,0x9e88e));const fs=require('fs'),path=require(_0x1cad07(0x20a)),config=require(_0x1cad07(0x202)),Database=require(_0x1cad07(0x1fd)),dbOther=new Database(config[_0x1cad07(0x212)],{}),dbFileIndex=new Database(config[_0x1cad07(0x206)],{});dbFileIndex['pragma']('journal_mode\x20=\x20WAL'),dbOther['pragma'](_0x1cad07(0x21a));const dbFileIndexTable=require('../../db/dbFileIndexTable');process[_0x1cad07(0x1f7)]=_0x1cad07(0x1ff);const bookIndexUtil=require(_0x1cad07(0x215)),indexTableName=dbFileIndexTable[_0x1cad07(0x1f4)],dbScanTaskTable=require(_0x1cad07(0x1fa)),indexUtil=require(_0x1cad07(0x203));process['on'](_0x1cad07(0x1fe),(_0x110b4d,_0x340f39)=>{const _0x255ad7=_0x1cad07;console[_0x255ad7(0x1f6)]('Error\x20occurred\x20',_0x110b4d);});async function startIndexingFolder(_0x3bd49e){return new Promise(async(_0x3744d4,_0x379fa1)=>{const _0x4dbfd8=_0x2fbe;try{let _0x5df695=new Date()[_0x4dbfd8(0x1fb)](),_0x50061e=fs['statSync'](_0x3bd49e);if(!_0x50061e[_0x4dbfd8(0x20c)]())return console[_0x4dbfd8(0x1f6)](_0x4dbfd8(0x20b),_0x3bd49e),_0x3744d4();console[_0x4dbfd8(0x1f6)](_0x4dbfd8(0x211),_0x3bd49e),await indexUtil[_0x4dbfd8(0x216)](dbFileIndex,indexTableName,_0x3bd49e);let {checkFileCount:_0x1b1af0,checkPathCount:_0xa6527b}=await bookIndexUtil[_0x4dbfd8(0x214)](dbOther,dbFileIndex,_0x3bd49e);console[_0x4dbfd8(0x1f6)](_0x4dbfd8(0x20e)+_0x3bd49e,_0x4dbfd8(0x1f1),new Date()[_0x4dbfd8(0x1fb)]()-_0x5df695,'ms',_0x4dbfd8(0x1f8),_0xa6527b,_0x4dbfd8(0x1f9),_0x1b1af0),_0x3744d4();}catch(_0x3f97c1){console[_0x4dbfd8(0x1f6)](_0x4dbfd8(0x200),_0x3bd49e),_0x3744d4();}});}async function runScanTask(){const _0x4d6e03=_0x1cad07;let _0x3d2c5d=dbScanTaskTable[_0x4d6e03(0x20f)](dbOther,dbScanTaskTable['SCAN_TYPE_BOOK']);_0x3d2c5d?(dbOther[_0x4d6e03(0x205)](_0x4d6e03(0x1fc))[_0x4d6e03(0x204)](Date[_0x4d6e03(0x1ef)](),_0x3d2c5d['scan_path']),startIndexingFolder(_0x3d2c5d[_0x4d6e03(0x217)])[_0x4d6e03(0x1f0)](()=>{dbScanTaskTable['deleteTask'](dbOther,_0x3d2c5d['id']),runScanTask();})):(console[_0x4d6e03(0x1f6)](_0x4d6e03(0x1f5)),indexUtil['setIndexingState'](dbOther,indexTableName,![]),process[_0x4d6e03(0x213)]());}function _0x2fbe(_0x15c1c2,_0x4cf05c){const _0x12c492=_0x12c4();return _0x2fbe=function(_0x2fbe7f,_0x42d84b){_0x2fbe7f=_0x2fbe7f-0x1ee;let _0x5b5619=_0x12c492[_0x2fbe7f];return _0x5b5619;},_0x2fbe(_0x15c1c2,_0x4cf05c);}function _0x12c4(){const _0x262ad5=['耗时:','5075320hbzfQK','4dHogBD','INDEX_TABLE_NAME_BOOK','图书管理:未找到扫描任务[Books\x20scanning\x20task\x20not\x20found]','log','title','文件夹数量','文件数量','../../db/dbScanTaskTable','getTime','UPDATE\x20source_folder\x20SET\x20last_scan_time=?\x20\x20WHERE\x20path=?\x20and\x20type=\x27book\x27','better-sqlite3','uncaughtException','NasCabBookIndexWorker','扫描目录已不存在\x20','528144wjCdNN','../../myConfig/config','./indexUtil','run','prepare','dbFileIndex','495056JjpxIH','6821045bSgUOM','setIndexingState','path','要扫描的目录不是文件夹','isDirectory','248188MhvqYT','图书管理：扫描完成：','getOnTask','18fezLAR','图书管理:\x20开始扫描','dbOther','exit','recursionFilesAddIndex','./bookIndexUtil','recursionDeleteIndex','scan_path','25215200AeFiRg','9dzsEQC','journal_mode\x20=\x20WAL','4280870wAGQPU','now','then'];_0x12c4=function(){return _0x262ad5;};return _0x12c4();}indexUtil[_0x1cad07(0x209)](dbOther,indexTableName,!![]),runScanTask();