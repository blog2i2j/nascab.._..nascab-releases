const _0x3a24c7=_0x5eb1;(function(_0x402395,_0x286ba8){const _0x360a5c=_0x5eb1,_0x20f898=_0x402395();while(!![]){try{const _0xfd15cd=-parseInt(_0x360a5c(0x16d))/0x1*(-parseInt(_0x360a5c(0x17a))/0x2)+-parseInt(_0x360a5c(0x17d))/0x3*(-parseInt(_0x360a5c(0x166))/0x4)+parseInt(_0x360a5c(0x184))/0x5+parseInt(_0x360a5c(0x183))/0x6*(parseInt(_0x360a5c(0x188))/0x7)+parseInt(_0x360a5c(0x16b))/0x8*(parseInt(_0x360a5c(0x168))/0x9)+-parseInt(_0x360a5c(0x182))/0xa+parseInt(_0x360a5c(0x169))/0xb*(-parseInt(_0x360a5c(0x16a))/0xc);if(_0xfd15cd===_0x286ba8)break;else _0x20f898['push'](_0x20f898['shift']());}catch(_0x3b0e67){_0x20f898['push'](_0x20f898['shift']());}}}(_0x1b57,0xc34a2));const fs=require('fs'),path=require(_0x3a24c7(0x174)),config=require(_0x3a24c7(0x163)),Database=require(_0x3a24c7(0x171)),dbOther=new Database(config[_0x3a24c7(0x162)],{}),dbFileIndex=new Database(config['dbFileIndex'],{});dbFileIndex[_0x3a24c7(0x185)](_0x3a24c7(0x189)),dbOther[_0x3a24c7(0x185)](_0x3a24c7(0x189));const dbFileIndexTable=require(_0x3a24c7(0x178));process['title']=_0x3a24c7(0x18a);const bookIndexUtil=require(_0x3a24c7(0x17e)),indexTableName=dbFileIndexTable[_0x3a24c7(0x186)],dbScanTaskTable=require(_0x3a24c7(0x180)),indexUtil=require('./indexUtil');function _0x5eb1(_0xd12a46,_0x16da8f){const _0x1b57d1=_0x1b57();return _0x5eb1=function(_0x5eb1f9,_0x4a9022){_0x5eb1f9=_0x5eb1f9-0x162;let _0x53e910=_0x1b57d1[_0x5eb1f9];return _0x53e910;},_0x5eb1(_0xd12a46,_0x16da8f);}process['on'](_0x3a24c7(0x16e),(_0x418ebc,_0x53613e)=>{const _0x219aa6=_0x3a24c7;console[_0x219aa6(0x181)](_0x219aa6(0x165),_0x418ebc);});async function startIndexingFolder(_0x2f68e9){return new Promise(async(_0x3ff3a6,_0x3342d1)=>{const _0x511d67=_0x5eb1;try{let _0x3ebd9f=new Date()[_0x511d67(0x17b)](),_0x2fbfde=fs[_0x511d67(0x179)](_0x2f68e9);if(!_0x2fbfde[_0x511d67(0x17f)]())return console[_0x511d67(0x181)]('要扫描的目录不是文件夹',_0x2f68e9),_0x3ff3a6();console[_0x511d67(0x181)]('图书管理:\x20开始扫描',_0x2f68e9),await indexUtil['recursionDeleteIndex'](dbFileIndex,indexTableName,_0x2f68e9);let {checkFileCount:_0xb1291f,checkPathCount:_0x8a1447}=await bookIndexUtil[_0x511d67(0x187)](dbOther,dbFileIndex,_0x2f68e9);console[_0x511d67(0x181)](_0x511d67(0x16c)+_0x2f68e9,_0x511d67(0x17c),new Date()[_0x511d67(0x17b)]()-_0x3ebd9f,'ms','文件夹数量',_0x8a1447,'文件数量',_0xb1291f),_0x3ff3a6();}catch(_0xf5e747){console['log'](_0x511d67(0x175),_0x2f68e9),_0x3ff3a6();}});}async function runScanTask(){const _0x1b6c68=_0x3a24c7;let _0x15c9bb=dbScanTaskTable[_0x1b6c68(0x172)](dbOther,dbScanTaskTable[_0x1b6c68(0x173)]);_0x15c9bb?(dbOther[_0x1b6c68(0x170)](_0x1b6c68(0x164))[_0x1b6c68(0x16f)](Date[_0x1b6c68(0x167)](),_0x15c9bb[_0x1b6c68(0x176)]),startIndexingFolder(_0x15c9bb[_0x1b6c68(0x176)])['then'](()=>{dbScanTaskTable['deleteTask'](dbOther,_0x15c9bb['id']),runScanTask();})):(console[_0x1b6c68(0x181)](_0x1b6c68(0x177)),indexUtil['setIndexingState'](dbOther,indexTableName,![]),process['exit']());}indexUtil['setIndexingState'](dbOther,indexTableName,!![]),runScanTask();function _0x1b57(){const _0x1d14c8=['211173cqBdQU','./bookIndexUtil','isDirectory','../../db/dbScanTaskTable','log','2221960DrnMDZ','1147704hAzbLj','3995615IWJHrD','pragma','INDEX_TABLE_NAME_BOOK','recursionFilesAddIndex','7vyNFqL','journal_mode\x20=\x20WAL','NasCabBookIndexWorker','dbOther','../../myConfig/config','UPDATE\x20source_folder\x20SET\x20last_scan_time=?\x20\x20WHERE\x20path=?\x20and\x20type=\x27book\x27','Error\x20occurred\x20','84DtMHny','now','63cypjjv','3718QBNmmL','128436OQmSRJ','1659656bJlkTk','图书管理：扫描完成：','239633UyRQxr','uncaughtException','run','prepare','better-sqlite3','getOnTask','SCAN_TYPE_BOOK','path','扫描目录已不存在\x20','scan_path','图书管理:未找到扫描任务[Books\x20scanning\x20task\x20not\x20found]','../../db/dbFileIndexTable','statSync','6GkfRWn','getTime','耗时:'];_0x1b57=function(){return _0x1d14c8;};return _0x1b57();}