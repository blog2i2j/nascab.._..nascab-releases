const _0x293f4e=_0x3c20;(function(_0x3f8a04,_0x10e28c){const _0x5bbac8=_0x3c20,_0x1ef5bd=_0x3f8a04();while(!![]){try{const _0x3eaeb4=-parseInt(_0x5bbac8(0x10d))/0x1+-parseInt(_0x5bbac8(0x11f))/0x2+-parseInt(_0x5bbac8(0xec))/0x3*(parseInt(_0x5bbac8(0x10b))/0x4)+-parseInt(_0x5bbac8(0xd6))/0x5+parseInt(_0x5bbac8(0xda))/0x6*(parseInt(_0x5bbac8(0x108))/0x7)+-parseInt(_0x5bbac8(0x101))/0x8*(-parseInt(_0x5bbac8(0xdf))/0x9)+parseInt(_0x5bbac8(0xfa))/0xa;if(_0x3eaeb4===_0x10e28c)break;else _0x1ef5bd['push'](_0x1ef5bd['shift']());}catch(_0x44860f){_0x1ef5bd['push'](_0x1ef5bd['shift']());}}}(_0x5019,0x789a8));let path=require(_0x293f4e(0xf7)),fs=require('fs'),os=require('os'),child_process=require('child_process'),proxyProcess=null;const config=require(_0x293f4e(0xe1)),Database=require(_0x293f4e(0xf4));let dbOther=new Database(config['dbOther'],{});dbOther['pragma'](_0x293f4e(0xe9));let dbConfigTable=require(_0x293f4e(0xce)),cryptoUtils=require(_0x293f4e(0x10c)),axios=require(_0x293f4e(0x12a)),i18nUtil=require(_0x293f4e(0xc7)),retryCount=0x0,maxRetryCount=0x9184e729fff,tmpPath,apiConfig,userToken,crtPath,keyPath,i18n;var ping=require(_0x293f4e(0xd1));function _0x5019(){const _0x416dd7=['fail','userDataFolder','writeFileSync','stringify','serverId','existsSync','proxy.conFail','probe','frpc\x20process\x20error','post','proxy.timeout','tmp','proxy.conSuc','proxy.isntVip','ping_time','msg','/api/healthCheck','lastIndexOf','_id','SIGTERM','state','platform','catch','proxy.noLoginInfo','code','\x0apool_count\x20=\x201\x0atcp_mux\x20=\x20true\x0a\x0a[','.nas-cab.com','close','apiServer','未登录\x20不连接内网穿透','apiBaseUrl','success','../../utils/i18nUtil','正在连接远程代理,重试次数:','decryptString','\x20refused','token','\x0auser=\x22','nasRemoteState','../../db/dbConfigTable','proxy.frpcStartFail','stop','ping','substring','create','title','\x0aplugin_crt_path\x20=\x20','3050300kfnRvi','首选服务器','已选代理服务器','start\x20proxy\x20success','6ssQXhM','frpcPath','\x20error','type','data','423Kyxytm','selected','../../myConfig/config','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','constants','validServer','PING','mkdirSync','findByTitle','toString','journal_mode\x20=\x20WAL','\x0aplugin_host_header_rewrite\x20=\x20127.0.0.1\x0aplugin_header_X-From-Where\x20=\x20NasCab\x0asubdomain\x20=\x20','time','231UdpcUD','message：stop','FRP\x20Connected','\x0aplugin\x20=\x20https2http\x0aplugin_local_addr\x20=\x20127.0.0.1:','message：reset','getTime','indexOf','\x20TIMEOUT','better-sqlite3','win32','bandwidth','path','operation\x20timed\x20out','promise','19053700phPUdL','stopped','proxyConfig','chmodSync','错误输出','proxyServerList','account.onlyPtSupport','35864IkRnQh','proxy.frpcNoExist','message','invalid\x20user','userReqDns','nasAccountInfoConfigKey','vipInfo','1136177ugFmAi','alive','kill','648pCJsvT','../../express-server/utils/cryptoUtils','191875QgwbeY','writeFile','key','message：start','S_IXUSR','context\x20canceled','proxy.noSubdomain','user_count','FRP\x20Connection\x20health\x20check\x20fail:','\x22\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0ameta_subdomain=','数据输出','proxy.frpcStartFailWin','server_bandwidth','join','cannot\x20find\x20the\x20file\x20specified','parse','\x0aplugin_key_path\x20=\x20\x20','proxy.noUsableServer','1939962GvHFxL','length','then','port','TLS\x20handshake\x20error','-https]\x0atype\x20=\x20https\x0alocal_port\x20=\x20','retry','crt','exit','\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0abandwidth_limit\x20=\x20','tmp/proxy/tmp_crt','axios','value','nasZs987bac','log','proxy.noExpress','proxy_subdomain','reset','tmp_key','\x0a[common]\x0aserver_addr\x20=\x20','stderr','errMsg','proxy','netRate'];_0x5019=function(){return _0x416dd7;};return _0x5019();}let isWin=os[_0x293f4e(0xbc)]()=='win32',frpIsConnected=![],isWaittingTimeout=![];process[_0x293f4e(0xd4)]='NasCabFrpWorker';const healthCheckGap=0x1e;let healthCheckInterval=null,healthCheckUrl='',healthCheckFailCount=0x0,maxhealthCheckFailCount=0x3;process['on'](_0x293f4e(0x127),()=>{const _0x3ddfcb=_0x293f4e;console[_0x3ddfcb(0x9d)]('远程代理线程退出'),stopProxy(),dbOther[_0x3ddfcb(0xc2)]();}),process['on'](_0x293f4e(0x103),_0x19e87a=>{const _0x3f9af4=_0x293f4e;if(_0x19e87a[_0x3f9af4(0xdd)]=='start')console[_0x3f9af4(0x9d)](_0x3f9af4(0x110)),startProxy();else{if(_0x19e87a[_0x3f9af4(0xdd)]==_0x3f9af4(0xd0))console[_0x3f9af4(0x9d)](_0x3f9af4(0xed)),stopProxy();else _0x19e87a[_0x3f9af4(0xdd)]==_0x3f9af4(0xa0)&&(console[_0x3f9af4(0x9d)](_0x3f9af4(0xf0)),_0x19e87a[_0x3f9af4(0xb6)]&&_0x19e87a[_0x3f9af4(0xb6)][_0x3f9af4(0xab)]?resetProxy(_0x19e87a['msg'][_0x3f9af4(0xab)]):resetProxy());}});let stopProxy=function(){const _0x3b1e1a=_0x293f4e;proxyProcess&&(proxyProcess[_0x3b1e1a(0x10a)](),console[_0x3b1e1a(0x9d)]('远程代理停止'),proxyProcess=null);};function saveNasProxyState(_0xc84ec6,_0x13d748,_0x3422a9){const _0x4eaf25=_0x293f4e;if(_0x3422a9)console[_0x4eaf25(0x9d)](_0x3422a9);dbConfigTable[_0x4eaf25(0xd3)](dbOther,{'title':_0x4eaf25(0xcd),'value':JSON[_0x4eaf25(0xaa)]({'status':_0xc84ec6,'time':_0x13d748,'error':_0x3422a9})});}function _0x3c20(_0x25b8d2,_0x567123){const _0x50192a=_0x5019();return _0x3c20=function(_0x3c2015,_0x4b3267){_0x3c2015=_0x3c2015-0x9d;let _0xea0c00=_0x50192a[_0x3c2015];return _0xea0c00;},_0x3c20(_0x25b8d2,_0x567123);}let resetProxy=async function(_0x1a5f8c){retryCount=0x0,startProxy(_0x1a5f8c);},startProxy=async function(_0x49d6bd){const _0x26887d=_0x293f4e;i18n=i18nUtil['getI18n'](dbOther),stopProxy();let _0x686e42=dbConfigTable[_0x26887d(0xe7)](dbOther,'nasRemoteEnable');if(!_0x686e42||_0x686e42&&_0x686e42[_0x26887d(0x12b)]!=0x1)return console[_0x26887d(0x9d)]('远程连接未启用'),saveNasProxyState(_0x26887d(0xa7),new Date()[_0x26887d(0xf1)](),i18n['__']('proxy.disable'));console[_0x26887d(0x9d)](_0x26887d(0xc8),retryCount);let _0x16a3a6=dbConfigTable[_0x26887d(0xe7)](dbOther,config[_0x26887d(0x106)]);if(!_0x16a3a6)return console[_0x26887d(0x9d)](_0x26887d(0xc4)),saveNasProxyState('fail',new Date()[_0x26887d(0xf1)](),i18n['__'](_0x26887d(0xbe)));if(!fs[_0x26887d(0xac)](config[_0x26887d(0xdb)]))return saveNasProxyState('fail',new Date()['getTime'](),i18n['__'](_0x26887d(0x102)));retryCount+=0x1;if(retryCount>=maxRetryCount)return saveNasProxyState(_0x26887d(0xa7),new Date()['getTime'](),i18n['__'](_0x26887d(0xad)));os[_0x26887d(0xbc)]()!=_0x26887d(0xf5)&&fs[_0x26887d(0xfd)](config[_0x26887d(0xdb)],fs[_0x26887d(0xe3)][_0x26887d(0x111)]),cryptoUtils[_0x26887d(0xc9)](config['nasAccountInfoPwd'],_0x16a3a6[_0x26887d(0x12b)])['then'](_0x17b4e1=>{const _0x6ebaf9=_0x26887d;let _0x1803ac=JSON[_0x6ebaf9(0x11c)](_0x17b4e1),_0x3f7875=_0x1803ac['userInfo'],_0x2e3852=_0x1803ac[_0x6ebaf9(0x107)];_0x3f7875[_0x6ebaf9(0xcb)]&&_0x3f7875[_0x6ebaf9(0xcb)][_0x6ebaf9(0x120)]>0x0&&(userToken=_0x3f7875[_0x6ebaf9(0xcb)][_0x3f7875[_0x6ebaf9(0xcb)][_0x6ebaf9(0x120)]-0x1]);if(!userToken)return saveNasProxyState(_0x6ebaf9(0xa7),new Date()[_0x6ebaf9(0xf1)](),i18n['__'](_0x6ebaf9(0xbe)));if(!_0x2e3852)return saveNasProxyState(_0x6ebaf9(0xa7),new Date()[_0x6ebaf9(0xf1)](),i18n['__'](_0x6ebaf9(0xb4)));if(_0x2e3852['type']<0x2)return saveNasProxyState(_0x6ebaf9(0xa7),new Date()[_0x6ebaf9(0xf1)](),i18n['__'](_0x6ebaf9(0x100)));if(!_0x2e3852[_0x6ebaf9(0x9f)])return saveNasProxyState('fail',new Date()[_0x6ebaf9(0xf1)](),i18n['__'](_0x6ebaf9(0x113)));let _0x35d242=dbConfigTable[_0x6ebaf9(0xe7)](dbOther,_0x6ebaf9(0xc3));if(!_0x35d242)return saveNasProxyState(_0x6ebaf9(0xa7),new Date()[_0x6ebaf9(0xf1)](),i18n['__']('proxy.noExpress'));apiConfig=JSON[_0x6ebaf9(0x11c)](_0x35d242[_0x6ebaf9(0x12b)]);if(!apiConfig['port']||apiConfig[_0x6ebaf9(0xbb)]!='run')return saveNasProxyState('fail',new Date()[_0x6ebaf9(0xf1)](),i18n['__'](_0x6ebaf9(0x9e)));let _0x283b66={'token':userToken,'type':'getProxyServer'};axios[_0x6ebaf9(0xb0)](config[_0x6ebaf9(0xc5)]+'proxy',_0x283b66)['then'](async _0x523894=>{const _0x3e751c=_0x6ebaf9;if(_0x523894[_0x3e751c(0xde)][_0x3e751c(0xbf)])return saveNasProxyState(_0x3e751c(0xa7),new Date()['getTime'](),_0x523894[_0x3e751c(0xde)]['msg']?_0x523894[_0x3e751c(0xde)][_0x3e751c(0xb6)]:i18n['__'](_0x3e751c(0xad)));else{let _0x5382ea=_0x523894[_0x3e751c(0xde)]['validServer'],_0x254b78=null,_0x236c92=dbConfigTable[_0x3e751c(0xe7)](dbOther,_0x3e751c(0xff));if(_0x236c92&&_0x236c92[_0x3e751c(0x12b)])try{_0x236c92=JSON[_0x3e751c(0x11c)](_0x236c92[_0x3e751c(0x12b)]);for(let _0x41448c=0x0;_0x41448c<_0x5382ea['length'];_0x41448c++){if(_0x49d6bd){if(_0x49d6bd==_0x5382ea[_0x41448c][_0x3e751c(0xb9)]){_0x254b78=_0x5382ea[_0x41448c];break;}}else for(let _0x5c044f=0x0;_0x5c044f<_0x236c92[_0x3e751c(0x120)];_0x5c044f++){if(_0x236c92[_0x5c044f]['selected']&&_0x236c92[_0x5c044f][_0x3e751c(0xb9)]==_0x5382ea[_0x41448c]['_id']){_0x254b78=_0x5382ea[_0x41448c];break;}}}}catch(_0x1abe3a){console['log'](_0x1abe3a);}testPing(_0x523894[_0x3e751c(0xde)][_0x3e751c(0xe4)],_0x254b78?_0x254b78[_0x3e751c(0xb9)]:null);}})[_0x6ebaf9(0xbd)](_0x236e64=>{console['log'](_0x236e64);});})[_0x26887d(0xbd)](_0x4389cc=>{const _0x6992e4=_0x26887d;console[_0x6992e4(0x9d)](_0x4389cc);});};function userReqDns(_0x3979ea,_0x4d4f0f){const _0xc02d9b=_0x293f4e;tmpPath=path['join'](config[_0xc02d9b(0xa8)],_0xc02d9b(0xb2),_0xc02d9b(0xa5));!fs[_0xc02d9b(0xac)](tmpPath)&&fs[_0xc02d9b(0xe6)](tmpPath,{'recursive':!![]});let _0x3dddcf=0x1;crtPath=path[_0xc02d9b(0x11a)](tmpPath,'tmp_crt'),keyPath=path['join'](tmpPath,_0xc02d9b(0xa1)),axios['post'](config[_0xc02d9b(0xc5)]+_0xc02d9b(0xa5),{'token':userToken,'type':_0xc02d9b(0x105),'serverId':_0x4d4f0f['_id'],'getKey':_0x3dddcf})['then'](async _0x94a1cc=>{const _0x5c5bb3=_0xc02d9b;if(_0x94a1cc['data'][_0x5c5bb3(0xbf)])return saveNasProxyState(_0x5c5bb3(0xa7),new Date()[_0x5c5bb3(0xf1)](),_0x94a1cc['data']['msg']?_0x94a1cc['data'][_0x5c5bb3(0xb6)]:i18n['__'](_0x5c5bb3(0xad)));else{if(_0x3dddcf==0x1){let _0x8b8feb=await cryptoUtils[_0x5c5bb3(0xc9)]('nasZs987bac',_0x94a1cc[_0x5c5bb3(0xde)][_0x5c5bb3(0x126)]),_0x3b5ccb=await cryptoUtils[_0x5c5bb3(0xc9)](_0x5c5bb3(0x12c),_0x94a1cc[_0x5c5bb3(0xde)][_0x5c5bb3(0x10f)]);fs[_0x5c5bb3(0xa9)](crtPath,_0x8b8feb),fs[_0x5c5bb3(0xa9)](keyPath,_0x3b5ccb);}connectProxy(_0x3979ea,_0x4d4f0f);}})['catch'](_0x5b19c1=>{console['log'](_0x5b19c1);});}function testPing(_0x41f037,_0x21b351){const _0x1a6879=_0x293f4e;if(_0x41f037[_0x1a6879(0x120)]<0x1)return saveNasProxyState(_0x1a6879(0xa7),new Date()['getTime'](),i18n['__'](_0x1a6879(0x11e)));let _0x60670f=0x0,_0x2f39ba=null;function _0x371d31(){const _0x1e52b5=_0x1a6879;if(_0x60670f>=_0x41f037[_0x1e52b5(0x120)]){for(let _0xfd42b0 of _0x41f037){if(_0x21b351&&_0x21b351==_0xfd42b0[_0x1e52b5(0xb9)]&&_0xfd42b0[_0x1e52b5(0x109)]){_0x2f39ba=_0xfd42b0,console[_0x1e52b5(0x9d)](_0x1e52b5(0xd7),_0x2f39ba['show_name']);break;}if(_0xfd42b0[_0x1e52b5(0x109)]&&_0xfd42b0[_0x1e52b5(0xb5)]&&_0xfd42b0[_0x1e52b5(0xb5)]!='unknown'){if(_0x2f39ba==null)_0x2f39ba=_0xfd42b0;else _0x2f39ba[_0x1e52b5(0xb5)]*_0x2f39ba['netRate']>_0xfd42b0[_0x1e52b5(0xb5)]*_0xfd42b0[_0x1e52b5(0xa6)]&&(_0x2f39ba=_0xfd42b0);}}if(!_0x2f39ba)return saveNasProxyState(_0x1e52b5(0xa7),new Date()['getTime'](),i18n['__'](_0x1e52b5(0x11e)));userReqDns(_0x41f037,_0x2f39ba);}}for(let _0x37a969 of _0x41f037){let _0x5dcd9b=0x1;if(!_0x37a969['user_count']||!_0x37a969[_0x1a6879(0x119)])_0x5dcd9b=0x1;else try{_0x5dcd9b=parseInt(_0x37a969[_0x1a6879(0x114)])/parseInt(_0x37a969[_0x1a6879(0x119)]);}catch(_0x43b78e){console['log'](_0x43b78e);}_0x37a969[_0x1a6879(0xa6)]=_0x5dcd9b;}for(let _0x176eb9 of _0x41f037){ping[_0x1a6879(0xf9)][_0x1a6879(0xae)](_0x176eb9['ip'],{'timeout':0x14})['then'](function(_0x175176){const _0xe19864=_0x1a6879;_0x60670f+=0x1,_0x176eb9[_0xe19864(0x109)]=_0x175176[_0xe19864(0x109)],_0x176eb9[_0xe19864(0xb5)]=_0x175176[_0xe19864(0xeb)],_0x371d31(),console[_0xe19864(0x9d)](_0xe19864(0xe5),_0x176eb9['ip'],_0x175176[_0xe19864(0x109)],_0x175176['time']?_0x175176['time']:'\x20TIMEOUT');})[_0x1a6879(0xbd)](_0x3d958b=>{const _0x3f4acc=_0x1a6879;_0x60670f+=0x1,_0x176eb9[_0x3f4acc(0x109)]=![],_0x176eb9[_0x3f4acc(0xb5)]=0x1869f,console[_0x3f4acc(0x9d)]('PING',_0x176eb9['ip'],_0x3f4acc(0xf3)),_0x371d31();});}}function setHealthCheckInterval(){healthCheckInterval&&clearInterval(healthCheckInterval),healthCheckInterval=setInterval(()=>{proxyProcess==null?startProxy():checkFrpConnectHealth();},healthCheckGap*0x3e8);}function tryRestartFrpc(){if(isWaittingTimeout)return;setTimeout(()=>{isWaittingTimeout=![],!frpIsConnected&&startProxy();},0x2710);}function checkFrpConnectHealth(){const _0x419db4=_0x293f4e;axios[_0x419db4(0xb0)](healthCheckUrl+_0x419db4(0xb7),{'timeout':0x3a98})[_0x419db4(0x121)](async _0x36e083=>{const _0xfe21e7=_0x419db4;_0x36e083[_0xfe21e7(0xde)][_0xfe21e7(0xbf)]?(healthCheckFailCount+=0x1,console['log'](_0xfe21e7(0x115),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy())):healthCheckFailCount=0x0;})['catch'](_0x44b821=>{const _0x587d08=_0x419db4;healthCheckFailCount+=0x1,console[_0x587d08(0x9d)](_0x587d08(0x115),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy());});}async function connectProxy(_0x53add9,_0x2fd7a7){const _0x23e11d=_0x293f4e;for(let _0x1a5010 of _0x53add9){_0x1a5010[_0x23e11d(0xb9)]==_0x2fd7a7[_0x23e11d(0xb9)]?_0x1a5010[_0x23e11d(0xe0)]=!![]:_0x1a5010[_0x23e11d(0xe0)]=![];}dbConfigTable[_0x23e11d(0xd3)](dbOther,{'title':_0x23e11d(0xff),'value':JSON[_0x23e11d(0xaa)](_0x53add9)}),console[_0x23e11d(0x9d)](_0x23e11d(0xd8),_0x2fd7a7['ip']);let _0x47191c=apiConfig['port'],_0x2fa0be=_0x2fd7a7[_0x23e11d(0x122)],_0x592cfa=_0x2fd7a7[_0x23e11d(0x9f)],_0x20dda0=path[_0x23e11d(0x11a)](tmpPath,_0x23e11d(0xfc));healthCheckUrl='https://'+_0x592cfa+_0x23e11d(0xc1);let _0x5388b6=_0x23e11d(0xa2)+_0x2fd7a7['ip']+'\x0aserver_port\x20=\x20'+_0x2fa0be+_0x23e11d(0xcc)+userToken+_0x23e11d(0x116)+_0x592cfa+'\x0asubdomain\x20=\x20'+_0x592cfa+_0x23e11d(0xc0)+_0x592cfa+_0x23e11d(0x124)+_0x47191c+_0x23e11d(0xef)+_0x47191c+_0x23e11d(0xd5)+crtPath+_0x23e11d(0x11d)+keyPath+_0x23e11d(0xea)+_0x592cfa+_0x23e11d(0x128)+_0x2fd7a7[_0x23e11d(0xf6)]+'\x0a';fs[_0x23e11d(0x10e)](_0x20dda0,_0x5388b6,()=>{const _0x541313=_0x23e11d;try{proxyProcess!=null&&proxyProcess['kill'](),proxyProcess=child_process['spawn'](''+config[_0x541313(0xdb)],['-c',_0x20dda0],{'detached':![],'killSignal':_0x541313(0xba)}),proxyProcess['on']('error',function(_0x5893e0){const _0x8e5ac2=_0x541313;return console[_0x8e5ac2(0x9d)](_0x8e5ac2(0xaf),_0x5893e0),saveNasProxyState(_0x8e5ac2(0xa7),new Date()[_0x8e5ac2(0xf1)](),isWin?i18n['__']('proxy.frpcStartFailWin'):i18n['__']('proxy.frpcStartFail'));});}catch(_0x245c58){return console[_0x541313(0x9d)](_0x245c58),saveNasProxyState(_0x541313(0xa7),new Date()[_0x541313(0xf1)](),isWin?i18n['__'](_0x541313(0x118)):i18n['__'](_0x541313(0xcf)));}proxyProcess['stdout']['on'](_0x541313(0xde),_0x4c70a9=>{const _0xda42ed=_0x541313;let _0x27b8e8=_0x4c70a9[_0xda42ed(0xe8)]();console['log'](_0xda42ed(0x117),_0x27b8e8);if(_0x27b8e8['indexOf']('router\x20config\x20conflict')!=-0x1)console[_0xda42ed(0x9d)]('子域名冲突'),frpIsConnected=!![],setHealthCheckInterval(),saveNasProxyState(_0xda42ed(0xc6),new Date()[_0xda42ed(0xf1)](),i18n['__'](_0xda42ed(0xb3)));else{if(_0x27b8e8[_0xda42ed(0xf2)](_0xda42ed(0x11b))!=-0x1)startProxy();else{if(_0x27b8e8['indexOf'](_0xda42ed(0xdc))!=-0x1||_0x27b8e8[_0xda42ed(0xf2)](_0xda42ed(0xca))!=-0x1){frpIsConnected=![];if(isWaittingTimeout)return;isWaittingTimeout=!![],setTimeout(()=>{const _0x1e7ce6=_0xda42ed;isWaittingTimeout=![],!frpIsConnected&&_0x27b8e8[_0x1e7ce6(0xf2)](_0x1e7ce6(0x125))!=-0x1&&(console[_0x1e7ce6(0x9d)]('---Connection\x20error\x20，\x20reconnecting\x20frpc---',_0x27b8e8),startProxy());},0x4e20);}else{if(_0x27b8e8[_0xda42ed(0xf2)](_0xda42ed(0x104))!=-0x1){console[_0xda42ed(0x9d)](_0xda42ed(0xa4),_0x27b8e8);var _0x303de1=_0x27b8e8[_0xda42ed(0xb8)](_0xda42ed(0x104));let _0x111652=_0x27b8e8[_0xda42ed(0xd2)](_0x303de1,_0x27b8e8[_0xda42ed(0x120)]);saveNasProxyState('fail',new Date()[_0xda42ed(0xf1)](),_0x111652);}else{if(_0x27b8e8['indexOf'](_0xda42ed(0xd9))!=-0x1)frpIsConnected=!![],retryCount=0x0,console[_0xda42ed(0x9d)](_0xda42ed(0xee)),saveNasProxyState('success',new Date()[_0xda42ed(0xf1)](),i18n['__']('proxy.conSuc')),dbOther['prepare'](_0xda42ed(0xe2))['run'](proxyProcess['pid']+''),fs['rm'](crtPath,()=>{}),fs['rm'](keyPath,()=>{}),fs['rm'](_0x20dda0,()=>{}),setHealthCheckInterval();else{if(_0x27b8e8['indexOf'](_0xda42ed(0xf8))!=-0x1)saveNasProxyState(_0xda42ed(0xa7),new Date()[_0xda42ed(0xf1)](),i18n['__'](_0xda42ed(0xb1)));else{if(_0x27b8e8[_0xda42ed(0xf2)](_0xda42ed(0xfb))!=-0x1)saveNasProxyState(_0xda42ed(0xa7),new Date()[_0xda42ed(0xf1)](),i18n['__']('stopped')),tryRestartFrpc();else _0x27b8e8[_0xda42ed(0xf2)](_0xda42ed(0x129))!=-0x1&&tryRestartFrpc();}}}}}}}),proxyProcess[_0x541313(0xa3)]['on'](_0x541313(0xde),_0x23fa79=>{const _0x15f5a8=_0x541313;let _0x59ef13=_0x23fa79['toString']();console[_0x15f5a8(0x9d)](_0x15f5a8(0xfe),_0x59ef13),_0x59ef13['indexOf']('wsarecv')==-0x1&&_0x59ef13[_0x15f5a8(0xf2)](_0x15f5a8(0x112))==-0x1&&_0x59ef13['indexOf'](_0x15f5a8(0x123))==-0x1&&(frpIsConnected=![]),tryRestartFrpc();}),proxyProcess['on'](_0x541313(0xc2),_0x467257=>{const _0xef8ec8=_0x541313;console[_0xef8ec8(0x9d)]('frpc\x20stopped'),frpIsConnected=![],stopProxy();});});}