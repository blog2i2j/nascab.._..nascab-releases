const _0x2b0b67=_0x5624;(function(_0x18cc44,_0x47b73c){const _0x5d28e5=_0x5624,_0x3f19ac=_0x18cc44();while(!![]){try{const _0x177f52=-parseInt(_0x5d28e5(0x1c2))/0x1+-parseInt(_0x5d28e5(0x21e))/0x2+-parseInt(_0x5d28e5(0x202))/0x3+-parseInt(_0x5d28e5(0x236))/0x4*(parseInt(_0x5d28e5(0x1d4))/0x5)+parseInt(_0x5d28e5(0x1e7))/0x6+-parseInt(_0x5d28e5(0x1e6))/0x7*(-parseInt(_0x5d28e5(0x1dc))/0x8)+parseInt(_0x5d28e5(0x1d2))/0x9;if(_0x177f52===_0x47b73c)break;else _0x3f19ac['push'](_0x3f19ac['shift']());}catch(_0x13759c){_0x3f19ac['push'](_0x3f19ac['shift']());}}}(_0x2dcf,0x30c99));let path=require(_0x2b0b67(0x1c0)),fs=require('fs'),os=require('os'),child_process=require('child_process'),proxyProcess=null;function _0x2dcf(){const _0x35a2e0=['SIGTERM','frpc\x20process\x20error','proxy.noUsableServer','axios','\x0aplugin\x20=\x20https2http\x0aplugin_local_addr\x20=\x20127.0.0.1:','stop','data','-https]\x0atype\x20=\x20https\x0alocal_port\x20=\x20','.nas-cab.com','proxy.noLoginInfo','proxy.frpcStartFailWin','---Connection\x20error\x20，\x20reconnecting\x20frpc---','proxy.conSuc','length','lastIndexOf','\x0auser=\x22','close','未登录\x20不连接内网穿透','proxy.noSubdomain','writeFileSync','run','../../myConfig/config','platform','152958GLrUiZ','FRP\x20Connection\x20health\x20check\x20fail:','findByTitle','probe','netRate','stdout','writeFile','win32','apiBaseUrl','join','validServer','frpcPath','exit','tmp/proxy/tmp_crt','selected','ping_time','proxy.timeout','operation\x20timed\x20out','/api/healthCheck','time','stopped','\x20refused','type','https://','message：reset','parse','serverId','proxy','364188uSIWZB','ping','success','journal_mode\x20=\x20WAL','invalid\x20user','error','NasCabFrpWorker','router\x20config\x20conflict','fail','proxy.frpcNoExist','getI18n','start\x20proxy\x20success','../../utils/i18nUtil','子域名冲突','\x20TIMEOUT','\x0apool_count\x20=\x201\x0atcp_mux\x20=\x20true\x0a\x0a[','远程代理线程退出','start','server_bandwidth','existsSync','prepare','user_count','reset','code','1499412ensnby','then','userReqDns','nasAccountInfoConfigKey','show_name','FRP\x20Connected','PING','tmp_crt','log','dbOther','alive','nasZs987bac','message：stop','已选代理服务器','better-sqlite3','../../db/dbConfigTable','crt','token','\x0aserver_port\x20=\x20','toString','proxy.conFail','indexOf','userDataFolder','chmodSync','远程代理停止','errMsg','message：start','数据输出','promise','path','create','211776RonsyU','\x0aplugin_host_header_rewrite\x20=\x20127.0.0.1\x0aplugin_header_X-From-Where\x20=\x20NasCab\x0asubdomain\x20=\x20','getTime','spawn','proxyConfig','proxy.frpcStartFail','account.onlyPtSupport','错误输出','REPLACE\x20INTO\x20process_record(process_id)\x20VALUES(?)','decryptString','首选服务器','tmp_key','catch','\x22\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0ameta_subdomain=','vipInfo','正在连接远程代理,重试次数:','4332051GtqUzr','proxy_subdomain','5fAllgC','kill','wsarecv','pragma','\x20error','\x0ause_compression\x20=\x20true\x0ause_encryption\x20=\x20true\x0abandwidth_limit\x20=\x20','nasRemoteEnable','post','242344IAHhUC','msg','stringify','bandwidth','S_IXUSR','title','key','pid','context\x20canceled','apiServer','49BEQSaq','1956912QzwkuY','_id','value','\x0a[common]\x0aserver_addr\x20=\x20'];_0x2dcf=function(){return _0x35a2e0;};return _0x2dcf();}const config=require(_0x2b0b67(0x200)),Database=require(_0x2b0b67(0x1b1));let dbOther=new Database(config[_0x2b0b67(0x23f)],{});dbOther[_0x2b0b67(0x1d7)](_0x2b0b67(0x221));let dbConfigTable=require(_0x2b0b67(0x1b2)),cryptoUtils=require('../../express-server/utils/cryptoUtils'),axios=require(_0x2b0b67(0x1ee)),i18nUtil=require(_0x2b0b67(0x22a)),retryCount=0x0,maxRetryCount=0x9184e729fff,tmpPath,apiConfig,userToken,crtPath,keyPath,i18n;var ping=require(_0x2b0b67(0x21f));let isWin=os[_0x2b0b67(0x201)]()==_0x2b0b67(0x209),frpIsConnected=![],isWaittingTimeout=![];process[_0x2b0b67(0x1e1)]=_0x2b0b67(0x224);const healthCheckGap=0x1e;let healthCheckInterval=null,healthCheckUrl='',healthCheckFailCount=0x0,maxhealthCheckFailCount=0x3;process['on'](_0x2b0b67(0x20e),()=>{const _0x364c01=_0x2b0b67;console['log'](_0x364c01(0x22e)),stopProxy(),dbOther['close']();}),process['on']('message',_0x45cc3b=>{const _0x9474f2=_0x2b0b67;if(_0x45cc3b['type']==_0x9474f2(0x22f))console['log'](_0x9474f2(0x1bd)),startProxy();else{if(_0x45cc3b[_0x9474f2(0x218)]==_0x9474f2(0x1f0))console['log'](_0x9474f2(0x242)),stopProxy();else _0x45cc3b['type']==_0x9474f2(0x234)&&(console[_0x9474f2(0x23e)](_0x9474f2(0x21a)),_0x45cc3b[_0x9474f2(0x1dd)]&&_0x45cc3b[_0x9474f2(0x1dd)][_0x9474f2(0x21c)]?resetProxy(_0x45cc3b[_0x9474f2(0x1dd)]['serverId']):resetProxy());}});let stopProxy=function(){const _0x14f8c0=_0x2b0b67;proxyProcess&&(proxyProcess['kill'](),console[_0x14f8c0(0x23e)](_0x14f8c0(0x1bb)),proxyProcess=null);};function saveNasProxyState(_0x194a9b,_0x43533b,_0x18ab13){const _0x1ff787=_0x2b0b67;if(_0x18ab13)console[_0x1ff787(0x23e)](_0x18ab13);dbConfigTable[_0x1ff787(0x1c1)](dbOther,{'title':'nasRemoteState','value':JSON[_0x1ff787(0x1de)]({'status':_0x194a9b,'time':_0x43533b,'error':_0x18ab13})});}let resetProxy=async function(_0x51f097){retryCount=0x0,startProxy(_0x51f097);},startProxy=async function(_0x13ea64){const _0x260f7b=_0x2b0b67;i18n=i18nUtil[_0x260f7b(0x228)](dbOther),stopProxy();let _0x622b85=dbConfigTable[_0x260f7b(0x204)](dbOther,_0x260f7b(0x1da));if(!_0x622b85||_0x622b85&&_0x622b85[_0x260f7b(0x1e9)]!=0x1)return console[_0x260f7b(0x23e)]('远程连接未启用'),saveNasProxyState(_0x260f7b(0x226),new Date()[_0x260f7b(0x1c4)](),i18n['__']('proxy.disable'));console[_0x260f7b(0x23e)](_0x260f7b(0x1d1),retryCount);let _0x6a2ec5=dbConfigTable[_0x260f7b(0x204)](dbOther,config[_0x260f7b(0x239)]);if(!_0x6a2ec5)return console[_0x260f7b(0x23e)](_0x260f7b(0x1fc)),saveNasProxyState('fail',new Date()[_0x260f7b(0x1c4)](),i18n['__'](_0x260f7b(0x1f4)));if(!fs['existsSync'](config['frpcPath']))return saveNasProxyState(_0x260f7b(0x226),new Date()['getTime'](),i18n['__'](_0x260f7b(0x227)));retryCount+=0x1;if(retryCount>=maxRetryCount)return saveNasProxyState(_0x260f7b(0x226),new Date()[_0x260f7b(0x1c4)](),i18n['__'](_0x260f7b(0x1b7)));os[_0x260f7b(0x201)]()!=_0x260f7b(0x209)&&fs[_0x260f7b(0x1ba)](config[_0x260f7b(0x20d)],fs['constants'][_0x260f7b(0x1e0)]),cryptoUtils[_0x260f7b(0x1cb)](config['nasAccountInfoPwd'],_0x6a2ec5[_0x260f7b(0x1e9)])[_0x260f7b(0x237)](_0x15b7cd=>{const _0x1061bc=_0x260f7b;let _0x2612f2=JSON[_0x1061bc(0x21b)](_0x15b7cd),_0xf5a9bf=_0x2612f2['userInfo'],_0x206145=_0x2612f2[_0x1061bc(0x1d0)];_0xf5a9bf['token']&&_0xf5a9bf['token'][_0x1061bc(0x1f8)]>0x0&&(userToken=_0xf5a9bf['token'][_0xf5a9bf[_0x1061bc(0x1b4)][_0x1061bc(0x1f8)]-0x1]);if(!userToken)return saveNasProxyState('fail',new Date()[_0x1061bc(0x1c4)](),i18n['__']('proxy.noLoginInfo'));if(!_0x206145)return saveNasProxyState(_0x1061bc(0x226),new Date()['getTime'](),i18n['__']('proxy.isntVip'));if(_0x206145[_0x1061bc(0x218)]<0x2)return saveNasProxyState(_0x1061bc(0x226),new Date()[_0x1061bc(0x1c4)](),i18n['__'](_0x1061bc(0x1c8)));if(!_0x206145['proxy_subdomain'])return saveNasProxyState(_0x1061bc(0x226),new Date()[_0x1061bc(0x1c4)](),i18n['__'](_0x1061bc(0x1fd)));let _0xe4f14e=dbConfigTable[_0x1061bc(0x204)](dbOther,_0x1061bc(0x1e5));if(!_0xe4f14e)return saveNasProxyState('fail',new Date()['getTime'](),i18n['__']('proxy.noExpress'));apiConfig=JSON[_0x1061bc(0x21b)](_0xe4f14e[_0x1061bc(0x1e9)]);if(!apiConfig['port']||apiConfig['state']!=_0x1061bc(0x1ff))return saveNasProxyState(_0x1061bc(0x226),new Date()['getTime'](),i18n['__']('proxy.noExpress'));let _0xd9ee77={'token':userToken,'type':'getProxyServer'};axios[_0x1061bc(0x1db)](config[_0x1061bc(0x20a)]+_0x1061bc(0x21d),_0xd9ee77)[_0x1061bc(0x237)](async _0x41fa08=>{const _0x483470=_0x1061bc;if(_0x41fa08[_0x483470(0x1f1)][_0x483470(0x235)])return saveNasProxyState(_0x483470(0x226),new Date()['getTime'](),_0x41fa08['data'][_0x483470(0x1dd)]?_0x41fa08['data'][_0x483470(0x1dd)]:i18n['__'](_0x483470(0x1b7)));else{let _0x628497=_0x41fa08[_0x483470(0x1f1)][_0x483470(0x20c)],_0x27081f=null,_0x5767a1=dbConfigTable[_0x483470(0x204)](dbOther,'proxyServerList');if(_0x5767a1&&_0x5767a1[_0x483470(0x1e9)])try{_0x5767a1=JSON[_0x483470(0x21b)](_0x5767a1[_0x483470(0x1e9)]);for(let _0x2ddd60=0x0;_0x2ddd60<_0x628497['length'];_0x2ddd60++){if(_0x13ea64){if(_0x13ea64==_0x628497[_0x2ddd60][_0x483470(0x1e8)]){_0x27081f=_0x628497[_0x2ddd60];break;}}else for(let _0x516f55=0x0;_0x516f55<_0x5767a1[_0x483470(0x1f8)];_0x516f55++){if(_0x5767a1[_0x516f55]['selected']&&_0x5767a1[_0x516f55]['_id']==_0x628497[_0x2ddd60][_0x483470(0x1e8)]){_0x27081f=_0x628497[_0x2ddd60];break;}}}}catch(_0x86308c){console[_0x483470(0x23e)](_0x86308c);}testPing(_0x41fa08['data']['validServer'],_0x27081f?_0x27081f[_0x483470(0x1e8)]:null);}})['catch'](_0x2ca09e=>{const _0x4fb83a=_0x1061bc;console[_0x4fb83a(0x23e)](_0x2ca09e);});})['catch'](_0x5ac1a3=>{console['log'](_0x5ac1a3);});};function userReqDns(_0xbffb68,_0x144de8){const _0x54159e=_0x2b0b67;tmpPath=path['join'](config[_0x54159e(0x1b9)],'tmp',_0x54159e(0x21d));!fs[_0x54159e(0x231)](tmpPath)&&fs['mkdirSync'](tmpPath,{'recursive':!![]});let _0x5c4199=0x1;crtPath=path[_0x54159e(0x20b)](tmpPath,_0x54159e(0x23d)),keyPath=path[_0x54159e(0x20b)](tmpPath,_0x54159e(0x1cd)),axios['post'](config[_0x54159e(0x20a)]+_0x54159e(0x21d),{'token':userToken,'type':_0x54159e(0x238),'serverId':_0x144de8[_0x54159e(0x1e8)],'getKey':_0x5c4199})[_0x54159e(0x237)](async _0x19cbce=>{const _0x29dbdd=_0x54159e;if(_0x19cbce[_0x29dbdd(0x1f1)][_0x29dbdd(0x235)])return saveNasProxyState(_0x29dbdd(0x226),new Date()[_0x29dbdd(0x1c4)](),_0x19cbce[_0x29dbdd(0x1f1)]['msg']?_0x19cbce[_0x29dbdd(0x1f1)][_0x29dbdd(0x1dd)]:i18n['__'](_0x29dbdd(0x1b7)));else{if(_0x5c4199==0x1){let _0x3cce0e=await cryptoUtils[_0x29dbdd(0x1cb)](_0x29dbdd(0x241),_0x19cbce[_0x29dbdd(0x1f1)][_0x29dbdd(0x1b3)]),_0x4f0926=await cryptoUtils[_0x29dbdd(0x1cb)](_0x29dbdd(0x241),_0x19cbce[_0x29dbdd(0x1f1)][_0x29dbdd(0x1e2)]);fs[_0x29dbdd(0x1fe)](crtPath,_0x3cce0e),fs[_0x29dbdd(0x1fe)](keyPath,_0x4f0926);}connectProxy(_0xbffb68,_0x144de8);}})[_0x54159e(0x1ce)](_0x2a13c7=>{console['log'](_0x2a13c7);});}function testPing(_0x138a67,_0x5694d5){const _0x24f88a=_0x2b0b67;if(_0x138a67[_0x24f88a(0x1f8)]<0x1)return saveNasProxyState(_0x24f88a(0x226),new Date()['getTime'](),i18n['__'](_0x24f88a(0x1ed)));let _0x27f9af=0x0,_0x58e9d2=null;function _0xffba1c(){const _0x264ea1=_0x24f88a;if(_0x27f9af>=_0x138a67[_0x264ea1(0x1f8)]){for(let _0x5092b0 of _0x138a67){if(_0x5694d5&&_0x5694d5==_0x5092b0[_0x264ea1(0x1e8)]&&_0x5092b0[_0x264ea1(0x240)]){_0x58e9d2=_0x5092b0,console[_0x264ea1(0x23e)](_0x264ea1(0x1cc),_0x58e9d2[_0x264ea1(0x23a)]);break;}if(_0x5092b0['alive']&&_0x5092b0['ping_time']&&_0x5092b0[_0x264ea1(0x211)]!='unknown'){if(_0x58e9d2==null)_0x58e9d2=_0x5092b0;else _0x58e9d2[_0x264ea1(0x211)]*_0x58e9d2[_0x264ea1(0x206)]>_0x5092b0[_0x264ea1(0x211)]*_0x5092b0[_0x264ea1(0x206)]&&(_0x58e9d2=_0x5092b0);}}if(!_0x58e9d2)return saveNasProxyState(_0x264ea1(0x226),new Date()['getTime'](),i18n['__']('proxy.noUsableServer'));userReqDns(_0x138a67,_0x58e9d2);}}for(let _0x49481e of _0x138a67){let _0x146528=0x1;if(!_0x49481e['user_count']||!_0x49481e[_0x24f88a(0x230)])_0x146528=0x1;else try{_0x146528=parseInt(_0x49481e[_0x24f88a(0x233)])/parseInt(_0x49481e[_0x24f88a(0x230)]);}catch(_0x2c6fbc){console[_0x24f88a(0x23e)](_0x2c6fbc);}_0x49481e[_0x24f88a(0x206)]=_0x146528;}for(let _0x14c3b7 of _0x138a67){ping[_0x24f88a(0x1bf)][_0x24f88a(0x205)](_0x14c3b7['ip'],{'timeout':0x14})[_0x24f88a(0x237)](function(_0xffaaf4){const _0x54734f=_0x24f88a;_0x27f9af+=0x1,_0x14c3b7[_0x54734f(0x240)]=_0xffaaf4['alive'],_0x14c3b7['ping_time']=_0xffaaf4[_0x54734f(0x215)],_0xffba1c(),console[_0x54734f(0x23e)]('PING',_0x14c3b7['ip'],_0xffaaf4['alive'],_0xffaaf4[_0x54734f(0x215)]?_0xffaaf4[_0x54734f(0x215)]:_0x54734f(0x22c));})[_0x24f88a(0x1ce)](_0x5512ed=>{const _0x33e093=_0x24f88a;_0x27f9af+=0x1,_0x14c3b7[_0x33e093(0x240)]=![],_0x14c3b7[_0x33e093(0x211)]=0x1869f,console[_0x33e093(0x23e)](_0x33e093(0x23c),_0x14c3b7['ip'],'\x20TIMEOUT'),_0xffba1c();});}}function setHealthCheckInterval(){healthCheckInterval&&clearInterval(healthCheckInterval),healthCheckInterval=setInterval(()=>{proxyProcess==null?startProxy():checkFrpConnectHealth();},healthCheckGap*0x3e8);}function tryRestartFrpc(){if(isWaittingTimeout)return;setTimeout(()=>{isWaittingTimeout=![],!frpIsConnected&&startProxy();},0x2710);}function checkFrpConnectHealth(){const _0x8a924c=_0x2b0b67;axios[_0x8a924c(0x1db)](healthCheckUrl+_0x8a924c(0x214),{'timeout':0x3a98})[_0x8a924c(0x237)](async _0x1000af=>{const _0x5f2238=_0x8a924c;_0x1000af['data']['code']?(healthCheckFailCount+=0x1,console[_0x5f2238(0x23e)](_0x5f2238(0x203),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy())):healthCheckFailCount=0x0;})[_0x8a924c(0x1ce)](_0x1e9419=>{const _0x2ae807=_0x8a924c;healthCheckFailCount+=0x1,console[_0x2ae807(0x23e)](_0x2ae807(0x203),healthCheckFailCount),healthCheckFailCount>maxhealthCheckFailCount&&(healthCheckFailCount=0x0,startProxy());});}function _0x5624(_0x58aa79,_0x6fab6f){const _0x2dcf26=_0x2dcf();return _0x5624=function(_0x562449,_0x2f658e){_0x562449=_0x562449-0x1b1;let _0xfdb821=_0x2dcf26[_0x562449];return _0xfdb821;},_0x5624(_0x58aa79,_0x6fab6f);}async function connectProxy(_0x28dd5a,_0x45d87a){const _0x4a984a=_0x2b0b67;for(let _0x19f084 of _0x28dd5a){_0x19f084[_0x4a984a(0x1e8)]==_0x45d87a[_0x4a984a(0x1e8)]?_0x19f084[_0x4a984a(0x210)]=!![]:_0x19f084['selected']=![];}dbConfigTable[_0x4a984a(0x1c1)](dbOther,{'title':'proxyServerList','value':JSON[_0x4a984a(0x1de)](_0x28dd5a)}),console[_0x4a984a(0x23e)](_0x4a984a(0x243),_0x45d87a['ip']);let _0x16cd52=apiConfig['port'],_0x99ad1f=_0x45d87a['port'],_0x13444d=_0x45d87a[_0x4a984a(0x1d3)],_0xaa5843=path[_0x4a984a(0x20b)](tmpPath,_0x4a984a(0x1c6));healthCheckUrl=_0x4a984a(0x219)+_0x13444d+_0x4a984a(0x1f3);let _0x32b9e4=_0x4a984a(0x1ea)+_0x45d87a['ip']+_0x4a984a(0x1b5)+_0x99ad1f+_0x4a984a(0x1fa)+userToken+_0x4a984a(0x1cf)+_0x13444d+'\x0asubdomain\x20=\x20'+_0x13444d+_0x4a984a(0x22d)+_0x13444d+_0x4a984a(0x1f2)+_0x16cd52+_0x4a984a(0x1ef)+_0x16cd52+'\x0aplugin_crt_path\x20=\x20'+crtPath+'\x0aplugin_key_path\x20=\x20\x20'+keyPath+_0x4a984a(0x1c3)+_0x13444d+_0x4a984a(0x1d9)+_0x45d87a[_0x4a984a(0x1df)]+'\x0a';fs[_0x4a984a(0x208)](_0xaa5843,_0x32b9e4,()=>{const _0x414e62=_0x4a984a;try{proxyProcess!=null&&proxyProcess[_0x414e62(0x1d5)](),proxyProcess=child_process[_0x414e62(0x1c5)](''+config['frpcPath'],['-c',_0xaa5843],{'detached':![],'killSignal':_0x414e62(0x1eb)}),proxyProcess['on'](_0x414e62(0x223),function(_0x3dff06){const _0x378baa=_0x414e62;return console[_0x378baa(0x23e)](_0x378baa(0x1ec),_0x3dff06),saveNasProxyState(_0x378baa(0x226),new Date()[_0x378baa(0x1c4)](),isWin?i18n['__'](_0x378baa(0x1f5)):i18n['__'](_0x378baa(0x1c7)));});}catch(_0x4fc997){return console['log'](_0x4fc997),saveNasProxyState(_0x414e62(0x226),new Date()['getTime'](),isWin?i18n['__'](_0x414e62(0x1f5)):i18n['__']('proxy.frpcStartFail'));}proxyProcess[_0x414e62(0x207)]['on'](_0x414e62(0x1f1),_0x58d8b9=>{const _0x4d9324=_0x414e62;let _0x575704=_0x58d8b9[_0x4d9324(0x1b6)]();console[_0x4d9324(0x23e)](_0x4d9324(0x1be),_0x575704);if(_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x225))!=-0x1)console[_0x4d9324(0x23e)](_0x4d9324(0x22b)),frpIsConnected=!![],setHealthCheckInterval(),saveNasProxyState(_0x4d9324(0x220),new Date()['getTime'](),i18n['__'](_0x4d9324(0x1f7)));else{if(_0x575704['indexOf']('cannot\x20find\x20the\x20file\x20specified')!=-0x1)startProxy();else{if(_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x1d8))!=-0x1||_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x217))!=-0x1){frpIsConnected=![];if(isWaittingTimeout)return;isWaittingTimeout=!![],setTimeout(()=>{const _0x399586=_0x4d9324;isWaittingTimeout=![],!frpIsConnected&&_0x575704['indexOf']('retry')!=-0x1&&(console[_0x399586(0x23e)](_0x399586(0x1f6),_0x575704),startProxy());},0x4e20);}else{if(_0x575704['indexOf'](_0x4d9324(0x222))!=-0x1){console['log'](_0x4d9324(0x1bc),_0x575704);var _0x22eae6=_0x575704[_0x4d9324(0x1f9)]('invalid\x20user');let _0x5f4845=_0x575704['substring'](_0x22eae6,_0x575704['length']);saveNasProxyState(_0x4d9324(0x226),new Date()[_0x4d9324(0x1c4)](),_0x5f4845);}else{if(_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x229))!=-0x1)frpIsConnected=!![],retryCount=0x0,console['log'](_0x4d9324(0x23b)),saveNasProxyState(_0x4d9324(0x220),new Date()[_0x4d9324(0x1c4)](),i18n['__']('proxy.conSuc')),dbOther[_0x4d9324(0x232)](_0x4d9324(0x1ca))['run'](proxyProcess[_0x4d9324(0x1e3)]+''),fs['rm'](crtPath,()=>{}),fs['rm'](keyPath,()=>{}),fs['rm'](_0xaa5843,()=>{}),setHealthCheckInterval();else{if(_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x213))!=-0x1)saveNasProxyState(_0x4d9324(0x226),new Date()[_0x4d9324(0x1c4)](),i18n['__'](_0x4d9324(0x212)));else{if(_0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x216))!=-0x1)saveNasProxyState(_0x4d9324(0x226),new Date()[_0x4d9324(0x1c4)](),i18n['__'](_0x4d9324(0x216))),tryRestartFrpc();else _0x575704[_0x4d9324(0x1b8)](_0x4d9324(0x20f))!=-0x1&&tryRestartFrpc();}}}}}}}),proxyProcess['stderr']['on'](_0x414e62(0x1f1),_0x2b274c=>{const _0x552777=_0x414e62;let _0x138afd=_0x2b274c['toString']();console['log'](_0x552777(0x1c9),_0x138afd),_0x138afd[_0x552777(0x1b8)](_0x552777(0x1d6))==-0x1&&_0x138afd[_0x552777(0x1b8)](_0x552777(0x1e4))==-0x1&&_0x138afd['indexOf']('TLS\x20handshake\x20error')==-0x1&&(frpIsConnected=![]),tryRestartFrpc();}),proxyProcess['on'](_0x414e62(0x1fb),_0x48a87f=>{const _0x3a6266=_0x414e62;console[_0x3a6266(0x23e)]('frpc\x20stopped'),frpIsConnected=![],stopProxy();});});}