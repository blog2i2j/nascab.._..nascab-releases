const _0x1e96f1=_0x1fc3;function _0x3ab5(){const _0x343009=['file_index_movie','235932mGJQcN','join','\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20file_index_movie\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20SET\x20movie_info_state=','SELECT\x20*\x20FROM\x20source_folder\x20where\x20type=\x27movie\x27\x20AND\x20\x20?\x20like\x20','catch','send','../utils/messageUtil','stack','811211rxsdrr','message','better-sqlite3','11330Otgimk','get','saveMovieInfoToDb','开始查询','../db/dbFileIndexTable','movie_info_state','\x20LIMIT\x201','runSearchNfoWorker','close','then','dbOther','424028JMdNLG','ignore_match_info','error','../myConfig/config','2348038LhVoFh','../utils/movieInfoUtil','getByWhere','usedNfo','exit','log','../utils/nfoUtil','parseNfo','Error\x20occurred\x20in\x20movie\x20info\x20searching\x20process','filename','138352aHgJyD','`path`||\x27','prepare','\x20movie_info_state=0\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20size>','journal_mode\x20=\x20WAL','nfo获取失败了','path',',movie_info_get_times=','pragma','4047642NYDXnJ','run','is_tvplay','18yHOTDw','NasCabMovieNfoWorker','441SxCvCM'];_0x3ab5=function(){return _0x343009;};return _0x3ab5();}(function(_0x2256a3,_0x5f1820){const _0xe18582=_0x1fc3,_0x3762d5=_0x2256a3();while(!![]){try{const _0x3d18da=parseInt(_0xe18582(0xdb))/0x1+-parseInt(_0xe18582(0x103))/0x2*(parseInt(_0xe18582(0x107))/0x3)+-parseInt(_0xe18582(0xe9))/0x4+-parseInt(_0xe18582(0xde))/0x5+-parseInt(_0xe18582(0x100))/0x6+parseInt(_0xe18582(0xed))/0x7+-parseInt(_0xe18582(0xf7))/0x8*(-parseInt(_0xe18582(0x105))/0x9);if(_0x3d18da===_0x5f1820)break;else _0x3762d5['push'](_0x3762d5['shift']());}catch(_0x592adb){_0x3762d5['push'](_0x3762d5['shift']());}}}(_0x3ab5,0x7ae4f));const config=require(_0x1e96f1(0xec));let path=require(_0x1e96f1(0xfd));const dbFileIndexTable=require(_0x1e96f1(0xe2)),Database=require(_0x1e96f1(0xdd));let dbFileIndex=new Database(config['dbFileIndex'],{'timeout':0xea60}),dbOther=new Database(config[_0x1e96f1(0xe8)],{});dbOther[_0x1e96f1(0xff)](_0x1e96f1(0xfb)),dbFileIndex['pragma'](_0x1e96f1(0xfb));const nfoUtil=require(_0x1e96f1(0xf3)),messageUtil=require(_0x1e96f1(0x10d)),movieInfoUtil=require(_0x1e96f1(0xee));process['title']=_0x1e96f1(0x104);function _0x1fc3(_0x392806,_0x118974){const _0x3ab512=_0x3ab5();return _0x1fc3=function(_0x1fc3dc,_0xc93021){_0x1fc3dc=_0x1fc3dc-0xda;let _0x56009a=_0x3ab512[_0x1fc3dc];return _0x56009a;},_0x1fc3(_0x392806,_0x118974);}function updateMovieInfoState(_0x3a223c,_0x3bcf0a,_0x16ca2f){const _0xde0051=_0x1e96f1;let _0x1931a1=new Date()['getTime']();const _0xacc701=_0xde0051(0x109)+_0x3bcf0a+',movie_info_get_time='+_0x1931a1+_0xde0051(0xfe)+_0x16ca2f+'\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id='+_0x3a223c+'\x0a\x09\x20\x20\x20\x20';return dbFileIndex['prepare'](_0xacc701)[_0xde0051(0x101)]();}function getInfoStart(){return new Promise((_0x14eb12,_0x114e55)=>{const _0x2ef2ab=_0x1fc3;let _0x5c52d8=0x400*0x400*0x64,_0x3ea9a4=dbFileIndexTable[_0x2ef2ab(0xef)](dbFileIndex,_0x2ef2ab(0xfa)+_0x5c52d8+_0x2ef2ab(0xe4),'*',_0x2ef2ab(0x106));if(_0x3ea9a4){let _0xa0cf81=path[_0x2ef2ab(0x108)](_0x3ea9a4[_0x2ef2ab(0xfd)],_0x3ea9a4['filename']);nfoUtil[_0x2ef2ab(0xf4)](_0x3ea9a4,!![],![])[_0x2ef2ab(0xe7)](_0x54a9ca=>{return updateMovieInfoState(_0x3ea9a4['id'],0x1,0x1),movieInfoUtil['saveMovieInfoToDb'](dbFileIndex,_0x3ea9a4['id'],_0x54a9ca),_0x14eb12({'usedNfo':!![]});})[_0x2ef2ab(0x10b)](_0x453a12=>{const _0x18785b=_0x2ef2ab;let _0x60ca10=_0x18785b(0x10a)+_0x18785b(0xf8)+path['sep']+'%\x27',_0x42d82a=dbOther[_0x18785b(0xf9)](_0x60ca10)[_0x18785b(0xdf)](path[_0x18785b(0x108)](_0x3ea9a4[_0x18785b(0xfd)],_0x3ea9a4['filename']));if(_0x42d82a&&_0x42d82a[_0x18785b(0xea)]==0x1)return updateMovieInfoState(_0x3ea9a4['id'],0x3,0x1),_0x14eb12();console[_0x18785b(0xf2)](_0x18785b(0xe1),_0x3ea9a4[_0x18785b(0xf6)],_0x3ea9a4[_0x18785b(0xe3)]),movieInfoUtil[_0x18785b(0xe5)](dbOther,_0x3ea9a4[_0x18785b(0xfd)],_0x3ea9a4[_0x18785b(0xf6)],_0x3ea9a4[_0x18785b(0x102)])[_0x18785b(0xe7)](_0x49a515=>{const _0x39ad30=_0x18785b;updateMovieInfoState(_0x3ea9a4['id'],0x1,0x1),nfoUtil['parseNfo'](_0x3ea9a4,!![],![])['then'](_0x28f492=>{const _0x377727=_0x1fc3;return movieInfoUtil[_0x377727(0xe0)](dbFileIndex,_0x3ea9a4['id'],_0x28f492),_0x14eb12();})[_0x39ad30(0x10b)](_0x3ef81e=>{return _0x14eb12();});})['catch'](_0xf42061=>{const _0x3d32ea=_0x18785b;return console['log'](_0x3d32ea(0xfc)),updateMovieInfoState(_0x3ea9a4['id'],0x3,0x1),_0x14eb12();});});}else exitProcess();});}function exitProcess(){const _0x51ba1b=_0x1e96f1;try{dbOther['close'](),dbFileIndex[_0x51ba1b(0xe6)]();}catch(_0x1718b9){}process[_0x51ba1b(0x10c)]({'type':_0x51ba1b(0xe6)}),process[_0x51ba1b(0xf1)]();}async function runGetMovieInfo(){const _0x10bbad=_0x1e96f1;getInfoStart()[_0x10bbad(0xe7)](_0x5386bb=>{const _0x26df3b=_0x10bbad;_0x5386bb&&_0x5386bb[_0x26df3b(0xf0)]?runGetMovieInfo():setTimeout(()=>{runGetMovieInfo();},0x1388);})[_0x10bbad(0x10b)](_0x35d71d=>{console['log'](_0x35d71d),exitProcess();});}runGetMovieInfo(),process['on']('uncaughtException',(_0x431a1e,_0x2aeaa3)=>{const _0x268343=_0x1e96f1;console['log'](_0x431a1e),messageUtil['saveMsg'](dbOther,_0x268343(0xf5),_0x268343(0xeb),_0x431a1e[_0x268343(0xda)]||_0x431a1e[_0x268343(0xdc)]);});