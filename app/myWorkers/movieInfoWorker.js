const _0x452996=_0x237c;(function(_0x2da7a2,_0x242a29){const _0xf476c2=_0x237c,_0x31e5fe=_0x2da7a2();while(!![]){try{const _0x208cf8=parseInt(_0xf476c2(0xbc))/0x1*(parseInt(_0xf476c2(0xc0))/0x2)+parseInt(_0xf476c2(0xa9))/0x3+parseInt(_0xf476c2(0xa2))/0x4*(-parseInt(_0xf476c2(0xbf))/0x5)+-parseInt(_0xf476c2(0xa7))/0x6+parseInt(_0xf476c2(0xc4))/0x7*(parseInt(_0xf476c2(0xc3))/0x8)+parseInt(_0xf476c2(0x96))/0x9+-parseInt(_0xf476c2(0x9f))/0xa*(parseInt(_0xf476c2(0xcb))/0xb);if(_0x208cf8===_0x242a29)break;else _0x31e5fe['push'](_0x31e5fe['shift']());}catch(_0x1c116f){_0x31e5fe['push'](_0x31e5fe['shift']());}}}(_0x1416,0xb700c));const config=require(_0x452996(0xb3));let path=require(_0x452996(0xba));const dbFileIndexTable=require('../db/dbFileIndexTable'),Database=require(_0x452996(0xb6));let dbFileIndex=new Database(config[_0x452996(0xb8)],{'timeout':0xea60}),dbOther=new Database(config[_0x452996(0x9c)],{});dbOther[_0x452996(0x9a)]('journal_mode\x20=\x20WAL'),dbFileIndex[_0x452996(0x9a)]('journal_mode\x20=\x20WAL');const nfoUtil=require(_0x452996(0xbb)),messageUtil=require(_0x452996(0xaf)),movieInfoUtil=require(_0x452996(0xc2));function _0x237c(_0x2f2ac0,_0x4ada09){const _0x14166e=_0x1416();return _0x237c=function(_0x237caf,_0x6d1faa){_0x237caf=_0x237caf-0x96;let _0x3fb2c5=_0x14166e[_0x237caf];return _0x3fb2c5;},_0x237c(_0x2f2ac0,_0x4ada09);}process[_0x452996(0xc9)]=_0x452996(0xb9);function updateMovieInfoState(_0x999006,_0x1f38eb,_0x2e7928){const _0xa3fe59=_0x452996;let _0x1a0a61=new Date()[_0xa3fe59(0xa3)]();const _0x515f4f=_0xa3fe59(0xb4)+_0x1f38eb+_0xa3fe59(0xad)+_0x1a0a61+_0xa3fe59(0xbe)+_0x2e7928+_0xa3fe59(0xac)+_0x999006+_0xa3fe59(0xb7);return dbFileIndex[_0xa3fe59(0xa0)](_0x515f4f)[_0xa3fe59(0x97)]();}function _0x1416(){const _0x469cb1=['43113bmQqmz','stack','join','close','usedNfo','title','sep','979YRhFVI','then','log','3432726yjiVoj','run','SELECT\x20*\x20FROM\x20source_folder\x20where\x20type=\x27movie\x27\x20AND\x20\x20?\x20like\x20','exit','pragma','saveMsg','dbOther','ignore_match_info','file_index_movie','11850yzEMAc','prepare','is_tvplay','5183316QwYvzt','getTime','message','filename','uncaughtException','8353758mOJNEd','\x20LIMIT\x201','4241046uxEzJy','get','\x20movie_info_state=0\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20size>','\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id=',',movie_info_get_time=','parseNfo','../utils/messageUtil','error','catch','send','../myConfig/config','\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20file_index_movie\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20SET\x20movie_info_state=','nfo获取失败了','better-sqlite3','\x0a\x09\x20\x20\x20\x20','dbFileIndex','NasCabMovieNfoWorker','path','../utils/nfoUtil','673868xIDsgP','开始查询',',movie_info_get_times=','5PnHokc','4PTVqaP','getByWhere','../utils/movieInfoUtil','520VUaayw'];_0x1416=function(){return _0x469cb1;};return _0x1416();}function getInfoStart(){return new Promise((_0x2efca2,_0x300fb7)=>{const _0x41b89f=_0x237c;let _0x271bfa=0x400*0x400*0x64,_0x14c6f4=dbFileIndexTable[_0x41b89f(0xc1)](dbFileIndex,_0x41b89f(0xab)+_0x271bfa+_0x41b89f(0xa8),'*',_0x41b89f(0x9e));if(_0x14c6f4){let _0x33d31f=path[_0x41b89f(0xc6)](_0x14c6f4['path'],_0x14c6f4[_0x41b89f(0xa5)]);nfoUtil[_0x41b89f(0xae)](_0x14c6f4,!![],![])[_0x41b89f(0xcc)](_0x24bee8=>{return updateMovieInfoState(_0x14c6f4['id'],0x1,0x1),movieInfoUtil['saveMovieInfoToDb'](dbFileIndex,_0x14c6f4['id'],_0x24bee8),_0x2efca2({'usedNfo':!![]});})[_0x41b89f(0xb1)](_0x23f9ae=>{const _0x3f52fd=_0x41b89f;let _0x2c97e6=_0x3f52fd(0x98)+'`path`||\x27'+path[_0x3f52fd(0xca)]+'%\x27',_0x355135=dbOther[_0x3f52fd(0xa0)](_0x2c97e6)[_0x3f52fd(0xaa)](path[_0x3f52fd(0xc6)](_0x14c6f4[_0x3f52fd(0xba)],_0x14c6f4[_0x3f52fd(0xa5)]));if(_0x355135&&_0x355135[_0x3f52fd(0x9d)]==0x1)return updateMovieInfoState(_0x14c6f4['id'],0x3,0x1),_0x2efca2();console['log'](_0x3f52fd(0xbd),_0x14c6f4[_0x3f52fd(0xa5)],_0x14c6f4['movie_info_state']),movieInfoUtil['runSearchNfoWorker'](dbOther,_0x14c6f4['path'],_0x14c6f4[_0x3f52fd(0xa5)],_0x14c6f4[_0x3f52fd(0xa1)])[_0x3f52fd(0xcc)](_0x5913c3=>{const _0x40bf34=_0x3f52fd;updateMovieInfoState(_0x14c6f4['id'],0x1,0x1),nfoUtil['parseNfo'](_0x14c6f4,!![],![])['then'](_0x2c9974=>{return movieInfoUtil['saveMovieInfoToDb'](dbFileIndex,_0x14c6f4['id'],_0x2c9974),_0x2efca2();})[_0x40bf34(0xb1)](_0x355a88=>{return _0x2efca2();});})['catch'](_0x6937cc=>{const _0xe12467=_0x3f52fd;return console[_0xe12467(0xcd)](_0xe12467(0xb5)),updateMovieInfoState(_0x14c6f4['id'],0x3,0x1),_0x2efca2();});});}else exitProcess();});}function exitProcess(){const _0x252728=_0x452996;try{dbOther[_0x252728(0xc7)](),dbFileIndex['close']();}catch(_0x1b7ceb){}process[_0x252728(0xb2)]({'type':_0x252728(0xc7)}),process[_0x252728(0x99)]();}async function runGetMovieInfo(){const _0x440c20=_0x452996;getInfoStart()[_0x440c20(0xcc)](_0x19e39e=>{const _0x2b7ff0=_0x440c20;_0x19e39e&&_0x19e39e[_0x2b7ff0(0xc8)]?runGetMovieInfo():setTimeout(()=>{runGetMovieInfo();},0x1388);})[_0x440c20(0xb1)](_0x30e02c=>{const _0x3c2fd3=_0x440c20;console[_0x3c2fd3(0xcd)](_0x30e02c),exitProcess();});}runGetMovieInfo(),process['on'](_0x452996(0xa6),(_0x4e207b,_0x521757)=>{const _0x1c6cff=_0x452996;console[_0x1c6cff(0xcd)](_0x4e207b),messageUtil[_0x1c6cff(0x9b)](dbOther,'Error\x20occurred\x20in\x20movie\x20info\x20searching\x20process',_0x1c6cff(0xb0),_0x4e207b[_0x1c6cff(0xc5)]||_0x4e207b[_0x1c6cff(0xa4)]);});