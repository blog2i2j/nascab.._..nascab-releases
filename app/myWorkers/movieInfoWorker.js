const _0x475cd4=_0x1daa;(function(_0x23fd74,_0x11aac0){const _0x2b41ba=_0x1daa,_0x57f907=_0x23fd74();while(!![]){try{const _0x44e37f=parseInt(_0x2b41ba(0x1ea))/0x1+-parseInt(_0x2b41ba(0x1e5))/0x2*(-parseInt(_0x2b41ba(0x1d7))/0x3)+parseInt(_0x2b41ba(0x1e3))/0x4*(parseInt(_0x2b41ba(0x1c5))/0x5)+-parseInt(_0x2b41ba(0x1e0))/0x6+parseInt(_0x2b41ba(0x1d1))/0x7+parseInt(_0x2b41ba(0x1d0))/0x8*(parseInt(_0x2b41ba(0x1bc))/0x9)+-parseInt(_0x2b41ba(0x1bf))/0xa*(-parseInt(_0x2b41ba(0x1e6))/0xb);if(_0x44e37f===_0x11aac0)break;else _0x57f907['push'](_0x57f907['shift']());}catch(_0x4f8dd2){_0x57f907['push'](_0x57f907['shift']());}}}(_0x4480,0x4c5c7));function _0x1daa(_0x4a46be,_0x4fca7b){const _0x4480ad=_0x4480();return _0x1daa=function(_0x1daad8,_0x1a0a89){_0x1daad8=_0x1daad8-0x1b7;let _0x1d76b2=_0x4480ad[_0x1daad8];return _0x1d76b2;},_0x1daa(_0x4a46be,_0x4fca7b);}const config=require(_0x475cd4(0x1e8));let path=require(_0x475cd4(0x1bd));const dbFileIndexTable=require(_0x475cd4(0x1d4)),Database=require(_0x475cd4(0x1c8));let dbFileIndex=new Database(config[_0x475cd4(0x1cf)],{'timeout':0xea60}),dbOther=new Database(config[_0x475cd4(0x1b9)],{});dbOther[_0x475cd4(0x1db)]('journal_mode\x20=\x20WAL'),dbFileIndex[_0x475cd4(0x1db)](_0x475cd4(0x1be));const nfoUtil=require(_0x475cd4(0x1e7)),messageUtil=require(_0x475cd4(0x1e2)),movieInfoUtil=require(_0x475cd4(0x1cd));process[_0x475cd4(0x1c3)]='NasCabMovieNfoWorker';function _0x4480(){const _0x598de0=['send','../utils/messageUtil','24JTSMkB','\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20file_index_movie\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20SET\x20movie_info_state=','28WeMOSI','28094JBemfi','../utils/nfoUtil','../myConfig/config','catch','59879kjAKRN','SELECT\x20*\x20FROM\x20source_folder\x20where\x20type=\x27movie\x27\x20AND\x20\x20?\x20like\x20','then','dbOther','getTime','filename','9xgHbLG','path','journal_mode\x20=\x20WAL','70aXPiOW','uncaughtException','is_tvplay','开始查询','title','join','350255LAFTyh',',movie_info_get_times=','ignore_match_info','better-sqlite3','log','nfo获取失败了',',movie_info_get_time=','error','../utils/movieInfoUtil','exit','dbFileIndex','807496pbOjPs','1110375BfaIle','\x0a\x09\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id=','movie_info_state','../db/dbFileIndexTable','run','prepare','28434RJSozB','parseNfo','Error\x20occurred\x20in\x20movie\x20info\x20searching\x20process','close','pragma','getByWhere','saveMovieInfoToDb','message','get','3465252liZlIJ'];_0x4480=function(){return _0x598de0;};return _0x4480();}function updateMovieInfoState(_0xa14f86,_0x5f2f9f,_0x8c05fe){const _0x4b69d4=_0x475cd4;let _0x10d11e=new Date()[_0x4b69d4(0x1ba)]();const _0x5c57de=_0x4b69d4(0x1e4)+_0x5f2f9f+_0x4b69d4(0x1cb)+_0x10d11e+_0x4b69d4(0x1c6)+_0x8c05fe+_0x4b69d4(0x1d2)+_0xa14f86+'\x0a\x09\x20\x20\x20\x20';return dbFileIndex['prepare'](_0x5c57de)[_0x4b69d4(0x1d5)]();}function getInfoStart(){return new Promise((_0x2dd318,_0x1a527e)=>{const _0x17fae6=_0x1daa;let _0x4900b2=0x400*0x400*0x64,_0x1ea9c2=dbFileIndexTable[_0x17fae6(0x1dc)](dbFileIndex,'\x20movie_info_state=0\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20size>'+_0x4900b2+'\x20LIMIT\x201','*','file_index_movie');if(_0x1ea9c2){let _0x105d38=path[_0x17fae6(0x1c4)](_0x1ea9c2[_0x17fae6(0x1bd)],_0x1ea9c2[_0x17fae6(0x1bb)]);nfoUtil['parseNfo'](_0x1ea9c2,!![],![])[_0x17fae6(0x1b8)](_0x4b707e=>{return updateMovieInfoState(_0x1ea9c2['id'],0x1,0x1),movieInfoUtil['saveMovieInfoToDb'](dbFileIndex,_0x1ea9c2['id'],_0x4b707e),_0x2dd318({'usedNfo':!![]});})[_0x17fae6(0x1e9)](_0x162aa9=>{const _0x3a02d9=_0x17fae6;let _0x1e577=_0x3a02d9(0x1b7)+'`path`||\x27'+path['sep']+'%\x27',_0xd42cea=dbOther[_0x3a02d9(0x1d6)](_0x1e577)[_0x3a02d9(0x1df)](path[_0x3a02d9(0x1c4)](_0x1ea9c2[_0x3a02d9(0x1bd)],_0x1ea9c2[_0x3a02d9(0x1bb)]));if(_0xd42cea&&_0xd42cea[_0x3a02d9(0x1c7)]==0x1)return updateMovieInfoState(_0x1ea9c2['id'],0x3,0x1),_0x2dd318();console[_0x3a02d9(0x1c9)](_0x3a02d9(0x1c2),_0x1ea9c2[_0x3a02d9(0x1bb)],_0x1ea9c2[_0x3a02d9(0x1d3)]),movieInfoUtil['runSearchNfoWorker'](dbOther,_0x1ea9c2[_0x3a02d9(0x1bd)],_0x1ea9c2[_0x3a02d9(0x1bb)],_0x1ea9c2[_0x3a02d9(0x1c1)])[_0x3a02d9(0x1b8)](_0x54e70b=>{const _0x3f8df6=_0x3a02d9;updateMovieInfoState(_0x1ea9c2['id'],0x1,0x1),nfoUtil[_0x3f8df6(0x1d8)](_0x1ea9c2,!![],![])[_0x3f8df6(0x1b8)](_0x43ea6=>{const _0x9d602c=_0x3f8df6;return movieInfoUtil[_0x9d602c(0x1dd)](dbFileIndex,_0x1ea9c2['id'],_0x43ea6),_0x2dd318();})['catch'](_0x51dccb=>{return _0x2dd318();});})[_0x3a02d9(0x1e9)](_0x4ca096=>{const _0x4cfa7d=_0x3a02d9;return console[_0x4cfa7d(0x1c9)](_0x4cfa7d(0x1ca)),updateMovieInfoState(_0x1ea9c2['id'],0x3,0x1),_0x2dd318();});});}else exitProcess();});}function exitProcess(){const _0x536020=_0x475cd4;try{dbOther[_0x536020(0x1da)](),dbFileIndex[_0x536020(0x1da)]();}catch(_0x1eab38){}process[_0x536020(0x1e1)]({'type':_0x536020(0x1da)}),process[_0x536020(0x1ce)]();}async function runGetMovieInfo(){const _0xa54f7b=_0x475cd4;getInfoStart()['then'](_0x3b40d5=>{_0x3b40d5&&_0x3b40d5['usedNfo']?runGetMovieInfo():setTimeout(()=>{runGetMovieInfo();},0x1388);})[_0xa54f7b(0x1e9)](_0x5cb1a8=>{const _0x3efc6a=_0xa54f7b;console[_0x3efc6a(0x1c9)](_0x5cb1a8),exitProcess();});}runGetMovieInfo(),process['on'](_0x475cd4(0x1c0),(_0x3bcacc,_0x126f8c)=>{const _0x5ddffa=_0x475cd4;console['log'](_0x3bcacc),messageUtil['saveMsg'](dbOther,_0x5ddffa(0x1d9),_0x5ddffa(0x1cc),_0x3bcacc['stack']||_0x3bcacc[_0x5ddffa(0x1de)]);});