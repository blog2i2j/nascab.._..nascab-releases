function _0x30ed(_0x4b969f,_0x25d6aa){const _0x4afa08=_0x4afa();return _0x30ed=function(_0x30ed8c,_0x5238f0){_0x30ed8c=_0x30ed8c-0x1c2;let _0x1b1be2=_0x4afa08[_0x30ed8c];return _0x1b1be2;},_0x30ed(_0x4b969f,_0x25d6aa);}const _0x54beab=_0x30ed;(function(_0x2ec4c4,_0xa264ee){const _0x5acecf=_0x30ed,_0x4c72b9=_0x2ec4c4();while(!![]){try{const _0x292721=-parseInt(_0x5acecf(0x1fe))/0x1+-parseInt(_0x5acecf(0x1da))/0x2+-parseInt(_0x5acecf(0x1c2))/0x3*(parseInt(_0x5acecf(0x1d5))/0x4)+parseInt(_0x5acecf(0x1d7))/0x5*(parseInt(_0x5acecf(0x1ec))/0x6)+-parseInt(_0x5acecf(0x1ed))/0x7+parseInt(_0x5acecf(0x1f1))/0x8+parseInt(_0x5acecf(0x1db))/0x9;if(_0x292721===_0xa264ee)break;else _0x4c72b9['push'](_0x4c72b9['shift']());}catch(_0x5938ae){_0x4c72b9['push'](_0x4c72b9['shift']());}}}(_0x4afa,0x87f91));function _0x4afa(){const _0x119cd6=['../../myConfig/config','../../db/dbDownloadTasksTable','startTask','prepare','operation','下载线程已经退出,从缓存列表删除','forkNewBtDownloadWorker','STATE_COMPLETED','deleteTask','569740obLaWA','updateTaskField','torrentPath','getAllTaskFromDb','maxDownloadingCount','forkNewHttpDownloadWorker','16554xHPquR','START_ALL','task_type','taskWorkerCacheList','删除全部任务\x20异常','deleteAll','btManager\x20异常','STATE_WAITING','RESTART','startAll','task_name','onTaskChange','DELETE','BT下载Worker已存在','log','splice','taskObj','暂停全部任务\x20异常','worker','508dmdNuq','setAllDownloadingTaskToPause','3261020kNLlKw','新建BT下载Worker','PAUSE_ALL','327878aXCuXo','7962741OnxEsw','getTargetCache','当前状态','exports','STATE_DOWNLOADING','START','SELECT\x20*\x20FROM\x20download_tasks\x20WHERE\x20task_state\x20<\x20?','includes','workerSendMsg','任务无需开始','maxUploadSpeed','pauseAll','PAUSE','ADD','STATE_PAUSE','maxDownloadSpeed','pauseTask','6eHTBlg','200508IaRAGr','dbOther','MAGNET','taskObjList','3864808UAmexg','all','task_state','length'];_0x4afa=function(){return _0x119cd6;};return _0x4afa();}const dbDownloadTasksTable=require(_0x54beab(0x1f6)),config=require(_0x54beab(0x1f5));let shouldStartDownloadStateList=[dbDownloadTasksTable['STATE_PARSING'],dbDownloadTasksTable[_0x54beab(0x1c9)],dbDownloadTasksTable[_0x54beab(0x1fc)],dbDownloadTasksTable[_0x54beab(0x1df)],dbDownloadTasksTable['STATE_PAUSE']];class btDownloadManager{constructor(_0x523118,_0x5ac45e,_0x412873,_0x406172){const _0x479028=_0x54beab;try{this[_0x479028(0x1ee)]=_0x523118,this[_0x479028(0x1fb)]=_0x5ac45e,this[_0x479028(0x203)]=_0x412873,this[_0x479028(0x1e3)]=_0x406172,this[_0x479028(0x1c5)]=[],this[_0x479028(0x202)]=0x1,this[_0x479028(0x1ea)]=0x400*0x400,this[_0x479028(0x1e5)]=0x400*0x400;}catch(_0x805d33){console[_0x479028(0x1d0)](_0x805d33);}}[_0x54beab(0x1d6)](){const _0x313ea9=_0x54beab;dbDownloadTasksTable[_0x313ea9(0x1d6)](this[_0x313ea9(0x1ee)]);}['getAllTaskFromDb'](){const _0x5ec049=_0x54beab;this[_0x5ec049(0x1f0)]=this[_0x5ec049(0x1ee)][_0x5ec049(0x1f8)](_0x5ec049(0x1e1))[_0x5ec049(0x1f2)](dbDownloadTasksTable[_0x5ec049(0x1fc)]);}[_0x54beab(0x1e6)](){const _0x40c07e=_0x54beab;try{this[_0x40c07e(0x201)]();for(let _0xc29c18 of this[_0x40c07e(0x1f0)]){this[_0x40c07e(0x1eb)](_0xc29c18);}}catch(_0x3cb149){console[_0x40c07e(0x1d0)](_0x40c07e(0x1d3),_0x3cb149);}}[_0x54beab(0x1c7)](){const _0x287ad7=_0x54beab;try{this[_0x287ad7(0x201)]();for(let _0x5eeb95 of this['taskObjList']){this[_0x287ad7(0x1fd)](_0x5eeb95);}}catch(_0x51e98c){console[_0x287ad7(0x1d0)](_0x287ad7(0x1c6),_0x51e98c);}}['startAll'](){const _0x185ef0=_0x54beab;try{this[_0x185ef0(0x201)]();for(let _0x314c7d of this[_0x185ef0(0x1f0)]){this['startTask'](_0x314c7d);}}catch(_0x2b3201){console[_0x185ef0(0x1d0)](_0x185ef0(0x1c8),_0x2b3201);}}[_0x54beab(0x1fd)](_0x21e857){const _0x16f3ab=_0x54beab;let _0x270c64=this[_0x16f3ab(0x1dc)](_0x21e857['id']);_0x270c64?this[_0x16f3ab(0x1e3)](_0x270c64['worker'],{'operation':_0x16f3ab(0x1ce),'taskObj':_0x270c64[_0x16f3ab(0x1d2)]}):console['log']('DELETE\x20未找到缓存的worker');}[_0x54beab(0x1eb)](_0x18180d){const _0x57b608=_0x54beab;let _0x18b070=this[_0x57b608(0x1dc)](_0x18180d['id']);dbDownloadTasksTable[_0x57b608(0x1ff)](this[_0x57b608(0x1ee)],_0x18180d['id'],_0x57b608(0x1f3),dbDownloadTasksTable[_0x57b608(0x1e9)]),_0x18b070?this['workerSendMsg'](_0x18b070[_0x57b608(0x1d4)],{'operation':_0x57b608(0x1e7),'taskObj':_0x18b070[_0x57b608(0x1d2)]}):console['log']('PAUSE\x20未找到缓存的worker');}[_0x54beab(0x1f7)](_0x217b46){const _0xd2d41f=_0x54beab;if(!shouldStartDownloadStateList[_0xd2d41f(0x1e2)](_0x217b46[_0xd2d41f(0x1f3)])){console[_0xd2d41f(0x1d0)](_0xd2d41f(0x1e4),_0x217b46[_0xd2d41f(0x1cc)],_0xd2d41f(0x1dd),_0x217b46['task_state']);return;}let _0x34f52a;for(let _0x1c32e4 in this[_0xd2d41f(0x1c5)]){if(this[_0xd2d41f(0x1c5)][_0x1c32e4][_0xd2d41f(0x1d2)]['id']==_0x217b46['id']){_0x34f52a=this[_0xd2d41f(0x1c5)][_0x1c32e4]['worker'],console[_0xd2d41f(0x1d0)](_0xd2d41f(0x1cf));break;}}!_0x34f52a&&(console[_0xd2d41f(0x1d0)](_0xd2d41f(0x1d8)),_0x217b46[_0xd2d41f(0x1c4)]=='TORRENT'||_0x217b46[_0xd2d41f(0x1c4)]==_0xd2d41f(0x1ef)?_0x34f52a=this['forkNewBtDownloadWorker']():_0x34f52a=this[_0xd2d41f(0x203)](),_0x34f52a['on']('exit',()=>{const _0x3eaf47=_0xd2d41f;try{for(let _0x116294 in this[_0x3eaf47(0x1c5)]){let _0x5043f8=this[_0x3eaf47(0x1c5)][_0x116294];if(_0x5043f8['worker']===_0x34f52a){console[_0x3eaf47(0x1d0)](_0x3eaf47(0x1fa)),this[_0x3eaf47(0x1c5)][_0x3eaf47(0x1d1)](_0x116294,0x1);break;}}}catch(_0x4ca3ed){console[_0x3eaf47(0x1d0)](_0x4ca3ed);}}),this[_0xd2d41f(0x1c5)]['push']({'taskObj':_0x217b46,'worker':_0x34f52a})),this[_0xd2d41f(0x1e3)](_0x34f52a,{'torrentSaveFolder':config[_0xd2d41f(0x200)],'operation':'START','taskObj':_0x217b46});}[_0x54beab(0x1dc)](_0x46d31e){const _0x36234d=_0x54beab;for(let _0x55819b in this[_0x36234d(0x1c5)]){let _0x4ed753=this[_0x36234d(0x1c5)][_0x55819b];if(_0x4ed753[_0x36234d(0x1d2)]['id']===_0x46d31e)return _0x4ed753;}}[_0x54beab(0x1cd)](_0x5935db){const _0x522717=_0x54beab;console[_0x522717(0x1d0)]('下载任务变化',_0x5935db[_0x522717(0x1f9)]);let {operation:_0x48ab7a,taskId:_0xb9d221,deleteFile:_0x5f4c1d}=_0x5935db;if(_0x48ab7a==_0x522717(0x1e8)){if(_0x5935db[_0x522717(0x1f0)]&&_0x5935db[_0x522717(0x1f0)][_0x522717(0x1f4)]>0x0)for(let _0x33dca3 of _0x5935db[_0x522717(0x1f0)]){this[_0x522717(0x1f7)](_0x33dca3);}}else{if(_0x48ab7a==_0x522717(0x1ce))this['deleteTask'](_0x5935db['taskObj']);else{if(_0x48ab7a==_0x522717(0x1e7))this['pauseTask'](_0x5935db['taskObj']);else{if(_0x48ab7a==_0x522717(0x1e0))_0x5935db['taskObj']&&this['startTask'](_0x5935db['taskObj']);else{if(_0x48ab7a==_0x522717(0x1ca))_0x5935db[_0x522717(0x1d2)]&&(this[_0x522717(0x1eb)](_0x5935db['taskObj']),this[_0x522717(0x1f7)](_0x5935db[_0x522717(0x1d2)]));else{if(_0x48ab7a==_0x522717(0x1c3))this[_0x522717(0x1cb)]();else{if(_0x48ab7a==_0x522717(0x1d9))this[_0x522717(0x1e6)]();else _0x48ab7a=='DELETE_ALL'&&this[_0x522717(0x1c7)]();}}}}}}}}module[_0x54beab(0x1de)]=btDownloadManager;