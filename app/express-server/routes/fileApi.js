const _0x1d5784=_0x5062;(function(_0x25fa6a,_0x4eedbc){const _0x2d489c=_0x5062,_0x39c414=_0x25fa6a();while(!![]){try{const _0x47bb99=-parseInt(_0x2d489c(0x152))/0x1*(-parseInt(_0x2d489c(0x12d))/0x2)+parseInt(_0x2d489c(0x15a))/0x3*(-parseInt(_0x2d489c(0x14c))/0x4)+-parseInt(_0x2d489c(0x137))/0x5+parseInt(_0x2d489c(0x17a))/0x6*(-parseInt(_0x2d489c(0x118))/0x7)+-parseInt(_0x2d489c(0x154))/0x8*(parseInt(_0x2d489c(0x150))/0x9)+-parseInt(_0x2d489c(0x17b))/0xa*(parseInt(_0x2d489c(0x175))/0xb)+-parseInt(_0x2d489c(0x101))/0xc*(-parseInt(_0x2d489c(0x169))/0xd);if(_0x47bb99===_0x4eedbc)break;else _0x39c414['push'](_0x39c414['shift']());}catch(_0x15924a){_0x39c414['push'](_0x39c414['shift']());}}}(_0x21ab,0xb8798));let express=require('express'),router=express['Router'](),path=require('path'),fs=require('fs');function _0x21ab(){const _0x58c7b3=['inOutTrash','../../db/dbMusicIndexTable','/getInfo','currentUser','getFileHashName','166738KhLFnC','indexId','power_get','LEVEL_MAIN_OPERATION','filename','dbOther','tiny_path','/inOutTrash','push','deleteIndexFolder','attachment;\x20filename*=UTF-8\x27\x27','size','4411ZKFyUX','end','stat','headers','includes','4661682YVUraH','37470dqBJxc','exifInfo','UPDATE\x20file_index_photo\x20SET\x20is_show=0\x20WHERE\x20path=?\x20AND\x20filename\x20=?','Unable\x20to\x20read\x20file','ids','download','serverType','.txt','Content-Disposition','set','.HEIC','STATE_SUC','sep','trash','5028BfXwVO','join','check_time','ignoreLivephoto','is_file','range','rawImgTypeList','extname','utf8','../utils/sharpUtils','body','cachePath','videoTypeList','log','setHeader','status','returnErrMsg','.JPG','decodePath','app','/deleteFromDisk','getTime','params\x20is\x20not\x20valid','7YJMoBK','../../myConfig/config','.MOV','UPDATE\x20file_index_photo\x20SET\x20is_show=1\x20WHERE\x20path=?\x20AND\x20filename\x20=?','sendStatus','doUserCanGet','dbFileIndex','music','file\x20not\x20found','../../db/dbFileOperationRecord','STATE_FAIL','changes','imgTypeList','sendFile','image','deletePathAll','replace','/clearTinyImg','video','putInSystemTrash','updateById','206odadoT','delete','operation\x20fail','basename','genTinyFile','isFile','transToMp3','returnDealedFile','exports','shell','4264220LSzyYD','raw','then','exifr','pipe','post','query','code','toLowerCase','Convert\x20to\x20utf8\x20','increasePlayCount','.MP4','addFileOperationRecord','path','run','json','photo','audio/mpeg','endsWith','is_livephoto','toUpperCase','4hLBFky','get','returnFileError','send','9ZpHNOZ','Content-Type','9131IPsBXK','parse','7325216ddAKNf','fullPath','../../utils/musicTransCodeUtil','/tinyImg*','username','length','4532967iSCjOq','getIndexTableNameByType','getFileHashNameByPathAndStat','bytes=0-1','sharp','dirname','power_delete','catch','prepare','raw_filename'];_0x21ab=function(){return _0x58c7b3;};return _0x21ab();}const sharp=require(_0x1d5784(0x15e));function _0x5062(_0x22982a,_0x2536a8){const _0x21ab09=_0x21ab();return _0x5062=function(_0x50626a,_0x3ac866){_0x50626a=_0x50626a-0xf6;let _0x38921b=_0x21ab09[_0x50626a];return _0x38921b;},_0x5062(_0x22982a,_0x2536a8);}let sharpUtil=require(_0x1d5784(0x10a)),exifUtil=require(_0x1d5784(0x13a)),fileUtil=require('../utils/fileUtils');const config=require(_0x1d5784(0x119)),dbFileIndexTable=require('../../db/dbFileIndexTable'),dbFileOperationRecord=require(_0x1d5784(0x121)),dbUserTable=require('../../db/dbUserTable'),dbMusicIndexTable=require(_0x1d5784(0x165));let musicTransCodeUtil=require(_0x1d5784(0x156));const encodingUtil=require('../../utils/encodingUtil');function getIndexTableName(_0x587411){const _0x1deafa=_0x1d5784;let _0x9d80c8=dbFileIndexTable[_0x1deafa(0x15b)](_0x587411);return _0x9d80c8;}function getIndexObj(_0x337c53,_0x36e7bf){const _0x3d63a2=_0x1d5784;let _0x4e81f6=_0x337c53[_0x3d63a2(0x10b)][_0x3d63a2(0xf9)]||_0x337c53[_0x3d63a2(0x13d)][_0x3d63a2(0xf9)],_0x2e44ef=getIndexTableName(_0x4e81f6);return dbFileIndexTable['getById'](_0x337c53['app'][_0x3d63a2(0x11e)],_0x36e7bf,_0x2e44ef);}router[_0x1d5784(0x13c)](_0x1d5784(0x170),(_0x2cb698,_0x41b664,_0x243cbd)=>{const _0x45769c=_0x1d5784;let _0x5946a1=_0x2cb698[_0x45769c(0x10b)][_0x45769c(0xf7)],_0x3cc30f=_0x2cb698['body'][_0x45769c(0x100)];if(dbUserTable[_0x45769c(0x11d)](_0x2cb698,_0x41b664,_0x45769c(0x147),'power_delete')==!![]){if(_0x5946a1&&_0x5946a1['length']>0x0){let _0x509892='(';for(let _0x221232=0x0;_0x221232<_0x5946a1[_0x45769c(0x159)];_0x221232++){let _0x53cbb1=getIndexObj(_0x2cb698,_0x5946a1[_0x221232]);if(!_0x53cbb1)continue;_0x53cbb1[_0x45769c(0x163)]!=null&&_0x53cbb1[_0x45769c(0x163)]!=''&&_0x53cbb1[_0x45769c(0x105)]&&(_0x3cc30f==0x1?_0x2cb698['app']['dbFileIndex'][_0x45769c(0x162)](_0x45769c(0x11b))[_0x45769c(0x145)](_0x53cbb1[_0x45769c(0x144)],_0x53cbb1['raw_filename']):_0x2cb698[_0x45769c(0x114)][_0x45769c(0x11e)][_0x45769c(0x162)](_0x45769c(0x17d))[_0x45769c(0x145)](_0x53cbb1['path'],_0x53cbb1[_0x45769c(0x163)])),_0x509892+=_0x5946a1[_0x221232],_0x221232!=_0x5946a1[_0x45769c(0x159)]-0x1&&(_0x509892+=',');}_0x509892+=')';let _0x4c953f=dbFileIndexTable[_0x45769c(0x164)](_0x2cb698['app']['dbFileIndex'],_0x509892,_0x3cc30f,getIndexTableName(_0x2cb698[_0x45769c(0x10b)][_0x45769c(0xf9)]));_0x4c953f[_0x45769c(0x123)]>0x0&&_0x41b664['json']({'code':0x0,'count':_0x4c953f[_0x45769c(0x123)]});}else{_0x41b664[_0x45769c(0x146)]({'code':0x1,'message':'params\x20is\x20not\x20valid'});return;}}}),router[_0x1d5784(0x13c)](_0x1d5784(0x115),(_0xc278a7,_0x1cbbbe,_0x290d56)=>{const _0x450f1d=_0x1d5784;let _0x31b377=_0xc278a7[_0x450f1d(0x10b)][_0x450f1d(0xf7)],_0x6723ab=_0xc278a7[_0x450f1d(0x10b)]['serverType'],_0x459fcf=_0xc278a7[_0x450f1d(0x10b)][_0x450f1d(0x172)]==0x1,_0x25ea0f=_0xc278a7[_0x450f1d(0x10b)][_0x450f1d(0x104)]==0x1,_0xe85b90=_0xc278a7[_0x450f1d(0x10b)][_0x450f1d(0x12b)],_0x4a8f02=getIndexTableName(_0x6723ab);function _0x2ee32d(_0x4f08bc,_0x33da21){const _0x7d8128=_0x450f1d;dbFileOperationRecord[_0x7d8128(0x143)](_0xc278a7[_0x7d8128(0x114)][_0x7d8128(0x16e)],{'username':_0xc278a7[_0x7d8128(0x167)][_0x7d8128(0x158)],'targetPath':_0x4f08bc,'level':dbFileOperationRecord[_0x7d8128(0x16c)],'type':dbFileOperationRecord['TYPE_DELETE'],'state':_0x33da21?dbFileOperationRecord[_0x7d8128(0xfe)]:dbFileOperationRecord[_0x7d8128(0x122)]});}function _0x4e9128(_0x54343d){const _0x58d15e=_0x450f1d;if(_0x54343d['is_file']==0x1&&_0x54343d[_0x58d15e(0x14a)]==0x1){let _0x3dfc20=path[_0x58d15e(0x102)](_0x54343d['path'],_0x54343d[_0x58d15e(0x16d)][_0x58d15e(0x128)](_0x58d15e(0x11a),'')+_0x58d15e(0xfd));_0x54343d[_0x58d15e(0x16d)][_0x58d15e(0x149)](_0x58d15e(0x142))&&(_0x3dfc20=path[_0x58d15e(0x102)](_0x54343d[_0x58d15e(0x144)],_0x54343d[_0x58d15e(0x16d)][_0x58d15e(0x128)](_0x58d15e(0x142),'')+_0x58d15e(0x112))),fs['existsSync'](_0x3dfc20)&&_0xdcd021(_0x54343d,_0x3dfc20,![]);}}function _0xdcd021(_0x46001f,_0x5ab4ef,_0x554328){const _0x59142a=_0x450f1d;_0xe85b90==0x1?(process[_0x59142a(0x14f)]({'type':_0x59142a(0x136),'shellType':_0x59142a(0x100),'path':_0x5ab4ef}),_0x2ee32d(_0x5ab4ef,!![])):fs['rm'](_0x5ab4ef,{'recursive':!![]},_0x34070f=>{_0x34070f?_0x2ee32d(_0x5ab4ef,![]):_0x2ee32d(_0x5ab4ef,!![]);}),_0x554328&&_0x4e9128(_0x46001f);}function _0x17e558(_0x5ed607){const _0x581906=_0x450f1d;dbFileIndexTable[_0x581906(0x12e)](_0xc278a7[_0x581906(0x114)]['dbFileIndex'],_0x5ed607,_0x4a8f02);}function _0xc539f8(_0x249e28,_0x21abfd){const _0x22a6e3=_0x450f1d;if(!_0x21abfd)return;dbFileIndexTable[_0x22a6e3(0x12e)](_0xc278a7[_0x22a6e3(0x114)][_0x22a6e3(0x11e)],_0x249e28,_0x4a8f02);let _0x5486d7=dbFileIndexTable[_0x22a6e3(0x127)](_0xc278a7[_0x22a6e3(0x114)]['dbFileIndex'],_0x21abfd,_0x4a8f02);}if(_0x31b377&&_0x31b377['length']>0x0){let _0x5d4fed=0x0,_0xd688a2=0x0,_0x503eed=[];for(let _0xb97ab9=0x0;_0xb97ab9<_0x31b377[_0x450f1d(0x159)];_0xb97ab9++){let _0x17709c=_0x31b377[_0xb97ab9],_0x4f6c2f=getIndexObj(_0xc278a7,_0x17709c,_0x4a8f02);if(_0x4f6c2f){if(dbUserTable['doUserCanGet'](_0xc278a7,_0x1cbbbe,_0x6723ab,_0x450f1d(0x160),_0x4f6c2f[_0x450f1d(0x144)])==!![]){_0x5d4fed+=0x1,_0x503eed[_0x450f1d(0x171)](_0x17709c);let _0x47db64=path[_0x450f1d(0x102)](_0x4f6c2f[_0x450f1d(0x144)],path[_0x450f1d(0xff)],_0x4f6c2f[_0x450f1d(0x16d)]),_0x37fdbd=_0x4f6c2f['is_file']==0x0;_0x459fcf&&(_0x47db64=_0x4f6c2f[_0x450f1d(0x144)],_0x37fdbd=!![]),_0x37fdbd?_0xc539f8(_0x17709c,_0x47db64):_0x17e558(_0x17709c),_0xdcd021(_0x4f6c2f,_0x47db64,!_0x25ea0f);}else _0xd688a2+=0x1;}}return _0x1cbbbe[_0x450f1d(0x146)]({'code':0x0,'deletedIds':_0x503eed,'deleteCount':_0x5d4fed,'errCount':_0xd688a2});}else return _0xc278a7[_0x450f1d(0x114)][_0x450f1d(0x111)](_0x1cbbbe,_0x450f1d(0x117));});function genTinyForFilePath(_0x3d92b0,_0x3e33fa,_0x18dac8,_0x5d7ae5){const _0x5bd88a=_0x1d5784;let _0x14e55c=path['extname'](_0x3e33fa)?path[_0x5bd88a(0x108)](_0x3e33fa)[_0x5bd88a(0x13f)]():null,_0x4dd4ad=![];if(config[_0x5bd88a(0x124)]['includes'](_0x14e55c)||config[_0x5bd88a(0x107)][_0x5bd88a(0x179)](_0x14e55c[_0x5bd88a(0x13f)]()))_0x4dd4ad=_0x5bd88a(0x126);else{if(config[_0x5bd88a(0x10d)][_0x5bd88a(0x179)](_0x14e55c))_0x4dd4ad=_0x5bd88a(0x12a);else return _0x3d92b0[_0x5bd88a(0x110)](0x194)[_0x5bd88a(0x176)]();}sharpUtil[_0x5bd88a(0x131)](_0x3e33fa,path[_0x5bd88a(0x15f)](_0x18dac8),path[_0x5bd88a(0x130)](_0x18dac8),_0x4dd4ad,null,_0x27f3f3=>{const _0x36d3fe=_0x5bd88a;_0x3d92b0[_0x36d3fe(0x125)](_0x27f3f3);},_0x4dd9b9=>{const _0xf0ec9a=_0x5bd88a;return _0x3d92b0[_0xf0ec9a(0x110)](0x194)[_0xf0ec9a(0x176)]();},_0x5d7ae5);}function genTiny(_0x3b94ab,_0x55a3d0,_0x52fa8a,_0x3cc1d4,_0x1b7676,_0x3bf270){const _0x331ebc=_0x1d5784;let _0x39f08b=_0x331ebc(0x126);_0x3cc1d4['type']==0x2&&(_0x39f08b=_0x331ebc(0x12a)),sharpUtil['genTinyFile'](_0x52fa8a,path[_0x331ebc(0x15f)](_0x3bf270),path['basename'](_0x3bf270),_0x39f08b,_0x3cc1d4,_0x492cea=>{const _0x15eb1c=_0x331ebc;dbFileIndexTable[_0x15eb1c(0x12c)](_0x55a3d0,_0x3cc1d4['id'],_0x15eb1c(0x16f),_0x492cea,_0x1b7676),_0x3b94ab[_0x15eb1c(0x125)](_0x492cea);},_0x2fc8fa=>{const _0x39863b=_0x331ebc;return _0x3b94ab[_0x39863b(0x110)](0x194)[_0x39863b(0x176)]();});}router[_0x1d5784(0x14d)]('/rawFileByPath*',(_0xcf9398,_0x4caa71,_0x5302cd)=>{const _0x52e755=_0x1d5784;let _0x2bfaeb=_0xcf9398[_0x52e755(0x13d)][_0x52e755(0x155)];_0x2bfaeb=fileUtil[_0x52e755(0x113)](_0x2bfaeb);let _0x47277c=_0xcf9398[_0x52e755(0x13d)][_0x52e755(0xf8)]==0x1,_0x4ec0b8=_0xcf9398[_0x52e755(0x13d)][_0x52e755(0x174)],_0x2db4f7=_0xcf9398[_0x52e755(0x13d)]['quality'];fs[_0x52e755(0x177)](_0x2bfaeb,(_0x505f01,_0x2bdb1a)=>{const _0x1128dc=_0x52e755;if(_0x505f01)return _0x4caa71[_0x1128dc(0x11c)](0x194);if(dbUserTable[_0x1128dc(0x11d)](_0xcf9398,_0x4caa71,'',_0x1128dc(0x16b),_0x2bfaeb)==!![])try{let _0x44a0cf=_0xcf9398[_0x1128dc(0x13d)][_0x1128dc(0x138)];if(_0x44a0cf&&_0x44a0cf==0x1){if(_0x47277c){const _0x411bb2=encodeURIComponent(path[_0x1128dc(0x130)](_0x2bfaeb))['replace'](/%([0-9A-F]{2})/g,(_0x2f0aa4,_0x462d29)=>'%'+_0x462d29['toUpperCase']());_0x4caa71['setHeader'](_0x1128dc(0xfb),'attachment;\x20filename*=UTF-8\x27\x27'+_0x411bb2);}return _0x4caa71[_0x1128dc(0x125)](_0x2bfaeb);}sharpUtil[_0x1128dc(0x134)](_0x4caa71,_0x2bfaeb,_0x47277c,_0x4ec0b8,_0x2db4f7);}catch(_0x18ce74){return _0x4caa71[_0x1128dc(0x110)](0x194)['end']();}});}),router['get']('/tinyImgByPath*',(_0x211f22,_0x5e3bb3,_0x51a1dc)=>{const _0x384eda=_0x1d5784;let _0xbb8a3c=_0x211f22[_0x384eda(0x13d)][_0x384eda(0x155)];_0xbb8a3c=fileUtil[_0x384eda(0x113)](_0xbb8a3c);let _0x46c2ee=_0x211f22[_0x384eda(0x13d)][_0x384eda(0x174)];fs['stat'](_0xbb8a3c,(_0x1b8885,_0x571717)=>{const _0x34ad68=_0x384eda;if(_0x1b8885)return _0x5e3bb3[_0x34ad68(0x11c)](0x194);config[_0x34ad68(0x15c)](_0x46c2ee,_0xbb8a3c,_0x4d31f1=>{const _0x44fb77=_0x34ad68;if(!_0x4d31f1)return _0x5e3bb3[_0x44fb77(0x11c)](0x194);let _0x261322=path[_0x44fb77(0x102)](config['cachePath'],_0x4d31f1);dbUserTable[_0x44fb77(0x11d)](_0x211f22,_0x5e3bb3,'',_0x44fb77(0x16b),_0xbb8a3c,!![])==!![]&&fs[_0x44fb77(0x177)](_0x261322,(_0x5af164,_0x30fb3f)=>{const _0x5e51e9=_0x44fb77;if(_0x5af164)return genTinyForFilePath(_0x5e3bb3,_0xbb8a3c,_0x261322,_0x46c2ee);return _0x30fb3f[_0x5e51e9(0x132)]()?_0x5e3bb3['sendFile'](_0x261322):genTinyForFilePath(_0x5e3bb3,_0xbb8a3c,_0x261322,_0x46c2ee);});});});}),router['get'](_0x1d5784(0x157),(_0x57d1d8,_0x89889e,_0x14c6f2)=>{const _0x53d913=_0x1d5784;let _0x1a4f1e=_0x57d1d8['query'][_0x53d913(0x16a)],_0x36e5c1=_0x57d1d8[_0x53d913(0x13d)][_0x53d913(0xf9)],_0x4354a6=getIndexTableName(_0x36e5c1),_0x11a680=getIndexObj(_0x57d1d8,_0x1a4f1e);if(!_0x11a680)return _0x89889e[_0x53d913(0x110)](0x194)['end']();let _0x1d448d=config[_0x53d913(0x168)](_0x11a680),_0xa33ca1=path['join'](config[_0x53d913(0x10c)],_0x1d448d);if(dbUserTable[_0x53d913(0x11d)](_0x57d1d8,_0x89889e,_0x36e5c1,_0x53d913(0x16b),_0x11a680[_0x53d913(0x144)])==!![]){let _0x19c0cd=path['join'](_0x11a680[_0x53d913(0x144)],path[_0x53d913(0xff)],_0x11a680[_0x53d913(0x16d)]);fs[_0x53d913(0x177)](_0x19c0cd,(_0x32e1c1,_0xc6ebfd)=>{const _0x15e2b6=_0x53d913;if(_0x32e1c1)return!_0x11a680[_0x15e2b6(0x16f)]?_0x89889e[_0x15e2b6(0x110)](0x194)[_0x15e2b6(0x176)]():fs[_0x15e2b6(0x177)](_0x11a680['tiny_path'],(_0x5ecb7c,_0x4cddb1)=>{const _0x3b7290=_0x15e2b6;return _0x5ecb7c||_0x4cddb1&&!_0x4cddb1[_0x3b7290(0x132)]()?_0x89889e[_0x3b7290(0x110)](0x194)['end']():_0x89889e[_0x3b7290(0x125)](_0x11a680[_0x3b7290(0x16f)]);});if(!_0xc6ebfd[_0x15e2b6(0x132)]())return _0x89889e[_0x15e2b6(0x110)](0x194)['end']();!_0x11a680[_0x15e2b6(0x16f)]?fs['stat'](_0xa33ca1,(_0x391546,_0xdc262b)=>{const _0x15a9d4=_0x15e2b6;if(_0x391546)return genTiny(_0x89889e,_0x57d1d8[_0x15a9d4(0x114)][_0x15a9d4(0x11e)],_0x19c0cd,_0x11a680,_0x4354a6,_0xa33ca1);return _0xdc262b['isFile']()&&_0xdc262b[_0x15a9d4(0x174)]>0x7d0?(dbFileIndexTable[_0x15a9d4(0x12c)](_0x57d1d8['app'][_0x15a9d4(0x11e)],_0x11a680['id'],_0x15a9d4(0x16f),_0xa33ca1,_0x4354a6),_0x89889e[_0x15a9d4(0x125)](_0xa33ca1)):genTiny(_0x89889e,_0x57d1d8[_0x15a9d4(0x114)][_0x15a9d4(0x11e)],_0x19c0cd,_0x11a680,_0x4354a6,_0xa33ca1);}):fs[_0x15e2b6(0x177)](_0x11a680[_0x15e2b6(0x16f)],(_0x84a2df,_0x41585f)=>{const _0x13f917=_0x15e2b6;return _0x84a2df||!_0x41585f[_0x13f917(0x132)]()?genTiny(_0x89889e,_0x57d1d8['app']['dbFileIndex'],_0x19c0cd,_0x11a680,_0x4354a6,_0xa33ca1):_0x89889e['sendFile'](_0x11a680['tiny_path']);});});}}),router[_0x1d5784(0x14d)]('/rawFile*',(_0x32d646,_0x54ce87,_0x29c682)=>{const _0x250cbc=_0x1d5784;let _0x1a1b11=_0x32d646[_0x250cbc(0x13d)][_0x250cbc(0x16a)],_0xec4949=_0x32d646['query']['serverType'],_0x286135=getIndexObj(_0x32d646,_0x1a1b11),_0x276d59=getIndexTableName(_0xec4949),_0x1e7b95=_0x32d646['query'][_0x250cbc(0xf8)]==0x1,_0x28af70=_0x32d646['query'][_0x250cbc(0x174)],_0x148a14=_0x32d646[_0x250cbc(0x13d)]['quality'];if(!_0x286135)return _0x54ce87[_0x250cbc(0x110)](0x194)['end']();if(dbUserTable['doUserCanGet'](_0x32d646,_0x54ce87,_0xec4949,_0x250cbc(0x16b),_0x286135['path'])==!![]){_0xec4949==_0x250cbc(0x11f)&&(dbMusicIndexTable[_0x250cbc(0x141)](_0x32d646[_0x250cbc(0x114)][_0x250cbc(0x11e)],_0x1a1b11),dbMusicIndexTable['updatePlayTime'](_0x32d646[_0x250cbc(0x114)][_0x250cbc(0x11e)],_0x1a1b11));dbFileIndexTable[_0x250cbc(0x12c)](_0x32d646[_0x250cbc(0x114)][_0x250cbc(0x11e)],_0x1a1b11,_0x250cbc(0x103),new Date()[_0x250cbc(0x116)](),_0x276d59);let _0x3c2030=_0x286135['path']+path[_0x250cbc(0xff)]+_0x286135[_0x250cbc(0x16d)];fs[_0x250cbc(0x177)](_0x3c2030,(_0x495b2c,_0x263cb5)=>{const _0xf58593=_0x250cbc;if(_0x495b2c||!_0x263cb5[_0xf58593(0x132)]())return _0x54ce87[_0xf58593(0x110)](0x194)[_0xf58593(0x176)]();let _0x548501=_0x32d646[_0xf58593(0x13d)][_0xf58593(0x138)];if(_0x548501&&_0x548501==0x1){if(_0x1e7b95){const _0x3f525f=encodeURIComponent(path[_0xf58593(0x130)](_0x3c2030))[_0xf58593(0x128)](/%([0-9A-F]{2})/g,(_0x5056cd,_0x1d8480)=>'%'+_0x1d8480[_0xf58593(0x14b)]());_0x54ce87[_0xf58593(0x10f)](_0xf58593(0xfb),_0xf58593(0x173)+_0x3f525f);}return _0x54ce87[_0xf58593(0x125)](_0x3c2030);}if(_0x32d646[_0xf58593(0x13d)][_0xf58593(0x133)]==0x1){_0x54ce87[_0xf58593(0xfc)](_0xf58593(0x151),_0xf58593(0x148));const _0xabd206=_0x32d646[_0xf58593(0x178)][_0xf58593(0x106)];if(_0xf58593(0x15d)==_0xabd206)return _0x54ce87['sendFile'](_0x3c2030);return musicTransCodeUtil['transToMp3'](_0x54ce87,_0x3c2030);}else _0x32d646[_0xf58593(0x13d)][_0xf58593(0x13e)]&&_0x32d646['query'][_0xf58593(0x13e)]==_0xf58593(0x109)&&path[_0xf58593(0x108)](_0x3c2030)&&path[_0xf58593(0x108)](_0x3c2030)[_0xf58593(0x13f)]()==_0xf58593(0xfa)?(console[_0xf58593(0x10e)](_0xf58593(0x140),_0x3c2030),encodingUtil['getUtf8FileStream'](_0x3c2030)[_0xf58593(0x139)](_0x433aa5=>{const _0x3d00b8=_0xf58593;return _0x433aa5?_0x433aa5[_0x3d00b8(0x13b)](_0x54ce87):(console[_0x3d00b8(0x10e)](_0x3d00b8(0xf6),_0x3c2030),_0x54ce87['sendFile'](_0x3c2030));})):sharpUtil[_0xf58593(0x134)](_0x54ce87,_0x3c2030,_0x1e7b95,_0x28af70,_0x148a14);});}}),router[_0x1d5784(0x13c)](_0x1d5784(0x166),(_0x315098,_0x4f8db0,_0x3d6f4c)=>{const _0x5413ea=_0x1d5784;let _0x1ed319=_0x315098[_0x5413ea(0x10b)]['indexId'],_0x3ec181=getIndexObj(_0x315098,_0x1ed319);if(!_0x3ec181)return _0x4f8db0['status'](0x194)[_0x5413ea(0x176)]();if(dbUserTable[_0x5413ea(0x11d)](_0x315098,_0x4f8db0,'',_0x5413ea(0x16b),_0x3ec181[_0x5413ea(0x144)])==!![]){let _0x1b268e=_0x3ec181[_0x5413ea(0x144)]+path[_0x5413ea(0xff)]+_0x3ec181[_0x5413ea(0x16d)];exifUtil[_0x5413ea(0x153)](_0x1b268e)[_0x5413ea(0x139)](_0x343251=>{const _0x1bb14d=_0x5413ea;_0x3ec181[_0x1bb14d(0x17c)]=_0x343251,_0x4f8db0[_0x1bb14d(0x146)]({'code':0x0,'data':_0x3ec181});})[_0x5413ea(0x161)](_0x17bb32=>{const _0x18d0da=_0x5413ea;_0x3ec181[_0x18d0da(0x17c)]=![],_0x4f8db0[_0x18d0da(0x146)]({'code':0x0,'data':_0x3ec181});});}}),router[_0x1d5784(0x13c)](_0x1d5784(0x129),(_0x39093e,_0x418de3,_0x8e17f9)=>{const _0x50f578=_0x1d5784;let _0x1824ac=_0x39093e[_0x50f578(0x10b)][_0x50f578(0x16a)],_0x2abdfb=getIndexObj(_0x39093e,_0x1824ac),_0x27d520=getIndexTableName(_0x39093e['query']['serverType']);if(!_0x2abdfb)return _0x418de3[_0x50f578(0x146)]({'code':0x2,'message':_0x50f578(0x120)});try{fs['rm'](_0x2abdfb[_0x50f578(0x16f)],_0x905ca7=>{const _0x22ee5a=_0x50f578;return _0x905ca7?fileUtil[_0x22ee5a(0x14e)](_0x418de3,_0x905ca7):(dbFileIndexTable['updateById'](_0x39093e[_0x22ee5a(0x114)][_0x22ee5a(0x11e)],_0x1824ac,'tiny_path','',_0x27d520),_0x418de3['json']({'code':0x0}));});}catch(_0x45ae95){return _0x418de3[_0x50f578(0x146)]({'code':0x2,'message':_0x50f578(0x12f)});}}),module[_0x1d5784(0x135)]=router;