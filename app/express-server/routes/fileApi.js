const _0x5c4e07=_0x31c2;(function(_0x44d419,_0x4b8230){const _0x417150=_0x31c2,_0x48ef32=_0x44d419();while(!![]){try{const _0x221ec8=parseInt(_0x417150(0xeb))/0x1*(-parseInt(_0x417150(0x115))/0x2)+-parseInt(_0x417150(0xe8))/0x3*(parseInt(_0x417150(0x149))/0x4)+parseInt(_0x417150(0x13c))/0x5+-parseInt(_0x417150(0x12c))/0x6*(parseInt(_0x417150(0xf0))/0x7)+parseInt(_0x417150(0x10c))/0x8+-parseInt(_0x417150(0x150))/0x9+parseInt(_0x417150(0x10f))/0xa;if(_0x221ec8===_0x4b8230)break;else _0x48ef32['push'](_0x48ef32['shift']());}catch(_0xbd41da){_0x48ef32['push'](_0x48ef32['shift']());}}}(_0x20ea,0xe6260));let express=require(_0x5c4e07(0x12d)),router=express['Router'](),path=require(_0x5c4e07(0x106)),fs=require('fs');const sharp=require(_0x5c4e07(0x147));let sharpUtil=require(_0x5c4e07(0x127)),exifUtil=require(_0x5c4e07(0x128)),fileUtil=require('../utils/fileUtils');const config=require(_0x5c4e07(0x120)),dbFileIndexTable=require(_0x5c4e07(0xff)),dbFileOperationRecord=require(_0x5c4e07(0xfc)),dbUserTable=require(_0x5c4e07(0x112)),dbMusicIndexTable=require(_0x5c4e07(0x155));let musicTransCodeUtil=require(_0x5c4e07(0xe6));const encodingUtil=require('../../utils/encodingUtil');function getIndexTableName(_0x3502f7){const _0x158edb=_0x5c4e07;let _0x414c02=dbFileIndexTable[_0x158edb(0x148)](_0x3502f7);return _0x414c02;}function getIndexObj(_0x2c8256,_0xf91b0c){const _0x108f8e=_0x5c4e07;let _0x30907a=_0x2c8256[_0x108f8e(0x158)][_0x108f8e(0xe1)]||_0x2c8256[_0x108f8e(0x134)]['serverType'],_0x428443=getIndexTableName(_0x30907a);return dbFileIndexTable[_0x108f8e(0x143)](_0x2c8256['app'][_0x108f8e(0xfb)],_0xf91b0c,_0x428443);}router[_0x5c4e07(0xdc)](_0x5c4e07(0x159),(_0x1e20a6,_0x10bc55,_0x2ff6d8)=>{const _0x31cf56=_0x5c4e07;let _0x4160f6=_0x1e20a6[_0x31cf56(0x158)][_0x31cf56(0x119)],_0x1772b5=_0x1e20a6[_0x31cf56(0x158)][_0x31cf56(0x104)];if(dbUserTable[_0x31cf56(0xea)](_0x1e20a6,_0x10bc55,_0x31cf56(0xe2),'power_delete')==!![]){if(_0x4160f6&&_0x4160f6[_0x31cf56(0x11c)]>0x0){let _0x54ee66='(';for(let _0x5d95bb=0x0;_0x5d95bb<_0x4160f6['length'];_0x5d95bb++){let _0x4f44bd=getIndexObj(_0x1e20a6,_0x4160f6[_0x5d95bb]);if(!_0x4f44bd)continue;_0x4f44bd[_0x31cf56(0x109)]!=null&&_0x4f44bd[_0x31cf56(0x109)]!=''&&_0x4f44bd[_0x31cf56(0x133)]&&(_0x1772b5==0x1?_0x1e20a6['app'][_0x31cf56(0xfb)][_0x31cf56(0x11f)](_0x31cf56(0x117))[_0x31cf56(0xf9)](_0x4f44bd[_0x31cf56(0x106)],_0x4f44bd['raw_filename']):_0x1e20a6[_0x31cf56(0x10a)][_0x31cf56(0xfb)]['prepare'](_0x31cf56(0x14a))[_0x31cf56(0xf9)](_0x4f44bd[_0x31cf56(0x106)],_0x4f44bd[_0x31cf56(0x109)])),_0x54ee66+=_0x4160f6[_0x5d95bb],_0x5d95bb!=_0x4160f6[_0x31cf56(0x11c)]-0x1&&(_0x54ee66+=',');}_0x54ee66+=')';let _0x5bc3d0=dbFileIndexTable['inOutTrash'](_0x1e20a6[_0x31cf56(0x10a)][_0x31cf56(0xfb)],_0x54ee66,_0x1772b5,getIndexTableName(_0x1e20a6[_0x31cf56(0x158)][_0x31cf56(0xe1)]));_0x5bc3d0[_0x31cf56(0xe4)]>0x0&&_0x10bc55[_0x31cf56(0x12f)]({'code':0x0,'count':_0x5bc3d0['changes']});}else{_0x10bc55[_0x31cf56(0x12f)]({'code':0x1,'message':_0x31cf56(0x10d)});return;}}}),router['post'](_0x5c4e07(0x126),(_0x1a2948,_0x395b51,_0x528a9a)=>{const _0x56bcf3=_0x5c4e07;let _0x4a9443=_0x1a2948[_0x56bcf3(0x158)][_0x56bcf3(0x119)],_0x4fe586=_0x1a2948['body'][_0x56bcf3(0xe1)],_0x299e11=_0x1a2948['body'][_0x56bcf3(0xda)]==0x1,_0xb0439f=_0x1a2948['body'][_0x56bcf3(0x146)]==0x1,_0x1d9058=_0x1a2948[_0x56bcf3(0x158)]['putInSystemTrash'],_0x5d6450=getIndexTableName(_0x4fe586);function _0x379dbd(_0x4f4d08,_0x1fdb3a){const _0x1569c=_0x56bcf3;dbFileOperationRecord[_0x1569c(0x14b)](_0x1a2948[_0x1569c(0x10a)][_0x1569c(0x154)],{'username':_0x1a2948[_0x1569c(0x108)][_0x1569c(0xe0)],'targetPath':_0x4f4d08,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0x1569c(0x123)],'state':_0x1fdb3a?dbFileOperationRecord[_0x1569c(0x152)]:dbFileOperationRecord[_0x1569c(0x136)]});}function _0x76eebd(_0x530790){const _0x48bf09=_0x56bcf3;if(_0x530790[_0x48bf09(0x133)]==0x1&&_0x530790[_0x48bf09(0x101)]==0x1){let _0x4ebf29=path[_0x48bf09(0x13b)](_0x530790[_0x48bf09(0x106)],_0x530790['filename']['replace'](_0x48bf09(0x145),'')+_0x48bf09(0x10e));_0x530790[_0x48bf09(0xf7)][_0x48bf09(0xf5)]('.MP4')&&(_0x4ebf29=path[_0x48bf09(0x13b)](_0x530790['path'],_0x530790['filename'][_0x48bf09(0xe7)](_0x48bf09(0xef),'')+_0x48bf09(0x12e))),fs['existsSync'](_0x4ebf29)&&_0x36a9d8(_0x530790,_0x4ebf29,![]);}}function _0x36a9d8(_0x358ec0,_0x5f47b8,_0x4575a6){const _0x493ebb=_0x56bcf3;_0x1d9058==0x1?(process[_0x493ebb(0xed)]({'type':_0x493ebb(0x103),'shellType':_0x493ebb(0x104),'path':_0x5f47b8}),_0x379dbd(_0x5f47b8,!![])):fs['rm'](_0x5f47b8,{'recursive':!![]},_0x519a2c=>{_0x519a2c?_0x379dbd(_0x5f47b8,![]):_0x379dbd(_0x5f47b8,!![]);}),_0x4575a6&&_0x76eebd(_0x358ec0);}function _0x130512(_0xe6616){const _0x357ce8=_0x56bcf3;dbFileIndexTable[_0x357ce8(0x144)](_0x1a2948[_0x357ce8(0x10a)][_0x357ce8(0xfb)],_0xe6616,_0x5d6450);}function _0x337d17(_0x2fa0ae,_0x3448da){const _0x10abd2=_0x56bcf3;if(!_0x3448da)return;dbFileIndexTable[_0x10abd2(0x144)](_0x1a2948[_0x10abd2(0x10a)][_0x10abd2(0xfb)],_0x2fa0ae,_0x5d6450);let _0x26f5b2=dbFileIndexTable['deletePathAll'](_0x1a2948[_0x10abd2(0x10a)][_0x10abd2(0xfb)],_0x3448da,_0x5d6450);}if(_0x4a9443&&_0x4a9443[_0x56bcf3(0x11c)]>0x0){let _0x385895=0x0,_0x517634=0x0,_0x11dedf=[];for(let _0x10eef1=0x0;_0x10eef1<_0x4a9443[_0x56bcf3(0x11c)];_0x10eef1++){let _0x255978=_0x4a9443[_0x10eef1],_0x12e869=getIndexObj(_0x1a2948,_0x255978,_0x5d6450);if(_0x12e869){if(dbUserTable['doUserCanGet'](_0x1a2948,_0x395b51,_0x4fe586,_0x56bcf3(0x13a),_0x12e869['path'])==!![]){_0x385895+=0x1,_0x11dedf['push'](_0x255978);let _0xfa0467=path[_0x56bcf3(0x13b)](_0x12e869[_0x56bcf3(0x106)],path[_0x56bcf3(0x142)],_0x12e869['filename']),_0x16801d=_0x12e869[_0x56bcf3(0x133)]==0x0;_0x299e11&&(_0xfa0467=_0x12e869[_0x56bcf3(0x106)],_0x16801d=!![]),_0x16801d?_0x337d17(_0x255978,_0xfa0467):_0x130512(_0x255978),_0x36a9d8(_0x12e869,_0xfa0467,!_0xb0439f);}else _0x517634+=0x1;}}return _0x395b51[_0x56bcf3(0x12f)]({'code':0x0,'deletedIds':_0x11dedf,'deleteCount':_0x385895,'errCount':_0x517634});}else return _0x1a2948['app']['returnErrMsg'](_0x395b51,_0x56bcf3(0x10d));});function genTinyForFilePath(_0x4277db,_0x4cedac,_0x414910,_0x307e3d){const _0x48ad74=_0x5c4e07;let _0x5b7af2=path['extname'](_0x4cedac)?path[_0x48ad74(0x156)](_0x4cedac)['toLowerCase']():null,_0x36d5d2=![];if(config[_0x48ad74(0xfe)][_0x48ad74(0xe9)](_0x5b7af2)||config[_0x48ad74(0x130)][_0x48ad74(0xe9)](_0x5b7af2['toLowerCase']()))_0x36d5d2=_0x48ad74(0x110);else{if(config[_0x48ad74(0x11b)][_0x48ad74(0xe9)](_0x5b7af2))_0x36d5d2=_0x48ad74(0x135);else return _0x4277db['status'](0x194)[_0x48ad74(0x153)]();}sharpUtil[_0x48ad74(0xe5)](_0x4cedac,path[_0x48ad74(0x11e)](_0x414910),path[_0x48ad74(0x114)](_0x414910),_0x36d5d2,null,_0x3a90d0=>{_0x4277db['sendFile'](_0x3a90d0);},_0x1b057b=>{const _0x2020a6=_0x48ad74;return _0x4277db['status'](0x194)[_0x2020a6(0x153)]();},_0x307e3d);}function genTiny(_0x5180cb,_0x1b01f3,_0x10f3b7,_0x111673,_0x1d7373,_0x5e9a6b){const _0x28cdf1=_0x5c4e07;let _0x56be43=_0x28cdf1(0x110);_0x111673['type']==0x2&&(_0x56be43='video'),sharpUtil[_0x28cdf1(0xe5)](_0x10f3b7,path[_0x28cdf1(0x11e)](_0x5e9a6b),path[_0x28cdf1(0x114)](_0x5e9a6b),_0x56be43,_0x111673,_0x3feb57=>{const _0x169411=_0x28cdf1;dbFileIndexTable[_0x169411(0xdf)](_0x1b01f3,_0x111673['id'],_0x169411(0xf2),_0x3feb57,_0x1d7373),_0x5180cb[_0x169411(0xe3)](_0x3feb57);},_0x1a554e=>{const _0x5f1bd5=_0x28cdf1;return _0x5180cb[_0x5f1bd5(0x137)](0x194)[_0x5f1bd5(0x153)]();});}function _0x31c2(_0x180f42,_0x40b3a3){const _0x20ea91=_0x20ea();return _0x31c2=function(_0x31c203,_0x43332b){_0x31c203=_0x31c203-0xda;let _0x4ac3dd=_0x20ea91[_0x31c203];return _0x4ac3dd;},_0x31c2(_0x180f42,_0x40b3a3);}router[_0x5c4e07(0xec)](_0x5c4e07(0xfa),(_0xb8033d,_0x30504f,_0x50a496)=>{const _0x3df6cd=_0x5c4e07;let _0x2c67a4=_0xb8033d[_0x3df6cd(0x134)][_0x3df6cd(0x105)];_0x2c67a4=fileUtil[_0x3df6cd(0xdd)](_0x2c67a4);let _0x5bc3d8=_0xb8033d['query'][_0x3df6cd(0x13d)]==0x1,_0x5e1375=_0xb8033d[_0x3df6cd(0x134)]['size'],_0x4386de=_0xb8033d['query'][_0x3df6cd(0x10b)];fs[_0x3df6cd(0x107)](_0x2c67a4,(_0x53300b,_0x3d211c)=>{const _0x20d6c1=_0x3df6cd;if(_0x53300b)return _0x30504f['sendStatus'](0x194);if(dbUserTable[_0x20d6c1(0xea)](_0xb8033d,_0x30504f,'',_0x20d6c1(0x151),_0x2c67a4)==!![])try{let _0x570215=_0xb8033d[_0x20d6c1(0x134)][_0x20d6c1(0x100)];if(_0x570215&&_0x570215==0x1){if(_0x5bc3d8){const _0x262351=encodeURIComponent(path[_0x20d6c1(0x114)](_0x2c67a4))[_0x20d6c1(0xe7)](/%([0-9A-F]{2})/g,(_0x26e8b3,_0x45b50f)=>'%'+_0x45b50f[_0x20d6c1(0x13e)]());_0x30504f[_0x20d6c1(0x14f)](_0x20d6c1(0xf8),_0x20d6c1(0x121)+_0x262351);}return _0x30504f[_0x20d6c1(0xe3)](_0x2c67a4);}sharpUtil['returnDealedFile'](_0x30504f,_0x2c67a4,_0x5bc3d8,_0x5e1375,_0x4386de);}catch(_0x4dd0f0){return _0x30504f[_0x20d6c1(0x137)](0x194)[_0x20d6c1(0x153)]();}});}),router[_0x5c4e07(0xec)]('/tinyImgByPath*',(_0x3ab741,_0x199d73,_0x2675b0)=>{const _0xbd6077=_0x5c4e07;let _0x5c36db=_0x3ab741[_0xbd6077(0x134)][_0xbd6077(0x105)];_0x5c36db=fileUtil[_0xbd6077(0xdd)](_0x5c36db);let _0x2e75fa=_0x3ab741[_0xbd6077(0x134)]['size'];fs['stat'](_0x5c36db,(_0x3def24,_0x57dfeb)=>{const _0x316dcf=_0xbd6077;if(_0x3def24)return _0x199d73[_0x316dcf(0x118)](0x194);config[_0x316dcf(0x140)](_0x2e75fa,_0x5c36db,_0x3a9ba6=>{const _0x323eec=_0x316dcf;if(!_0x3a9ba6)return _0x199d73['sendStatus'](0x194);let _0x40d763=path['join'](config[_0x323eec(0x11a)],_0x3a9ba6);dbUserTable[_0x323eec(0xea)](_0x3ab741,_0x199d73,'',_0x323eec(0x151),_0x5c36db,!![])==!![]&&fs[_0x323eec(0x107)](_0x40d763,(_0xda1f43,_0x3c8ee5)=>{const _0x59c625=_0x323eec;if(_0xda1f43)return genTinyForFilePath(_0x199d73,_0x5c36db,_0x40d763,_0x2e75fa);return _0x3c8ee5[_0x59c625(0x157)]()?_0x199d73[_0x59c625(0xe3)](_0x40d763):genTinyForFilePath(_0x199d73,_0x5c36db,_0x40d763,_0x2e75fa);});});});}),router[_0x5c4e07(0xec)]('/tinyImg*',(_0x562113,_0x431502,_0x15e415)=>{const _0x399d6a=_0x5c4e07;let _0x3e2995=_0x562113[_0x399d6a(0x134)]['indexId'],_0x486e6a=_0x562113['query'][_0x399d6a(0xe1)],_0x2b2216=getIndexTableName(_0x486e6a),_0x67af31=getIndexObj(_0x562113,_0x3e2995);if(!_0x67af31)return _0x431502[_0x399d6a(0x137)](0x194)[_0x399d6a(0x153)]();let _0x1e7e42=config[_0x399d6a(0xde)](_0x67af31),_0x12fa1e=path[_0x399d6a(0x13b)](config[_0x399d6a(0x11a)],_0x1e7e42);if(dbUserTable['doUserCanGet'](_0x562113,_0x431502,_0x486e6a,_0x399d6a(0x151),_0x67af31[_0x399d6a(0x106)])==!![]){let _0x82c68f=path[_0x399d6a(0x13b)](_0x67af31[_0x399d6a(0x106)],path[_0x399d6a(0x142)],_0x67af31[_0x399d6a(0xf7)]);fs[_0x399d6a(0x107)](_0x82c68f,(_0x464e87,_0x59b24a)=>{const _0x49d0db=_0x399d6a;if(_0x464e87)return!_0x67af31[_0x49d0db(0xf2)]?_0x431502[_0x49d0db(0x137)](0x194)[_0x49d0db(0x153)]():fs[_0x49d0db(0x107)](_0x67af31['tiny_path'],(_0x321749,_0x956f1)=>{const _0x149eef=_0x49d0db;return _0x321749||_0x956f1&&!_0x956f1[_0x149eef(0x157)]()?_0x431502[_0x149eef(0x137)](0x194)[_0x149eef(0x153)]():_0x431502[_0x149eef(0xe3)](_0x67af31[_0x149eef(0xf2)]);});if(!_0x59b24a[_0x49d0db(0x157)]())return _0x431502[_0x49d0db(0x137)](0x194)[_0x49d0db(0x153)]();!_0x67af31[_0x49d0db(0xf2)]?fs[_0x49d0db(0x107)](_0x12fa1e,(_0x39b01a,_0x5a387b)=>{const _0x3906ff=_0x49d0db;if(_0x39b01a)return genTiny(_0x431502,_0x562113[_0x3906ff(0x10a)]['dbFileIndex'],_0x82c68f,_0x67af31,_0x2b2216,_0x12fa1e);return _0x5a387b[_0x3906ff(0x157)]()&&_0x5a387b[_0x3906ff(0x141)]>0x7d0?(dbFileIndexTable[_0x3906ff(0xdf)](_0x562113['app'][_0x3906ff(0xfb)],_0x67af31['id'],'tiny_path',_0x12fa1e,_0x2b2216),_0x431502['sendFile'](_0x12fa1e)):genTiny(_0x431502,_0x562113['app'][_0x3906ff(0xfb)],_0x82c68f,_0x67af31,_0x2b2216,_0x12fa1e);}):fs[_0x49d0db(0x107)](_0x67af31[_0x49d0db(0xf2)],(_0x5ee328,_0x350a02)=>{const _0x58063b=_0x49d0db;return _0x5ee328||!_0x350a02[_0x58063b(0x157)]()?genTiny(_0x431502,_0x562113[_0x58063b(0x10a)][_0x58063b(0xfb)],_0x82c68f,_0x67af31,_0x2b2216,_0x12fa1e):_0x431502[_0x58063b(0xe3)](_0x67af31[_0x58063b(0xf2)]);});});}}),router[_0x5c4e07(0xec)](_0x5c4e07(0xfd),(_0x1da71e,_0x120000,_0x47c462)=>{const _0x2caba6=_0x5c4e07;let _0x1fc3ec=_0x1da71e[_0x2caba6(0x134)][_0x2caba6(0x12a)],_0x2ee828=_0x1da71e[_0x2caba6(0x134)][_0x2caba6(0xe1)],_0x4600c2=getIndexObj(_0x1da71e,_0x1fc3ec),_0x15a21e=getIndexTableName(_0x2ee828),_0x5daac2=_0x1da71e['query'][_0x2caba6(0x13d)]==0x1,_0x476387=_0x1da71e[_0x2caba6(0x134)][_0x2caba6(0x141)],_0x2c2e53=_0x1da71e[_0x2caba6(0x134)][_0x2caba6(0x10b)];if(!_0x4600c2)return _0x120000['status'](0x194)[_0x2caba6(0x153)]();if(dbUserTable[_0x2caba6(0xea)](_0x1da71e,_0x120000,_0x2ee828,'power_get',_0x4600c2[_0x2caba6(0x106)])==!![]){_0x2ee828==_0x2caba6(0x129)&&(dbMusicIndexTable[_0x2caba6(0x113)](_0x1da71e[_0x2caba6(0x10a)]['dbFileIndex'],_0x1fc3ec),dbMusicIndexTable[_0x2caba6(0x116)](_0x1da71e[_0x2caba6(0x10a)][_0x2caba6(0xfb)],_0x1fc3ec));dbFileIndexTable[_0x2caba6(0xdf)](_0x1da71e[_0x2caba6(0x10a)][_0x2caba6(0xfb)],_0x1fc3ec,_0x2caba6(0x14d),new Date()[_0x2caba6(0x111)](),_0x15a21e);let _0x2e51b0=_0x4600c2[_0x2caba6(0x106)]+path['sep']+_0x4600c2['filename'];fs['stat'](_0x2e51b0,(_0x576d23,_0x257828)=>{const _0x565a72=_0x2caba6;if(_0x576d23||!_0x257828['isFile']())return _0x120000[_0x565a72(0x137)](0x194)['end']();let _0x505ea1=_0x1da71e[_0x565a72(0x134)][_0x565a72(0x100)];if(_0x505ea1&&_0x505ea1==0x1){if(_0x5daac2){const _0x1bfbc1=encodeURIComponent(path['basename'](_0x2e51b0))['replace'](/%([0-9A-F]{2})/g,(_0x456c52,_0x4c9313)=>'%'+_0x4c9313[_0x565a72(0x13e)]());_0x120000[_0x565a72(0x14f)]('Content-Disposition',_0x565a72(0x121)+_0x1bfbc1);}return _0x120000[_0x565a72(0xe3)](_0x2e51b0);}if(_0x1da71e[_0x565a72(0x134)][_0x565a72(0xf1)]==0x1){_0x120000[_0x565a72(0xdb)](_0x565a72(0x132),_0x565a72(0x11d));const _0x59d5da=_0x1da71e['headers'][_0x565a72(0x138)];if(_0x565a72(0x122)==_0x59d5da)return _0x120000[_0x565a72(0xe3)](_0x2e51b0);return musicTransCodeUtil[_0x565a72(0xf1)](_0x120000,_0x2e51b0);}else _0x1da71e[_0x565a72(0x134)]['code']&&_0x1da71e['query'][_0x565a72(0x139)]==_0x565a72(0x102)&&path['extname'](_0x2e51b0)&&path['extname'](_0x2e51b0)['toLowerCase']()==_0x565a72(0x12b)?(console[_0x565a72(0x13f)](_0x565a72(0xf4),_0x2e51b0),encodingUtil['getUtf8FileStream'](_0x2e51b0)[_0x565a72(0xee)](_0x16f9a3=>{const _0x4cff8e=_0x565a72;return _0x16f9a3?_0x16f9a3['pipe'](_0x120000):(console['log']('Unable\x20to\x20read\x20file',_0x2e51b0),_0x120000[_0x4cff8e(0xe3)](_0x2e51b0));})):sharpUtil['returnDealedFile'](_0x120000,_0x2e51b0,_0x5daac2,_0x476387,_0x2c2e53);});}}),router['post'](_0x5c4e07(0x124),(_0xc90270,_0x4e0b0b,_0x50a2a0)=>{const _0x5c336e=_0x5c4e07;let _0xa6fcce=_0xc90270[_0x5c336e(0x158)][_0x5c336e(0x12a)],_0x1fcdee=getIndexObj(_0xc90270,_0xa6fcce);if(!_0x1fcdee)return _0x4e0b0b[_0x5c336e(0x137)](0x194)['end']();if(dbUserTable[_0x5c336e(0xea)](_0xc90270,_0x4e0b0b,'','power_get',_0x1fcdee[_0x5c336e(0x106)])==!![]){let _0x18e7a0=_0x1fcdee[_0x5c336e(0x106)]+path[_0x5c336e(0x142)]+_0x1fcdee[_0x5c336e(0xf7)];exifUtil[_0x5c336e(0xf3)](_0x18e7a0)[_0x5c336e(0xee)](_0x146f54=>{const _0x535150=_0x5c336e;_0x1fcdee[_0x535150(0xf6)]=_0x146f54,_0x4e0b0b[_0x535150(0x12f)]({'code':0x0,'data':_0x1fcdee});})[_0x5c336e(0x131)](_0x26b5d5=>{const _0x36b5ce=_0x5c336e;_0x1fcdee[_0x36b5ce(0xf6)]=![],_0x4e0b0b[_0x36b5ce(0x12f)]({'code':0x0,'data':_0x1fcdee});});}}),router['post'](_0x5c4e07(0x14e),(_0x55f501,_0x46bddf,_0x5c8994)=>{const _0x1ee588=_0x5c4e07;let _0x250770=_0x55f501[_0x1ee588(0x158)][_0x1ee588(0x12a)],_0x5760ee=getIndexObj(_0x55f501,_0x250770),_0x44117b=getIndexTableName(_0x55f501[_0x1ee588(0x134)]['serverType']);if(!_0x5760ee)return _0x46bddf['json']({'code':0x2,'message':'file\x20not\x20found'});try{fs['rm'](_0x5760ee[_0x1ee588(0xf2)],_0xe12f58=>{const _0x17bb1a=_0x1ee588;return _0xe12f58?fileUtil[_0x17bb1a(0x125)](_0x46bddf,_0xe12f58):(dbFileIndexTable['updateById'](_0x55f501['app'][_0x17bb1a(0xfb)],_0x250770,_0x17bb1a(0xf2),'',_0x44117b),_0x46bddf[_0x17bb1a(0x12f)]({'code':0x0}));});}catch(_0x1b7870){return _0x46bddf[_0x1ee588(0x12f)]({'code':0x2,'message':'operation\x20fail'});}}),module[_0x5c4e07(0x14c)]=router;function _0x20ea(){const _0x4f52ac=['getFileHashNameByPathAndStat','size','sep','getById','delete','.MOV','ignoreLivephoto','sharp','getIndexTableNameByType','4eOXaHn','UPDATE\x20file_index_photo\x20SET\x20is_show=0\x20WHERE\x20path=?\x20AND\x20filename\x20=?','addFileOperationRecord','exports','check_time','/clearTinyImg','setHeader','16600131lgrzGj','power_get','STATE_SUC','end','dbOther','../../db/dbMusicIndexTable','extname','isFile','body','/inOutTrash','deleteIndexFolder','set','post','decodePath','getFileHashName','updateById','username','serverType','photo','sendFile','changes','genTinyFile','../../utils/musicTransCodeUtil','replace','1316955XsEmzJ','includes','doUserCanGet','9WlNYES','get','send','then','.MP4','7hqbeVY','transToMp3','tiny_path','parse','Convert\x20to\x20utf8\x20','endsWith','exifInfo','filename','Content-Disposition','run','/rawFileByPath*','dbFileIndex','../../db/dbFileOperationRecord','/rawFile*','imgTypeList','../../db/dbFileIndexTable','raw','is_livephoto','utf8','shell','trash','fullPath','path','stat','currentUser','raw_filename','app','quality','9618256VicfuT','params\x20is\x20not\x20valid','.HEIC','27364710ktiIZb','image','getTime','../../db/dbUserTable','increasePlayCount','basename','135802pPtCFO','updatePlayTime','UPDATE\x20file_index_photo\x20SET\x20is_show=1\x20WHERE\x20path=?\x20AND\x20filename\x20=?','sendStatus','ids','cachePath','videoTypeList','length','audio/mpeg','dirname','prepare','../../myConfig/config','attachment;\x20filename*=UTF-8\x27\x27','bytes=0-1','TYPE_DELETE','/getInfo','returnFileError','/deleteFromDisk','../utils/sharpUtils','exifr','music','indexId','.txt','10758282Ocxxgz','express','.JPG','json','rawImgTypeList','catch','Content-Type','is_file','query','video','STATE_FAIL','status','range','code','power_delete','join','8457675ySpJKE','download','toUpperCase','log'];_0x20ea=function(){return _0x4f52ac;};return _0x20ea();}