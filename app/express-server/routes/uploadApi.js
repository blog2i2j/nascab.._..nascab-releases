const _0x11ce69=_0x1480;(function(_0x358e78,_0x47c5c5){const _0x590569=_0x1480,_0x2b63e8=_0x358e78();while(!![]){try{const _0x3654eb=parseInt(_0x590569(0x94))/0x1+-parseInt(_0x590569(0x9d))/0x2+parseInt(_0x590569(0x8f))/0x3*(-parseInt(_0x590569(0xc9))/0x4)+-parseInt(_0x590569(0xb9))/0x5+-parseInt(_0x590569(0xc3))/0x6*(-parseInt(_0x590569(0xb6))/0x7)+-parseInt(_0x590569(0x92))/0x8*(parseInt(_0x590569(0x91))/0x9)+parseInt(_0x590569(0x97))/0xa;if(_0x3654eb===_0x47c5c5)break;else _0x2b63e8['push'](_0x2b63e8['shift']());}catch(_0x184028){_0x2b63e8['push'](_0x2b63e8['shift']());}}}(_0x5321,0x305bd));let express=require(_0x11ce69(0xac)),router=express['Router'](),uploadUtil=require('../utils/uploadUtils');const dbUserTable=require(_0x11ce69(0xa0));function _0x5321(){const _0x462f7f=['W_OK','targetFolderNotExist','1962375xSqoyL','substring','../utils/fileUtils','filename','exports','savePath','decodePath','returnFileError','query','encodeFilename','11310GFFJXc','error\x20book\x20index\x20id','log','R_OK','join','getById','4pHRCpQ','/regularUpload','app','headers','.jpg','nascab_torrentSavePath','722649vNOAQU','lastIndexOf','5697onykBM','3856GixcEp','noPermission','250035akYkAs','uploadBookCover','operationFail','10569100KFKfFJ','need\x20book\x20index\x20id','SAMENAME','INDEX_TABLE_NAME_BOOK','dirname','skip','450138EhbkmR','uploadSubtitle','overMode','../../db/dbUserTable','body','/folderExist','stat','书籍封面保存目录','json','post','over','sameNameFileAlreadExist','over_mode','access','basename','express','folder','doUserCanGet','power_add','uploadFile','save_path','constants','path','returnErrMsg','relativePath','203evcgzb'];_0x5321=function(){return _0x462f7f;};return _0x5321();}let fs=require('fs'),fileUtil=require(_0x11ce69(0xbb)),path=require('path'),config=require('../../myConfig/config');const dbFileIndexTable=require('../../db/dbFileIndexTable');function _0x1480(_0x42d2ae,_0x8d2368){const _0x5321d5=_0x5321();return _0x1480=function(_0x14806d,_0x55a16e){_0x14806d=_0x14806d-0x8f;let _0x12ab1d=_0x5321d5[_0x14806d];return _0x12ab1d;},_0x1480(_0x42d2ae,_0x8d2368);}router[_0x11ce69(0xa6)](_0x11ce69(0xa2),function(_0x1b8295,_0x3a1595){const _0x1c5a10=_0x11ce69;let _0x1b0ce0=_0x1b8295[_0x1c5a10(0xa1)][_0x1c5a10(0xbe)];fs[_0x1c5a10(0xa3)](_0x1b0ce0,(_0xe5fe9f,_0xcbd2f0)=>{const _0x11725d=_0x1c5a10;return _0xe5fe9f?_0x1b8295[_0x11725d(0xcb)][_0x11725d(0xb4)](_0x3a1595,_0x3a1595['__'](_0x11725d(0xb8))):_0x3a1595[_0x11725d(0xa5)]({'code':0x0});});}),router[_0x11ce69(0xa6)](_0x11ce69(0xca),function(_0x114ea6,_0x50447d){const _0x6e1f25=_0x11ce69;if(_0x114ea6[_0x6e1f25(0xcc)][_0x6e1f25(0xb1)]){let _0x5be8c8=decodeURIComponent(_0x114ea6[_0x6e1f25(0xcc)][_0x6e1f25(0xb1)]);_0x114ea6[_0x6e1f25(0xa1)][_0x6e1f25(0xbe)]=_0x5be8c8,_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xbe)]=_0x5be8c8;}_0x114ea6[_0x6e1f25(0xcc)][_0x6e1f25(0xa9)]&&(_0x114ea6['query']['overMode']=_0x114ea6['headers'][_0x6e1f25(0xa9)]);let _0x39f79c,_0xe7f508,_0xcc67ec=!![];try{_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xbe)]&&(_0x39f79c=fileUtil['decodePath'](_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xbe)]));if(_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0x95)]==0x1){let _0x476cf7=_0x114ea6[_0x6e1f25(0xc1)]['bookIndexId'];if(!_0x476cf7)return _0x114ea6['app'][_0x6e1f25(0xb4)](_0x50447d,_0x6e1f25(0x98));let _0x4bfa21=dbFileIndexTable[_0x6e1f25(0xc8)](_0x114ea6[_0x6e1f25(0xcb)]['dbFileIndex'],_0x476cf7,dbFileIndexTable[_0x6e1f25(0x9a)]);if(!_0x4bfa21)return _0x114ea6[_0x6e1f25(0xcb)][_0x6e1f25(0xb4)](_0x50447d,_0x6e1f25(0xc4));_0x39f79c=_0x4bfa21[_0x6e1f25(0xb3)],_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xbe)]=_0x4bfa21[_0x6e1f25(0xb3)],_0x114ea6['query'][_0x6e1f25(0x9f)]=_0x6e1f25(0xa7),_0xcc67ec=![];let _0x52290a=path[_0x6e1f25(0xc7)](_0x4bfa21[_0x6e1f25(0xb3)],_0x4bfa21[_0x6e1f25(0xbc)]),_0x3bbf6b=_0x52290a[_0x6e1f25(0xba)](0x0,_0x52290a[_0x6e1f25(0x90)]('.'))+_0x6e1f25(0xcd),_0x4caa3f=path[_0x6e1f25(0xab)](_0x3bbf6b);_0x114ea6[_0x6e1f25(0xc1)]['filename']=encodeURIComponent(_0x4caa3f),console[_0x6e1f25(0xc5)](_0x6e1f25(0xa4),_0x39f79c,_0x114ea6['query'][_0x6e1f25(0xbc)]);}if(_0x114ea6['query'][_0x6e1f25(0xb5)]){_0xe7f508=fileUtil['decodePath'](_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xb5)]);let _0x5545a4=path[_0x6e1f25(0x9b)](path[_0x6e1f25(0xc7)](_0x39f79c,_0xe7f508));!fs['existsSync'](_0x5545a4)&&fs['mkdirSync'](_0x5545a4,{'recursive':!![]}),_0x114ea6['query'][_0x6e1f25(0xbe)]=_0x5545a4,_0xcc67ec=![];}if(_0x114ea6['query'][_0x6e1f25(0xc2)]){_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xbc)]=fileUtil[_0x6e1f25(0xbf)](_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0xc2)]);let _0x3cf2b9=path['join'](_0x39f79c,_0x114ea6['query'][_0x6e1f25(0xbc)]);if(_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0x9f)]&&_0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0x9f)]==_0x6e1f25(0x9c)&&fs['existsSync'](_0x3cf2b9))return _0x50447d['json']({'code':0x1,'remark':_0x6e1f25(0x99),'message':_0x50447d['__'](_0x6e1f25(0xa8))});}}catch(_0x77bc99){return console[_0x6e1f25(0xc5)](_0x77bc99),_0x114ea6[_0x6e1f25(0xcb)]['returnErrMsg'](_0x50447d,_0x50447d['__'](_0x6e1f25(0x96)));}if(_0x39f79c&&_0x39f79c!=_0x6e1f25(0xce))fs[_0x6e1f25(0xaa)](_0x39f79c,fs[_0x6e1f25(0xb2)][_0x6e1f25(0xb7)]|fs[_0x6e1f25(0xb2)][_0x6e1f25(0xc6)],_0x3a9370=>{const _0x2dc67b=_0x6e1f25;if(_0x3a9370)return fileUtil[_0x2dc67b(0xc0)](_0x50447d,_0x3a9370);if(dbUserTable[_0x2dc67b(0xae)](_0x114ea6,_0x50447d,_0x2dc67b(0xad),_0x2dc67b(0xaf),_0x39f79c,!![])==!![])uploadUtil[_0x2dc67b(0xb0)](_0x114ea6,_0x50447d,_0xcc67ec);else return _0x114ea6[_0x2dc67b(0xcb)][_0x2dc67b(0xb4)](_0x50447d,_0x50447d['__'](_0x2dc67b(0x93)));});else _0x114ea6[_0x6e1f25(0xc1)][_0x6e1f25(0x9e)]==0x1?uploadUtil[_0x6e1f25(0xb0)](_0x114ea6,_0x50447d,_0xcc67ec):uploadUtil[_0x6e1f25(0xb0)](_0x114ea6,_0x50447d,_0xcc67ec);}),module[_0x11ce69(0xbd)]=router;