const _0x1fe013=_0x128e;(function(_0x434b56,_0x3c6376){const _0x325a5f=_0x128e,_0x2b3967=_0x434b56();while(!![]){try{const _0x29d557=parseInt(_0x325a5f(0x2fc))/0x1*(-parseInt(_0x325a5f(0x249))/0x2)+parseInt(_0x325a5f(0x1ab))/0x3+-parseInt(_0x325a5f(0x1c1))/0x4*(parseInt(_0x325a5f(0x22e))/0x5)+parseInt(_0x325a5f(0x18b))/0x6+parseInt(_0x325a5f(0x213))/0x7+-parseInt(_0x325a5f(0x1d0))/0x8+parseInt(_0x325a5f(0x26e))/0x9;if(_0x29d557===_0x3c6376)break;else _0x2b3967['push'](_0x2b3967['shift']());}catch(_0x1d7d22){_0x2b3967['push'](_0x2b3967['shift']());}}}(_0x2817,0x6c4f8));let express=require('express'),router=express[_0x1fe013(0x2d0)](),path=require(_0x1fe013(0x28d));const sharp=require(_0x1fe013(0x1f2)),config=require(_0x1fe013(0x24e)),dbFileIndexTable=require(_0x1fe013(0x190)),dbSourceFolderTable=require('../../db/dbSourceFolderTable'),dbFileOperationRecord=require(_0x1fe013(0x1a2));let checkUtil=require('../utils/checkUtil');function _0x2817(){const _0x4e0b20=['folderNotExist','文件写入成功','rawFaceIndexIdList','/getBoundsPhoto','maxLng','/removeFromFace','INDEX_TABLE_NAME_MOVIE','1503586UfbqDw','update','/addAlbum','./photoApiUtils','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20phash\x20is\x20null\x20and\x20type=1','dbFileIndex','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20photo_faces2index\x20WHERE\x20compare_state=0','indexOf','geohash','UPDATE\x20','deleteRawTempFile','facesPath','\x20AND\x20geohash2!=\x27undefined\x27\x20GROUP\x20BY\x20geohash2','\x20path=\x27','getAllByWhereAndField','updateBySql','path_list','genTinyFile','photo_index_id','../../utils/exifUtils','\x20AND\x20\x20is_file=1\x20','\x20in_trash=1\x20and\x20is_file=1\x20','GPSDateStamp','rotate','\x20OFFSET\x20','imgList','send','125oVPwTX','timeOrder','changes','orderField','\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)','/mergeFace','\x20is_file,id,path,filename,ext,duration,size\x20','findByTitle','/searchMode','cocossdWaitDealCount','/operationLibrary','photo','UPDATE\x20photo_faces\x20SET\x20face_name=?\x20where\x20id\x20=\x20?','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_class_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27','minLat','geoHashList','../../db/dbUserTable','UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20id\x20=\x20?','existsSync','\x20\x20AND\x20filename\x20LIKE\x20\x27%','STATE_FAIL','.jpg','sourceFolderList','\x20SET\x20in_trash=1,in_trash_time=','toLowerCase','desc','../utils/sqliteUtil','26932gVufKA','../../myWorkers/index/photoIndexUtil','query','/switchFaceId','includes','../../myConfig/config','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id','REPLACE\x20INTO\x20photo_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20face_name=?\x20and\x20belong_face_id\x20is\x20null','push','geohash4\x20=\x20','UPDATE\x20photo_faces\x20SET\x20disabled=?\x20where\x20','aiClassId','is_livephoto','\x20(((type=1\x20or\x20type=2)\x20\x20)\x20OR\x20is_file=0\x20)\x20','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','share_uid','dealList','json','\x20and\x20face_id=','SELECT\x20id,path,filename,original_date,size\x20FROM\x20file_index_photo\x20where\x20id=','shareUidList','fileExist','log','currentUser','sortField','run','getUserPathWhere','original_date','type','stringify','../utils/sharpUtils','update\x20file_index_photo\x20set\x20ai_face_detect_state=0','defaultMoviePlay','\x20AND\x20','\x20original_time=\x27','\x20latitude=\x27','13154940THavSd','similar','getList','join','DELETE\x20FROM\x20photo_phash_similar\x20where\x20index_id=?','/clearTrashBin','serveType','SELECT\x20f.*,a.id\x20as\x20f2id,a.width\x20as\x20f2width,a.height\x20as\x20f2height,a.x\x20as\x20f2x,a.y\x20as\x20f2y\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20photo_faces2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20a.photo_index_id=f.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20a.face_id\x20in\x20','isAdmin','geohash2\x20=\x20','../../db/dbConfigTable','toString','then','class_id','\x20type=2\x20\x20','similarIndexList','create_time','f2y','id,username','getPhotoByParams','power_add','parse','create','SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20id=?','f2width','exports','end','abs','deleteList','/getAiDealState','/editExifByIndexId','path','basename','UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?','photoSavedAsNewFile','piexifjs','photoPreviewType','geoInfoWriteErr','GPSIFD','cachePath','binary','similarWaitDealCount','\x20LIMIT\x201','.MP4','dataPreview','post','/updateAlbum','moviePlaylongPressRate','music','offset','cocossd','/getAllAlbum','SELECT\x20index_id\x20FROM\x20photo_phash_similar\x20group\x20by\x20index_id\x20limit\x20','checkSqlInjection','GPSLongitudeRef','GET','load','UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27\x27\x20where\x20id=','trim','STATE_SUC','timeType','\x20LIMIT\x20?\x20OFFSET\x20?','faceApiWaitDealCount','%\x27)\x20','transaction','dialog','floor','fileType','splice','delete\x20from\x20photo_faces\x20where\x201=1','/getPhotoClasses','searchStr','\x27,geohash5=\x27','(\x27mouse\x27,\x27person\x27,\x27traffic\x20light\x27,\x27stop\x20sign\x27,\x27parking\x20meter\x27,\x27fire\x20hydrant\x27)','\x20id,geohash,latitude,longitude,original_time\x20','transSpcielFormat','GPSLatitude','shell','\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time\x20','title','now','\x20id\x20in\x20(','getByName','GPS','SELECT\x20*\x20from\x20photo_phash_similar\x20where\x20index_id=','searchMode','getExcludePathWhereStr','\x20WHERE\x20title\x20like\x20?','getTime','.JPG','\x20AND\x20geohash4!=\x27undefined\x27\x20GROUP\x20BY\x20geohash4','addFileOperationRecord','Exif','key','zoom','/deleteAlbum','all','size','Router','ADD','value','SELECT\x20*\x20FROM\x20photo_library\x20','getPathByType','CUSTOM','isVip','original_time','../../db/dbAlbumTable','search','album.sameNameExist','user_list','GPSLatitudeRef','imagePreviewSize','face_img_path','is_admin','getAlbumWhereStr','dump','\x20AND\x20(type=1\x20or\x20type=2)\x20AND\x20in_trash=0','ordinaryAlbumId','get','存在livephoto','status','LEVEL_MAIN_OPERATION','power_change','\x27,geohash4=\x27','putInSystemTrash','getById','.MOV','minLng','jpeg','face_id','/resetFaceAi','endsWith','\x20WHERE\x20id\x20=\x20','libraryId','imagePreviewType','f2x','book','indexObj','\x20AND\x20in_trash=0\x20\x20\x20AND\x20is_file=1\x20\x20\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20limit\x201','SELECT\x20*\x20FROM\x20file_index_photo\x20WHERE\x20in_trash=1\x20AND\x20is_file=1\x20AND\x20raw_filename\x20is\x20not\x20null\x20AND\x20raw_filename!=\x27\x27\x20AND\x20type=1','UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=0\x20where\x20is_face_poster=1\x20and\x20face_id\x20in\x20','RAW','51iKaORh','/getFaceImg/*','name','INDEX_TABLE_NAME_BOOK','INDEX_TABLE_NAME_PHOTO','editId','undefined','mkdir','minIndexId','replace','username','count','sendFile','getFaceInSql','rawFile','insert','id,is_file,is_livephoto,path,filename,raw_filename,is_raw','4402608yNPLKK','geohash5\x20=\x20','raw_filename','\x20\x20\x20AND\x20in_trash!=1\x20','\x20order\x20by\x20f.original_time\x20desc\x20limit\x201','../../db/dbFileIndexTable','defaultTranscodeResolution','locationList','faceApiWaitCompareCount','asc','filename','atleastChooseTwoFaces','\x20\x20AND\x20(filename\x20LIKE\x20\x27%','doUserCanGet','delete\x20from\x20photo_phash_similar\x20where\x201=1','faceapi','index_id','extname','moviePreferLanguage','SELECT\x20*\x20FROM\x20photo_faces\x20where\x20id\x20=?','returnErrMsg','faceId','excludePathPhoto','../../db/dbFileOperationRecord','%\x27\x20OR\x20mode\x20\x20LIKE\x20\x27%','/dealSimilarPhoto','orderType','substring','\x27\x20where\x20id=','/getSimilarPhoto','delete\x20from\x20photo_phash_similar\x20where\x20index_id=','trash','279984rlHsOF','getFileHashName','mtime','f2id','targetFaceId','/setFacePoster','UPDATE\x20photo_faces\x20SET\x20belong_face_id=?\x20where\x20id\x20=\x20?\x20or\x20belong_face_id=?','/getPhotoByTime','data_value','movie','getDate','ctimeMs','length','UPDATE\x20photo_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?','excludeFilenamePhoto','keepIndexList','mode','stat','startFaceAiWork','\x20SET\x20in_trash=0\x20WHERE\x20in_trash=1','prepare','round','111816PVeddf','COCO_CLASS_MIN_SCORE','writeFile','getAllByWhere','longitude','\x20is_file=1\x20','operationFail','\x27,original_date=\x27','\x20type=1\x20','/getAlbumPhotoForMap','timestamp','power_delete','getMonth','\x27\x20AND\x20','SELECT\x20f.id\x20FROM\x20photo_faces2index\x20as\x20p\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20p.photo_index_id=f.id\x20WHERE\x20p.face_id=?\x20','5394384uARtiy','faceIdList','indexId','INDEX_TABLE_NAME_MUSIC',',ctime=','UPDATE\x20photo_faces\x20SET\x20face_name=null\x20where\x20face_name\x20=\x20?','\x27,longitude=\x27','photoIndexId','EDIT','from','searchValue','getTimeLineDateList','DateTimeOriginal','findWithField','delete','disabled','dbOther','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20share_for_subuser=1','order\x20field\x20error','resize','getSharpInstanceFromInput','f2height','dirname','getIndexTableNameByType','photoPreviewSize','DELETE\x20FROM\x20photo_library\x20\x20WHERE\x20id=?','albumId','rawFaceId','parent','ExifIFD','.HEIC','app','data','getUserPower','sharp','body','\x20in_trash=0\x20AND\x20latitude!=\x27undefined\x27\x20AND\x20longitude!=\x27undefined\x27\x20AND\x20latitude\x20is\x20not\x20null','sep','DELETE','SELECT\x20name,cn_name,geohash\x20FROM\x20cities\x20WHERE\x20geohash=?','operation\x20fail','aiClassesEnable','file_index_photo-indexing','\x20AND\x20geohash\x20LIKE\x20?\x20','power_get','indexFullPath','Image\x20format\x20not\x20support','.jpeg','\x27,geohash3=\x27','getFullYear','\x20and\x20title\x20like\x20?','cacheDeleteFail','faceName','SELECT\x20f.id\x20as\x20photo_index_id\x20FROM\x20ai_classes2index\x20as\x20a\x20INNER\x20JOIN\x20file_index_photo\x20as\x20f\x20ON\x20a.photo_index_id=f.id\x20WHERE\x20a.class_id=?\x20and\x20score>?\x20and\x20\x20f.in_trash=0\x20\x20and\x20f.tiny_path\x20is\x20not\x20null\x20AND\x20f.tiny_path\x20!=\x20\x270\x27\x20\x20','\x20and\x20a.is_face_poster=1\x20limit\x201','similar_index_id','chi','utimes','SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20file_index_photo\x20WHERE\x20ai_face_detect_state=0\x20and\x20(type=1\x20or\x20type=2)\x20and\x20tiny_path\x20is\x20not\x20null\x20AND\x20tiny_path\x20!=\x20\x270\x27\x20','bboxes'];_0x2817=function(){return _0x4e0b20;};return _0x2817();}const sqliteUtil=require(_0x1fe013(0x248)),exifUtils=require(_0x1fe013(0x226)),dbUserTable=require(_0x1fe013(0x23e)),dbAlbumTable=require(_0x1fe013(0x2d8));let geohash=require('ngeohash'),fs=require('fs');function _0x128e(_0x570559,_0x3d88c1){const _0x2817a4=_0x2817();return _0x128e=function(_0x128e4b,_0x276e54){_0x128e4b=_0x128e4b-0x17e;let _0x47c155=_0x2817a4[_0x128e4b];return _0x47c155;},_0x128e(_0x570559,_0x3d88c1);}const dbConfigTable=require(_0x1fe013(0x278));let sharpUtil=require(_0x1fe013(0x268)),nasAccountUtil=require('../utils/nasAccountUtils'),fileUtil=require('../utils/fileUtils');const photoApiUtil=require(_0x1fe013(0x216)),platform=require('os')['platform'](),photoIndexUtil=require(_0x1fe013(0x24a));let piexif=require(_0x1fe013(0x291)),sha256=require('sha256');router[_0x1fe013(0x29b)]('/getTimeLineDateList',(_0x144915,_0x27c184,_0x55d7e8)=>{const _0x1d7b40=_0x1fe013;if(dbUserTable['doUserCanGet'](_0x144915,_0x27c184,_0x1d7b40(0x239),_0x1d7b40(0x1fc))==!![]){let _0x84c78c=_0x144915[_0x1d7b40(0x1f3)]['year'],_0x2cf8db=_0x144915[_0x1d7b40(0x1f3)]['type'],_0x1442a3=_0x144915['body'][_0x1d7b40(0x21b)],_0x38338e=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x1ea)],_0x48fa26=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x2b5)],_0x426515=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x2e3)],_0x560336=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x255)],_0x5d8677=_0x144915[_0x1d7b40(0x1f3)]['libraryId'],_0x213ec5=_0x144915['body']['faceId'],_0x121835=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x22f)],_0x2e478d=_0x144915[_0x1d7b40(0x1f3)][_0x1d7b40(0x244)],_0x1be352=dbUserTable[_0x1d7b40(0x264)](_0x144915,_0x1d7b40(0x239),'power_get',!![],_0x2e478d),_0x138cd6=_0x1be352,_0x226903=[];_0x1442a3&&(_0x138cd6+=_0x1d7b40(0x1fb),_0x226903[_0x1d7b40(0x252)](_0x1442a3+'%'));let _0x38428d=dbSourceFolderTable[_0x1d7b40(0x2c4)](_0x144915[_0x1d7b40(0x1ef)]['dbOther'],_0x1d7b40(0x28d),_0x1d7b40(0x1a1));_0x38428d&&(_0x138cd6+=_0x1d7b40(0x26b)+_0x38428d);let _0x489bfb=dbSourceFolderTable['getExcludePathWhereStr'](_0x144915[_0x1d7b40(0x1ef)][_0x1d7b40(0x1e0)],_0x1d7b40(0x195),_0x1d7b40(0x1b9));_0x489bfb&&(_0x138cd6+=_0x1d7b40(0x26b)+_0x489bfb);if(_0x5d8677){let _0x4ebe0f=_0x144915[_0x1d7b40(0x1ef)][_0x1d7b40(0x218)]['prepare'](_0x1d7b40(0x258))[_0x1d7b40(0x2e4)](_0x5d8677);if(_0x4ebe0f)try{let _0x557468=JSON['parse'](_0x4ebe0f[_0x1d7b40(0x223)]),_0x422d8e=dbUserTable['getPathWhere'](!![],_0x557468);_0x138cd6+=_0x422d8e;}catch(_0x3fe01f){console[_0x1d7b40(0x260)](_0x3fe01f);}}if(_0x38338e){let _0x4fdbae=dbAlbumTable[_0x1d7b40(0x2e0)](_0x144915['app']['dbOther'],_0x38338e);_0x4fdbae&&(_0x138cd6+=_0x1d7b40(0x26b)+_0x4fdbae);}_0x48fa26&&(_0x138cd6+=_0x1d7b40(0x232),_0x226903['push']('%'+_0x48fa26+'%'),_0x226903[_0x1d7b40(0x252)]('%'+_0x48fa26+'%'));_0x138cd6+=_0x1d7b40(0x18e);let _0x364788=dbFileIndexTable[_0x1d7b40(0x1db)](_0x144915[_0x1d7b40(0x1ef)][_0x1d7b40(0x218)],_0x84c78c,_0x2cf8db,_0x138cd6,_0x426515,_0x560336,_0x213ec5,_0x226903,_0x121835);_0x27c184[_0x1d7b40(0x25b)]({'code':0x0,'data':_0x364788});}});let geoDbCache={};router[_0x1fe013(0x29b)](_0x1fe013(0x1b2),(_0x5c0f90,_0x440c2c,_0x43f794)=>{const _0x47689a=_0x1fe013;if(dbUserTable['doUserCanGet'](_0x5c0f90,_0x440c2c,_0x47689a(0x239),_0x47689a(0x1fc))==!![]){result=photoApiUtil[_0x47689a(0x281)](_0x5c0f90,_0x440c2c);let _0x4bd5eb=[],_0x1b382b=[];try{let _0x320e64=Date[_0x47689a(0x2be)]();if(result&&result[_0x47689a(0x1b7)]>0x0){for(let _0x15acb6 of result){!_0x4bd5eb[_0x47689a(0x24d)](_0x15acb6[_0x47689a(0x265)])&&(_0x4bd5eb['push'](_0x15acb6[_0x47689a(0x265)]),_0x1b382b['push']({'date':_0x15acb6[_0x47689a(0x265)],'geoHashList':[],'locationList':[]}));if(_0x15acb6[_0x47689a(0x21b)]&&_0x15acb6[_0x47689a(0x21b)]!=_0x47689a(0x180)&&_0x15acb6['geohash']['length']>0x4){let _0x50d733=_0x1b382b[_0x4bd5eb[_0x47689a(0x21a)](_0x15acb6[_0x47689a(0x265)])][_0x47689a(0x23d)],_0x16927b=_0x15acb6[_0x47689a(0x21b)][_0x47689a(0x1a6)](0x0,0x5);!_0x50d733[_0x47689a(0x24d)](_0x16927b)&&_0x50d733[_0x47689a(0x1b7)]<0x5&&_0x50d733[_0x47689a(0x252)](_0x16927b);}}for(let _0x4a91ae of _0x1b382b){if(_0x4a91ae['geoHashList']['length']<0x1)continue;for(let _0x4216d5 in _0x4a91ae[_0x47689a(0x23d)]){let _0x431e97=_0x4a91ae[_0x47689a(0x23d)][_0x4216d5][_0x47689a(0x1a6)](0x0,0x5),_0x378f39=null;if(geoDbCache[_0x431e97])_0x378f39=geoDbCache[_0x431e97];else{let _0xbebead=_0x47689a(0x1f7);_0x378f39=_0x5c0f90[_0x47689a(0x1ef)]['dbCity']['prepare'](_0xbebead)[_0x47689a(0x2e4)](_0x431e97),geoDbCache[_0x431e97]=_0x378f39;}_0x378f39&&_0x4a91ae['locationList'][_0x47689a(0x252)](_0x378f39);}delete _0x4a91ae['geoHashList'];}for(let _0x1e93d1=_0x1b382b[_0x47689a(0x1b7)]-0x1;_0x1e93d1>=0x0;_0x1e93d1--){_0x1b382b[_0x1e93d1][_0x47689a(0x192)][_0x47689a(0x1b7)]<0x1&&_0x1b382b[_0x47689a(0x2b2)](_0x1e93d1,0x1);}}}catch(_0x5113ef){console[_0x47689a(0x260)](_0x5113ef);}let _0x31ff27={'code':0x0,'data':result,'originalDateItemList':_0x1b382b},_0x11a008=dbConfigTable[_0x47689a(0x235)](_0x5c0f90[_0x47689a(0x1ef)][_0x47689a(0x1e0)],_0x47689a(0x292)),_0x159869=dbConfigTable[_0x47689a(0x235)](_0x5c0f90[_0x47689a(0x1ef)][_0x47689a(0x1e0)],_0x47689a(0x1e8));_0x31ff27[_0x47689a(0x2f4)]=_0x47689a(0x2fb);if(_0x11a008&&_0x11a008[_0x47689a(0x2d2)]==_0x47689a(0x2d5)&&_0x159869&&_0x159869[_0x47689a(0x2d2)])try{let _0x514941=parseInt(_0x159869[_0x47689a(0x2d2)]);_0x31ff27['imagePreviewType']=_0x47689a(0x2d5),_0x31ff27[_0x47689a(0x2dd)]=_0x514941;}catch(_0x80059a){console[_0x47689a(0x260)](_0x80059a);}_0x440c2c['json'](_0x31ff27);}}),router[_0x1fe013(0x29b)](_0x1fe013(0x1ca),(_0x3c229a,_0x4eb15e,_0x501d9d)=>{const _0x50a991=_0x1fe013;let _0x59c0cf=dbUserTable[_0x50a991(0x264)](_0x3c229a,_0x50a991(0x239),_0x50a991(0x1fc),!![]),_0x145a21='\x20id,latitude,longitude,geohash,tiny_path',_0x36826e=_0x50a991(0x1f4),_0x21ee2e=_0x3c229a['body']['libraryId'];if(_0x3c229a[_0x50a991(0x1f3)][_0x50a991(0x1ea)]){let _0x3bc1dd=dbAlbumTable[_0x50a991(0x2e0)](_0x3c229a[_0x50a991(0x1ef)]['dbOther'],_0x3c229a[_0x50a991(0x1f3)]['albumId']);_0x3bc1dd&&(_0x36826e+=_0x50a991(0x26b)+_0x3bc1dd);}if(_0x21ee2e){let _0x5e3e8d=_0x3c229a[_0x50a991(0x1ef)][_0x50a991(0x218)][_0x50a991(0x1bf)]('SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?')[_0x50a991(0x2e4)](_0x21ee2e);if(_0x5e3e8d)try{let _0x5cac9d=JSON[_0x50a991(0x283)](_0x5e3e8d[_0x50a991(0x223)]),_0x9e824f=dbUserTable['getPathWhere'](!![],_0x5cac9d);_0x36826e+=_0x9e824f;}catch(_0x2c8d4d){console['log'](_0x2c8d4d);}}function _0x2288cb(_0x44bd5a,_0x542a6c,_0x53d569){const _0x4a668f=_0x50a991;if(_0x53d569){let _0x26b9e7=0x0;if(_0x3c229a[_0x4a668f(0x1f3)][_0x4a668f(0x2e3)]){let _0x29b0bb=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbumCount'](_0x3c229a[_0x4a668f(0x1ef)][_0x4a668f(0x218)],_0x3c229a[_0x4a668f(0x1f3)][_0x4a668f(0x2e3)],_0x44bd5a);_0x26b9e7=_0x29b0bb[_0x4a668f(0x185)];}else{let _0x3bce4c=dbFileIndexTable['getCountByWhere'](_0x3c229a['app']['dbFileIndex'],_0x44bd5a);_0x26b9e7=_0x3bce4c[_0x4a668f(0x185)];}return _0x26b9e7;}else{let _0x5a4a43=[];return _0x3c229a[_0x4a668f(0x1f3)][_0x4a668f(0x2e3)]?_0x5a4a43=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbum'](_0x3c229a[_0x4a668f(0x1ef)]['dbFileIndex'],_0x3c229a['body'][_0x4a668f(0x2e3)],_0x44bd5a,_0x542a6c):_0x5a4a43=dbFileIndexTable[_0x4a668f(0x221)](_0x3c229a[_0x4a668f(0x1ef)][_0x4a668f(0x218)],_0x44bd5a,_0x542a6c,dbFileIndexTable[_0x4a668f(0x17e)]),_0x5a4a43;}}_0x36826e+=_0x59c0cf,_0x36826e+=_0x50a991(0x227);let _0x2191ca=0xc8,_0x3999c8=[],_0x23345c=_0x2288cb(_0x36826e,null,!![]);if(_0x23345c<_0x2191ca)_0x3999c8=_0x2288cb(_0x36826e,'*');else{let _0x84529e=_0x36826e+'\x20AND\x20geohash5!=\x27undefined\x27\x20GROUP\x20BY\x20geohash5',_0x1069b3=_0x2288cb(_0x84529e,'*');if(_0x1069b3&&_0x1069b3[_0x50a991(0x1b7)]<_0x2191ca)_0x3999c8=_0x1069b3;else{let _0x385cf8=_0x36826e+_0x50a991(0x2c8),_0x3d69a8=_0x2288cb(_0x385cf8,'*');if(_0x3d69a8&&_0x3d69a8[_0x50a991(0x1b7)]<_0x2191ca)_0x3999c8=_0x3d69a8;else{let _0x11b900=_0x36826e+'\x20AND\x20geohash3!=\x27undefined\x27\x20GROUP\x20BY\x20geohash3',_0x3a7d1f=_0x2288cb(_0x11b900,'*');if(_0x3a7d1f&&_0x3a7d1f[_0x50a991(0x1b7)]<_0x2191ca)_0x3999c8=_0x3a7d1f;else{let _0x4eb72b=_0x36826e+_0x50a991(0x21f);_0x3999c8=_0x2288cb(_0x4eb72b,'*');}}}}return _0x4eb15e[_0x50a991(0x25b)]({'code':0x0,'mapPhoto':_0x3999c8});}),router[_0x1fe013(0x29b)](_0x1fe013(0x20f),(_0x409e86,_0x569b40,_0x185f79)=>{const _0x4229cd=_0x1fe013;if(dbUserTable[_0x4229cd(0x198)](_0x409e86,_0x569b40,'photo',_0x4229cd(0x1fc))==!![]){let _0x4e0cea=dbUserTable[_0x4229cd(0x264)](_0x409e86,_0x4229cd(0x239),'power_get',!![]),_0x12a3dc=_0x409e86[_0x4229cd(0x1f3)][_0x4229cd(0x23c)],_0x637607=_0x409e86[_0x4229cd(0x1f3)][_0x4229cd(0x2ed)],_0x2c4846=_0x409e86[_0x4229cd(0x1f3)]['maxLat'],_0x5662a8=_0x409e86['body'][_0x4229cd(0x210)],_0x189c78=_0x409e86[_0x4229cd(0x1f3)][_0x4229cd(0x2cc)],_0x490aff='',_0x53616a=0x2;if(_0x189c78<=0x4)_0x53616a=0x2,_0x490aff=_0x4229cd(0x277);else{if(_0x189c78<=0x6)_0x53616a=0x3,_0x490aff='geohash3\x20=\x20';else{if(_0x189c78<=0x8)_0x53616a=0x4,_0x490aff=_0x4229cd(0x253);else _0x189c78<=0xc&&(_0x53616a=0x5,_0x490aff=_0x4229cd(0x18c));}}let _0x136206=geohash[_0x4229cd(0x20b)](_0x12a3dc,_0x637607,_0x2c4846,_0x5662a8,_0x53616a),_0x204b1f=[];for(let _0x1b49e3=0x0;_0x1b49e3<_0x136206['length'];_0x1b49e3++){let _0x2a1128=_0x136206[_0x1b49e3],_0x105f49='\x20'+_0x490aff+'\x20\x27'+_0x2a1128+'\x27\x20'+_0x4e0cea+_0x4229cd(0x2f8),_0x2e4512=dbFileIndexTable['getByWhere'](_0x409e86[_0x4229cd(0x1ef)]['dbFileIndex'],_0x105f49,_0x4229cd(0x2b8));_0x2e4512&&_0x204b1f['push'](_0x2e4512);}_0x569b40[_0x4229cd(0x25b)]({'code':0x0,'mapPhoto':_0x204b1f});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x215),(_0x496ec6,_0x3646a8,_0x44dc1f)=>{const _0x467499=_0x1fe013;if(dbUserTable[_0x467499(0x198)](_0x496ec6,_0x3646a8,'photo',_0x467499(0x282))==!![]){let _0xa29fd7=_0x496ec6[_0x467499(0x1f3)]['type'],_0x150248=_0x496ec6[_0x467499(0x1f3)][_0x467499(0x1f0)],_0x2d2626=_0x496ec6[_0x467499(0x1f3)][_0x467499(0x1b3)],_0x334230=_0x496ec6[_0x467499(0x1f3)][_0x467499(0x2fe)],_0x541f9f=_0x496ec6[_0x467499(0x1f3)][_0x467499(0x17f)];if(!_0x150248||!_0x150248[_0x467499(0x1da)]||sqliteUtil[_0x467499(0x2a3)](_0x150248[_0x467499(0x1da)])==!![])return _0x496ec6['app']['returnErrMsg'](_0x3646a8,'error\x20data');if(!_0x541f9f){let _0x2c77d9=dbAlbumTable[_0x467499(0x2c0)](_0x496ec6['app'][_0x467499(0x1e0)],_0x334230);if(_0x2c77d9)return _0x496ec6[_0x467499(0x1ef)][_0x467499(0x19f)](_0x3646a8,_0x3646a8['__'](_0x467499(0x2da)));}let _0x5dec18=null;_0x541f9f?_0x5dec18=dbAlbumTable[_0x467499(0x214)](_0x496ec6['app'][_0x467499(0x1e0)],{'type':_0xa29fd7,'data':_0x150248,'data_value':_0x2d2626,'name':_0x334230},_0x541f9f):_0x5dec18=dbAlbumTable[_0x467499(0x284)](_0x496ec6[_0x467499(0x1ef)][_0x467499(0x1e0)],{'type':_0xa29fd7,'data':_0x150248,'data_value':_0x2d2626,'name':_0x334230}),_0x3646a8[_0x467499(0x25b)]({'code':0x0,'result':_0x5dec18});}}),router['post'](_0x1fe013(0x2cd),(_0x3e7825,_0x328c8e,_0x3105c4)=>{const _0x4bb55f=_0x1fe013;if(dbUserTable[_0x4bb55f(0x198)](_0x3e7825,_0x328c8e,_0x4bb55f(0x239),_0x4bb55f(0x1cc))==!![]){let _0x463c93=_0x3e7825[_0x4bb55f(0x1f3)]['id'],_0x481b1e=dbAlbumTable[_0x4bb55f(0x1de)](_0x3e7825[_0x4bb55f(0x1ef)]['dbOther'],_0x463c93);_0x481b1e[_0x4bb55f(0x230)]>0x0?_0x328c8e['json']({'code':0x0,'result':_0x481b1e}):_0x328c8e[_0x4bb55f(0x25b)]({'code':0x1,'message':_0x4bb55f(0x1f8)});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x29c),(_0x3e6297,_0x593fe7,_0x4673e9)=>{const _0x578bb2=_0x1fe013;if(dbUserTable[_0x578bb2(0x198)](_0x3e6297,_0x593fe7,_0x578bb2(0x239),_0x578bb2(0x2e8))==!![]){let _0x25c1d5=_0x3e6297[_0x578bb2(0x1f3)]['id'],_0x2bd3bf=_0x3e6297['body'][_0x578bb2(0x2fe)],_0x1fc3cf=dbAlbumTable[_0x578bb2(0x2c0)](_0x3e6297[_0x578bb2(0x1ef)][_0x578bb2(0x1e0)],_0x2bd3bf);if(_0x1fc3cf)return _0x3e6297[_0x578bb2(0x1ef)][_0x578bb2(0x19f)](_0x593fe7,_0x593fe7['__'](_0x578bb2(0x2da)));let _0x4149aa=dbAlbumTable['udpateName'](_0x3e6297[_0x578bb2(0x1ef)][_0x578bb2(0x1e0)],_0x25c1d5,_0x2bd3bf);_0x4149aa[_0x578bb2(0x230)]>0x0?_0x593fe7[_0x578bb2(0x25b)]({'code':0x0,'result':_0x4149aa}):_0x593fe7[_0x578bb2(0x25b)]({'code':0x1,'message':_0x578bb2(0x1f8)});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x2a1),(_0x2ba48e,_0x1d480d,_0x5f514d)=>{const _0x375ce1=_0x1fe013;if(dbUserTable[_0x375ce1(0x198)](_0x2ba48e,_0x1d480d,_0x375ce1(0x239),_0x375ce1(0x1fc))==!![]){let _0x155fdc=dbUserTable['getUserPathWhere'](_0x2ba48e,_0x375ce1(0x239),_0x375ce1(0x1fc),!![]),_0x22127e=_0x2ba48e[_0x375ce1(0x1f3)][_0x375ce1(0x185)]||0x32,_0x346867=_0x2ba48e[_0x375ce1(0x1f3)][_0x375ce1(0x29f)]||0x0,_0x3a8f7d=_0x2ba48e[_0x375ce1(0x1f3)][_0x375ce1(0x231)]||'id',_0x4a81cb=_0x2ba48e[_0x375ce1(0x1f3)][_0x375ce1(0x1a5)]||_0x375ce1(0x247),_0xf31382=_0x2ba48e[_0x375ce1(0x1f3)][_0x375ce1(0x2d9)];(![_0x375ce1(0x2fe),'id'][_0x375ce1(0x24d)](_0x3a8f7d)||![_0x375ce1(0x194),_0x375ce1(0x247)]['includes'](_0x4a81cb))&&_0x1d480d[_0x375ce1(0x25b)]({'code':0x0,'data':[]});let _0x314e21=dbAlbumTable[_0x375ce1(0x270)](_0x2ba48e[_0x375ce1(0x1ef)][_0x375ce1(0x1e0)],_0x22127e,_0x346867,_0x3a8f7d,_0x4a81cb,_0xf31382);for(let _0x40be7f=0x0;_0x40be7f<_0x314e21['length'];_0x40be7f++){let _0x36f98c=_0x375ce1(0x1c6);_0x36f98c+=_0x155fdc;let _0x50addc=dbAlbumTable[_0x375ce1(0x2e0)](_0x2ba48e[_0x375ce1(0x1ef)][_0x375ce1(0x1e0)],_0x314e21[_0x40be7f]['id']);_0x50addc&&(_0x36f98c+=_0x375ce1(0x26b)+_0x50addc);_0x36f98c+=_0x375ce1(0x2e2),_0x36f98c+='\x20ORDER\x20BY\x20original_time\x20DESC\x20LIMIT\x201';try{let _0x2f0e00=dbFileIndexTable[_0x375ce1(0x1c4)](_0x2ba48e[_0x375ce1(0x1ef)]['dbFileIndex'],_0x36f98c);_0x314e21[_0x40be7f][_0x375ce1(0x22c)]=_0x2f0e00;}catch(_0x2daf90){console[_0x375ce1(0x260)](_0x2daf90),_0x314e21[_0x40be7f][_0x375ce1(0x22c)]=[];}}_0x1d480d[_0x375ce1(0x25b)]({'code':0x0,'data':_0x314e21});}}),router['post'](_0x1fe013(0x236),(_0x2cd2f8,_0x4a0006,_0x3149cc)=>{const _0x37c3bd=_0x1fe013;let _0x377f87=_0x2cd2f8[_0x37c3bd(0x1f3)][_0x37c3bd(0x2cb)],_0x59aa82=dbFileIndexTable[_0x37c3bd(0x2c3)](_0x2cd2f8['app'][_0x37c3bd(0x218)],_0x377f87),_0x1e0e85=[];for(let _0x15f313=0x0;_0x15f313<_0x59aa82[_0x37c3bd(0x1b7)];_0x15f313++){_0x1e0e85[_0x37c3bd(0x252)](_0x59aa82[_0x15f313][_0x37c3bd(0x1bb)]);}_0x4a0006[_0x37c3bd(0x25b)]({'code':0x0,'data':_0x1e0e85});}),router['post']('/getFileTreePhoto',(_0x59f889,_0x1fa656,_0x3cfb79)=>{const _0x5e8874=_0x1fe013;let _0x58670d=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x1ec)],_0x3e8cf3=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x274)],_0x418d59=_0x59f889['body']['count'],_0x26b158=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x29f)]||0x0;_0x26b158=parseInt(_0x26b158);let _0x31b147=parseInt(_0x59f889['body']['showFileType']),_0x203bca=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x2b5)],_0x12dc46=[_0x5e8874(0x195),'original_time','size',_0x5e8874(0x27e),'filename_number'],_0x43a059=[_0x5e8874(0x194),_0x5e8874(0x247)],_0xad37d1=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x231)]||'id',_0x28260f=_0x59f889[_0x5e8874(0x1f3)][_0x5e8874(0x1a5)]||_0x5e8874(0x247);!_0x12dc46['includes'](_0xad37d1)&&(_0xad37d1='id');!_0x43a059['includes'](_0x28260f)&&(_0xad37d1=_0x5e8874(0x247));if(dbUserTable['doUserCanGet'](_0x59f889,_0x1fa656,_0x3e8cf3,_0x5e8874(0x1fc))==!![]){let _0xed3a0d=[];if(!_0x58670d){let _0x165fda=[];_0x59f889[_0x5e8874(0x261)][_0x5e8874(0x2df)]==0x1?_0x165fda=dbSourceFolderTable[_0x5e8874(0x2d4)](_0x59f889[_0x5e8874(0x1ef)][_0x5e8874(0x1e0)],_0x3e8cf3):_0x165fda=dbUserTable[_0x5e8874(0x1f1)](_0x59f889[_0x5e8874(0x1ef)][_0x5e8874(0x1e0)],_0x59f889[_0x5e8874(0x261)][_0x5e8874(0x184)],_0x3e8cf3);if(_0x165fda)for(let _0xb939fb=0x0;_0xb939fb<_0x165fda[_0x5e8874(0x1b7)];_0xb939fb++){_0xed3a0d[_0x5e8874(0x252)]({'path':_0x165fda[_0xb939fb]['path'],'is_file':0x0,'filename':path[_0x5e8874(0x28e)](_0x165fda[_0xb939fb]['path']),'root':!![]});}}else{if(_0x59f889[_0x5e8874(0x261)][_0x5e8874(0x2df)]!=0x1){if(dbUserTable[_0x5e8874(0x198)](_0x59f889,_0x1fa656,_0x3e8cf3,'power_get',_0x58670d)!==!![])return;}_0x58670d=path[_0x5e8874(0x271)](_0x58670d),_0x58670d=_0x58670d['replace'](/\'/g,'\x27\x27');let _0x22b135=_0x5e8874(0x220)+_0x58670d+_0x5e8874(0x1ce);if(_0x31b147==0x0)_0x22b135+=_0x5e8874(0x257);else{if(_0x31b147==0x1)_0x22b135+=_0x5e8874(0x1c9);else{if(_0x31b147==0x2)_0x22b135+=_0x5e8874(0x27c);else _0x31b147==0x3&&(_0x22b135+='\x20is_file=0\x20');}}if(_0x203bca){let _0x215391=_0x5e8874(0x197)+_0x203bca+_0x5e8874(0x1a3)+_0x203bca+_0x5e8874(0x2ad);_0x3e8cf3==_0x5e8874(0x1b4)&&(_0x215391=_0x5e8874(0x241)+_0x203bca+'%\x27\x20'),_0x22b135+=_0x215391;}let _0x37c5ae='\x20is_file,id,path,filename,ext,type,width,height,duration,size,original_date,original_time,latitude,longitude\x20',_0x3e3044=dbFileIndexTable[_0x5e8874(0x1e7)](_0x3e8cf3);if(_0x3e8cf3==_0x5e8874(0x1b4))_0x37c5ae=_0x5e8874(0x2bc);else _0x3e8cf3==_0x5e8874(0x29e)&&(_0x37c5ae=_0x5e8874(0x234));_0x22b135+='\x20ORDER\x20BY\x20is_file\x20asc,\x20'+_0xad37d1+'\x20'+_0x28260f+'\x20LIMIT\x20'+_0x418d59+_0x5e8874(0x22b)+_0x26b158,_0xed3a0d=dbFileIndexTable['getAllByWhere'](_0x59f889['app']['dbFileIndex'],_0x22b135,_0x37c5ae,_0x3e3044);}let _0x5b269c=path[_0x5e8874(0x1f5)],_0x3378e4={'platform':platform,'code':0x0,'data':_0xed3a0d,'sep':_0x5b269c};return _0x1fa656['json'](_0x3378e4);}}),router[_0x1fe013(0x29b)]('/getIndexDetail',(_0x4e23f2,_0x4f2b82,_0x27511a)=>{const _0x3c8159=_0x1fe013;let _0x5a9fd2=_0x4e23f2[_0x3c8159(0x1f3)]['id'],_0x561bf0=_0x4e23f2[_0x3c8159(0x1f3)]['serverType'],_0x217556=dbFileIndexTable['INDEX_TABLE_NAME_PHOTO'];if(_0x561bf0==_0x3c8159(0x1b4))_0x217556=dbFileIndexTable[_0x3c8159(0x212)];else{if(_0x561bf0==_0x3c8159(0x29e))_0x217556=dbFileIndexTable[_0x3c8159(0x1d3)];else _0x561bf0==_0x3c8159(0x2f6)&&(_0x217556=dbFileIndexTable[_0x3c8159(0x2ff)]);}let _0x48a23d=dbFileIndexTable[_0x3c8159(0x2eb)](_0x4e23f2[_0x3c8159(0x1ef)][_0x3c8159(0x218)],_0x5a9fd2,_0x217556);if(!_0x48a23d)return _0x4f2b82[_0x3c8159(0x2e6)](0x194)[_0x3c8159(0x288)]();if(dbUserTable[_0x3c8159(0x198)](_0x4e23f2,_0x4f2b82,'','power_get',_0x48a23d[_0x3c8159(0x28d)])==!![]){let _0x33a7ca={'code':0x0,'data':_0x48a23d};if(_0x561bf0==_0x3c8159(0x1b4)){let _0x3017b5=dbConfigTable[_0x3c8159(0x235)](_0x4e23f2['app'][_0x3c8159(0x1e0)],'moviePreferLanguage');_0x33a7ca['moviePreferLanguage']=_0x3017b5?_0x3017b5[_0x3c8159(0x2d2)]:_0x3c8159(0x208),_0x33a7ca[_0x3c8159(0x1f0)][_0x3c8159(0x19d)]=_0x33a7ca['moviePreferLanguage'];let _0x4c69ab=dbConfigTable[_0x3c8159(0x235)](_0x4e23f2['app'][_0x3c8159(0x1e0)],_0x3c8159(0x29d));_0x33a7ca[_0x3c8159(0x29d)]=_0x4c69ab?_0x4c69ab[_0x3c8159(0x2d2)]:'2',_0x33a7ca['data'][_0x3c8159(0x29d)]=_0x33a7ca['moviePlaylongPressRate'];let _0xe6a851=dbConfigTable[_0x3c8159(0x235)](_0x4e23f2['app'][_0x3c8159(0x1e0)],'defaultTranscodeResolution');_0x33a7ca[_0x3c8159(0x191)]=_0xe6a851?_0xe6a851[_0x3c8159(0x2d2)]:'3';let _0x40b308=dbConfigTable[_0x3c8159(0x235)](_0x4e23f2[_0x3c8159(0x1ef)][_0x3c8159(0x1e0)],_0x3c8159(0x26a));_0x33a7ca[_0x3c8159(0x26a)]=_0x40b308?_0x40b308[_0x3c8159(0x2d2)]:_0x3c8159(0x188);let _0x376fe3=path[_0x3c8159(0x271)](_0x48a23d[_0x3c8159(0x28d)],_0x48a23d[_0x3c8159(0x195)]);fs[_0x3c8159(0x1bc)](_0x376fe3,(_0x3ffe63,_0x4a2ef6)=>{const _0x4b41cf=_0x3c8159;return _0x3ffe63?(_0x33a7ca[_0x4b41cf(0x25f)]=0x0,_0x33a7ca[_0x4b41cf(0x1fd)]=_0x376fe3):(_0x33a7ca[_0x4b41cf(0x25f)]=0x1,_0x33a7ca['indexFullPath']=_0x376fe3),_0x4f2b82[_0x4b41cf(0x25b)](_0x33a7ca);});}else return _0x4f2b82[_0x3c8159(0x25b)](_0x33a7ca);}}),router[_0x1fe013(0x29b)](_0x1fe013(0x28c),(_0x5dd0c1,_0x1436de,_0x433aae)=>{const _0x291b6d=_0x1fe013;if(dbUserTable[_0x291b6d(0x198)](_0x5dd0c1,_0x1436de,_0x291b6d(0x239),_0x291b6d(0x2e8))==!![]){let _0x549609=_0x5dd0c1[_0x291b6d(0x1f3)]['id'],_0x24591d=_0x5dd0c1[_0x291b6d(0x1f3)]['latitude'],_0x3aab9e=_0x5dd0c1[_0x291b6d(0x1f3)][_0x291b6d(0x1c5)],_0xf681a=_0x5dd0c1['body']['newDate'],_0x50d716=dbFileIndexTable[_0x291b6d(0x2eb)](_0x5dd0c1['app'][_0x291b6d(0x218)],_0x549609);if(!_0x50d716)return _0x5dd0c1[_0x291b6d(0x1ef)][_0x291b6d(0x19f)](_0x1436de,_0x1436de['__'](_0x291b6d(0x290)));let _0x37f04d=path[_0x291b6d(0x271)](_0x50d716[_0x291b6d(0x28d)],path['sep'],_0x50d716[_0x291b6d(0x195)]),_0x479759=path['extname'](_0x37f04d)?path[_0x291b6d(0x19c)](_0x37f04d)[_0x291b6d(0x246)]():'';if(_0x479759!=_0x291b6d(0x243)&&_0x479759!=_0x291b6d(0x1ff))return _0x5dd0c1[_0x291b6d(0x1ef)][_0x291b6d(0x19f)](_0x1436de,_0x291b6d(0x1fe));fs[_0x291b6d(0x1bc)](_0x37f04d,(_0x5a0c82,_0x1244b5)=>{const _0x3930ef=_0x291b6d;if(_0x5a0c82||!_0x1244b5['isFile']())return _0x5dd0c1[_0x3930ef(0x1ef)]['returnErrMsg'](_0x1436de,_0x1436de['__'](_0x3930ef(0x20c)));if(_0x5a0c82||!_0x1244b5['isFile']())return _0x5dd0c1[_0x3930ef(0x1ef)][_0x3930ef(0x19f)](_0x1436de,_0x1436de['__'](_0x3930ef(0x20c)));fs['readFile'](_0x37f04d,(_0x4fdd24,_0x2abebf)=>{const _0x4f07ff=_0x3930ef;if(_0x4fdd24)return _0x5dd0c1['app'][_0x4f07ff(0x19f)](_0x1436de,_0x1436de['__'](_0x4f07ff(0x1c7)));var _0x4279b1=piexif[_0x4f07ff(0x2a6)](_0x2abebf[_0x4f07ff(0x279)](_0x4f07ff(0x296)));if(_0x24591d&&_0x3aab9e){function _0x5520e7(_0x5db46c){const _0x438863=_0x4f07ff;try{_0x5db46c=Number(_0x5db46c);let _0x1cb8bc=Math['floor'](Math['abs'](_0x5db46c)),_0x1c60f1=(Math[_0x438863(0x289)](_0x5db46c)-_0x1cb8bc)*0x3c,_0x49b876=Math[_0x438863(0x2b0)](_0x1c60f1),_0x39b475=Math[_0x438863(0x1c0)]((_0x1c60f1-_0x49b876)*0x3c*0x64);return[[_0x1cb8bc,0x1],[_0x49b876,0x1],[_0x39b475,0x64]];}catch(_0x464275){return'';}}let _0x24ea2b=_0x5520e7(_0x24591d),_0x12909e=_0x5520e7(_0x3aab9e);if(!_0x12909e||!_0x24ea2b)return _0x5dd0c1['app']['returnErrMsg'](_0x1436de,'ERROR\x20GPS\x20LOCATION');_0x4279b1[_0x4f07ff(0x2c1)][piexif[_0x4f07ff(0x294)][_0x4f07ff(0x2dc)]]=_0x24591d>=0x0?'N':'S',_0x4279b1[_0x4f07ff(0x2c1)][piexif['GPSIFD'][_0x4f07ff(0x2ba)]]=_0x24ea2b,(_0x4279b1[_0x4f07ff(0x2c1)][piexif[_0x4f07ff(0x294)][_0x4f07ff(0x2a4)]]=_0x3aab9e>=0x0?'E':'W',_0x4279b1['GPS'][piexif[_0x4f07ff(0x294)]['GPSLongitude']]=_0x12909e);let _0x267c8a=geohash['encode'](_0x24591d,_0x3aab9e,0x8),_0x3716d7=_0x267c8a['substring'](0x0,0x5),_0x4f639d=_0x267c8a[_0x4f07ff(0x1a6)](0x0,0x4),_0x1bb83b=_0x267c8a[_0x4f07ff(0x1a6)](0x0,0x3),_0x3c4585=_0x267c8a[_0x4f07ff(0x1a6)](0x0,0x2);dbFileIndexTable['updateBySql'](_0x5dd0c1[_0x4f07ff(0x1ef)][_0x4f07ff(0x218)],_0x50d716['id'],_0x4f07ff(0x26d)+_0x24591d+_0x4f07ff(0x1d6)+_0x3aab9e+'\x27,geohash=\x27'+_0x267c8a+_0x4f07ff(0x2b6)+_0x3716d7+_0x4f07ff(0x2e9)+_0x4f639d+_0x4f07ff(0x200)+_0x1bb83b+'\x27,geohash2=\x27'+_0x3c4585+'\x27\x20');}if(_0xf681a){_0x4279b1[_0x4f07ff(0x2ca)][piexif[_0x4f07ff(0x1ed)][_0x4f07ff(0x1dc)]]=_0xf681a,_0x4279b1['GPS'][piexif['GPSIFD'][_0x4f07ff(0x229)]]=_0xf681a;let _0x57ad3a=new Date(_0xf681a),_0x1dbbf6=_0x57ad3a['getTime'](),_0x53bce3=_0x57ad3a[_0x4f07ff(0x201)](),_0x2f51a1=_0x57ad3a[_0x4f07ff(0x1cd)]()+0x1;_0x2f51a1=_0x2f51a1>=0xa?_0x2f51a1:'0'+_0x2f51a1;let _0x55cfc4=_0x57ad3a[_0x4f07ff(0x1b5)]();_0x55cfc4=_0x55cfc4>=0xa?_0x55cfc4:'0'+_0x55cfc4;let _0x2635d9=_0x53bce3+'-'+_0x2f51a1+'-'+_0x55cfc4;dbFileIndexTable[_0x4f07ff(0x222)](_0x5dd0c1['app'][_0x4f07ff(0x218)],_0x50d716['id'],_0x4f07ff(0x26c)+_0x1dbbf6+_0x4f07ff(0x1c8)+_0x2635d9+'\x27\x20');}try{var _0xe73af3=piexif[_0x4f07ff(0x2e1)](_0x4279b1),_0x101e6e=piexif[_0x4f07ff(0x189)](_0xe73af3,_0x2abebf[_0x4f07ff(0x279)](_0x4f07ff(0x296)));let _0x537f61=path[_0x4f07ff(0x271)](_0x50d716['path'],_0x50d716[_0x4f07ff(0x195)]);fs[_0x4f07ff(0x1c3)](_0x537f61,Buffer[_0x4f07ff(0x1d9)](_0x101e6e,_0x4f07ff(0x296)),{},_0x5e876d=>{const _0x4c03b2=_0x4f07ff;if(_0x5e876d)return console[_0x4c03b2(0x260)](_0x5e876d),_0x5dd0c1[_0x4c03b2(0x1ef)][_0x4c03b2(0x19f)](_0x1436de,_0x1436de['__'](_0x4c03b2(0x1c7)));console['log'](_0x4c03b2(0x20d)),fs[_0x4c03b2(0x209)](_0x537f61,new Date(_0x50d716[_0x4c03b2(0x1ad)]),new Date(_0x50d716['mtime']),_0x5a248a=>{const _0x483de2=_0x4c03b2;_0x5a248a&&console[_0x483de2(0x260)](_0x5a248a),fs['stat'](_0x537f61,(_0x30d2a,_0x451b0b)=>{const _0x24bc2e=_0x483de2;if(_0x30d2a)return _0x5dd0c1[_0x24bc2e(0x1ef)][_0x24bc2e(0x19f)](_0x1436de,_0x1436de['__']('operationFail'));return dbFileIndexTable[_0x24bc2e(0x222)](_0x5dd0c1['app'][_0x24bc2e(0x218)],_0x50d716['id'],'\x20size='+_0x451b0b[_0x24bc2e(0x2cf)]+_0x24bc2e(0x1d4)+_0x451b0b[_0x24bc2e(0x1b6)]+'\x20'),_0x1436de[_0x24bc2e(0x25b)]({'code':0x0,'newIndex':dbFileIndexTable[_0x24bc2e(0x2eb)](_0x5dd0c1[_0x24bc2e(0x1ef)][_0x24bc2e(0x218)],_0x50d716['id'])});});});});}catch(_0x488e53){return console[_0x4f07ff(0x260)](_0x488e53),_0x5dd0c1[_0x4f07ff(0x1ef)][_0x4f07ff(0x19f)](_0x1436de,_0x1436de['__'](_0x4f07ff(0x293)));}});});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x2b4),(_0x228745,_0x45d489,_0x1a4d45)=>{const _0x54c628=_0x1fe013;if(dbUserTable[_0x54c628(0x198)](_0x228745,_0x45d489,_0x54c628(0x239),_0x54c628(0x1fc))==!![]){let _0x3d2ceb=dbConfigTable[_0x54c628(0x235)](_0x228745[_0x54c628(0x1ef)][_0x54c628(0x1e0)],_0x54c628(0x1f9));if(!_0x3d2ceb||_0x3d2ceb[_0x54c628(0x2d2)]!='1')return _0x45d489[_0x54c628(0x25b)]({'code':0x0,'data':[],'enable':![]});let _0x1dfe72=_0x54c628(0x2b7),_0x55db4d=dbUserTable[_0x54c628(0x264)](_0x228745,_0x54c628(0x239),_0x54c628(0x1fc),!![]),_0x113364=_0x228745[_0x54c628(0x1ef)][_0x54c628(0x218)]['prepare']('SELECT\x20*\x20FROM\x20ai_classes\x20where\x20\x20class_name\x20not\x20in\x20'+_0x1dfe72)[_0x54c628(0x2ce)](),_0x57117e=[];for(let _0x2998b4 in _0x113364){let _0x124b21=_0x113364[_0x2998b4],_0x30134a=_0x228745[_0x54c628(0x1ef)][_0x54c628(0x218)][_0x54c628(0x1bf)](_0x54c628(0x205)+_0x55db4d+'\x20order\x20by\x20score\x20desc')[_0x54c628(0x2e4)](_0x124b21['id'],dbFileIndexTable[_0x54c628(0x1c2)]);if(_0x30134a)_0x113364[_0x2998b4][_0x54c628(0x225)]=_0x30134a[_0x54c628(0x225)],_0x113364[_0x2998b4][_0x54c628(0x27b)]=_0x113364[_0x2998b4]['id'],_0x57117e[_0x54c628(0x252)](_0x113364[_0x2998b4]);else continue;}_0x45d489[_0x54c628(0x25b)]({'code':0x0,'data':_0x57117e,'enable':!![]});}}),router[_0x1fe013(0x29b)]('/getPhotoFaces',(_0x531200,_0x3a7753,_0x53d47e)=>{const _0x2c59ea=_0x1fe013;if(dbUserTable[_0x2c59ea(0x198)](_0x531200,_0x3a7753,'photo',_0x2c59ea(0x1fc))==!![]){let _0x4970f6=dbConfigTable[_0x2c59ea(0x235)](_0x531200[_0x2c59ea(0x1ef)]['dbOther'],'aiFaceEnable');if(!_0x4970f6||_0x4970f6[_0x2c59ea(0x2d2)]!='1')return _0x3a7753[_0x2c59ea(0x25b)]({'code':0x0,'data':[],'enable':![]});let _0x2c5c49=0x5,_0x32a6cf=dbConfigTable[_0x2c59ea(0x235)](_0x531200[_0x2c59ea(0x1ef)][_0x2c59ea(0x1e0)],'aiFaceMinPhotoCount');_0x32a6cf&&_0x32a6cf['value']&&(_0x32a6cf[_0x2c59ea(0x2d2)]>0x0&&(_0x2c5c49=_0x32a6cf[_0x2c59ea(0x2d2)]));let _0xfc1314=_0x531200[_0x2c59ea(0x1ef)][_0x2c59ea(0x218)][_0x2c59ea(0x1bf)]('SELECT\x20*\x20FROM\x20photo_faces\x20WHERE\x20disabled=0\x20and\x20belong_face_id\x20is\x20null\x20and\x20face_photo_count>=?\x20order\x20by\x20face_photo_count\x20desc\x20limit\x20500')[_0x2c59ea(0x2ce)](parseInt(_0x2c5c49)),_0x5d713b=[];if(_0x531200['currentUser'][_0x2c59ea(0x2df)]==0x1)_0x5d713b=_0xfc1314;else{let _0x11ec3d=dbUserTable[_0x2c59ea(0x264)](_0x531200,_0x2c59ea(0x239),_0x2c59ea(0x1fc),!![]);for(let _0x2a90c5 of _0xfc1314){try{let _0x339aaa=_0x531200[_0x2c59ea(0x1ef)][_0x2c59ea(0x218)][_0x2c59ea(0x1bf)](_0x2c59ea(0x1cf)+_0x11ec3d+_0x2c59ea(0x298))[_0x2c59ea(0x2e4)](_0x2a90c5['id']);_0x339aaa&&_0x5d713b[_0x2c59ea(0x252)](_0x2a90c5);}catch(_0x3d3251){console[_0x2c59ea(0x260)](_0x3d3251),_0x5d713b[_0x2c59ea(0x252)](_0x2a90c5);}}}_0x3a7753[_0x2c59ea(0x25b)]({'code':0x0,'data':_0x5d713b,'enable':!![]});}}),router['post'](_0x1fe013(0x1b0),(_0x30bd76,_0x4b53b7,_0x56f29b)=>{const _0x508c00=_0x1fe013;let _0x2f889a=_0x30bd76[_0x508c00(0x1f3)]['setFaceId'],_0x2fcee6=_0x30bd76[_0x508c00(0x1f3)][_0x508c00(0x1eb)],_0x49f4ac=_0x30bd76['body'][_0x508c00(0x1d7)];if(dbUserTable[_0x508c00(0x198)](_0x30bd76,_0x4b53b7,_0x508c00(0x239),'power_change')==!![]){let _0x33e0fc=dbFileIndexTable[_0x508c00(0x187)](_0x30bd76['app'][_0x508c00(0x218)],_0x2f889a);_0x30bd76[_0x508c00(0x1ef)]['dbFileIndex'][_0x508c00(0x1bf)](_0x508c00(0x2fa)+_0x33e0fc)[_0x508c00(0x263)](),_0x30bd76[_0x508c00(0x1ef)][_0x508c00(0x218)][_0x508c00(0x1bf)]('UPDATE\x20photo_faces2index\x20SET\x20is_face_poster=1\x20where\x20photo_index_id\x20=\x20'+_0x49f4ac+_0x508c00(0x25c)+_0x2fcee6)['run'](),_0x30bd76[_0x508c00(0x1ef)][_0x508c00(0x218)][_0x508c00(0x1bf)](_0x508c00(0x2a7)+_0x2f889a)[_0x508c00(0x263)](),_0x4b53b7[_0x508c00(0x25b)]({'code':0x0});}}),router['post'](_0x1fe013(0x211),(_0x2ea31a,_0x51c4de,_0x41fc03)=>{const _0x38a5ec=_0x1fe013;let _0x508c29=_0x2ea31a[_0x38a5ec(0x1f3)][_0x38a5ec(0x28a)];try{_0x508c29=JSON[_0x38a5ec(0x283)](_0x508c29);}catch(_0xc08915){console[_0x38a5ec(0x260)](_0xc08915);}if(dbUserTable[_0x38a5ec(0x198)](_0x2ea31a,_0x51c4de,_0x38a5ec(0x239),_0x38a5ec(0x2e8))==!![]){for(let _0x262f55 of _0x508c29){_0x2ea31a[_0x38a5ec(0x1ef)][_0x38a5ec(0x218)][_0x38a5ec(0x1bf)]('DELETE\x20FROM\x20photo_faces2index\x20where\x20face_id=?\x20and\x20photo_index_id\x20=?')[_0x38a5ec(0x263)](parseInt(_0x262f55[_0x38a5ec(0x1a0)]),parseInt(_0x262f55[_0x38a5ec(0x1d2)]));}_0x51c4de[_0x38a5ec(0x25b)]({'code':0x0});}}),router[_0x1fe013(0x29b)]('/updatePhotoFace',(_0x17de2f,_0x3aa594,_0x373387)=>{const _0x2652da=_0x1fe013;if(dbUserTable[_0x2652da(0x198)](_0x17de2f,_0x3aa594,'photo',_0x2652da(0x2e8))==!![]){let _0x23c140=_0x17de2f[_0x2652da(0x1f3)][_0x2652da(0x204)],_0x42e1fc=_0x17de2f[_0x2652da(0x1f3)][_0x2652da(0x1df)],_0x56b3ee=_0x17de2f[_0x2652da(0x1f3)]['faceId'],_0x2d7cdd=_0x17de2f[_0x2652da(0x1f3)][_0x2652da(0x1d1)];if(_0x23c140){_0x23c140=_0x23c140[_0x2652da(0x2a8)]();let _0x1cc048=_0x17de2f[_0x2652da(0x1ef)][_0x2652da(0x218)][_0x2652da(0x1bf)](_0x2652da(0x251))[_0x2652da(0x2e4)](_0x23c140);_0x1cc048&&_0x1cc048['id']!=_0x56b3ee?_0x17de2f[_0x2652da(0x1ef)][_0x2652da(0x218)]['prepare'](_0x2652da(0x28f))[_0x2652da(0x263)](_0x1cc048['id'],_0x56b3ee):(_0x17de2f[_0x2652da(0x1ef)]['dbFileIndex'][_0x2652da(0x1bf)](_0x2652da(0x1d5))[_0x2652da(0x263)](_0x23c140),_0x17de2f[_0x2652da(0x1ef)][_0x2652da(0x218)][_0x2652da(0x1bf)](_0x2652da(0x23a))[_0x2652da(0x263)](_0x23c140,_0x56b3ee));}if(parseInt(_0x42e1fc)==0x0||parseInt(_0x42e1fc)==0x1){if(_0x2d7cdd){let _0x309e98=_0x2652da(0x2bf);for(let _0x43803e in _0x2d7cdd){_0x309e98+=_0x2d7cdd[_0x43803e],_0x43803e!=_0x2d7cdd[_0x2652da(0x1b7)]-0x1&&(_0x309e98+=',');}_0x309e98+=')';let _0x46afe5=_0x2652da(0x254)+_0x309e98;_0x17de2f[_0x2652da(0x1ef)][_0x2652da(0x218)][_0x2652da(0x1bf)](_0x46afe5)[_0x2652da(0x263)](_0x42e1fc);}else _0x17de2f[_0x2652da(0x1ef)][_0x2652da(0x218)]['prepare'](_0x2652da(0x23f))['run'](_0x42e1fc,_0x56b3ee);}return _0x3aa594['json']({'code':0x0});}}),router['post'](_0x1fe013(0x233),(_0x3499f7,_0x42c1fd,_0x507dec)=>{const _0x466996=_0x1fe013;if(dbUserTable[_0x466996(0x198)](_0x3499f7,_0x42c1fd,_0x466996(0x239),_0x466996(0x2e8))==!![]){let _0x4f1ce5=_0x3499f7[_0x466996(0x1f3)]['faceIdList'];if(!_0x4f1ce5||_0x4f1ce5[_0x466996(0x1b7)]<0x2)return _0x3499f7[_0x466996(0x1ef)][_0x466996(0x19f)](_0x42c1fd,_0x42c1fd['__'](_0x466996(0x196)));let _0x27473f=_0x3499f7['app'][_0x466996(0x218)][_0x466996(0x1bf)](_0x466996(0x285))[_0x466996(0x2e4)](_0x4f1ce5[0x0]);if(!_0x27473f)return _0x3499f7[_0x466996(0x1ef)][_0x466996(0x19f)](_0x42c1fd,_0x42c1fd['__']('operationFail'));for(let _0x328566=0x1;_0x328566<_0x4f1ce5['length'];_0x328566++){let _0x496cac=_0x4f1ce5[_0x328566];_0x3499f7[_0x466996(0x1ef)][_0x466996(0x218)][_0x466996(0x1bf)](_0x466996(0x1b1))[_0x466996(0x263)](_0x27473f['id'],_0x496cac,_0x496cac);}return process[_0x466996(0x22d)]({'type':_0x466996(0x1bd)}),_0x42c1fd['json']({'code':0x0});}}),router[_0x1fe013(0x2e4)](_0x1fe013(0x2fd),(_0x26dfda,_0x256942,_0x3b1344)=>{const _0x2fa2f4=_0x1fe013;let _0x507872=_0x26dfda[_0x2fa2f4(0x24b)][_0x2fa2f4(0x1a0)];if(dbUserTable[_0x2fa2f4(0x198)](_0x26dfda,_0x256942,_0x2fa2f4(0x239),'power_get')==!![]){let _0x9aa0e9=_0x26dfda[_0x2fa2f4(0x1ef)]['dbFileIndex'][_0x2fa2f4(0x1bf)](_0x2fa2f4(0x19e))[_0x2fa2f4(0x2e4)](_0x507872);if(!_0x9aa0e9)return _0x256942[_0x2fa2f4(0x2e6)](0x194)[_0x2fa2f4(0x288)]();_0x26dfda[_0x2fa2f4(0x261)]['is_admin']!=0x1?_0x19e3f6(![]):!_0x9aa0e9['face_img_path']?_0x19e3f6(!![]):fs[_0x2fa2f4(0x1bc)](_0x9aa0e9[_0x2fa2f4(0x2de)],(_0x31f7c2,_0x5e9db9)=>{const _0x42887a=_0x2fa2f4;if(!_0x31f7c2){let _0x516d71=new Date()[_0x42887a(0x2c6)](),_0x56e0ce=0x48*0xe10*0x3e8;if(_0x5e9db9[_0x42887a(0x1b6)]){let _0xda70d9=_0x516d71-_0x5e9db9['ctimeMs'];if(_0xda70d9>_0x56e0ce)return _0x19e3f6(!![]);}return _0x256942[_0x42887a(0x186)](_0x9aa0e9[_0x42887a(0x2de)]);}_0x19e3f6(!![]);});function _0x19e3f6(_0x1a19cb){const _0x156737=_0x2fa2f4;let _0x5b9cef=dbFileIndexTable[_0x156737(0x187)](_0x26dfda['app'][_0x156737(0x218)],_0x507872),_0x56c75c=_0x156737(0x275)+_0x5b9cef+'\x20';if(_0x26dfda[_0x156737(0x261)][_0x156737(0x2df)]!=0x1){let _0x2f3057=dbUserTable[_0x156737(0x264)](_0x26dfda,_0x156737(0x239),_0x156737(0x1fc),!![]);_0x56c75c+=_0x2f3057;}let _0x43e868=_0x26dfda[_0x156737(0x1ef)][_0x156737(0x218)][_0x156737(0x1bf)](_0x56c75c+_0x156737(0x206))[_0x156737(0x2e4)]();if(!_0x43e868){_0x43e868=_0x26dfda[_0x156737(0x1ef)]['dbFileIndex']['prepare'](_0x56c75c+_0x156737(0x18f))[_0x156737(0x2e4)]();if(!_0x43e868)return _0x256942[_0x156737(0x2e6)](0x194)['end']();}if(!_0x43e868)return _0x256942[_0x156737(0x2e6)](0x194)[_0x156737(0x288)]();let _0x4d2f6a=path['join'](_0x43e868[_0x156737(0x28d)],_0x43e868[_0x156737(0x195)]);if(parseInt(_0x43e868[_0x156737(0x266)])==0x2){let _0x116b08=config[_0x156737(0x1ac)](_0x43e868),_0x599037=path[_0x156737(0x271)](config[_0x156737(0x295)],_0x116b08);sharpUtil[_0x156737(0x224)](_0x4d2f6a,path[_0x156737(0x1e6)](_0x599037),path[_0x156737(0x28e)](_0x599037),'video',_0x43e868,_0x2c23ba=>{_0x4d2f6a=_0x599037,_0x2f1f09();},_0x1564b1=>{const _0x325737=_0x156737;return _0x256942[_0x325737(0x2e6)](0x194)[_0x325737(0x288)]();});}else _0x2f1f09();function _0x2f1f09(){const _0x3f68a1=_0x156737;let _0x1a674e=path[_0x3f68a1(0x271)](config[_0x3f68a1(0x21e)],_0x43e868[_0x3f68a1(0x1ae)]+new Date()[_0x3f68a1(0x2c6)]()+'.jpg'),_0x1941ca=0x7d0;sharpUtil[_0x3f68a1(0x2b9)](_0x4d2f6a,(_0x364ae6,_0x26679e,_0x221eec)=>{const _0x3ed332=_0x3f68a1;let _0x59db85=parseInt(_0x43e868[_0x3ed332(0x286)]*1.4),_0x1fb256=parseInt(_0x43e868[_0x3ed332(0x1e5)]*1.4),_0x120551=parseInt(_0x43e868[_0x3ed332(0x2f5)]-_0x59db85*0.2),_0x42632a=parseInt(_0x43e868[_0x3ed332(0x27f)]-_0x1fb256*0.2);if(_0x42632a<0x0)_0x42632a=0x0;if(_0x120551<0x0)_0x120551=0x0;_0x5e6fdb(_0x364ae6,_0x26679e,_0x221eec,_0x120551,_0x42632a,_0x59db85,_0x1fb256,()=>{const _0x318e6a=_0x3ed332;let _0x49b9b2=parseInt(_0x43e868['f2width']),_0x578843=parseInt(_0x43e868[_0x318e6a(0x1e5)]),_0x19fd80=parseInt(_0x43e868[_0x318e6a(0x2f5)]),_0x2cfb44=parseInt(_0x43e868[_0x318e6a(0x27f)]);if(_0x2cfb44<0x0)_0x2cfb44=0x0;if(_0x19fd80<0x0)_0x19fd80=0x0;_0x5e6fdb(_0x364ae6,_0x26679e,_0x221eec,_0x19fd80,_0x2cfb44,_0x49b9b2,_0x578843);});});function _0x5e6fdb(_0x35225c,_0xd4ade1,_0x5f5900,_0x8ead1d,_0x2bc614,_0x5f482d,_0x81133f,_0x59f66a){const _0x47f7bf=_0x3f68a1;let _0x986702=sharpUtil[_0x47f7bf(0x1e4)](_0x35225c),_0x56fcbe=exifUtils['getRotateFromTags'](_0x5f5900);_0x56fcbe?_0x986702=_0x986702[_0x47f7bf(0x22a)](_0x56fcbe):_0x986702=_0x986702[_0x47f7bf(0x22a)](),_0x986702[_0x47f7bf(0x1e3)]({'width':_0x1941ca,'height':_0x1941ca,'withoutEnlargement':!![]})[_0x47f7bf(0x2ee)]()['extract']({'left':_0x8ead1d,'top':_0x2bc614,'width':_0x5f482d,'height':_0x81133f})['toFile'](_0x1a674e,function(_0x35aa6c){const _0x1e4c54=_0x47f7bf;if(_0x35aa6c){_0xd4ade1&&sharpUtil[_0x1e4c54(0x21d)](_0x35225c);if(_0x59f66a)_0x59f66a();else return _0x256942['status'](0x194)['end']();}else{_0xd4ade1&&sharpUtil[_0x1e4c54(0x21d)](_0x35225c);if(_0x1a19cb)return _0x26dfda[_0x1e4c54(0x1ef)][_0x1e4c54(0x218)][_0x1e4c54(0x1bf)]('UPDATE\x20photo_faces\x20SET\x20face_img_path=\x27'+_0x1a674e+_0x1e4c54(0x1a7)+_0x507872)['run'](),_0x256942[_0x1e4c54(0x186)](_0x1a674e);else _0x256942[_0x1e4c54(0x186)](_0x1a674e),_0x256942['on']('close',()=>{fs['rm'](_0x1a674e,_0x8d574d=>{});});}});}}}}}),router['post'](_0x1fe013(0x24c),(_0x6d0b50,_0x5464d3,_0x48fe28)=>{const _0x280177=_0x1fe013;let _0x2ea852=_0x6d0b50[_0x280177(0x1f3)][_0x280177(0x1af)],_0x5dd197=_0x6d0b50[_0x280177(0x1f3)][_0x280177(0x20e)],_0x3719eb=[];if(!_0x2ea852||!_0x5dd197)return _0x5464d3[_0x280177(0x25b)]({'code':0x0,'sucIdList':_0x3719eb});try{_0x5dd197=JSON[_0x280177(0x283)](_0x5dd197);for(let _0x37296b in _0x5dd197){let _0x5a4233=_0x5dd197[_0x37296b],_0x35c8ec=_0x6d0b50[_0x280177(0x1ef)][_0x280177(0x218)][_0x280177(0x1bf)]('UPDATE\x20photo_faces2index\x20SET\x20face_id=?\x20WHERE\x20face_id=?\x20and\x20photo_index_id=?')[_0x280177(0x263)](parseInt(_0x2ea852),parseInt(_0x5a4233[_0x280177(0x2ef)]),parseInt(_0x5a4233['photo_index_id']));_0x3719eb[_0x280177(0x252)](_0x5a4233[_0x280177(0x225)]);}return _0x5464d3['json']({'code':0x0,'sucIdList':_0x3719eb});}catch(_0x54f678){return console['log'](_0x54f678),_0x5464d3[_0x280177(0x25b)]({'code':0x0,'sucIdList':_0x3719eb});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x28b),(_0x1a0e96,_0x1f6f55,_0x3a89e2)=>{const _0x131655=_0x1fe013;let _0x2f4e96=_0x1a0e96[_0x131655(0x1f3)][_0x131655(0x266)],_0x5d19d8={};if(_0x1a0e96[_0x131655(0x261)][_0x131655(0x2df)]==0x1){if(!_0x2f4e96||_0x2f4e96==_0x131655(0x19a)){let _0x305bc9=_0x1a0e96['app']['dbFileIndex'][_0x131655(0x1bf)](_0x131655(0x20a))[_0x131655(0x2e4)]();_0x5d19d8[_0x131655(0x2ac)]=_0x305bc9[_0x131655(0x185)];if(_0x305bc9['count']<0x1){let _0xd73cd5=_0x1a0e96[_0x131655(0x1ef)][_0x131655(0x218)][_0x131655(0x1bf)](_0x131655(0x219))[_0x131655(0x2e4)]();_0x5d19d8[_0x131655(0x193)]=_0xd73cd5[_0x131655(0x185)];}}if(!_0x2f4e96||_0x2f4e96==_0x131655(0x2a0)){let _0x1b2ff8=_0x1a0e96[_0x131655(0x1ef)]['dbFileIndex']['prepare'](_0x131655(0x23b))[_0x131655(0x2e4)]();_0x5d19d8[_0x131655(0x237)]=_0x1b2ff8[_0x131655(0x185)];}if(!_0x2f4e96||_0x2f4e96==_0x131655(0x26f)){let _0x4cadfa=_0x1a0e96[_0x131655(0x1ef)][_0x131655(0x218)][_0x131655(0x1bf)](_0x131655(0x217))[_0x131655(0x2e4)]();_0x5d19d8[_0x131655(0x297)]=_0x4cadfa[_0x131655(0x185)];}}let _0x3f04b0=dbConfigTable[_0x131655(0x235)](_0x1a0e96['app'][_0x131655(0x1e0)],_0x131655(0x1fa)),_0x3a9cbd=0x0;return!_0x3f04b0?_0x3a9cbd=0x0:_0x3a9cbd=_0x3f04b0[_0x131655(0x2d2)],_0x5d19d8['isIndexing']=_0x3a9cbd,_0x1f6f55[_0x131655(0x25b)]({'code':0x0,'data':_0x5d19d8});}),router[_0x1fe013(0x29b)](_0x1fe013(0x2f0),(_0x217c9b,_0x3d4e77,_0x389fcf)=>{const _0x24362f=_0x1fe013;if(dbUserTable[_0x24362f(0x198)](_0x217c9b,_0x3d4e77,_0x24362f(0x239),_0x24362f(0x2e8))==!![])try{fs['rm'](config[_0x24362f(0x21e)],{'recursive':!![]},_0x5331fc=>{const _0x56cf2b=_0x24362f;if(_0x5331fc)return console[_0x56cf2b(0x260)](_0x5331fc),_0x217c9b[_0x56cf2b(0x1ef)][_0x56cf2b(0x19f)](_0x3d4e77,_0x3d4e77['__'](_0x56cf2b(0x203))+':'+config[_0x56cf2b(0x21e)],_0x56cf2b(0x2af));fs[_0x56cf2b(0x181)](config[_0x56cf2b(0x21e)],_0xd869e0=>{const _0x79ea45=_0x56cf2b;if(_0xd869e0)return _0x217c9b[_0x79ea45(0x1ef)][_0x79ea45(0x19f)](_0x3d4e77,_0x3d4e77['__'](_0x79ea45(0x1c7)),'dialog');let _0x102951=_0x217c9b[_0x79ea45(0x1ef)][_0x79ea45(0x218)][_0x79ea45(0x2ae)](()=>{const _0x31084a=_0x79ea45;return _0x217c9b['app'][_0x31084a(0x218)][_0x31084a(0x1bf)](_0x31084a(0x2b3))[_0x31084a(0x263)](),_0x217c9b[_0x31084a(0x1ef)][_0x31084a(0x218)][_0x31084a(0x1bf)]('delete\x20from\x20photo_faces2index\x20where\x201=1')['run'](),_0x217c9b[_0x31084a(0x1ef)][_0x31084a(0x218)][_0x31084a(0x1bf)](_0x31084a(0x269))[_0x31084a(0x263)](),process[_0x31084a(0x22d)]({'type':'startFaceAiWork'}),_0x3d4e77['json']({'code':0x0});});_0x102951();});});}catch(_0x198925){return _0x217c9b[_0x24362f(0x1ef)][_0x24362f(0x19f)](_0x3d4e77,_0x3d4e77['__'](_0x24362f(0x1c7)),_0x24362f(0x2af));}}),router['post']('/resetSimilarPhotoAi',(_0x17c29c,_0x6c8b71,_0x4995a0)=>{const _0x217536=_0x1fe013;if(dbUserTable[_0x217536(0x198)](_0x17c29c,_0x6c8b71,_0x217536(0x239),_0x217536(0x2e8))==!![])try{let _0x382911=_0x17c29c[_0x217536(0x1ef)][_0x217536(0x218)][_0x217536(0x2ae)](()=>{const _0x4ad73c=_0x217536;return _0x17c29c[_0x4ad73c(0x1ef)][_0x4ad73c(0x218)][_0x4ad73c(0x1bf)](_0x4ad73c(0x199))[_0x4ad73c(0x263)](),_0x17c29c[_0x4ad73c(0x1ef)]['dbFileIndex'][_0x4ad73c(0x1bf)]('update\x20file_index_photo\x20set\x20phash=null,phash_compare=0')[_0x4ad73c(0x263)](),process[_0x4ad73c(0x22d)]({'type':'startSimilarPhotoWork'}),_0x6c8b71[_0x4ad73c(0x25b)]({'code':0x0});});_0x382911();}catch(_0x4aefec){return _0x17c29c[_0x217536(0x1ef)][_0x217536(0x19f)](_0x6c8b71,_0x6c8b71['__'](_0x217536(0x1c7)),_0x217536(0x2af));}}),router[_0x1fe013(0x29b)](_0x1fe013(0x1a8),(_0x2a19f8,_0x3dab56,_0x2372ba)=>{const _0x14406=_0x1fe013;if(dbUserTable['isAdmin'](_0x2a19f8,_0x3dab56)!==!![])return;let _0x1b99d2=dbConfigTable[_0x14406(0x235)](_0x2a19f8[_0x14406(0x1ef)][_0x14406(0x1e0)],'aiSimilarPhotoEnable');if(!_0x1b99d2||_0x1b99d2['value']!='1')return _0x3dab56[_0x14406(0x25b)]({'code':0x0,'data':[],'enable':![]});let _0x7b66a=_0x2a19f8['body'][_0x14406(0x182)];if(!_0x7b66a)_0x7b66a=0x0;let _0x3d083f=_0x2a19f8['body'][_0x14406(0x185)];if(!_0x3d083f||_0x3d083f>0x64)_0x3d083f=0x64;let _0x3aef7c=[],_0x57909f=_0x2a19f8[_0x14406(0x1ef)][_0x14406(0x218)][_0x14406(0x1bf)](_0x14406(0x24f))[_0x14406(0x2ce)](),_0x34fc03=_0x2a19f8['app'][_0x14406(0x218)][_0x14406(0x1bf)](_0x14406(0x2a2)+_0x3d083f)['all']();for(let _0x490e0e in _0x34fc03){let _0x106124=_0x34fc03[_0x490e0e],_0x2eb604=_0x2a19f8[_0x14406(0x1ef)][_0x14406(0x218)][_0x14406(0x1bf)](_0x14406(0x25d)+_0x106124[_0x14406(0x19b)])[_0x14406(0x2e4)](),_0x3392ad=_0x2a19f8[_0x14406(0x1ef)][_0x14406(0x218)]['prepare']('SELECT\x20f.id,f.path,f.filename,f.original_date,f.size\x20FROM\x20photo_phash_similar\x20as\x20a\x20inner\x20join\x20file_index_photo\x20as\x20f\x20on\x20a.similar_index_id=f.id\x20where\x20a.index_id='+_0x106124['index_id'])['all']();_0x34fc03[_0x490e0e][_0x14406(0x2f7)]=_0x2eb604,_0x34fc03[_0x490e0e][_0x14406(0x27d)]=[_0x2eb604],_0x34fc03[_0x490e0e][_0x14406(0x27d)][_0x14406(0x252)](..._0x3392ad),_0x34fc03[_0x490e0e][_0x14406(0x27d)][_0x14406(0x1b7)]>0x1?_0x3aef7c[_0x14406(0x252)](_0x34fc03[_0x490e0e]):_0x2a19f8[_0x14406(0x1ef)]['dbFileIndex'][_0x14406(0x1bf)](_0x14406(0x272))[_0x14406(0x263)](_0x106124[_0x14406(0x19b)]);}return _0x3dab56[_0x14406(0x25b)]({'code':0x0,'data':_0x3aef7c,'enable':!![],'waitDealCount':_0x57909f['length']});}),router[_0x1fe013(0x29b)](_0x1fe013(0x1a4),(_0xcb5753,_0x42ec19,_0x6ab9bb)=>{const _0x2dc408=_0x1fe013;if(dbUserTable[_0x2dc408(0x276)](_0xcb5753,_0x42ec19)!==!![])return;nasAccountUtil[_0x2dc408(0x2d6)](_0x42ec19,_0xcb5753[_0x2dc408(0x1ef)][_0x2dc408(0x1e0)])[_0x2dc408(0x27a)](_0xfd9f18=>{const _0x14048e=_0x2dc408;if(!_0xfd9f18)return;let _0x3b4611=_0xcb5753[_0x14048e(0x1f3)][_0x14048e(0x25a)];for(let _0x5e51b4 in _0x3b4611){let _0x272952=_0xcb5753[_0x14048e(0x1ef)][_0x14048e(0x218)][_0x14048e(0x1bf)](_0x14048e(0x2c2)+_0x3b4611[_0x5e51b4][_0x14048e(0x19b)])[_0x14048e(0x2ce)]();for(let _0x2a41d7 in _0x272952){if(!_0x3b4611[_0x5e51b4][_0x14048e(0x1ba)][_0x14048e(0x24d)](parseInt(_0x272952[_0x2a41d7][_0x14048e(0x207)]))){let _0x2dedf8=new Date()[_0x14048e(0x2c6)]();_0xcb5753[_0x14048e(0x1ef)][_0x14048e(0x218)][_0x14048e(0x1bf)](_0x14048e(0x21c)+dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']+_0x14048e(0x245)+_0x2dedf8+_0x14048e(0x2f2)+_0x272952[_0x2a41d7]['similar_index_id'])['run']();}}if(!_0x3b4611[_0x5e51b4][_0x14048e(0x1ba)][_0x14048e(0x24d)](parseInt(_0x3b4611[_0x5e51b4][_0x14048e(0x19b)]))){let _0x4986a5=new Date()[_0x14048e(0x2c6)]();_0xcb5753[_0x14048e(0x1ef)][_0x14048e(0x218)][_0x14048e(0x1bf)](_0x14048e(0x21c)+dbFileIndexTable['INDEX_TABLE_NAME_PHOTO']+_0x14048e(0x245)+_0x4986a5+'\x20WHERE\x20id\x20=\x20'+_0x3b4611[_0x5e51b4][_0x14048e(0x19b)])[_0x14048e(0x263)]();}_0xcb5753[_0x14048e(0x1ef)][_0x14048e(0x218)][_0x14048e(0x1bf)](_0x14048e(0x1a9)+_0x3b4611[_0x5e51b4]['index_id'])[_0x14048e(0x263)]();}return _0x42ec19[_0x14048e(0x25b)]({'code':0x0});});}),router[_0x1fe013(0x29b)]('/restoreTrashBinFiles',(_0x4270bd,_0x1fc577,_0x259e22)=>{const _0x5c1b07=_0x1fe013;if(dbUserTable[_0x5c1b07(0x198)](_0x4270bd,_0x1fc577,_0x5c1b07(0x239),_0x5c1b07(0x2e8),'')==!![]){let _0xc9328f=_0x4270bd[_0x5c1b07(0x1ef)][_0x5c1b07(0x218)][_0x5c1b07(0x1bf)](_0x5c1b07(0x2f9))[_0x5c1b07(0x2ce)]();for(let _0x50a18c of _0xc9328f){_0x4270bd[_0x5c1b07(0x1ef)][_0x5c1b07(0x218)][_0x5c1b07(0x1bf)]('UPDATE\x20file_index_photo\x20SET\x20is_show=0\x20WHERE\x20path=?\x20AND\x20filename\x20=?')[_0x5c1b07(0x263)](_0x50a18c['path'],_0x50a18c[_0x5c1b07(0x18d)]);}return _0x4270bd[_0x5c1b07(0x1ef)][_0x5c1b07(0x218)][_0x5c1b07(0x1bf)](_0x5c1b07(0x21c)+dbFileIndexTable[_0x5c1b07(0x17e)]+_0x5c1b07(0x1be))[_0x5c1b07(0x263)](),_0x1fc577[_0x5c1b07(0x25b)]({'code':0x0});}}),router[_0x1fe013(0x29b)](_0x1fe013(0x273),(_0x5d3717,_0x55b5d2,_0x4ca27b)=>{const _0x5cac0e=_0x1fe013;let _0xeb850f=_0x5d3717['body'][_0x5cac0e(0x2ea)],_0x3a6e31=dbFileIndexTable[_0x5cac0e(0x1c4)](_0x5d3717[_0x5cac0e(0x1ef)]['dbFileIndex'],_0x5cac0e(0x228),_0x5cac0e(0x18a),dbFileIndexTable[_0x5cac0e(0x17e)]),_0x194fbd=dbFileIndexTable[_0x5cac0e(0x17e)];console[_0x5cac0e(0x260)]('Cleaning\x20out\x20the\x20recycle\x20bin\x20:\x20'+_0x3a6e31['length']);function _0x3293c9(_0x276dbe,_0x151f10){const _0x5baafb=_0x5cac0e;dbFileOperationRecord[_0x5baafb(0x2c9)](_0x5d3717[_0x5baafb(0x1ef)][_0x5baafb(0x1e0)],{'username':_0x5d3717['currentUser']['username'],'targetPath':_0x276dbe,'level':dbFileOperationRecord[_0x5baafb(0x2e7)],'type':dbFileOperationRecord['TYPE_DELETE'],'state':_0x151f10?dbFileOperationRecord[_0x5baafb(0x2a9)]:dbFileOperationRecord[_0x5baafb(0x242)]});}function _0x45dc51(_0x411cc1){const _0xb10336=_0x5cac0e;if(_0x411cc1['is_file']==0x1&&_0x411cc1[_0xb10336(0x256)]==0x1){let _0xf3f817=path[_0xb10336(0x271)](_0x411cc1[_0xb10336(0x28d)],_0x411cc1[_0xb10336(0x195)][_0xb10336(0x183)](_0xb10336(0x2ec),'')+_0xb10336(0x1ee));_0x411cc1[_0xb10336(0x195)][_0xb10336(0x2f1)](_0xb10336(0x299))&&(_0xf3f817=path[_0xb10336(0x271)](_0x411cc1[_0xb10336(0x28d)],_0x411cc1[_0xb10336(0x195)][_0xb10336(0x183)](_0xb10336(0x299),'')+_0xb10336(0x2c7))),fs[_0xb10336(0x240)](_0xf3f817)&&(console['log'](_0xb10336(0x2e5),_0xf3f817),_0xbd37c(_0x411cc1,_0xf3f817,![]));}}function _0xbd37c(_0x99198c,_0x428ddc,_0x554d0d){const _0x2c0b36=_0x5cac0e;_0xeb850f==0x1?(process[_0x2c0b36(0x22d)]({'type':_0x2c0b36(0x2bb),'shellType':_0x2c0b36(0x1aa),'path':_0x428ddc}),_0x3293c9(_0x428ddc,!![])):fs['rm'](_0x428ddc,{'recursive':!![]},_0x4cb792=>{_0x4cb792?_0x3293c9(_0x428ddc,![]):_0x3293c9(_0x428ddc,!![]);}),_0x554d0d&&_0x45dc51(_0x99198c);}function _0x53d03c(_0x27ebbd){const _0x576f72=_0x5cac0e;dbFileIndexTable['delete'](_0x5d3717[_0x576f72(0x1ef)]['dbFileIndex'],_0x27ebbd['id'],_0x194fbd);}for(let _0x49dacb in _0x3a6e31){let _0xa2ed73=_0x3a6e31[_0x49dacb];if(_0xa2ed73){if(dbUserTable[_0x5cac0e(0x198)](_0x5d3717,_0x55b5d2,_0x5cac0e(0x239),_0x5cac0e(0x1cc),_0xa2ed73[_0x5cac0e(0x28d)])==!![]){let _0x5b5daf=path['join'](_0xa2ed73[_0x5cac0e(0x28d)],path['sep'],_0xa2ed73[_0x5cac0e(0x195)]);_0x53d03c(_0xa2ed73),_0xbd37c(_0xa2ed73,_0x5b5daf,!![]);}}}return _0x55b5d2[_0x5cac0e(0x25b)]({'code':0x0});}),router[_0x1fe013(0x29b)](_0x1fe013(0x238),(_0x10f47c,_0x3eac60,_0x39c400)=>{const _0x5d4495=_0x1fe013;let _0x351708=_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x2bd)],_0x4384a2=_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x2f3)],_0x21b269=_0x10f47c[_0x5d4495(0x1f3)]['pathList'],_0x209bcf=_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x25e)],_0x4f8bb3=_0x10f47c[_0x5d4495(0x1f3)]['shareForSubUser'],_0x46892f=_0x10f47c[_0x5d4495(0x1f3)]['operation'];if(_0x46892f==_0x5d4495(0x2a5)){let _0x4bfaf0=_0x10f47c['body'][_0x5d4495(0x29f)]||0x0,_0x53dde8=_0x10f47c['body'][_0x5d4495(0x185)]||0x32,_0x3ef6a2=_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x2d9)]||'',_0x54f7fa=_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x231)]||'create_time',_0x484d7a=_0x10f47c['body'][_0x5d4495(0x1a5)]||_0x5d4495(0x247);if(!['create_time',_0x5d4495(0x2bd)][_0x5d4495(0x24d)](_0x54f7fa))return console['log'](_0x5d4495(0x1e2),_0x54f7fa),[];let _0x5c2946=[],_0x12131f=[],_0x32c52a=_0x5d4495(0x2d3);_0x10f47c['currentUser'][_0x5d4495(0x2df)]==0x1?_0x3ef6a2&&(_0x32c52a+=_0x5d4495(0x2c5),_0x12131f['push']('%'+_0x3ef6a2+'%')):(_0x32c52a=_0x5d4495(0x1e1),_0x3ef6a2&&(_0x32c52a+=_0x5d4495(0x202),_0x12131f[_0x5d4495(0x252)]('%'+_0x3ef6a2+'%')));_0x32c52a+='\x20ORDER\x20BY\x20'+_0x54f7fa+'\x20'+_0x484d7a+_0x5d4495(0x2ab),_0x12131f['push'](_0x53dde8),_0x12131f['push'](_0x4bfaf0),_0x5c2946=_0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x218)][_0x5d4495(0x1bf)](_0x32c52a)[_0x5d4495(0x2ce)](_0x12131f);if(_0x5c2946[_0x5d4495(0x1b7)]<0x1)return _0x3eac60[_0x5d4495(0x25b)]({'code':0x0,'data':[]});for(let _0x230640 in _0x5c2946){let _0x3c99ff=_0x5c2946[_0x230640];try{let _0x586dc7=JSON[_0x5d4495(0x283)](_0x3c99ff[_0x5d4495(0x259)]),_0x2df360=[];for(let _0x324710 of _0x586dc7){let _0x192a78=dbUserTable[_0x5d4495(0x1dd)](_0x10f47c[_0x5d4495(0x1ef)]['dbOther'],_0x324710,_0x5d4495(0x280));_0x2df360[_0x5d4495(0x252)](_0x192a78);}_0x5c2946[_0x230640][_0x5d4495(0x2db)]=_0x2df360;}catch(_0x2ed86a){console[_0x5d4495(0x260)](_0x2ed86a);}_0x10f47c['body'][_0x5d4495(0x185)]=0x4,_0x10f47c[_0x5d4495(0x1f3)]['excludeIds']=[],_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x2b1)]=0x0,_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x262)]=_0x5d4495(0x2d7),_0x10f47c[_0x5d4495(0x1f3)]['sortType']='desc',_0x10f47c['body'][_0x5d4495(0x2aa)]=0x1,_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x1cb)]=0x9184e729fff,_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x1aa)]=0x0,_0x10f47c[_0x5d4495(0x1f3)][_0x5d4495(0x2f3)]=_0x5c2946[_0x230640]['id'],_0x5c2946[_0x230640][_0x5d4495(0x29a)]=photoApiUtil[_0x5d4495(0x281)](_0x10f47c,_0x3eac60);}return _0x3eac60[_0x5d4495(0x25b)]({'code':0x0,'data':_0x5c2946});}else{if(_0x10f47c[_0x5d4495(0x261)][_0x5d4495(0x2df)]!=0x1)return _0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x19f)](_0x3eac60,_0x3eac60['__']('noPermission'));if(_0x46892f==_0x5d4495(0x2d1)||_0x46892f==_0x5d4495(0x1d8)){if(!_0x21b269||!_0x21b269 instanceof Array||_0x21b269[_0x5d4495(0x1b7)]<0x1)return _0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x19f)](_0x3eac60,_0x3eac60['__']('operationFail'));if(_0x4f8bb3){if(_0x209bcf!=null&&!_0x209bcf instanceof Array)return _0x10f47c['app'][_0x5d4495(0x19f)](_0x3eac60,_0x3eac60['__'](_0x5d4495(0x1c7)));}if(sqliteUtil['checkSqlInjection'](JSON[_0x5d4495(0x267)](_0x21b269))==!![])return _0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x19f)](_0x3eac60,'error\x20pathList');}if(_0x46892f==_0x5d4495(0x1d8)&&_0x4384a2)_0x10f47c['app'][_0x5d4495(0x218)][_0x5d4495(0x1bf)](_0x5d4495(0x1b8))[_0x5d4495(0x263)](_0x351708,JSON[_0x5d4495(0x267)](_0x21b269),_0x4f8bb3,JSON[_0x5d4495(0x267)](_0x209bcf),_0x4384a2);else{if(_0x46892f==_0x5d4495(0x1f6)&&_0x4384a2)_0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x218)][_0x5d4495(0x1bf)](_0x5d4495(0x1e9))[_0x5d4495(0x263)](_0x4384a2);else{if(_0x46892f==_0x5d4495(0x2d1))_0x10f47c[_0x5d4495(0x1ef)]['dbFileIndex']['prepare'](_0x5d4495(0x250))[_0x5d4495(0x263)](_0x351708,JSON['stringify'](_0x21b269),_0x4f8bb3,JSON[_0x5d4495(0x267)](_0x209bcf),_0x10f47c[_0x5d4495(0x261)]['id']);else return _0x10f47c[_0x5d4495(0x1ef)][_0x5d4495(0x19f)](_0x3eac60,_0x3eac60['__']('noPermission'));}}return _0x3eac60[_0x5d4495(0x25b)]({'code':0x0});}}),module[_0x1fe013(0x287)]=router;