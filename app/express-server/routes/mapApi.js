const _0x20f20a=_0x36c3;(function(_0x454df0,_0x4530c7){const _0x1cfc85=_0x36c3,_0x1a1d33=_0x454df0();while(!![]){try{const _0x5e6a15=parseInt(_0x1cfc85(0x14e))/0x1+-parseInt(_0x1cfc85(0x14f))/0x2*(-parseInt(_0x1cfc85(0x133))/0x3)+-parseInt(_0x1cfc85(0x13a))/0x4*(parseInt(_0x1cfc85(0x14d))/0x5)+-parseInt(_0x1cfc85(0x137))/0x6+-parseInt(_0x1cfc85(0x12d))/0x7+-parseInt(_0x1cfc85(0x14b))/0x8*(parseInt(_0x1cfc85(0x122))/0x9)+parseInt(_0x1cfc85(0x11f))/0xa*(parseInt(_0x1cfc85(0x147))/0xb);if(_0x5e6a15===_0x4530c7)break;else _0x1a1d33['push'](_0x1a1d33['shift']());}catch(_0x4da16f){_0x1a1d33['push'](_0x1a1d33['shift']());}}}(_0x18be,0x52dc4));var express=require(_0x20f20a(0x144)),router=express[_0x20f20a(0x129)]();function _0x36c3(_0x53a2a7,_0x1d5895){const _0x18bec0=_0x18be();return _0x36c3=function(_0x36c30d,_0x33099e){_0x36c30d=_0x36c30d-0x113;let _0x414a31=_0x18bec0[_0x36c30d];return _0x414a31;},_0x36c3(_0x53a2a7,_0x1d5895);}let path=require(_0x20f20a(0x12e)),fs=require('fs');const dbFileIndexTable=require(_0x20f20a(0x135)),ngeohash=require(_0x20f20a(0x11e));let config=require(_0x20f20a(0x131)),axios=require(_0x20f20a(0x12f)),nasAccountUtil=require(_0x20f20a(0x13e));function getByGeohash(_0x5e18e8,_0x4dcf8b){const _0xb554e4=_0x20f20a;let _0x1e3109=_0x5e18e8['prepare']('SELECT\x20name,cn_name,geohash\x20FROM\x20cities\x20WHERE\x20geohash\x20like\x20?')[_0xb554e4(0x126)]([_0x4dcf8b+'%']);return _0x1e3109;}function getByGeohashNeighbor(_0xb8ff66,_0x4e43ad){const _0x232d48=_0x20f20a;let _0x5b0080=ngeohash['neighbors'](_0x4e43ad),_0x5dd4e8='',_0x2680a7=[];for(let _0x2d9389=0x0;_0x2d9389<_0x5b0080['length'];_0x2d9389++){_0x5dd4e8+='\x20geohash\x20like\x20?',_0x2680a7[_0x232d48(0x12c)](_0x5b0080[_0x2d9389]+'%'),_0x2d9389!=_0x5b0080[_0x232d48(0x142)]-0x1&&(_0x5dd4e8+=_0x232d48(0x154));}let _0x3fe916=_0x232d48(0x143)+_0x5dd4e8;return _0xb8ff66[_0x232d48(0x136)](_0x3fe916)[_0x232d48(0x126)](_0x2680a7);}function _0x18be(){const _0x278c08=['path','axios','zoom','../../myConfig/config','json','87ntKKiQ','createWriteStream','../../db/dbFileIndexTable','prepare','2425572blksTy','end','mapTiles','132808tYPyZW','https://down.nascab.cn/mapTiles/','dirname','catch','../utils/nasAccountUtils','set','/getZoom','dbCity','length','SELECT\x20name,cn_name,geohash\x20FROM\x20cities\x20WHERE\x20','express','dbFileIndex','lng','2563671owhmhn','status','stat','then','68344MFauVM','finish','35EFRYgx','410602FoNjLC','6236ArSTsC','sendFile','query','Content-Type','substring','\x20or\x20','isVip','mkdir','geohash','/tile','stream','post','app','join','GET','lat','exports','ngeohash','30FLqsWV','userDataFolder','dbOther','225qVYdnM','body','encode','data','get','/tile.png','indexId','Router','error','tile.png','push','73920IqjTKR'];_0x18be=function(){return _0x278c08;};return _0x18be();}router[_0x20f20a(0x126)](_0x20f20a(0x116),(_0x28f877,_0xf6317f,_0x8e077b)=>{const _0x293502=_0x20f20a;let _0x28ab9d=_0x28f877[_0x293502(0x151)][_0x293502(0x130)],_0x1c827b=_0x28f877[_0x293502(0x151)]['x'],_0x5cb3d0=_0x28f877[_0x293502(0x151)]['y'];if(!_0x28ab9d||!_0x1c827b||!_0x5cb3d0)return _0xf6317f[_0x293502(0x148)](0x194)[_0x293502(0x138)]();let _0x111941=_0x293502(0x13b)+_0x28ab9d+'/'+_0x1c827b+'/'+_0x5cb3d0+_0x293502(0x127),_0x4d5e83=path[_0x293502(0x11a)](config[_0x293502(0x120)],_0x293502(0x139),_0x28ab9d,_0x1c827b,_0x5cb3d0,_0x293502(0x12b));fs[_0x293502(0x149)](_0x4d5e83,(_0x27587a,_0x146a4d)=>{const _0xd68620=_0x293502;if(_0x27587a)axios({'url':_0x111941,'method':_0xd68620(0x11b),'responseType':_0xd68620(0x117)})[_0xd68620(0x14a)](_0x5ab873=>{const _0x35ab93=_0xd68620;fs[_0x35ab93(0x114)](path[_0x35ab93(0x13c)](_0x4d5e83),{'recursive':!![]},_0x6b3efe=>{const _0x50d6de=_0x35ab93;let _0x24c2c2=fs[_0x50d6de(0x134)](_0x4d5e83);_0x5ab873[_0x50d6de(0x125)]['pipe'](_0x24c2c2),_0x24c2c2['on'](_0x50d6de(0x14c),()=>{const _0x4b128c=_0x50d6de;return _0xf6317f[_0x4b128c(0x150)](_0x4d5e83);}),_0x24c2c2['on'](_0x50d6de(0x12a),()=>{const _0x5455f2=_0x50d6de;return _0xf6317f[_0x5455f2(0x148)](0x194)[_0x5455f2(0x138)]();});});})[_0xd68620(0x13d)](_0x5914d6=>{const _0x594933=_0xd68620;return _0xf6317f['status'](0x194)[_0x594933(0x138)]();});else return _0xf6317f[_0xd68620(0x13f)](_0xd68620(0x152),'image/png'),_0xf6317f['sendFile'](_0x4d5e83);});}),router[_0x20f20a(0x126)](_0x20f20a(0x140),(_0x55e0d6,_0x1a8d0e,_0x64bb2f)=>{const _0x2bd0c9=_0x20f20a;nasAccountUtil[_0x2bd0c9(0x113)](null,_0x55e0d6[_0x2bd0c9(0x119)][_0x2bd0c9(0x121)])['then'](_0x3b21c3=>{const _0x391eac=_0x2bd0c9;return _0x3b21c3?_0x1a8d0e[_0x391eac(0x132)]({'code':0x0,'zoomInfo':{'minZoom':0x2,'maxZoom':0xc}}):_0x1a8d0e[_0x391eac(0x132)]({'code':0x0,'zoomInfo':{'minZoom':0x2,'maxZoom':0x8}});});}),router[_0x20f20a(0x118)](_0x20f20a(0x140),(_0x1dda54,_0x3b1063,_0x12ed1c)=>{const _0x4e8f0f=_0x20f20a;nasAccountUtil[_0x4e8f0f(0x113)](null,_0x1dda54[_0x4e8f0f(0x119)][_0x4e8f0f(0x121)])[_0x4e8f0f(0x14a)](_0x542834=>{const _0x5bfe4e=_0x4e8f0f;return _0x542834?_0x3b1063[_0x5bfe4e(0x132)]({'code':0x0,'zoomInfo':{'minZoom':0x2,'maxZoom':0xc}}):_0x3b1063[_0x5bfe4e(0x132)]({'code':0x0,'zoomInfo':{'minZoom':0x2,'maxZoom':0x8}});});}),router[_0x20f20a(0x118)]('/getLocationStr',(_0x30b6e2,_0x3f69f8,_0x1ee9bc)=>{const _0x3f848f=_0x20f20a;let _0x50ef66=_0x30b6e2[_0x3f848f(0x123)][_0x3f848f(0x11c)],_0x5d5337=_0x30b6e2['body'][_0x3f848f(0x146)],_0x517226=_0x30b6e2[_0x3f848f(0x123)][_0x3f848f(0x128)],_0x478901=dbFileIndexTable['getById'](_0x30b6e2[_0x3f848f(0x119)][_0x3f848f(0x145)],_0x517226);function _0x150473(){const _0x117f51=_0x3f848f;return _0x3f69f8[_0x117f51(0x132)]({'code':0x0,'geo':{'name':'','cn_name':'','geohash':''}});}if(!_0x478901&&!_0x50ef66&&!_0x5d5337)return _0x150473();let _0x123a35=_0x30b6e2[_0x3f848f(0x119)][_0x3f848f(0x141)],_0xdb2da8='';if(_0x478901)_0xdb2da8=_0x478901[_0x3f848f(0x115)];else _0x50ef66&&_0x5d5337&&(_0xdb2da8=ngeohash[_0x3f848f(0x124)](_0x50ef66,_0x5d5337));if(!_0xdb2da8||_0xdb2da8=='undefined')return _0x150473();let _0x2238a6=undefined;for(let _0x5f13c3=0x5;_0x5f13c3>0x0;_0x5f13c3--){_0xdb2da8=_0xdb2da8[_0x3f848f(0x153)](0x0,_0x5f13c3),_0x2238a6=getByGeohash(_0x123a35,_0xdb2da8);!_0x2238a6&&(_0x2238a6=getByGeohashNeighbor(_0x123a35,_0xdb2da8));if(_0x2238a6)break;}return _0x3f69f8[_0x3f848f(0x132)]({'code':0x0,'geo':_0x2238a6});}),module[_0x20f20a(0x11d)]=router;