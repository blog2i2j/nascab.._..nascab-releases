const _0x55cb19=_0x4958;(function(_0x277d7c,_0x4089de){const _0x2f80b0=_0x4958,_0x5d48a1=_0x277d7c();while(!![]){try{const _0x18db42=parseInt(_0x2f80b0(0x277))/0x1+-parseInt(_0x2f80b0(0x170))/0x2*(parseInt(_0x2f80b0(0x1ea))/0x3)+-parseInt(_0x2f80b0(0x1d0))/0x4*(parseInt(_0x2f80b0(0x240))/0x5)+parseInt(_0x2f80b0(0x1a3))/0x6*(parseInt(_0x2f80b0(0x19f))/0x7)+parseInt(_0x2f80b0(0x1c9))/0x8+parseInt(_0x2f80b0(0x1c5))/0x9+-parseInt(_0x2f80b0(0x2a9))/0xa*(parseInt(_0x2f80b0(0x2af))/0xb);if(_0x18db42===_0x4089de)break;else _0x5d48a1['push'](_0x5d48a1['shift']());}catch(_0x47f132){_0x5d48a1['push'](_0x5d48a1['shift']());}}}(_0xbefe,0x36731));var express=require(_0x55cb19(0x26e)),router=express[_0x55cb19(0x189)]();let path=require(_0x55cb19(0x153));const dbFileIndexTable=require('../../db/dbFileIndexTable'),dbUserTable=require(_0x55cb19(0x263));var fs=require('fs');let config=require('../../myConfig/config'),axios=require('axios'),sha256=require(_0x55cb19(0x273)),nasAccountUtil=require(_0x55cb19(0x14c));const dbConfigTable=require(_0x55cb19(0x1e9)),videoStreamUtil=require(_0x55cb19(0x1e3)),dbSourceFolderTable=require(_0x55cb19(0x297)),nfoUtil=require(_0x55cb19(0x251)),dbMovieFavorite=require(_0x55cb19(0x25a)),movieUtil=require(_0x55cb19(0x26a));let fileUtil=require(_0x55cb19(0x15c));const sqliteUtil=require(_0x55cb19(0x20a)),photoApiUtils=require(_0x55cb19(0x280));let movieSeasonUtil=require(_0x55cb19(0x185)),movieInfoUtil=require(_0x55cb19(0x20f));const dbScanTaskTable=require(_0x55cb19(0x1cc));let movieFieldStr=_0x55cb19(0x1be);function getTvSeriesPoster(_0x282178){const _0x530216=_0x55cb19;let _0x3cafb8='',_0x5a94e0=path[_0x530216(0x285)](path[_0x530216(0x243)](_0x282178[_0x530216(0x153)]),_0x530216(0x223));return fs[_0x530216(0x152)](_0x5a94e0)&&(_0x3cafb8=_0x5a94e0),!_0x3cafb8&&(_0x5a94e0=path[_0x530216(0x285)](path[_0x530216(0x243)](_0x282178[_0x530216(0x153)]),_0x530216(0x228)),fs[_0x530216(0x152)](_0x5a94e0)&&(_0x3cafb8=_0x5a94e0)),!_0x3cafb8&&(_0x5a94e0=path['join'](path[_0x530216(0x243)](_0x282178['path']),_0x530216(0x24f)),fs['existsSync'](_0x5a94e0)&&(_0x3cafb8=_0x5a94e0)),!_0x3cafb8&&(_0x5a94e0=path['join'](path[_0x530216(0x243)](_0x282178[_0x530216(0x153)]),'thumb.jpg'),fs[_0x530216(0x152)](_0x5a94e0)&&(_0x3cafb8=_0x5a94e0)),_0x3cafb8;}router[_0x55cb19(0x281)](_0x55cb19(0x29f),(_0x2bf0e8,_0x3e9cd1,_0x19ab9f)=>{const _0x2e4eb2=_0x55cb19;let _0x36754c=_0x2bf0e8[_0x2e4eb2(0x242)]['id'],_0xcebc26=dbFileIndexTable[_0x2e4eb2(0x2a4)](_0x2bf0e8[_0x2e4eb2(0x1d7)][_0x2e4eb2(0x26d)],_0x36754c,dbFileIndexTable[_0x2e4eb2(0x222)]);if(!_0xcebc26)return _0x2bf0e8['app']['returnErrMsg'](_0x3e9cd1,_0x3e9cd1['__'](_0x2e4eb2(0x257)));if(dbUserTable[_0x2e4eb2(0x1c8)](_0x2bf0e8,_0x3e9cd1,'movie',_0x2e4eb2(0x1d6),_0xcebc26[_0x2e4eb2(0x153)])==!![]){let _0x539333=dbUserTable[_0x2e4eb2(0x15e)](_0x2bf0e8,_0x2e4eb2(0x21b),_0x2e4eb2(0x1d6),!![]),_0x29d43b=_0x2e4eb2(0x19a);_0x29d43b+=_0x539333,_0x29d43b+=_0x2e4eb2(0x195),nfoUtil[_0x2e4eb2(0x267)](_0xcebc26)['then'](_0x4f70f1=>{const _0x4988a3=_0x2e4eb2;_0xcebc26=_0x4f70f1,_0x2bf0e8[_0x4988a3(0x242)]['needLogoPathAndFanart']=!![],_0x2bf0e8[_0x4988a3(0x242)]['useTvSeriesInfo']=0x1,_0xcebc26=addFolderCoverPath(_0x3e9cd1,_0x2bf0e8,_0xcebc26),_0x3ce171();})[_0x2e4eb2(0x192)](_0x16bc95=>{const _0x387d58=_0x2e4eb2;console[_0x387d58(0x1f6)](_0x387d58(0x28f),_0x16bc95),_0xcebc26=addFolderCoverPath(_0x3e9cd1,_0x2bf0e8,_0xcebc26),_0xcebc26[_0x387d58(0x1db)]=_0xcebc26['tvFolderName'],_0x3ce171();});function _0x3ce171(){const _0x17f213=_0x2e4eb2;addTvFolderPathAndName(_0xcebc26),setLogoAndFanart(_0x2bf0e8,_0xcebc26,_0xcebc26['tvFolderPath']);let _0x3ac243=dbMovieFavorite[_0x17f213(0x205)](_0x2bf0e8[_0x17f213(0x1d7)][_0x17f213(0x26d)],_0x2bf0e8[_0x17f213(0x20e)]['id'],_0xcebc26['id']);_0x3ac243?_0xcebc26[_0x17f213(0x272)]=0x1:_0xcebc26[_0x17f213(0x272)]=0x0;let _0x22880c={'code':0x0,'movieIndex':_0xcebc26};fs[_0x17f213(0x235)](_0xcebc26[_0x17f213(0x20d)],(_0x24c941,_0x237c4d)=>{const _0x359fb7=_0x17f213;_0x22880c[_0x359fb7(0x177)]=_0x24c941?0x0:0x1,_0x3e9cd1[_0x359fb7(0x2a8)](_0x22880c),_0xcebc26['is_tvplay']==0x1&&_0xcebc26[_0x359fb7(0x20d)]&&(dbScanTaskTable[_0x359fb7(0x22c)](_0x2bf0e8['app'][_0x359fb7(0x290)],_0x359fb7(0x21b),_0xcebc26[_0x359fb7(0x20d)]),process[_0x359fb7(0x28a)]({'type':'startScanPath','source_type':_0x359fb7(0x21b),'restartWatcher':![]}));});}}}),router['post'](_0x55cb19(0x287),(_0x36eaff,_0x2ec749,_0x89b942)=>{const _0x3685e5=_0x55cb19;let _0x4d16e9=_0x36eaff['body']['id'],_0x32d3c7=dbFileIndexTable[_0x3685e5(0x2a4)](_0x36eaff[_0x3685e5(0x1d7)][_0x3685e5(0x26d)],_0x4d16e9,dbFileIndexTable[_0x3685e5(0x222)]);if(!_0x32d3c7)return _0x36eaff[_0x3685e5(0x1d7)]['returnErrMsg'](_0x2ec749,_0x2ec749['__'](_0x3685e5(0x257)));if(dbUserTable[_0x3685e5(0x1c8)](_0x36eaff,_0x2ec749,_0x3685e5(0x21b),_0x3685e5(0x1d6),_0x32d3c7[_0x3685e5(0x153)])==!![]){let _0x1eabfc=dbUserTable[_0x3685e5(0x15e)](_0x36eaff,_0x3685e5(0x21b),'power_get',!![]),_0x135d3a='\x20type=2\x20and\x20is_file=1\x20and\x20id!=?\x20and\x20collection_id=0\x20';_0x135d3a+=_0x1eabfc,_0x135d3a+=_0x3685e5(0x195),nfoUtil['parseNfo'](_0x32d3c7,!![],![])[_0x3685e5(0x1fc)](_0x2e3673=>{const _0x32a938=_0x3685e5;_0x32d3c7=_0x2e3673,_0x36eaff[_0x32a938(0x242)][_0x32a938(0x1e2)]=!![],_0x32d3c7=addFolderCoverPath(_0x2ec749,_0x36eaff,_0x32d3c7),movieInfoUtil[_0x32a938(0x299)](_0x36eaff['app'][_0x32a938(0x26d)],_0x32d3c7['id'],_0x2e3673),_0x536b92();})[_0x3685e5(0x192)](()=>{_0x32d3c7=addFolderCoverPath(_0x2ec749,_0x36eaff,_0x32d3c7),_0x536b92();});function _0x536b92(){const _0x1e5a93=_0x3685e5;let _0x459cd5=dbMovieFavorite[_0x1e5a93(0x205)](_0x36eaff[_0x1e5a93(0x1d7)]['dbFileIndex'],_0x36eaff[_0x1e5a93(0x20e)]['id'],_0x32d3c7['id']);_0x459cd5?_0x32d3c7[_0x1e5a93(0x272)]=0x1:_0x32d3c7[_0x1e5a93(0x272)]=0x0;let _0x41858c=null;if(_0x32d3c7['is_tvplay']==0x1){let _0x3fa36a=_0x36eaff[_0x1e5a93(0x1d7)][_0x1e5a93(0x26d)][_0x1e5a93(0x274)](_0x1e5a93(0x269)+dbFileIndexTable[_0x1e5a93(0x222)]+_0x1e5a93(0x278))[_0x1e5a93(0x2ab)](_0x32d3c7[_0x1e5a93(0x153)]),_0x1d8abb='(';for(let _0x56e7b1 in _0x3fa36a){_0x1d8abb+=_0x3fa36a[_0x56e7b1]['id'],_0x56e7b1!=_0x3fa36a[_0x1e5a93(0x1ca)]-0x1&&(_0x1d8abb+=',');}_0x1d8abb+=')';let _0x8fddba=_0x36eaff[_0x1e5a93(0x1d7)]['dbFileIndex'][_0x1e5a93(0x274)](_0x1e5a93(0x22d)+_0x1d8abb+_0x1e5a93(0x25e))[_0x1e5a93(0x23d)]();_0x8fddba&&(_0x41858c=dbFileIndexTable[_0x1e5a93(0x2a4)](_0x36eaff[_0x1e5a93(0x1d7)]['dbFileIndex'],_0x8fddba['index_id'],dbFileIndexTable[_0x1e5a93(0x222)]));}let _0x499b4e={'code':0x0,'movieIndex':_0x32d3c7,'lastTvEpisodeIndex':_0x41858c},_0x523960=[];try{let _0x39b210=_0x36eaff[_0x1e5a93(0x1d7)][_0x1e5a93(0x26d)][_0x1e5a93(0x274)](_0x1e5a93(0x1ef)+_0x32d3c7[_0x1e5a93(0x153)]+_0x1e5a93(0x1f9))['all']();for(let _0x4abe72 in _0x39b210){let _0x4e19bf=path[_0x1e5a93(0x285)](_0x39b210[_0x4abe72][_0x1e5a93(0x153)],_0x39b210[_0x4abe72][_0x1e5a93(0x2ac)]);(_0x36eaff[_0x1e5a93(0x20e)][_0x1e5a93(0x21d)]==0x1||dbUserTable['doUserCanGet'](_0x36eaff,_0x2ec749,_0x1e5a93(0x1d9),_0x1e5a93(0x1d6),_0x4e19bf,!![])==!![])&&_0x523960['push'](_0x4e19bf);}_0x499b4e[_0x1e5a93(0x1ce)]=_0x523960;}catch(_0x5ddf96){}let _0x31f74f=path[_0x1e5a93(0x285)](_0x32d3c7[_0x1e5a93(0x153)],_0x32d3c7['filename']);fs[_0x1e5a93(0x235)](_0x31f74f,(_0x170d95,_0x2bfdaf)=>{const _0x4b37fe=_0x1e5a93;_0x499b4e['fileExist']=_0x170d95?0x0:0x1,_0x499b4e[_0x4b37fe(0x2a7)]=_0x31f74f,_0x2ec749[_0x4b37fe(0x2a8)](_0x499b4e),_0x32d3c7['is_tvplay']==0x1&&_0x32d3c7[_0x4b37fe(0x20d)]&&_0x32d3c7['isTvSeries']!=0x1&&(dbScanTaskTable[_0x4b37fe(0x22c)](_0x36eaff[_0x4b37fe(0x1d7)][_0x4b37fe(0x290)],_0x4b37fe(0x21b),_0x32d3c7['tvFolderPath']),process[_0x4b37fe(0x28a)]({'type':_0x4b37fe(0x161),'source_type':_0x4b37fe(0x21b),'restartWatcher':![]}));});}}}),router['post'](_0x55cb19(0x1fa),(_0x121a54,_0x14805c,_0x52d6bb)=>{const _0x34d96b=_0x55cb19;let _0x26bf0a=_0x121a54[_0x34d96b(0x242)]['id'],_0x3bd43a=_0x121a54[_0x34d96b(0x242)][_0x34d96b(0x1c0)]||0x0,_0x1c9282=_0x121a54[_0x34d96b(0x242)][_0x34d96b(0x174)]||0xa,_0x290a7c=_0x121a54[_0x34d96b(0x242)][_0x34d96b(0x29a)],_0xabc500=_0x121a54[_0x34d96b(0x242)][_0x34d96b(0x159)],_0x5bf5c1=_0x121a54[_0x34d96b(0x242)]['ignoreTvList'],_0x2f830d=_0x121a54[_0x34d96b(0x242)][_0x34d96b(0x203)],_0x23cb86=dbFileIndexTable[_0x34d96b(0x2a4)](_0x121a54[_0x34d96b(0x1d7)][_0x34d96b(0x26d)],_0x26bf0a,dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);if(!_0x23cb86)return _0x121a54[_0x34d96b(0x1d7)][_0x34d96b(0x1da)](_0x14805c,_0x14805c['__'](_0x34d96b(0x257)));let _0x68f555=movieFieldStr,_0x40026d=[],_0x41ad61=0x0;if(dbUserTable[_0x34d96b(0x1c8)](_0x121a54,_0x14805c,'movie','power_get',_0x23cb86[_0x34d96b(0x153)])==!![]){if(_0x5bf5c1==0x1)return _0x5e3ae3();let _0x3a8adc=_0x121a54[_0x34d96b(0x1d7)][_0x34d96b(0x26d)]['prepare']('SELECT\x20id,filename\x20FROM\x20'+dbFileIndexTable[_0x34d96b(0x222)]+_0x34d96b(0x1c1))[_0x34d96b(0x2ab)](_0x23cb86[_0x34d96b(0x153)]);for(let _0x29080f in _0x3a8adc){let _0x7f16f7=_0x3a8adc[_0x29080f];if(_0x7f16f7['filename']){let _0x48dfa5=movieUtil[_0x34d96b(0x217)](_0x7f16f7[_0x34d96b(0x2ac)]);_0x121a54[_0x34d96b(0x1d7)]['dbFileIndex'][_0x34d96b(0x274)](_0x34d96b(0x1ad)+dbFileIndexTable[_0x34d96b(0x222)]+_0x34d96b(0x249))[_0x34d96b(0x1f0)](_0x48dfa5,_0x7f16f7['id']);}}let _0x50d71d=dbUserTable[_0x34d96b(0x15e)](_0x121a54,_0x34d96b(0x21b),'power_get',!![]),_0x5e93b9='\x20type=2\x20and\x20is_file=1';_0x5e93b9+=_0x50d71d,_0x5e93b9+=_0x34d96b(0x1b4);_0x290a7c&&(_0x5e93b9+=_0x34d96b(0x221));if(_0xabc500){let _0x3a6802=movieUtil[_0x34d96b(0x217)](_0xabc500);_0x3a6802?_0x5e93b9+='\x20and\x20filename_number\x20>=\x20?\x20':_0x5e93b9+=_0x34d96b(0x1de);}let _0x45c985=_0x5e93b9;_0x5e93b9+=_0x34d96b(0x1f2);let _0x19b7ce=_0x34d96b(0x29e)+_0x68f555+_0x34d96b(0x178)+dbFileIndexTable[_0x34d96b(0x222)]+_0x34d96b(0x220)+_0x5e93b9+_0x34d96b(0x226)+_0x1c9282+_0x34d96b(0x20b)+_0x3bd43a*_0x1c9282;_0x40026d=_0x121a54[_0x34d96b(0x1d7)][_0x34d96b(0x26d)][_0x34d96b(0x274)](_0x19b7ce);if(_0x290a7c&&_0xabc500)_0x40026d=_0x40026d['all'](_0x23cb86['path'],'%'+_0x290a7c+'%','%'+_0x290a7c+'%');else{if(_0x290a7c)_0x40026d=_0x40026d[_0x34d96b(0x2ab)](_0x23cb86[_0x34d96b(0x153)],'%'+_0x290a7c+'%','%'+_0x290a7c+'%');else{if(_0xabc500){let _0x173b30=movieUtil[_0x34d96b(0x217)](_0xabc500);_0x40026d=_0x40026d[_0x34d96b(0x2ab)](_0x23cb86[_0x34d96b(0x153)],_0x173b30?_0x173b30:_0xabc500);}else _0x40026d=_0x40026d[_0x34d96b(0x2ab)](_0x23cb86[_0x34d96b(0x153)]);}}let _0x526ca5='SELECT\x20count(*)\x20as\x20count\x20FROM\x20'+dbFileIndexTable[_0x34d96b(0x222)]+_0x34d96b(0x1ff)+_0x45c985+'\x20',_0x7ec10c=_0x121a54['app'][_0x34d96b(0x26d)]['prepare'](_0x526ca5);if(_0x290a7c&&_0xabc500)_0x7ec10c=_0x7ec10c[_0x34d96b(0x23d)](_0x23cb86['path'],'%'+_0x290a7c+'%','%'+_0x290a7c+'%');else{if(_0x290a7c)_0x7ec10c=_0x7ec10c[_0x34d96b(0x23d)](_0x23cb86[_0x34d96b(0x153)],'%'+_0x290a7c+'%','%'+_0x290a7c+'%');else _0xabc500?_0x7ec10c=_0x7ec10c[_0x34d96b(0x23d)](_0x23cb86[_0x34d96b(0x153)],_0xabc500):_0x7ec10c=_0x7ec10c[_0x34d96b(0x23d)](_0x23cb86[_0x34d96b(0x153)]);}_0x41ad61=_0x7ec10c['count'];if(_0x40026d[_0x34d96b(0x1ca)]>0x0){let _0x34aa8b=0x0;for(let _0x77f79b in _0x40026d){let _0x538eb0=_0x40026d[_0x77f79b];nfoUtil[_0x34d96b(0x200)](_0x538eb0,!![],!![])[_0x34d96b(0x1fc)](_0x4661b0=>{const _0x2e5e20=_0x34d96b;_0x34aa8b+=0x1,_0x40026d[_0x77f79b]=_0x4661b0,_0x40026d[_0x77f79b]=addFolderCoverPath(_0x14805c,_0x121a54,_0x40026d[_0x77f79b],!![]),_0x34aa8b>=_0x40026d[_0x2e5e20(0x1ca)]&&_0x5e3ae3();})[_0x34d96b(0x192)](()=>{const _0x162af3=_0x34d96b;_0x34aa8b+=0x1,_0x40026d[_0x77f79b]=addFolderCoverPath(_0x14805c,_0x121a54,_0x40026d[_0x77f79b],!![]),_0x34aa8b>=_0x40026d[_0x162af3(0x1ca)]&&_0x5e3ae3();});}}else _0x5e3ae3();function _0x5e3ae3(){const _0x52a721=_0x34d96b;let _0x283f9b={'code':0x0,'tvplayList':_0x40026d,'count':_0x41ad61,'pageSize':_0x1c9282};if(!_0x2f830d){let _0xd4b6ef=path[_0x52a721(0x186)](_0x23cb86[_0x52a721(0x153)]),_0x27e097=movieSeasonUtil['getSeasonNumber'](_0xd4b6ef);if(_0x27e097>-0x1){let _0x1ddc4d=_0x52a721(0x29e)+_0x68f555+_0x52a721(0x178)+dbFileIndexTable[_0x52a721(0x222)]+_0x52a721(0x1a5),_0x7f53d6=_0x121a54[_0x52a721(0x1d7)]['dbFileIndex']['prepare'](_0x1ddc4d)['all'](path[_0x52a721(0x243)](_0x23cb86[_0x52a721(0x153)])+path['sep']+'%'),_0x258727=[];for(let _0x4322f5 of _0x7f53d6){let _0x2a888e=path[_0x52a721(0x186)](_0x4322f5['path']),_0x545878=movieSeasonUtil[_0x52a721(0x154)](_0x2a888e);_0x545878>-0x1&&(_0x4322f5['seasonNumber']=_0x545878,_0x258727[_0x52a721(0x1f5)](_0x4322f5));}for(let _0x3e7b5d of _0x258727){_0x3e7b5d=addFolderCoverPath(_0x14805c,_0x121a54,_0x3e7b5d);let _0x2369a6=dbFileIndexTable[_0x52a721(0x16c)](_0x121a54['app'][_0x52a721(0x26d)],_0x3e7b5d);_0x3e7b5d['tvCount']=_0x2369a6['count'];}_0x258727['length']>0x0&&(_0x258727[_0x52a721(0x270)](function(_0x165bc1,_0x5b8655){const _0x4a29b0=_0x52a721;return _0x165bc1[_0x4a29b0(0x1ba)]-_0x5b8655['seasonNumber'];}),_0x283f9b[_0x52a721(0x187)]=_0x258727);}}return _0x14805c[_0x52a721(0x2a8)](_0x283f9b);}}}),router[_0x55cb19(0x281)](_0x55cb19(0x1a4),(_0x5d346e,_0x22de93,_0x46bbe0)=>{const _0x3ec51f=_0x55cb19;let _0x300d8b=_0x5d346e[_0x3ec51f(0x242)][_0x3ec51f(0x1e5)],_0x71285f=[];for(let _0x43ec28 of _0x300d8b){let _0x4cbdd5=dbFileIndexTable[_0x3ec51f(0x2a4)](_0x5d346e[_0x3ec51f(0x1d7)][_0x3ec51f(0x26d)],_0x43ec28,dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);if(!_0x4cbdd5)continue;if(dbUserTable[_0x3ec51f(0x1c8)](_0x5d346e,_0x22de93,'',_0x3ec51f(0x265),_0x4cbdd5['path'])!==!![])continue;let _0x1fc9dd=path[_0x3ec51f(0x186)](_0x4cbdd5[_0x3ec51f(0x153)]),_0x55a17c=movieSeasonUtil[_0x3ec51f(0x154)](_0x1fc9dd);if(_0x55a17c>-0x1){let _0x10f549=path['join'](path[_0x3ec51f(0x243)](_0x4cbdd5['path'])),_0xd1a6e6=_0x5d346e[_0x3ec51f(0x1d7)]['dbFileIndex'][_0x3ec51f(0x274)](_0x3ec51f(0x1d5))[_0x3ec51f(0x2ab)](_0x10f549+path[_0x3ec51f(0x184)]+'%',_0x10f549);for(let _0x362763 of _0xd1a6e6){_0x71285f[_0x3ec51f(0x1f5)](_0x362763['id']);}}}_0x71285f[_0x3ec51f(0x1ca)]>0x0&&(_0x300d8b=[..._0x300d8b,..._0x71285f]);if(_0x300d8b[_0x3ec51f(0x1ca)]<0x1)return _0x22de93[_0x3ec51f(0x2a8)]({'code':0x0});let _0x4e9a6c='(';for(let _0x108247 in _0x300d8b){_0x4e9a6c+=_0x300d8b[_0x108247],_0x108247!=_0x300d8b[_0x3ec51f(0x1ca)]-0x1&&(_0x4e9a6c+=',');}return _0x4e9a6c+=')',_0x5d346e[_0x3ec51f(0x1d7)][_0x3ec51f(0x26d)][_0x3ec51f(0x274)](_0x3ec51f(0x1b6)+_0x4e9a6c)['run'](),_0x22de93[_0x3ec51f(0x2a8)]({'code':0x0});}),router[_0x55cb19(0x281)](_0x55cb19(0x2a6),(_0xb2a053,_0x15faf4,_0x475349)=>{const _0x30543e=_0x55cb19;let _0x51f74c=_0xb2a053[_0x30543e(0x242)][_0x30543e(0x25f)],_0x4958f5=_0xb2a053[_0x30543e(0x242)][_0x30543e(0x1b0)],_0x439fb2=_0xb2a053[_0x30543e(0x242)]['filepath'];function _0x50ea77(_0x386b99){const _0xcd573f=_0x30543e;let _0x2cbde6=[];for(let _0x33a99a in _0x386b99){_0x2cbde6[_0xcd573f(0x1f5)](_0x386b99[_0x33a99a]['id']);}inSql='(';for(let _0x2bc34a in _0x2cbde6){inSql+=_0x2cbde6[_0x2bc34a],_0x2bc34a!=_0x2cbde6['length']-0x1&&(inSql+=',');}return inSql+=')',inSql;}if(_0x51f74c&&_0x4958f5){let _0x36d8bc=dbFileIndexTable[_0x30543e(0x2a4)](_0xb2a053[_0x30543e(0x1d7)]['dbFileIndex'],_0x4958f5,dbFileIndexTable[_0x30543e(0x222)]),_0xaa7221='('+_0x4958f5+')';if(!_0x36d8bc)return _0xb2a053[_0x30543e(0x1d7)][_0x30543e(0x1da)](_0x15faf4,_0x15faf4['__']('operationFail'),_0x30543e(0x294));if(dbUserTable[_0x30543e(0x1c8)](_0xb2a053,_0x15faf4,'',_0x30543e(0x265),_0x36d8bc['path'])!==!![])return;let _0x2ebe9a=path[_0x30543e(0x186)](_0x36d8bc[_0x30543e(0x153)]),_0x1088a2=movieSeasonUtil[_0x30543e(0x154)](_0x2ebe9a);_0x1088a2>-0x1&&(_0x36d8bc[_0x30543e(0x196)]=0x0,_0x36d8bc['path']=path['dirname'](_0x36d8bc[_0x30543e(0x153)]),_0x36d8bc[_0x30543e(0x2ac)]='');if(_0x36d8bc[_0x30543e(0x196)]!=0x1){let _0x5a19b7=path[_0x30543e(0x285)](_0x36d8bc[_0x30543e(0x153)],_0x36d8bc['filename']);console['log'](_0x30543e(0x27a),_0x5a19b7);let _0x527544=_0xb2a053['app'][_0x30543e(0x26d)][_0x30543e(0x274)]('select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2')[_0x30543e(0x2ab)](_0x5a19b7+path['sep']+'%',_0x5a19b7);if(_0x527544[_0x30543e(0x1ca)]<0x1)return _0x15faf4['json']({'code':0x0});_0xaa7221=_0x50ea77(_0x527544);}return _0xb2a053['app'][_0x30543e(0x26d)][_0x30543e(0x274)](_0x30543e(0x253)+_0xaa7221+_0x30543e(0x1ab))[_0x30543e(0x1f0)](_0x51f74c),_0x15faf4['json']({'code':0x0});}else{if(_0x51f74c&&_0x439fb2){let _0x5c655e=_0xb2a053[_0x30543e(0x1d7)][_0x30543e(0x26d)][_0x30543e(0x274)](_0x30543e(0x1d5))['all'](_0x439fb2+path['sep']+'%',_0x439fb2),_0x2096eb=_0x50ea77(_0x5c655e);return _0xb2a053[_0x30543e(0x1d7)][_0x30543e(0x26d)][_0x30543e(0x274)](_0x30543e(0x253)+_0x2096eb+_0x30543e(0x1ab))['run'](_0x51f74c),_0x15faf4[_0x30543e(0x2a8)]({'code':0x0});}else return _0xb2a053[_0x30543e(0x1d7)]['returnErrMsg'](_0x15faf4,_0x15faf4['__'](_0x30543e(0x259)),_0x30543e(0x294));}});function getCollectionList(_0x32d379,_0x575484,_0x3203b9){const _0x13856c=_0x55cb19;let _0x4393f2=[],_0x1f6f54=_0x32d379['body'][_0x13856c(0x1dd)]||0x32,_0xa3aa8b=_0x32d379[_0x13856c(0x242)][_0x13856c(0x1f4)]||0x0,_0x23fecf=_0x32d379[_0x13856c(0x242)][_0x13856c(0x1e4)]||'id',_0x3b67ed=_0x32d379[_0x13856c(0x242)]['orderType']||_0x13856c(0x288),_0x29ad9c=_0x32d379['body']['search'],_0x5b8be6=_0x13856c(0x27f),_0x47f984=_0x13856c(0x180)+_0x5b8be6+_0x13856c(0x1b9),_0x1a8f40=[_0x3203b9];_0x29ad9c&&(_0x47f984+=_0x13856c(0x17e),_0x1a8f40[_0x13856c(0x1f5)]('%'+_0x29ad9c+'%'));_0x32d379['currentUser'][_0x13856c(0x21d)]!=0x1&&(_0x47f984+=_0x13856c(0x22f),_0x1a8f40[_0x13856c(0x1f5)](0x1));_0x47f984+=_0x13856c(0x1ee)+_0x23fecf+'\x20'+_0x3b67ed+_0x13856c(0x29d),_0x1a8f40[_0x13856c(0x1f5)](_0x1f6f54),_0x1a8f40[_0x13856c(0x1f5)](_0xa3aa8b),_0x4393f2=_0x32d379[_0x13856c(0x1d7)][_0x13856c(0x26d)][_0x13856c(0x274)](_0x47f984)[_0x13856c(0x2ab)](_0x1a8f40);for(let _0x20015a of _0x4393f2){if(_0x20015a[_0x13856c(0x1d2)]==0x1)continue;let _0x26c7af=getMoviesByParams(_0x575484,_0x32d379,null,'id',0x1,0x0,_0x13856c(0x288),null,null,null,null,null,null,_0x20015a['id']);_0x26c7af['length']>0x0&&(_0x20015a[_0x13856c(0x19c)]=_0x26c7af[0x0]);}return _0x4393f2;}router[_0x55cb19(0x281)]('/getCollection',(_0x1d9734,_0x53e3a3,_0x406068)=>{const _0x49a4d2=_0x55cb19;let _0x2574ae=_0x1d9734[_0x49a4d2(0x242)][_0x49a4d2(0x27d)]||_0x49a4d2(0x179),_0x39b79b=getCollectionList(_0x1d9734,_0x53e3a3,_0x2574ae);return _0x53e3a3[_0x49a4d2(0x2a8)]({'code':0x0,'data':_0x39b79b});}),router[_0x55cb19(0x281)]('/checkCollectionPwd',(_0x4c256c,_0x5a2e49,_0x4e895f)=>{const _0x11ef42=_0x55cb19;let _0x47c663=_0x4c256c[_0x11ef42(0x242)][_0x11ef42(0x1eb)],_0x71b8c2=_0x4c256c['body'][_0x11ef42(0x25f)];if(!_0x47c663)return _0x4c256c[_0x11ef42(0x1d7)][_0x11ef42(0x1da)](_0x5a2e49,_0x5a2e49['__'](_0x11ef42(0x167)),_0x11ef42(0x294));_0x47c663=sha256(_0x47c663);let _0xe5de4a=_0x4c256c[_0x11ef42(0x1d7)]['dbFileIndex'][_0x11ef42(0x274)](_0x11ef42(0x244))[_0x11ef42(0x23d)](_0x71b8c2,_0x47c663);if(!_0xe5de4a)return _0x4c256c['app'][_0x11ef42(0x1da)](_0x5a2e49,_0x5a2e49['__']('login.pwdErr'),_0x11ef42(0x294));return _0x5a2e49['json']({'code':0x0,'data':_0xe5de4a});}),router[_0x55cb19(0x281)](_0x55cb19(0x183),(_0x5d4e9d,_0x1ea9d3,_0x5971b6)=>{const _0x3bc2b0=_0x55cb19;let _0x59ed7b=_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x1e7)],_0x250de1=_0x5d4e9d['body'][_0x3bc2b0(0x230)],_0x293ca2=_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x1eb)],_0x51f52c=_0x5d4e9d['body'][_0x3bc2b0(0x25f)],_0x704bb7=_0x5d4e9d['body'][_0x3bc2b0(0x27d)]?_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x27d)]:_0x3bc2b0(0x179),_0x4ea5d7=_0x5d4e9d['body'][_0x3bc2b0(0x191)]?_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x191)]:'',_0x2e9c1b=_0x5d4e9d['body'][_0x3bc2b0(0x29b)]?_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x29b)]:'',_0x31d900=_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x158)];_0x31d900==null&&(_0x31d900=0x1);if(_0x704bb7==_0x3bc2b0(0x264)){if(!_0x4ea5d7||!_0x4ea5d7[_0x3bc2b0(0x27e)]||sqliteUtil[_0x3bc2b0(0x1cf)](_0x4ea5d7[_0x3bc2b0(0x27e)])==!![])return _0x5d4e9d[_0x3bc2b0(0x1d7)]['returnErrMsg'](_0x1ea9d3,_0x3bc2b0(0x1bf));}let _0x1667c9=_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x1dc)]?_0x5d4e9d[_0x3bc2b0(0x242)][_0x3bc2b0(0x1dc)]:'';if(_0x5d4e9d[_0x3bc2b0(0x20e)][_0x3bc2b0(0x21d)]!=0x1)return _0x5d4e9d['app'][_0x3bc2b0(0x1da)](_0x1ea9d3,_0x1ea9d3['__'](_0x3bc2b0(0x2a3)));if(_0x250de1=='1'){if(!_0x293ca2)return _0x5d4e9d['app'][_0x3bc2b0(0x1da)](_0x1ea9d3,_0x1ea9d3['__'](_0x3bc2b0(0x167)),_0x3bc2b0(0x294));_0x293ca2=sha256(_0x293ca2);}return _0x51f52c?_0x5d4e9d['app'][_0x3bc2b0(0x26d)]['prepare'](_0x3bc2b0(0x1d3))['run'](_0x59ed7b,JSON['stringify'](_0x4ea5d7),_0x250de1+'',_0x293ca2,_0x2e9c1b,_0x1667c9,_0x31d900,_0x51f52c):_0x5d4e9d[_0x3bc2b0(0x1d7)]['dbFileIndex'][_0x3bc2b0(0x274)](_0x3bc2b0(0x25c))[_0x3bc2b0(0x1f0)](_0x59ed7b,_0x250de1+'',_0x293ca2,_0x5d4e9d[_0x3bc2b0(0x20e)]['id']+'',_0x704bb7,JSON['stringify'](_0x4ea5d7),_0x2e9c1b,_0x1667c9,_0x31d900),_0x1ea9d3['json']({'code':0x0});}),router['post'](_0x55cb19(0x1ac),(_0x4e65da,_0x23fbc7,_0x4b59ba)=>{const _0x5a82e0=_0x55cb19;let _0x3b9030=_0x4e65da['body'][_0x5a82e0(0x25f)];if(_0x4e65da[_0x5a82e0(0x20e)]['is_admin']!=0x1)return _0x4e65da['app'][_0x5a82e0(0x1da)](_0x23fbc7,_0x23fbc7['__'](_0x5a82e0(0x2a3)));return _0x4e65da[_0x5a82e0(0x1d7)][_0x5a82e0(0x26d)][_0x5a82e0(0x274)](_0x5a82e0(0x216))[_0x5a82e0(0x1f0)](_0x3b9030),_0x4e65da[_0x5a82e0(0x1d7)][_0x5a82e0(0x26d)][_0x5a82e0(0x274)](_0x5a82e0(0x171))[_0x5a82e0(0x1f0)](_0x3b9030),_0x23fbc7[_0x5a82e0(0x2a8)]({'code':0x0});}),router[_0x55cb19(0x281)](_0x55cb19(0x201),(_0x1f0ec0,_0x10a25d,_0x1606aa)=>{const _0x1db6e9=_0x55cb19;return _0x1f0ec0['app'][_0x1db6e9(0x26d)][_0x1db6e9(0x274)](_0x1db6e9(0x18b)+_0x1f0ec0[_0x1db6e9(0x20e)]['id'])[_0x1db6e9(0x1f0)](),_0x10a25d['json']({'code':0x0});}),router[_0x55cb19(0x281)](_0x55cb19(0x14e),(_0x31a9a5,_0x38b6d4,_0x2cb625)=>{const _0x2c89c5=_0x55cb19;let _0x28e5a6=_0x31a9a5[_0x2c89c5(0x242)][_0x2c89c5(0x1b0)],_0x55be4a=_0x31a9a5[_0x2c89c5(0x242)][_0x2c89c5(0x24c)],_0x5a20d4=dbFileIndexTable[_0x2c89c5(0x2a4)](_0x31a9a5['app'][_0x2c89c5(0x26d)],_0x28e5a6,dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);if(!_0x5a20d4)return _0x38b6d4[_0x2c89c5(0x2a8)]({'code':0x0});if(_0x5a20d4[_0x2c89c5(0x202)]){let _0x4e9514=_0x31a9a5[_0x2c89c5(0x1d7)][_0x2c89c5(0x26d)]['prepare'](_0x2c89c5(0x15d))[_0x2c89c5(0x23d)](_0x5a20d4[_0x2c89c5(0x202)]);if(_0x4e9514&&_0x4e9514[_0x2c89c5(0x1d2)]==0x1)return _0x38b6d4[_0x2c89c5(0x2a8)]({'code':0x0});}let _0x22d744=_0x31a9a5['app'][_0x2c89c5(0x26d)][_0x2c89c5(0x274)]('SELECT\x20*\x20from\x20movie_history\x20WHERE\x20index_id=?\x20and\x20user_id=?')[_0x2c89c5(0x23d)](_0x28e5a6+'',_0x31a9a5['currentUser']['id']+'');return _0x22d744?_0x31a9a5['app'][_0x2c89c5(0x26d)][_0x2c89c5(0x274)](_0x2c89c5(0x1c2))[_0x2c89c5(0x1f0)](_0x55be4a,new Date()[_0x2c89c5(0x258)](),_0x28e5a6+'',_0x31a9a5[_0x2c89c5(0x20e)]['id']+''):_0x31a9a5[_0x2c89c5(0x1d7)][_0x2c89c5(0x26d)]['prepare'](_0x2c89c5(0x26b))[_0x2c89c5(0x1f0)](_0x28e5a6+'',_0x31a9a5[_0x2c89c5(0x20e)]['id']+'',_0x55be4a,new Date()[_0x2c89c5(0x258)]()),_0x38b6d4[_0x2c89c5(0x2a8)]({'code':0x0});}),router[_0x55cb19(0x281)](_0x55cb19(0x25d),(_0x46d656,_0x12b3bd,_0x4deac0)=>{const _0x4c82b4=_0x55cb19;let _0x538ae9=_0x46d656['body'][_0x4c82b4(0x1b0)],_0x493978=_0x4c82b4(0x232);if(_0x538ae9){let _0x30693f=_0x46d656[_0x4c82b4(0x1d7)][_0x4c82b4(0x26d)][_0x4c82b4(0x274)](_0x4c82b4(0x28b))[_0x4c82b4(0x23d)](_0x46d656[_0x4c82b4(0x20e)]['id']+'',_0x538ae9+'');return _0x12b3bd[_0x4c82b4(0x2a8)]({'code':0x0,'data':_0x30693f});}else{let _0x24c04c='SELECT\x20'+_0x493978+'\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id='+_0x46d656[_0x4c82b4(0x20e)]['id']+_0x4c82b4(0x284),_0x17cc1b=_0x46d656[_0x4c82b4(0x1d7)][_0x4c82b4(0x26d)][_0x4c82b4(0x274)](_0x24c04c)[_0x4c82b4(0x2ab)]();return _0x12b3bd[_0x4c82b4(0x2a8)]({'code':0x0,'data':_0x17cc1b});}}),router[_0x55cb19(0x281)](_0x55cb19(0x28e),(_0x3a7f0e,_0x409f18,_0x5c6289)=>{const _0x2844bb=_0x55cb19;let _0x3851cc=_0x3a7f0e[_0x2844bb(0x242)]['id'],_0x13eb13=dbFileIndexTable['getById'](_0x3a7f0e[_0x2844bb(0x1d7)]['dbFileIndex'],_0x3851cc,dbFileIndexTable[_0x2844bb(0x222)]);if(dbUserTable[_0x2844bb(0x1c8)](_0x3a7f0e,_0x409f18,_0x2844bb(0x21b),'power_get',_0x13eb13[_0x2844bb(0x153)])==!![]){let _0x3c6afc={'code':0x0,'data':_0x13eb13};return _0x409f18[_0x2844bb(0x2a8)](_0x3c6afc);}}),router['post']('/switchMatchInfo',(_0x5b803e,_0x3783cd,_0xc7ba1)=>{const _0x5b22ff=_0x55cb19;let _0x26a1f0=_0x5b803e['body'][_0x5b22ff(0x157)],_0x356eb3=_0x5b803e[_0x5b22ff(0x242)][_0x5b22ff(0x1b3)];if(dbUserTable[_0x5b22ff(0x23b)](_0x5b803e,_0x3783cd)===!![]){let _0x9fe787=dbSourceFolderTable[_0x5b22ff(0x2a4)](_0x5b803e[_0x5b22ff(0x1d7)][_0x5b22ff(0x290)],_0x26a1f0);if(!_0x9fe787)return _0x3783cd[_0x5b22ff(0x15f)](0x194)[_0x5b22ff(0x256)]();return _0x356eb3==0x1?(_0x5b803e['app'][_0x5b22ff(0x26d)]['prepare'](_0x5b22ff(0x26c))[_0x5b22ff(0x1f0)](_0x9fe787[_0x5b22ff(0x153)]+path[_0x5b22ff(0x184)]+'%',_0x9fe787[_0x5b22ff(0x153)]),dbSourceFolderTable[_0x5b22ff(0x28c)](_0x5b803e['app'][_0x5b22ff(0x290)],_0x5b22ff(0x17d),_0x356eb3,_0x26a1f0),process['send']({'type':_0x5b22ff(0x164)}),_0x3783cd[_0x5b22ff(0x2a8)]({'code':0x0})):(dbSourceFolderTable['updateByWhere'](_0x5b803e[_0x5b22ff(0x1d7)]['dbOther'],'ignore_match_info',_0x356eb3,_0x26a1f0),_0x5b803e[_0x5b22ff(0x1d7)]['dbFileIndex'][_0x5b22ff(0x274)](_0x5b22ff(0x1a1))[_0x5b22ff(0x1f0)](_0x9fe787[_0x5b22ff(0x153)]+path['sep']+'%',_0x9fe787[_0x5b22ff(0x153)]),process[_0x5b22ff(0x28a)]({'type':_0x5b22ff(0x164)}),_0x3783cd[_0x5b22ff(0x2a8)]({'code':0x0}));}}),router[_0x55cb19(0x281)]('/setTvplay',(_0x203d99,_0x352a75,_0x262750)=>{const _0x2f40db=_0x55cb19;let _0x4124a9=_0x203d99[_0x2f40db(0x242)][_0x2f40db(0x1f1)],_0x948274=_0x203d99[_0x2f40db(0x242)][_0x2f40db(0x1b0)],_0x4f53cc=_0x203d99[_0x2f40db(0x242)][_0x2f40db(0x157)];function _0x3d6908(_0x3e9dbf){const _0x2dd900=_0x2f40db;let _0x35311f=_0x203d99[_0x2dd900(0x1d7)][_0x2dd900(0x26d)][_0x2dd900(0x274)](_0x2dd900(0x27b)+dbFileIndexTable[_0x2dd900(0x222)]+_0x2dd900(0x1bc))[_0x2dd900(0x23d)](_0x3e9dbf);if(!_0x35311f)return;_0x203d99[_0x2dd900(0x1d7)][_0x2dd900(0x26d)][_0x2dd900(0x274)](_0x2dd900(0x1ad)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x2dd900(0x1fb))['run'](_0x3e9dbf),_0x203d99[_0x2dd900(0x1d7)]['dbFileIndex']['prepare'](_0x2dd900(0x1ad)+dbFileIndexTable[_0x2dd900(0x222)]+'\x20SET\x20show_in_list=1\x20WHERE\x20id=?')['run'](_0x35311f['id']),movieUtil[_0x2dd900(0x295)](_0x203d99[_0x2dd900(0x1d7)]['dbFileIndex'],_0x35311f);}if(_0x948274){let _0x44ad53=dbFileIndexTable[_0x2f40db(0x2a4)](_0x203d99['app']['dbFileIndex'],_0x948274,dbFileIndexTable[_0x2f40db(0x222)]);if(dbUserTable[_0x2f40db(0x1c8)](_0x203d99,_0x352a75,_0x2f40db(0x21b),_0x2f40db(0x265),_0x44ad53[_0x2f40db(0x153)])==!![])return _0x4124a9==0x1?_0x3d6908(_0x44ad53['path']):_0x203d99[_0x2f40db(0x1d7)][_0x2f40db(0x26d)][_0x2f40db(0x274)]('UPDATE\x20'+dbFileIndexTable[_0x2f40db(0x222)]+'\x20SET\x20show_in_list\x20=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=\x27'+_0x44ad53[_0x2f40db(0x153)]+'\x27')['run'](),_0x352a75[_0x2f40db(0x2a8)]({'code':0x0});}else{if(_0x4f53cc){let _0x4a3137=dbSourceFolderTable[_0x2f40db(0x2a4)](_0x203d99[_0x2f40db(0x1d7)]['dbOther'],_0x4f53cc);if(!_0x4a3137||_0x4a3137[_0x2f40db(0x27d)]!='movie')return _0x203d99[_0x2f40db(0x1d7)]['returnErrMsg'](_0x352a75,_0x352a75['__'](_0x2f40db(0x259)),_0x2f40db(0x294));if(_0x4124a9==0x1){dbSourceFolderTable[_0x2f40db(0x28c)](_0x203d99[_0x2f40db(0x1d7)][_0x2f40db(0x290)],'media_type',_0x2f40db(0x292),_0x4f53cc),_0x3d6908(_0x4a3137[_0x2f40db(0x153)]);let _0x494bff=_0x203d99[_0x2f40db(0x1d7)]['dbFileIndex'][_0x2f40db(0x274)](_0x2f40db(0x16e)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20WHERE\x20is_file=0\x20and\x20(path=?\x20or\x20path\x20like\x20?)\x20')[_0x2f40db(0x2ab)](_0x4a3137[_0x2f40db(0x153)],''+_0x4a3137[_0x2f40db(0x153)]+path[_0x2f40db(0x184)]+'%');for(let _0x30850e in _0x494bff){let _0x22f92d=path[_0x2f40db(0x285)](_0x494bff[_0x30850e]['path'],_0x494bff[_0x30850e][_0x2f40db(0x2ac)]);_0x3d6908(_0x22f92d);}}else{dbSourceFolderTable[_0x2f40db(0x28c)](_0x203d99[_0x2f40db(0x1d7)][_0x2f40db(0x290)],_0x2f40db(0x227),_0x2f40db(0x21b),_0x4f53cc);let _0x4c0566=_0x203d99[_0x2f40db(0x1d7)][_0x2f40db(0x26d)][_0x2f40db(0x274)](_0x2f40db(0x1ad)+dbFileIndexTable[_0x2f40db(0x222)]+_0x2f40db(0x1d1))['run'](_0x4a3137[_0x2f40db(0x153)],''+_0x4a3137['path']+path[_0x2f40db(0x184)]+'%');}return _0x352a75['json']({'code':0x0});}else return _0x203d99[_0x2f40db(0x1d7)][_0x2f40db(0x1da)](_0x352a75,_0x352a75['__']('operationFail'),_0x2f40db(0x294));}});function setLogoAndFanart(_0x2f2faf,_0xf5e1f9,_0xa6feaa,_0x37b444){const _0x355170=_0x55cb19;if(_0x2f2faf[_0x355170(0x242)][_0x355170(0x1e2)]){let _0x361ce3=_0x355170(0x1c6),_0x2ef591=[_0xa6feaa];_0x37b444?(_0x361ce3+=_0x355170(0x283),_0x2ef591[_0x355170(0x1f5)]('clearlogo.%'),_0x2ef591[_0x355170(0x1f5)](_0x37b444+_0x355170(0x28d)),_0x2ef591[_0x355170(0x1f5)](_0x37b444+_0x355170(0x1a8))):(_0x361ce3+=_0x355170(0x252),_0x2ef591[_0x355170(0x1f5)](_0x355170(0x162)));let _0x490ca4=_0x2f2faf[_0x355170(0x1d7)][_0x355170(0x26d)]['prepare'](_0x361ce3)[_0x355170(0x23d)](_0x2ef591);if(_0x490ca4){let _0x32abda=path[_0x355170(0x285)](_0x490ca4[_0x355170(0x153)],_0x490ca4[_0x355170(0x2ac)]);_0xf5e1f9['logo_path']=_0x32abda;}let _0x274a21=_0x355170(0x1c6),_0x1289ff=[_0xa6feaa];_0x37b444?(_0x274a21+='(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20or\x20filename\x20like\x20?)',_0x1289ff['push'](_0x355170(0x271)),_0x1289ff[_0x355170(0x1f5)](_0x37b444+_0x355170(0x224)),_0x1289ff[_0x355170(0x1f5)](_0x37b444+_0x355170(0x1df))):(_0x274a21+=_0x355170(0x252),_0x1289ff['push'](_0x355170(0x271)));let _0x2defd5=_0x2f2faf[_0x355170(0x1d7)][_0x355170(0x26d)]['prepare'](_0x274a21)[_0x355170(0x23d)](_0x1289ff);if(_0x2defd5){let _0x1ec76b=path[_0x355170(0x285)](_0x2defd5[_0x355170(0x153)],_0x2defd5[_0x355170(0x2ac)]);_0xf5e1f9['fanart_path']=_0x1ec76b;}}}function _0xbefe(){const _0xdcddb2=['UPDATE\x20movie_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?','autoSkip','stat','\x20LIKE\x20\x27%','movie_index_id','.srt','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20filename\x20like\x20?','/getSameNameSubtitles','isAdmin','exports','get','.vtt','\x20AND\x20','535985LiDRmL','\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20','body','dirname','SELECT\x20id,title,enable_pwd,create_time\x20FROM\x20movie_collection\x20where\x20id=?\x20and\x20pwd=?','movieTvCache','-UHD','pageCount','-QHD','\x20SET\x20filename_number=?\x20\x20WHERE\x20\x20id=?','\x20AND\x20collection_id=0','\x20AND\x20is_tvplay==1','time','login.pwdErr','movieShowMatchName','folder.jpg','\x20type=2','../../utils/nfoUtil','(filename\x20like\x20?)','UPDATE\x20file_index_movie\x20SET\x20collection_id=?\x20WHERE\x20id\x20in\x20','SELECT\x20*\x20FROM\x20movie_keys\x20WHERE\x20key_type=?\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20200','GET','end','index.videoInfoReadFail','getTime','operationFail','../../db/dbMovieFavorite','excludePathMovie','REPLACE\x20INTO\x20movie_collection(title,enable_pwd,pwd,user_id,type,data,collection_cover_path,data_value,share_for_subuser)\x20VALUES(\x20?,?,?,?,?,?,?,?,?)','/getHistory','\x20order\x20by\x20create_time\x20desc','collectionId','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_genres\x27\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','videoPath','ADD','../../db/dbUserTable','smart','power_change','create_time','parseNfoTvSeries','genresType','SELECT\x20id\x20FROM\x20','../utils/movieUtil','REPLACE\x20INTO\x20movie_history(index_id,user_id,time,create_time)\x20VALUES(\x20?,?,?,?)','UPDATE\x20file_index_movie\x20SET\x20movie_info_state=3\x20WHERE\x20path\x20like\x20?\x20OR\x20path=?','dbFileIndex','express','findWithField','sort','fanart.%','favorite','sha256','prepare','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_language\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','\x20AND\x20(','395077kKuDin','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20','movie_genres','checkPath','SELECT\x20*\x20from\x20','duration','type','searchValue','\x20id,title,data,enable_pwd,collection_cover_path,data_value,create_time,share_for_subuser\x20','./photoApiUtils','post','movie_director','(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20\x20or\x20filename\x20like\x20?)','\x20order\x20by\x20m.create_time\x20desc\x20limit\x2050','join','orderType','/getMovieDetail','desc','extname','send','SELECT\x20*\x20from\x20movie_history\x20where\x20user_id=?\x20and\x20index_id=?','updateByWhere','-clearlogo.%','/getIndexDetail','未找到NFO信息','dbOther','includes','tvplay','endsWith','dialog','dealFirstLetterSingle','\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id=','../../db/dbSourceFolderTable','parse','saveMovieInfoToDb','searchStr','coverPath','movie_actor','\x20LIMIT\x20?\x20OFFSET\x20?','SELECT\x20','/getTvSeriesDetail','\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20check_time\x20DESC\x20LIMIT\x20','key_value','%fanart%','noPermission','getById','\x20or\x20','/addIndexToCollection','fileFullPath','json','865900VwUrts','is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay==1','all','filename','defaultTranscodeResolution','set','33dXmqsJ','-seasonCount-','../utils/nasAccountUtils','replace','/addHistory','deleteFavorite','trash','tvCount','existsSync','path','getSeasonNumber','\x20AND\x20(filename_fl=?\x20AND\x20show_name_fl=?\x20AND\x20movie_info_name_fl=?)','show_name','sourceFolderId','shareForSubUser','fromName','\x20and\x20title\x20like\x20?','1080p\x203mbps','../utils/fileUtils','SELECT\x20*\x20from\x20movie_collection\x20where\x20id=?','getUserPathWhere','status','check_time','startScanPath','clearlogo.%','name','SWITCH_MOVIE_INFO','\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1','movieActors','pwdCanNotBeNull','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20share_for_subuser=1','excludeIds','movieIndexId','getAllByWhereAndField','getTvCount','REPLACE\x20INTO\x20movie_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)','SELECT\x20path,filename\x20from\x20','isTvSeries','2efqkXx','DELETE\x20FROM\x20movie_collection\x20WHERE\x20id=?','getPathWhere','\x27\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27','pageSize','seasonCount','sourceFolderList','fileExist','\x20FROM\x20','ordinary','id,username','getPhotoByParams','sortField','ignore_match_info','\x20AND\x20title\x20like\x20?\x20','\x20AND\x20is_tvplay==0','\x20SELECT\x20','UPDATE\x20file_index_movie\x20set\x20check_time=?\x20WHERE\x20id=?','shareUidList','/addCollection','sep','../../utils/movieSeasonUtil','basename','seasonList','\x20order\x20by\x20m.create_time\x20desc\x20limit\x2010','Router','tvFolderName','DELETE\x20FROM\x20movie_history\x20where\x20user_id=','/getMovieHomeData','operation','UPDATE\x20file_index_movie\x20set\x20open_duration=?,end_duration=?,skip_open_end=?\x20WHERE\x20id\x20in\x20','/getTvHomeData','%poster%','data','catch','folder_cover_path','needTvCount','\x20order\x20by\x20check_time\x20desc\x20limit\x2010\x20','is_file','movieGenres','sortType','firstLetter','\x20type=2\x20and\x20is_file=1\x20and\x20id!=?\x20and\x20collection_id=0\x20','now','coverMovie','delete','timestamp','7NbWzyA','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name','UPDATE\x20file_index_movie\x20SET\x20movie_info_state=0\x20WHERE\x20(path\x20like\x20?\x20OR\x20path=?)','movie_regions','1126638HsezOt','/removeIndexFromCollection','\x20as\x20f\x20WHERE\x20path\x20like\x20?\x20and\x20is_tvplay=1\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20limit\x20200','DELETE','\x27\x20or\x20filename\x20like\x20\x27','.clearlogo.%','sourceType','has','\x20and\x20show_in_list=1','/deleteCollection','UPDATE\x20','\x20like\x20?\x20','collectionPwd','indexId','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20id=?','subtitleSize','ignoreMatchInfo','\x20and\x20path=?\x20and\x20is_tvplay=1\x20','getCountByWhere','UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20WHERE\x20id\x20in\x20','EDIT','movieDirectors','\x20FROM\x20\x20movie_collection\x20WHERE\x20type=?','seasonNumber','ALL','\x20WHERE\x20path=?\x20and\x20is_file=1\x20and\x20type=2\x20order\x20by\x20filename','movieLanguage','\x20id,collection_id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list','error\x20data','page','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20and\x20filename_number\x20is\x20null','UPDATE\x20movie_history\x20SET\x20time=?,create_time=?\x20where\x20index_id=?\x20AND\x20user_id=?','%season','needSeasonCount','2926935TaOlLB','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20','endDuration','doUserCanGet','636200nqUiCM','length','replaceAll','../../db/dbScanTaskTable','\x20AND\x20(path\x20like\x20?\x20OR\x20filename\x20like\x20?\x20OR\x20movie_info_name\x20like\x20?\x20)','sameFolderImgList','checkSqlInjection','4EXQgvB','\x20SET\x20show_in_list=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=?\x20or\x20path\x20like\x20?','enable_pwd','UPDATE\x20movie_collection\x20SET\x20title=?,data=?,enable_pwd=?,pwd=?,collection_cover_path=?,data_value=?,share_for_subuser=?\x20WHERE\x20id=?','SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_movie\x20WHERE\x20path\x20like\x20?\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1','select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2','power_get','app','SELECT\x20*\x20FROM\x20source_folder\x20WHERE\x20type=?\x20LIMIT\x2010','folder','returnErrMsg','movie_info_name','dataValue','count','\x20and\x20filename\x20>=\x20?\x20','.fanart.%','FAVORITE','movieCollectionNotExist','needLogoPathAndFanart','../../utils/videoStreamUtil','orderField','indexIdList','addFavorite','title','.ass','../../db/dbConfigTable','1192794kYJpzU','pwd','movie_language','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27poster.%\x27\x20or\x20filename\x20like\x20\x27POSTER.%\x27\x20or\x20filename\x20like\x20\x27movie.%\x27\x20or\x20filename\x20like\x20\x27folder.%\x27\x20or\x20filename\x20like\x20\x27cover.%\x27\x20or\x20filename\x20like\x20\x27thumb.%\x27)','\x20order\x20by\x20','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=\x27','run','isTvPlay','\x20order\x20by\x20filename_number,filename','index_count','offset','push','log','getExcludePathWhereStr','-coverCache-','\x27\x20and\x20type=1\x20and\x20is_file=1\x20limit\x2020','/getTvList','\x20SET\x20show_in_list\x20=0,is_tvplay=1\x20WHERE\x20path=?','then','substr','-HD','\x20\x20WHERE\x20','parseNfo','/clearHistory','collection_id','ignoreSeasonList','trim','getFavorite','error\x20pathList','is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay!=1','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_regions\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','useTvSeriesInfo','../utils/sqliteUtil','\x20OFFSET\x20','share_uid','tvFolderPath','currentUser','../../utils/movieInfoUtil','/getMoviesByGenres','value','/deleteIndex','SELECT\x20*\x20FROM\x20movie_library\x20','libraryId','findByTitle','UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20where\x20collection_id=?','getFilenameNumber','getFavoriteList','\x20AND\x20(filename_fl=?\x20OR\x20show_name_fl=?\x20OR\x20movie_info_name_fl=?)','stringify','movie','search','is_admin','movieHomeShowLibrary','sourceList','\x20as\x20f\x20WHERE\x20','\x20and\x20(filename\x20like\x20?\x20or\x20movie_info_name\x20like\x20?)\x20','INDEX_TABLE_NAME_MOVIE','poster.jpg','-fanart.%','startsWith','\x20LIMIT\x20','media_type','poster.jpeg','HEIC','is_tvplay','/setTitleAndEnding','addScanTask','SELECT\x20index_id\x20FROM\x20movie_history\x20where\x20index_id\x20in\x20','user_list','\x20AND\x20share_for_subuser\x20=\x20?\x20','enablePwd','\x20ORDER\x20BY\x20','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id'];_0xbefe=function(){return _0xdcddb2;};return _0xbefe();}function _0x4958(_0x5952cf,_0x3a45db){const _0xbefe2e=_0xbefe();return _0x4958=function(_0x49582f,_0xf0d37d){_0x49582f=_0x49582f-0x14b;let _0x4d4e0b=_0xbefe2e[_0x49582f];return _0x4d4e0b;},_0x4958(_0x5952cf,_0x3a45db);}function addTvFolderPathAndName(_0x405174){const _0x1108f5=_0x55cb19;_0x405174[_0x1108f5(0x18a)]=path['basename'](_0x405174[_0x1108f5(0x153)]),_0x405174[_0x1108f5(0x20d)]=_0x405174[_0x1108f5(0x153)];if(_0x405174[_0x1108f5(0x22a)]==0x1){let _0x34b067=path[_0x1108f5(0x186)](_0x405174['path']),_0x2bf7b3=path['dirname'](_0x405174[_0x1108f5(0x153)]),_0x39c7dd=movieSeasonUtil[_0x1108f5(0x154)](_0x34b067);_0x39c7dd>-0x1&&(_0x405174[_0x1108f5(0x18a)]=path[_0x1108f5(0x186)](_0x2bf7b3),_0x405174[_0x1108f5(0x20d)]=_0x2bf7b3);if(!_0x405174[_0x1108f5(0x156)])_0x405174[_0x1108f5(0x156)]=_0x405174['tvFolderName'];}}function addFolderCoverPath(_0x5399f0,_0x1e7dcb,_0x41c9bf,_0x3c74d3=![]){const _0x13039e=_0x55cb19;let _0x219eb3;addTvFolderPathAndName(_0x41c9bf);let _0x6cc778=_0x41c9bf['id']+_0x13039e(0x1f8)+_0x3c74d3;!_0x1e7dcb[_0x13039e(0x245)]&&(_0x1e7dcb[_0x13039e(0x245)]=new Map());try{if(_0x41c9bf[_0x13039e(0x22a)]==0x1&&!_0x3c74d3)try{let _0x16f187=path[_0x13039e(0x186)](_0x41c9bf['path']),_0x3ee909=path[_0x13039e(0x243)](_0x41c9bf[_0x13039e(0x153)]),_0x687fa0=movieSeasonUtil[_0x13039e(0x154)](_0x16f187);if(_0x687fa0>-0x1){_0x41c9bf[_0x13039e(0x16f)]=0x1,_0x41c9bf[_0x13039e(0x1ba)]=_0x687fa0;if(_0x1e7dcb[_0x13039e(0x242)][_0x13039e(0x1c4)]){let _0x11acaa=_0x3ee909+_0x13039e(0x14b)+_0x3c74d3;_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x1aa)](_0x11acaa)?_0x41c9bf[_0x13039e(0x175)]=_0x1e7dcb[_0x13039e(0x245)]['get'](_0x11acaa):(_0x41c9bf[_0x13039e(0x175)]=_0x1e7dcb['app'][_0x13039e(0x26d)][_0x13039e(0x274)](_0x13039e(0x1d4))[_0x13039e(0x23d)](''+_0x3ee909+path['sep']+'%')['count'],_0x1e7dcb['movieTvCache']['set'](_0x11acaa,_0x41c9bf[_0x13039e(0x175)]));}}setLogoAndFanart(_0x1e7dcb,_0x41c9bf,_0x41c9bf['tvFolderPath']);if(_0x1e7dcb['body'][_0x13039e(0x209)]==0x1&&_0x687fa0>-0x1){let _0x14c16d=_0x41c9bf[_0x13039e(0x20d)]+'-seriesPoster';if(_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x1aa)](_0x14c16d))return _0x41c9bf[_0x13039e(0x193)]=_0x1e7dcb[_0x13039e(0x245)]['get'](_0x14c16d),_0x41c9bf;let _0x51c1f3=getTvSeriesPoster(_0x41c9bf);if(_0x51c1f3)return _0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x2ae)](_0x14c16d,_0x51c1f3),_0x41c9bf[_0x13039e(0x193)]=_0x51c1f3,_0x41c9bf;}if(!_0x219eb3&&_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x1aa)](_0x6cc778))return _0x41c9bf[_0x13039e(0x193)]=_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x23d)](_0x6cc778),_0x41c9bf;if(!_0x219eb3&&_0x687fa0>-0x1){parseInt(_0x687fa0)<0xa&&(_0x687fa0='0'+_0x687fa0);let _0x14f907=_0x13039e(0x1c3)+_0x687fa0+_0x13039e(0x190),_0x5a2670='%s'+_0x687fa0+_0x13039e(0x190),_0x51c636=_0x13039e(0x1ef)+_0x3ee909+_0x13039e(0x173)+_0x14f907+_0x13039e(0x1a7)+_0x5a2670+'\x27)';_0x219eb3=_0x1e7dcb[_0x13039e(0x1d7)][_0x13039e(0x26d)][_0x13039e(0x274)](_0x51c636)[_0x13039e(0x23d)]();}!_0x219eb3&&(_0x219eb3=_0x1e7dcb[_0x13039e(0x1d7)][_0x13039e(0x26d)]['prepare'](_0x13039e(0x1ed))[_0x13039e(0x23d)](_0x41c9bf[_0x13039e(0x153)]));}catch(_0x369eb6){console[_0x13039e(0x1f6)](_0x369eb6);}else{if(_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x1aa)](_0x6cc778))return _0x41c9bf[_0x13039e(0x193)]=_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x23d)](_0x6cc778),_0x41c9bf;let _0x1cc4ac=path[_0x13039e(0x298)](_0x41c9bf['filename']),_0x28fdba=_0x1cc4ac[_0x13039e(0x163)],_0x342a54=path[_0x13039e(0x285)](_0x41c9bf[_0x13039e(0x153)],_0x28fdba+'.jpg');if(fs[_0x13039e(0x152)](_0x342a54))return _0x41c9bf[_0x13039e(0x193)]=_0x342a54,_0x41c9bf;!_0x219eb3&&(_0x219eb3=_0x1e7dcb[_0x13039e(0x1d7)][_0x13039e(0x26d)][_0x13039e(0x274)](_0x13039e(0x239))['get'](_0x41c9bf['path'],'%'+_0x28fdba+_0x13039e(0x190)));if(!_0x219eb3){let _0x463f72=_0x28fdba;(_0x28fdba[_0x13039e(0x293)]('-HD')||_0x28fdba[_0x13039e(0x293)]('-FHD')||_0x28fdba[_0x13039e(0x293)](_0x13039e(0x248))||_0x28fdba['endsWith'](_0x13039e(0x246)))&&(_0x28fdba[_0x13039e(0x293)](_0x13039e(0x1fe))?_0x463f72=_0x463f72[_0x13039e(0x1fd)](0x0,_0x463f72['length']-0x3):_0x463f72=_0x463f72[_0x13039e(0x1fd)](0x0,_0x463f72[_0x13039e(0x1ca)]-0x4)),_0x219eb3=_0x1e7dcb[_0x13039e(0x1d7)][_0x13039e(0x26d)][_0x13039e(0x274)]('SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20?\x20or\x20filename\x20like\x20?)\x20and\x20filename\x20not\x20like\x20?')[_0x13039e(0x23d)](_0x41c9bf[_0x13039e(0x153)],_0x28fdba+'%',_0x463f72+'%',_0x13039e(0x2a2));}!_0x219eb3&&(_0x219eb3=_0x1e7dcb[_0x13039e(0x1d7)][_0x13039e(0x26d)]['prepare']('SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27poster.%\x27\x20or\x20filename\x20like\x20\x27POSTER.%\x27\x20or\x20filename\x20like\x20\x27movie.%\x27\x20or\x20filename\x20like\x20\x27folder.%\x27\x20or\x20filename\x20like\x20\x27cover.%\x27\x20or\x20filename\x20like\x20\x27thumb.%\x27)')[_0x13039e(0x23d)](_0x41c9bf[_0x13039e(0x153)]));let {name:_0x121c9e}=path[_0x13039e(0x298)](_0x41c9bf[_0x13039e(0x2ac)]);setLogoAndFanart(_0x1e7dcb,_0x41c9bf,_0x41c9bf['path'],_0x121c9e);}if(_0x219eb3){let _0x292865=path[_0x13039e(0x285)](_0x219eb3[_0x13039e(0x153)],_0x219eb3['filename']);!_0x292865[_0x13039e(0x293)](_0x13039e(0x229))&&!_0x292865[_0x13039e(0x293)]('heic')&&fs[_0x13039e(0x152)](_0x292865)?(_0x41c9bf[_0x13039e(0x193)]=_0x292865,_0x1e7dcb[_0x13039e(0x245)][_0x13039e(0x2ae)](_0x6cc778,_0x41c9bf['folder_cover_path'])):_0x1e7dcb['movieTvCache']['set'](_0x6cc778,'');}return _0x41c9bf;}catch(_0x433c22){return console['log'](_0x433c22),_0x41c9bf;}}function getMoviesByParams(_0x34015b,_0x13c2f2,_0x579100,_0x32f670,_0x1b0b36,_0x2d7862,_0xf0dc12,_0x1bbccb,_0x7747d1,_0x39dff6,_0x46ae35,_0x340087,_0x1eead9,_0x68c262,_0x538800,_0x471c1d,_0x557ecb,_0x316815){const _0xa56c33=_0x55cb19;let _0x545bf1=movieFieldStr;_0x316815&&(_0x545bf1=_0x316815);!_0x538800&&(_0x538800='ALL');let _0x57a09a='',_0x39f326=[],_0x583fea=dbUserTable[_0xa56c33(0x15e)](_0x13c2f2,_0xa56c33(0x21b),_0xa56c33(0x1d6),!![],_0x39dff6);if(_0x13c2f2[_0xa56c33(0x20e)][_0xa56c33(0x21d)]!=0x1&&!_0x583fea)return[];_0x57a09a+='\x20type=2';_0x7747d1&&(_0x7747d1=_0x7747d1[_0xa56c33(0x14d)]('\x27','')['replace']('’',''),_0x57a09a+=_0xa56c33(0x1cd),_0x39f326[_0xa56c33(0x1f5)]('%'+_0x7747d1+'%'),_0x39f326['push']('%'+_0x7747d1+'%'),_0x39f326[_0xa56c33(0x1f5)]('%'+_0x7747d1+'%'));let _0x51c8bc=dbSourceFolderTable[_0xa56c33(0x1f7)](_0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x290)],_0xa56c33(0x153),_0xa56c33(0x25b));_0x51c8bc&&(_0x57a09a+=_0xa56c33(0x23f)+_0x51c8bc);let _0x3aa792=dbSourceFolderTable[_0xa56c33(0x1f7)](_0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x290)],_0xa56c33(0x2ac),'excludeFilenameMovie');_0x3aa792&&(_0x57a09a+='\x20AND\x20'+_0x3aa792);function _0x30449d(_0x277b0c,_0x196b01){const _0x45fb0b=_0xa56c33;let _0x2aa499=_0x45fb0b(0x276);try{let _0x1e7466=JSON['parse'](_0x196b01),_0x5ef917=![];for(let _0xefec3a=0x0;_0xefec3a<_0x1e7466[_0x45fb0b(0x1ca)];_0xefec3a++){if(!_0x1e7466[_0xefec3a])continue;_0x5ef917=!![],_0x2aa499+='\x20'+_0x277b0c+_0x45fb0b(0x1ae),_0x39f326[_0x45fb0b(0x1f5)]('%'+_0x1e7466[_0xefec3a][_0x45fb0b(0x204)]()+'%'),_0xefec3a!=_0x1e7466[_0x45fb0b(0x1ca)]-0x1&&(_0x2aa499+=_0x45fb0b(0x2a5));}_0x2aa499+=')',_0x5ef917&&(_0x57a09a+=_0x2aa499);}catch(_0x597f46){console[_0x45fb0b(0x1f6)](_0x597f46);}}_0x46ae35&&_0x30449d(_0xa56c33(0x1a2),_0x46ae35);_0x340087&&_0x30449d(_0xa56c33(0x1ec),_0x340087);_0x1eead9&&_0x30449d(_0xa56c33(0x279),_0x1eead9);_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x166)]&&_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x166)]['length']>0x0&&_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x166)][0x0]!=''&&_0x30449d(_0xa56c33(0x29c),_0x13c2f2['body'][_0xa56c33(0x166)]);_0x13c2f2[_0xa56c33(0x242)]['movieDirectors']&&_0x13c2f2['body'][_0xa56c33(0x1b8)][_0xa56c33(0x1ca)]>0x0&&_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x1b8)][0x0]!=''&&_0x30449d(_0xa56c33(0x282),_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x1b8)]);if(_0x557ecb){let _0x4b6301=_0x13c2f2[_0xa56c33(0x1d7)]['dbFileIndex'][_0xa56c33(0x274)](_0xa56c33(0x1b1))[_0xa56c33(0x23d)](_0x557ecb);if(_0x4b6301)try{let _0x5e01b5=JSON[_0xa56c33(0x298)](_0x4b6301['path_list']),_0x17c5e1=dbUserTable[_0xa56c33(0x172)](!![],_0x5e01b5);_0x57a09a+=_0x17c5e1;}catch(_0xbbdb32){console[_0xa56c33(0x1f6)](_0xbbdb32);}}else{!_0x68c262&&(_0x68c262=0x0);let _0x2fbb38;if(_0x68c262!=0x0){_0x2fbb38=_0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x26d)][_0xa56c33(0x274)]('SELECT\x20*\x20from\x20movie_collection\x20where\x20id=?')[_0xa56c33(0x23d)](_0x68c262);if(!_0x2fbb38)return _0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x1da)](_0x34015b,_0x34015b['__'](_0xa56c33(0x1e1)));if(_0x2fbb38[_0xa56c33(0x1d2)]==0x1){let _0x2758f8=_0x13c2f2[_0xa56c33(0x242)][_0xa56c33(0x1af)];if(!_0x2758f8||_0x2fbb38[_0xa56c33(0x1eb)]!=sha256(_0x2758f8))return _0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x1da)](_0x34015b,_0x34015b['__'](_0xa56c33(0x24d)));}}if(_0x2fbb38&&_0x2fbb38[_0xa56c33(0x27d)]==_0xa56c33(0x264))try{_0x2fbb38[_0xa56c33(0x191)]=JSON[_0xa56c33(0x298)](_0x2fbb38[_0xa56c33(0x191)]),_0x57a09a+='\x20AND\x20'+_0x2fbb38[_0xa56c33(0x191)][_0xa56c33(0x27e)];}catch(_0x35c421){console[_0xa56c33(0x1f6)](_0x35c421);}else _0x57a09a+='\x20AND\x20collection_id\x20=\x20'+_0x68c262;}if(_0x579100){if(_0x579100==0x1)_0x57a09a+=_0xa56c33(0x17f);else _0x579100==0x2&&(_0x57a09a+=_0xa56c33(0x24b));}_0x471c1d&&(_0x471c1d=='#'?(_0x57a09a+=_0xa56c33(0x155),_0x39f326['push'](_0x471c1d),_0x39f326['push'](_0x471c1d),_0x39f326[_0xa56c33(0x1f5)](_0x471c1d)):(_0x57a09a+=_0xa56c33(0x219),_0x39f326[_0xa56c33(0x1f5)](_0x471c1d),_0x39f326[_0xa56c33(0x1f5)](_0x471c1d),_0x39f326[_0xa56c33(0x1f5)](_0x471c1d)));if(_0x1bbccb&&_0x1bbccb[_0xa56c33(0x1ca)]>0x0){_0x57a09a+='\x20AND\x20id\x20NOT\x20IN\x20(';for(let _0x3105b9=0x0;_0x3105b9<_0x1bbccb[_0xa56c33(0x1ca)];_0x3105b9++){_0x57a09a+=_0x1bbccb[_0x3105b9],_0x3105b9!=_0x1bbccb[_0xa56c33(0x1ca)]-0x1&&(_0x57a09a+=',');}_0x57a09a+=')';}_0x57a09a+=_0x583fea;_0x32f670&&_0xf0dc12?_0x57a09a+=_0xa56c33(0x241)+_0x32f670+'\x20'+_0xf0dc12:_0x57a09a+=_0xa56c33(0x165);!_0x1b0b36&&(_0x1b0b36=0x32);_0x57a09a+=_0xa56c33(0x29d),_0x39f326[_0xa56c33(0x1f5)](_0x1b0b36),_0x39f326['push'](_0x2d7862);let _0x3ea0e2=[];if(_0x538800==_0xa56c33(0x1e0))_0x3ea0e2=dbMovieFavorite['getAllFavoriteByWhere'](_0x13c2f2[_0xa56c33(0x1d7)]['dbFileIndex'],_0x13c2f2['currentUser']['id'],_0x57a09a,_0x545bf1,_0x39f326);else _0x538800==_0xa56c33(0x1bb)&&(_0x3ea0e2=dbFileIndexTable['getAllByWhereAndField'](_0x13c2f2[_0xa56c33(0x1d7)][_0xa56c33(0x26d)],_0x57a09a,_0x545bf1,dbFileIndexTable[_0xa56c33(0x222)],_0x39f326));if(_0x3ea0e2[_0xa56c33(0x1ca)]<0x1)return _0x3ea0e2;let _0xcc1312=[];for(let _0x19d18b in _0x3ea0e2){_0xcc1312[_0xa56c33(0x1f5)](_0x3ea0e2[_0x19d18b]['id']);}let _0x5f72cb=dbMovieFavorite[_0xa56c33(0x218)](_0x13c2f2[_0xa56c33(0x1d7)]['dbFileIndex'],_0x13c2f2[_0xa56c33(0x20e)]['id'],_0xcc1312);for(let _0x320567=0x0;_0x320567<_0x3ea0e2[_0xa56c33(0x1ca)];_0x320567++){_0x3ea0e2[_0x320567][_0xa56c33(0x272)]=0x0;for(let _0x4acf45 in _0x5f72cb){if(_0x5f72cb[_0x4acf45][_0xa56c33(0x237)]==_0x3ea0e2[_0x320567]['id']){_0x3ea0e2[_0x320567][_0xa56c33(0x272)]=0x1;break;}}let _0x20a074=_0x13c2f2['app'][_0xa56c33(0x26d)][_0xa56c33(0x274)]('SELECT\x20*\x20from\x20movie_history\x20where\x20user_id=?\x20and\x20index_id=?')['get'](_0x13c2f2[_0xa56c33(0x20e)]['id']+'',_0x3ea0e2[_0x320567]['id']+'');_0x20a074&&(_0x3ea0e2[_0x320567]['history']=_0x20a074);_0x3ea0e2[_0x320567]=addFolderCoverPath(_0x34015b,_0x13c2f2,_0x3ea0e2[_0x320567]);if(_0x3ea0e2[_0x320567][_0xa56c33(0x22a)]==0x1&&_0x13c2f2[_0xa56c33(0x242)]['needTvCount']){let _0x1d8aeb=dbFileIndexTable[_0xa56c33(0x16c)](_0x13c2f2[_0xa56c33(0x1d7)]['dbFileIndex'],_0x3ea0e2[_0x320567]);_0x3ea0e2[_0x320567][_0xa56c33(0x151)]=_0x1d8aeb['count'];}}return _0x3ea0e2;}function getShowMatchName(_0x5786ca){const _0x4a8e55=_0x55cb19;let _0x4fa696=dbConfigTable[_0x4a8e55(0x215)](_0x5786ca,'movieShowMatchName');return!_0x4fa696||_0x4fa696&&_0x4fa696[_0x4a8e55(0x211)]!=0x0?0x1:0x0;}router[_0x55cb19(0x281)]('/getMovies',(_0x548d82,_0x1ebba2,_0x34d368)=>{const _0x59a261=_0x55cb19;if(dbUserTable[_0x59a261(0x1c8)](_0x548d82,_0x1ebba2,_0x59a261(0x21b),_0x59a261(0x1d6))==!![]){let _0x2073f4=_0x548d82[_0x59a261(0x242)][_0x59a261(0x1dd)],_0x4c2830=_0x548d82['body'][_0x59a261(0x1f4)],_0x5df27a=_0x548d82[_0x59a261(0x242)][_0x59a261(0x17c)],_0x340773=_0x548d82[_0x59a261(0x242)][_0x59a261(0x198)],_0x2a3cf7=_0x548d82['body'][_0x59a261(0x169)],_0x35cdb5=_0x548d82['body'][_0x59a261(0x29a)],_0x3b5eee=_0x548d82[_0x59a261(0x242)][_0x59a261(0x176)],_0x2c7faa=_0x548d82[_0x59a261(0x242)]['movieRegion'],_0x332236=_0x548d82[_0x59a261(0x242)][_0x59a261(0x1bd)],_0x1387f4=_0x548d82[_0x59a261(0x242)][_0x59a261(0x197)],_0xd6a5b3=_0x548d82['body'][_0x59a261(0x1a9)],_0x111441=_0x548d82['body'][_0x59a261(0x25f)],_0x3b72e3=_0x548d82[_0x59a261(0x242)]['listType'],_0x59e155=_0x548d82[_0x59a261(0x242)][_0x59a261(0x199)],_0x4aa7e9=_0x548d82[_0x59a261(0x242)][_0x59a261(0x214)];_0x548d82[_0x59a261(0x242)][_0x59a261(0x194)]=!![],_0x548d82[_0x59a261(0x242)][_0x59a261(0x1c4)]=!![];let _0x125a24=getMoviesByParams(_0x1ebba2,_0x548d82,_0xd6a5b3,_0x5df27a,_0x2073f4,_0x4c2830,_0x340773,_0x2a3cf7,_0x35cdb5,_0x3b5eee,_0x2c7faa,_0x332236,_0x1387f4,_0x111441,_0x3b72e3,_0x59e155,_0x4aa7e9);return _0x1ebba2['json']({'movieShowMatchName':getShowMatchName(_0x548d82[_0x59a261(0x1d7)]['dbOther']),'code':0x0,'data':_0x125a24});}}),router[_0x55cb19(0x281)](_0x55cb19(0x210),(_0x9f1cc7,_0x593d28,_0x5144b8)=>{const _0x2336b6=_0x55cb19;if(dbUserTable['doUserCanGet'](_0x9f1cc7,_0x593d28,_0x2336b6(0x21b),_0x2336b6(0x1d6))==!![]){let _0x4e5c37=_0x9f1cc7[_0x2336b6(0x242)][_0x2336b6(0x176)],_0x1b3e0f=_0x9f1cc7[_0x2336b6(0x242)][_0x2336b6(0x247)],_0x380046=_0x9f1cc7['body'][_0x2336b6(0x1a9)];!_0x1b3e0f&&(_0x1b3e0f=0x9);let _0x4c1562='\x20id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list',_0x306c04='';_0x4e5c37?_0x306c04=dbUserTable[_0x2336b6(0x15e)](_0x9f1cc7,'movie',_0x2336b6(0x1d6),!![],_0x4e5c37):_0x306c04=dbUserTable[_0x2336b6(0x15e)](_0x9f1cc7,_0x2336b6(0x21b),_0x2336b6(0x1d6),!![]);let _0x10182b=_0x9f1cc7[_0x2336b6(0x242)][_0x2336b6(0x268)];!_0x10182b&&(_0x10182b=_0x2336b6(0x279));let _0x2fa240=_0x9f1cc7[_0x2336b6(0x1d7)][_0x2336b6(0x26d)][_0x2336b6(0x274)](_0x2336b6(0x254))[_0x2336b6(0x2ab)](_0x10182b),_0x46456f=[];for(let _0xa8732 of _0x2fa240){let _0x50cfad=_0xa8732[_0x2336b6(0x2a1)],_0x1cf353=_0x2336b6(0x250);_0x1cf353+=_0x306c04,_0x1cf353+=_0x2336b6(0x24a);if(_0x380046){if(_0x380046==0x1)_0x1cf353+=_0x2336b6(0x17f);else _0x380046==0x2&&(_0x1cf353+=_0x2336b6(0x24b));}_0x1cf353+=_0x2336b6(0x23f)+_0x10182b+_0x2336b6(0x236)+_0x50cfad+'%\x27',_0x1cf353+=_0x2336b6(0x2a0)+_0x1b3e0f;let _0x1e3ea7=dbFileIndexTable[_0x2336b6(0x16b)](_0x9f1cc7['app'][_0x2336b6(0x26d)],_0x1cf353,_0x4c1562,dbFileIndexTable[_0x2336b6(0x222)]),_0x4a0945=[];for(let _0x25b893 in _0x1e3ea7){_0x4a0945[_0x2336b6(0x1f5)](_0x1e3ea7[_0x25b893]['id']);}let _0x19d56d=dbMovieFavorite[_0x2336b6(0x218)](_0x9f1cc7[_0x2336b6(0x1d7)][_0x2336b6(0x26d)],_0x9f1cc7['currentUser']['id'],_0x4a0945);for(let _0x4057b0=0x0;_0x4057b0<_0x1e3ea7[_0x2336b6(0x1ca)];_0x4057b0++){_0x1e3ea7[_0x4057b0][_0x2336b6(0x272)]=0x0;for(let _0xa91d2f in _0x19d56d){if(_0x19d56d[_0xa91d2f][_0x2336b6(0x237)]==_0x1e3ea7[_0x4057b0]['id']){_0x1e3ea7[_0x4057b0][_0x2336b6(0x272)]=0x1;break;}}_0x1e3ea7[_0x4057b0]=addFolderCoverPath(_0x593d28,_0x9f1cc7,_0x1e3ea7[_0x4057b0]);}_0x1e3ea7[_0x2336b6(0x1ca)]>0x0&&_0x46456f['push']({'genresType':_0x10182b,'genresValue':_0x50cfad,'movieList':_0x1e3ea7,'indexCount':_0xa8732[_0x2336b6(0x1f3)]});}_0x593d28['json']({'code':0x0,'data':_0x46456f,'movieShowMatchName':getShowMatchName(_0x9f1cc7[_0x2336b6(0x1d7)][_0x2336b6(0x290)])});}}),router[_0x55cb19(0x281)](_0x55cb19(0x18c),(_0x2856bd,_0x108783,_0x47ea0b)=>{const _0x310e59=_0x55cb19;if(dbUserTable[_0x310e59(0x1c8)](_0x2856bd,_0x108783,'movie',_0x310e59(0x1d6))==!![]){let _0x560aa0=getMoviesByParams(_0x108783,_0x2856bd,0x1,'create_time',0xf,0x0,'desc');_0x2856bd[_0x310e59(0x242)][_0x310e59(0x194)]=!![],_0x2856bd['body']['needSeasonCount']=!![],_0x2856bd[_0x310e59(0x242)][_0x310e59(0x209)]=0x1;let _0xc3bc1b=getMoviesByParams(_0x108783,_0x2856bd,0x2,_0x310e59(0x266),0x32,0x0,_0x310e59(0x288));_0x2856bd[_0x310e59(0x242)][_0x310e59(0x194)]=![],_0x2856bd['body'][_0x310e59(0x1c4)]=![],_0x2856bd['body']['useTvSeriesInfo']=0x0;let _0x582335=dbConfigTable[_0x310e59(0x215)](_0x2856bd[_0x310e59(0x1d7)][_0x310e59(0x290)],'movieHomeShowMyMedia');_0x582335=!_0x582335||_0x582335&&_0x582335[_0x310e59(0x211)]==0x1;let _0x496c30=dbConfigTable[_0x310e59(0x215)](_0x2856bd['app']['dbOther'],_0x310e59(0x21e));_0x496c30=!_0x496c30||_0x496c30&&_0x496c30[_0x310e59(0x211)]==0x1;let _0x478f3e=dbConfigTable[_0x310e59(0x215)](_0x2856bd[_0x310e59(0x1d7)][_0x310e59(0x290)],'movieHomeShowHistory');_0x478f3e=!_0x478f3e||_0x478f3e&&_0x478f3e[_0x310e59(0x211)]==0x1;let _0x312c2c=[];if(_0x478f3e){let _0x22693c='m.time,\x20f.id,f.is_tvplay,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name',_0x57dfee=_0x310e59(0x29e)+_0x22693c+'\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id='+_0x2856bd[_0x310e59(0x20e)]['id']+_0x310e59(0x188);_0x312c2c=_0x2856bd[_0x310e59(0x1d7)][_0x310e59(0x26d)][_0x310e59(0x274)](_0x57dfee)[_0x310e59(0x2ab)]();let _0x46ac58=[];for(let _0x4ecca2 in _0x312c2c){_0x46ac58['push'](_0x312c2c[_0x4ecca2]['id']);}let _0x62189d=dbMovieFavorite[_0x310e59(0x218)](_0x2856bd['app'][_0x310e59(0x26d)],_0x2856bd[_0x310e59(0x20e)]['id'],_0x46ac58);for(let _0x496f02=0x0;_0x496f02<_0x312c2c['length'];_0x496f02++){_0x312c2c[_0x496f02][_0x310e59(0x272)]=0x0;for(let _0x3abef4 in _0x62189d){if(_0x62189d[_0x3abef4][_0x310e59(0x237)]==_0x312c2c[_0x496f02]['id']){_0x312c2c[_0x496f02][_0x310e59(0x272)]=0x1;break;}}}}let _0x266b1f=[];_0x496c30&&(_0x266b1f=getMovieLibrary(_0x2856bd,_0x108783,0x6));let _0x7eab3c={'code':0x0,'movies':_0x560aa0,'tv':_0xc3bc1b,'history':_0x312c2c,'libraryList':_0x266b1f,'sourceList':[]};_0x7eab3c[_0x310e59(0x24e)]=getShowMatchName(_0x2856bd[_0x310e59(0x1d7)]['dbOther']);if(_0x582335){let _0x114555=_0x2856bd[_0x310e59(0x1d7)][_0x310e59(0x290)][_0x310e59(0x274)](_0x310e59(0x1d8))[_0x310e59(0x2ab)](_0x310e59(0x21b));for(let _0x116aa2 of _0x114555){let _0x1265f7=getMoviesByParams(_0x108783,_0x2856bd,null,_0x310e59(0x160),0x4,0x0,_0x310e59(0x288),null,null,JSON[_0x310e59(0x21a)]([path[_0x310e59(0x285)](_0x116aa2[_0x310e59(0x153)])]));if(_0x1265f7['length']<0x1)continue;_0x7eab3c[_0x310e59(0x21f)][_0x310e59(0x1f5)]({'mediaType':_0x116aa2[_0x310e59(0x227)],'path':_0x116aa2[_0x310e59(0x153)],'name':path[_0x310e59(0x186)](_0x116aa2[_0x310e59(0x153)]),'sourceMovies':_0x1265f7});}}return _0x108783['json'](_0x7eab3c);}}),router['post'](_0x55cb19(0x18f),(_0x4adb0d,_0xa4d88f,_0x10fdbd)=>{const _0x3ce416=_0x55cb19;if(dbUserTable['doUserCanGet'](_0x4adb0d,_0xa4d88f,_0x3ce416(0x21b),'power_get')==!![]){let _0x194e03=getMoviesByParams(_0xa4d88f,_0x4adb0d,0x1,_0x3ce416(0x160),0xa,0x0,_0x3ce416(0x288)),_0x2598a8=getMoviesByParams(_0xa4d88f,_0x4adb0d,0x2,_0x3ce416(0x160),0xa,0x0,_0x3ce416(0x288)),_0x5a69ef='m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name',_0xbfafdb='SELECT\x20'+_0x5a69ef+_0x3ce416(0x296)+_0x4adb0d['currentUser']['id']+_0x3ce416(0x188),_0x3ad55d=_0x4adb0d[_0x3ce416(0x1d7)][_0x3ce416(0x26d)][_0x3ce416(0x274)](_0xbfafdb)[_0x3ce416(0x2ab)](),_0x7743b=getCollectionList(_0x4adb0d,_0xa4d88f,_0x3ce416(0x179)),_0xc1cf50=getCollectionList(_0x4adb0d,_0xa4d88f,'smart'),_0x2391bf=getMoviesByParams(_0xa4d88f,_0x4adb0d,null,_0x3ce416(0x160),0xa,0x0,_0x3ce416(0x288),null,null,null,null,null,null,null,'FAVORITE'),_0x173667=getMovieLibrary(_0x4adb0d,_0xa4d88f),_0x28c37a={'code':0x0,'movies':_0x194e03,'tv':_0x2598a8,'history':_0x3ad55d,'favorites':_0x2391bf,'collectionList':_0x7743b,'aiCollectionList':_0xc1cf50,'libraryList':_0x173667};return _0xa4d88f[_0x3ce416(0x2a8)](_0x28c37a);}}),router['post']('/getTvHomeData2',(_0x44acc7,_0x11a6e2,_0x1def0c)=>{const _0x57c078=_0x55cb19;if(dbUserTable[_0x57c078(0x1c8)](_0x44acc7,_0x11a6e2,_0x57c078(0x21b),_0x57c078(0x1d6))==!![]){let _0x50feb4=getMoviesByParams(_0x11a6e2,_0x44acc7,0x1,_0x57c078(0x160),0x1,0x0,_0x57c078(0x288)),_0x372669=getMoviesByParams(_0x11a6e2,_0x44acc7,0x2,_0x57c078(0x160),0x1,0x0,_0x57c078(0x288)),_0x40f201=_0x57c078(0x1a0),_0xa90b59=_0x57c078(0x29e)+_0x40f201+_0x57c078(0x296)+_0x44acc7[_0x57c078(0x20e)]['id']+'\x20order\x20by\x20m.create_time\x20desc\x20limit\x201',_0x51fa2e=_0x44acc7[_0x57c078(0x1d7)][_0x57c078(0x26d)]['prepare'](_0xa90b59)[_0x57c078(0x2ab)](),_0x382a7d=getMoviesByParams(_0x11a6e2,_0x44acc7,null,_0x57c078(0x160),0x1,0x0,_0x57c078(0x288),null,null,null,null,null,null,null,_0x57c078(0x1e0)),_0x1f2c77=dbFileIndexTable[_0x57c078(0x1b5)](_0x44acc7[_0x57c078(0x1d7)][_0x57c078(0x26d)],_0x57c078(0x207),dbFileIndexTable[_0x57c078(0x222)]),_0x2635e3=dbFileIndexTable[_0x57c078(0x1b5)](_0x44acc7[_0x57c078(0x1d7)]['dbFileIndex'],_0x57c078(0x2aa),dbFileIndexTable[_0x57c078(0x222)]);_0x44acc7[_0x57c078(0x242)][_0x57c078(0x19e)]=0x5af3107a3fff,_0x44acc7[_0x57c078(0x242)]['timeType']=0x1,_0x44acc7[_0x57c078(0x242)][_0x57c078(0x17c)]=_0x57c078(0x160),_0x44acc7['body'][_0x57c078(0x198)]='desc',_0x44acc7[_0x57c078(0x242)][_0x57c078(0x150)]=0x0,_0x44acc7[_0x57c078(0x242)][_0x57c078(0x1dd)]=0x1;let _0xa1b162=photoApiUtils[_0x57c078(0x17b)](_0x44acc7,_0x11a6e2),_0xa1d1b2=getMovieLibrary(_0x44acc7,_0x11a6e2),_0x195552={'movieCount':_0x1f2c77[_0x57c078(0x1dd)],'tvCount':_0x2635e3[_0x57c078(0x1dd)],'code':0x0,'movies':_0x50feb4,'tv':_0x372669,'history':_0x51fa2e,'favorites':_0x382a7d,'photos':_0xa1b162,'libraryList':_0xa1d1b2};return _0x11a6e2[_0x57c078(0x2a8)](_0x195552);}});let subtitleExtList=[_0x55cb19(0x238),_0x55cb19(0x1e8),_0x55cb19(0x23e)];router[_0x55cb19(0x281)](_0x55cb19(0x23a),(_0x15a164,_0x283c49,_0x4391bc)=>{const _0x972ec1=_0x55cb19;let _0x5a9a37=[],_0x4258a9=null;if(_0x15a164[_0x972ec1(0x242)][_0x972ec1(0x261)])_0x4258a9=_0x15a164[_0x972ec1(0x242)][_0x972ec1(0x261)],_0x4258a9=fileUtil['decodePath'](_0x4258a9);else{if(_0x15a164[_0x972ec1(0x242)]['id']){let _0x5697bc=_0x15a164[_0x972ec1(0x242)]['id'],_0x2caa9f=dbFileIndexTable[_0x972ec1(0x2a4)](_0x15a164[_0x972ec1(0x1d7)][_0x972ec1(0x26d)],_0x5697bc,dbFileIndexTable[_0x972ec1(0x222)]);_0x2caa9f&&(_0x4258a9=path['join'](_0x2caa9f['path'],_0x2caa9f['filename']),_0x15a164[_0x972ec1(0x1d7)][_0x972ec1(0x26d)]['prepare']('UPDATE\x20file_index_movie\x20set\x20check_time=?\x20WHERE\x20id=?')[_0x972ec1(0x1f0)](Date[_0x972ec1(0x19b)](),_0x2caa9f['id']));}}function _0x35aaa2(){const _0x35adc5=_0x972ec1;let _0x2d6026=dbConfigTable['findByTitle'](_0x15a164[_0x35adc5(0x1d7)][_0x35adc5(0x290)],_0x35adc5(0x1b2)),_0x2d11d9=dbConfigTable['findByTitle'](_0x15a164[_0x35adc5(0x1d7)][_0x35adc5(0x290)],_0x35adc5(0x2ad));return _0x283c49[_0x35adc5(0x2a8)]({'code':0x0,'data':_0x5a9a37,'defaultTranscodeResolution':_0x2d11d9?_0x2d11d9[_0x35adc5(0x211)]:_0x35adc5(0x15b),'userFontSize':_0x2d6026?_0x2d6026[_0x35adc5(0x211)]:1.5});}_0x4258a9?fs[_0x972ec1(0x235)](_0x4258a9,(_0x571ed6,_0x4fee2d)=>{const _0x81bcf=_0x972ec1;if(_0x571ed6)return _0x35aaa2();let _0x3b2dcb=path[_0x81bcf(0x243)](_0x4258a9);fs['readdir'](_0x3b2dcb,(_0x1568b2,_0x416dbb)=>{const _0x1bdf24=_0x81bcf;if(_0x1568b2)return _0x35aaa2();let _0x55ce35=path[_0x1bdf24(0x186)](_0x4258a9)[_0x1bdf24(0x14d)](path[_0x1bdf24(0x289)](_0x4258a9),''),_0xa0aa9a=_0x55ce35[_0x1bdf24(0x1cb)]('\x20','_');for(let _0x42f096 in _0x416dbb){let _0x33bff8=_0x416dbb[_0x42f096],_0x3d4336=path[_0x1bdf24(0x289)](_0x33bff8);(_0x33bff8[_0x1bdf24(0x225)](_0x55ce35)||_0x33bff8[_0x1bdf24(0x225)](_0xa0aa9a))&&subtitleExtList['includes'](_0x3d4336)&&_0x5a9a37[_0x1bdf24(0x1f5)]({'fileName':path[_0x1bdf24(0x186)](_0x33bff8),'filePath':path[_0x1bdf24(0x285)](_0x3b2dcb,_0x33bff8)});}return _0x35aaa2();});}):_0x35aaa2();}),router['post']('/getMovieKeys',(_0x598cfa,_0x17bc31,_0xd5d466)=>{const _0x2d5fb1=_0x55cb19;let _0x5db0f7=_0x598cfa[_0x2d5fb1(0x1d7)][_0x2d5fb1(0x26d)]['prepare'](_0x2d5fb1(0x260))[_0x2d5fb1(0x2ab)](),_0x54304c=_0x598cfa['app'][_0x2d5fb1(0x26d)][_0x2d5fb1(0x274)](_0x2d5fb1(0x275))[_0x2d5fb1(0x2ab)](),_0x1f3331=_0x598cfa[_0x2d5fb1(0x1d7)][_0x2d5fb1(0x26d)][_0x2d5fb1(0x274)](_0x2d5fb1(0x208))[_0x2d5fb1(0x2ab)]();_0x17bc31[_0x2d5fb1(0x2a8)]({'code':0x0,'data':_0x5db0f7['concat'](_0x54304c,_0x1f3331)});}),router[_0x55cb19(0x281)](_0x55cb19(0x212),(_0x129204,_0x3b53e8,_0x354d00)=>{const _0x25752e=_0x55cb19;let _0x63e66b=_0x129204[_0x25752e(0x242)]['indexId'],_0x3f12ed=dbFileIndexTable['getById'](_0x129204[_0x25752e(0x1d7)][_0x25752e(0x26d)],_0x63e66b,dbFileIndexTable[_0x25752e(0x222)]);if(!_0x3f12ed)return _0x3b53e8[_0x25752e(0x2a8)]({'code':0x0});if(dbUserTable[_0x25752e(0x1c8)](_0x129204,_0x3b53e8,'movie','power_delete',_0x3f12ed['path'])==!![])return dbFileIndexTable[_0x25752e(0x19d)](_0x129204[_0x25752e(0x1d7)]['dbFileIndex'],_0x63e66b,dbFileIndexTable[_0x25752e(0x222)]),_0x3b53e8['json']({'code':0x0});}),router['post']('/movieFavorite',(_0x5f0d9a,_0x1b987e,_0x17456f)=>{const _0x29d307=_0x55cb19;let _0x450af8=_0x5f0d9a['currentUser']['id'],_0x466a60=parseInt(_0x5f0d9a[_0x29d307(0x242)][_0x29d307(0x16a)]),_0x303bb5=dbMovieFavorite[_0x29d307(0x205)](_0x5f0d9a[_0x29d307(0x1d7)][_0x29d307(0x26d)],_0x450af8,_0x466a60),_0x3dbbb6=0x0;if(_0x303bb5)dbMovieFavorite[_0x29d307(0x14f)](_0x5f0d9a['app'][_0x29d307(0x26d)],_0x450af8,_0x466a60);else{_0x3dbbb6=0x1;let _0x53a349=new Date()[_0x29d307(0x258)]();_0x5f0d9a[_0x29d307(0x1d7)][_0x29d307(0x26d)][_0x29d307(0x274)](_0x29d307(0x181))[_0x29d307(0x1f0)](_0x53a349,_0x466a60),dbMovieFavorite[_0x29d307(0x1e6)](_0x5f0d9a[_0x29d307(0x1d7)][_0x29d307(0x26d)],_0x450af8,_0x466a60);}return _0x1b987e[_0x29d307(0x2a8)]({'code':0x0,'favorite':_0x3dbbb6});}),router[_0x55cb19(0x281)](_0x55cb19(0x22b),(_0x1e3bf6,_0x488afc,_0x3f695c)=>{const _0x252ff1=_0x55cb19;try{let _0x3b60c6=parseInt(_0x1e3bf6[_0x252ff1(0x242)]['indexId']),_0x4c8c21=dbFileIndexTable[_0x252ff1(0x2a4)](_0x1e3bf6[_0x252ff1(0x1d7)][_0x252ff1(0x26d)],_0x3b60c6,dbFileIndexTable[_0x252ff1(0x222)]);if(!_0x4c8c21)return _0x488afc[_0x252ff1(0x2a8)]({'code':0x0});let _0x38d02b=parseInt(_0x1e3bf6[_0x252ff1(0x242)]['openDuration']),_0x336a99=parseInt(_0x1e3bf6[_0x252ff1(0x242)][_0x252ff1(0x1c7)]);!_0x336a99&&(_0x336a99=0x0);!_0x38d02b&&(_0x38d02b=0x0);let _0x3f1c80=parseInt(_0x1e3bf6[_0x252ff1(0x242)][_0x252ff1(0x234)]);if(_0x38d02b<0x0||_0x336a99<0x0||_0x38d02b>_0x4c8c21[_0x252ff1(0x27c)]||_0x336a99>_0x4c8c21['duration']||_0x3f1c80!=0x0&&_0x3f1c80!=0x1)return _0x1e3bf6[_0x252ff1(0x1d7)][_0x252ff1(0x1da)](_0x488afc,'Value\x20out\x20of\x20limit');let _0x228546=[_0x4c8c21];_0x4c8c21[_0x252ff1(0x22a)]==0x1&&(_0x228546=_0x1e3bf6[_0x252ff1(0x1d7)]['dbFileIndex'][_0x252ff1(0x274)]('SELECT\x20id\x20FROM\x20'+dbFileIndexTable[_0x252ff1(0x222)]+_0x252ff1(0x278))[_0x252ff1(0x2ab)](_0x4c8c21['path']));let _0x12f977='(';for(let _0xed1ad in _0x228546){_0x12f977+=_0x228546[_0xed1ad]['id'],_0xed1ad!=_0x228546[_0x252ff1(0x1ca)]-0x1&&(_0x12f977+=',');}return _0x12f977+=')',_0x1e3bf6[_0x252ff1(0x1d7)][_0x252ff1(0x26d)][_0x252ff1(0x274)](_0x252ff1(0x18e)+_0x12f977)['run'](_0x38d02b,_0x336a99,_0x3f1c80),_0x488afc[_0x252ff1(0x2a8)]({'code':0x0});}catch(_0x312eb6){return console[_0x252ff1(0x1f6)](_0x312eb6),_0x1e3bf6[_0x252ff1(0x1d7)]['returnErrMsg'](_0x488afc,_0x488afc['__'](_0x252ff1(0x259)));}});function getMovieLibrary(_0x595f75,_0x2ae39b,_0x4d43b4){const _0x263056=_0x55cb19;let _0x107b6c=_0x595f75[_0x263056(0x242)]['offset']||0x0,_0x51af53=_0x4d43b4||_0x595f75[_0x263056(0x242)][_0x263056(0x1dd)]||0x32,_0x21e09b=_0x595f75[_0x263056(0x242)][_0x263056(0x21c)]||'',_0x4a6319=_0x595f75[_0x263056(0x242)]['orderField']||_0x263056(0x266),_0x5a65ce=_0x595f75[_0x263056(0x242)][_0x263056(0x286)]||'desc';if(!['create_time',_0x263056(0x1e7)][_0x263056(0x291)](_0x4a6319))return console[_0x263056(0x1f6)]('order\x20field\x20error',_0x4a6319),[];let _0x5a3f66=[],_0x3c8054=[],_0x10925b=_0x263056(0x213);_0x595f75[_0x263056(0x20e)][_0x263056(0x21d)]==0x1?_0x21e09b&&(_0x10925b+='\x20WHERE\x20title\x20like\x20?',_0x3c8054[_0x263056(0x1f5)]('%'+_0x21e09b+'%')):(_0x10925b=_0x263056(0x168),_0x21e09b&&(_0x10925b+=_0x263056(0x15a),_0x3c8054[_0x263056(0x1f5)]('%'+_0x21e09b+'%')));_0x10925b+=_0x263056(0x231)+_0x4a6319+'\x20'+_0x5a65ce+_0x263056(0x29d),_0x3c8054[_0x263056(0x1f5)](_0x51af53),_0x3c8054['push'](_0x107b6c),_0x5a3f66=_0x595f75[_0x263056(0x1d7)][_0x263056(0x26d)][_0x263056(0x274)](_0x10925b)['all'](_0x3c8054);if(_0x5a3f66[_0x263056(0x1ca)]<0x1)return[];for(let _0x124dd1 in _0x5a3f66){let _0x53c5ae=_0x5a3f66[_0x124dd1];try{let _0xbabb99=JSON['parse'](_0x53c5ae[_0x263056(0x20c)]),_0x9e63c=[];for(let _0x2ec196 of _0xbabb99){let _0x59f1c0=dbUserTable[_0x263056(0x26f)](_0x595f75['app'][_0x263056(0x290)],_0x2ec196,_0x263056(0x17a));_0x9e63c[_0x263056(0x1f5)](_0x59f1c0);}_0x5a3f66[_0x124dd1][_0x263056(0x22e)]=_0x9e63c;}catch(_0x2ab639){console[_0x263056(0x1f6)](_0x2ab639);}let _0x2f998a=getMoviesByParams(_0x2ae39b,_0x595f75,null,_0x263056(0x160),0x4,0x0,'desc',null,null,null,null,null,null,null,null,null,_0x5a3f66[_0x124dd1]['id']);_0x5a3f66[_0x124dd1]['dataPreview']=_0x2f998a;}return _0x5a3f66;}router['post']('/operationLibrary',(_0x42b3cb,_0x2283a9,_0x57bd4b)=>{const _0x59ee5a=_0x55cb19;let _0x1a5bd6=_0x42b3cb[_0x59ee5a(0x242)][_0x59ee5a(0x1e7)],_0x3e6a32=_0x42b3cb[_0x59ee5a(0x242)]['libraryId'],_0x33607a=_0x42b3cb[_0x59ee5a(0x242)]['pathList'],_0x16c5f8=_0x42b3cb[_0x59ee5a(0x242)][_0x59ee5a(0x182)],_0x4edeb2=_0x42b3cb[_0x59ee5a(0x242)][_0x59ee5a(0x158)],_0x5de076=_0x42b3cb[_0x59ee5a(0x242)][_0x59ee5a(0x18d)];if(_0x5de076==_0x59ee5a(0x255)){let _0x25b7d7=getMovieLibrary(_0x42b3cb,_0x2283a9);return _0x2283a9[_0x59ee5a(0x2a8)]({'code':0x0,'data':_0x25b7d7});}else{if(_0x42b3cb[_0x59ee5a(0x20e)][_0x59ee5a(0x21d)]!=0x1)return _0x42b3cb[_0x59ee5a(0x1d7)][_0x59ee5a(0x1da)](_0x2283a9,_0x2283a9['__']('noPermission'));if(_0x5de076==_0x59ee5a(0x262)||_0x5de076=='EDIT'){if(!_0x33607a||!_0x33607a instanceof Array||_0x33607a[_0x59ee5a(0x1ca)]<0x1)return _0x42b3cb[_0x59ee5a(0x1d7)]['returnErrMsg'](_0x2283a9,_0x2283a9['__'](_0x59ee5a(0x259)));if(_0x4edeb2){if(_0x16c5f8!=null&&!_0x16c5f8 instanceof Array)return _0x42b3cb[_0x59ee5a(0x1d7)][_0x59ee5a(0x1da)](_0x2283a9,_0x2283a9['__']('operationFail'));}if(sqliteUtil['checkSqlInjection'](JSON[_0x59ee5a(0x21a)](_0x33607a))==!![])return _0x42b3cb[_0x59ee5a(0x1d7)][_0x59ee5a(0x1da)](_0x2283a9,_0x59ee5a(0x206));}if(_0x5de076==_0x59ee5a(0x1b7)&&_0x3e6a32)_0x42b3cb['app'][_0x59ee5a(0x26d)]['prepare'](_0x59ee5a(0x233))[_0x59ee5a(0x1f0)](_0x1a5bd6,JSON['stringify'](_0x33607a),_0x4edeb2,JSON['stringify'](_0x16c5f8),_0x3e6a32);else{if(_0x5de076==_0x59ee5a(0x1a6)&&_0x3e6a32)_0x42b3cb[_0x59ee5a(0x1d7)][_0x59ee5a(0x26d)][_0x59ee5a(0x274)]('DELETE\x20FROM\x20movie_library\x20\x20WHERE\x20id=?')['run'](_0x3e6a32);else{if(_0x5de076==_0x59ee5a(0x262))_0x42b3cb[_0x59ee5a(0x1d7)][_0x59ee5a(0x26d)][_0x59ee5a(0x274)](_0x59ee5a(0x16d))[_0x59ee5a(0x1f0)](_0x1a5bd6,JSON[_0x59ee5a(0x21a)](_0x33607a),_0x4edeb2,JSON['stringify'](_0x16c5f8),_0x42b3cb['currentUser']['id']);else return _0x42b3cb[_0x59ee5a(0x1d7)]['returnErrMsg'](_0x2283a9,_0x2283a9['__'](_0x59ee5a(0x2a3)));}}return _0x2283a9['json']({'code':0x0});}}),module[_0x55cb19(0x23c)]=router;