const _0x3022ca=_0x204f;(function(_0x28284e,_0x2c581d){const _0x39df36=_0x204f,_0x45eae2=_0x28284e();while(!![]){try{const _0x43d9d0=-parseInt(_0x39df36(0x21c))/0x1*(-parseInt(_0x39df36(0x130))/0x2)+-parseInt(_0x39df36(0x27d))/0x3+parseInt(_0x39df36(0x1c2))/0x4+parseInt(_0x39df36(0x158))/0x5*(-parseInt(_0x39df36(0x218))/0x6)+-parseInt(_0x39df36(0x276))/0x7*(parseInt(_0x39df36(0x185))/0x8)+-parseInt(_0x39df36(0x12f))/0x9+parseInt(_0x39df36(0x1e0))/0xa*(parseInt(_0x39df36(0x1b6))/0xb);if(_0x43d9d0===_0x2c581d)break;else _0x45eae2['push'](_0x45eae2['shift']());}catch(_0x4794d2){_0x45eae2['push'](_0x45eae2['shift']());}}}(_0x2e7b,0x2304e));var express=require(_0x3022ca(0x172)),router=express[_0x3022ca(0x1d1)]();let path=require(_0x3022ca(0x1e9));const dbFileIndexTable=require(_0x3022ca(0x1ec)),dbUserTable=require(_0x3022ca(0x19e));var fs=require('fs');let config=require(_0x3022ca(0x150)),axios=require(_0x3022ca(0x14d)),sha256=require(_0x3022ca(0x228)),nasAccountUtil=require(_0x3022ca(0x1f0));const dbConfigTable=require(_0x3022ca(0x21d)),videoStreamUtil=require('../../utils/videoStreamUtil'),dbSourceFolderTable=require(_0x3022ca(0x253)),nfoUtil=require('../../utils/nfoUtil'),dbMovieFavorite=require(_0x3022ca(0x1b8)),movieUtil=require(_0x3022ca(0x145));let fileUtil=require(_0x3022ca(0x1fb));const sqliteUtil=require('../utils/sqliteUtil'),photoApiUtils=require(_0x3022ca(0x176));let movieSeasonUtil=require('../../utils/movieSeasonUtil'),movieInfoUtil=require(_0x3022ca(0x27f));const dbScanTaskTable=require(_0x3022ca(0x19d));let movieFieldStr='\x20id,collection_id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list';function getTvSeriesPoster(_0x13f6c5){const _0x1b876d=_0x3022ca;let _0x21f308='',_0x54d344=path[_0x1b876d(0x14f)](path[_0x1b876d(0x1e6)](_0x13f6c5[_0x1b876d(0x1e9)]),_0x1b876d(0x1cb));return fs[_0x1b876d(0x277)](_0x54d344)&&(_0x21f308=_0x54d344),!_0x21f308&&(_0x54d344=path[_0x1b876d(0x14f)](path[_0x1b876d(0x1e6)](_0x13f6c5[_0x1b876d(0x1e9)]),_0x1b876d(0x273)),fs[_0x1b876d(0x277)](_0x54d344)&&(_0x21f308=_0x54d344)),!_0x21f308&&(_0x54d344=path[_0x1b876d(0x14f)](path['dirname'](_0x13f6c5[_0x1b876d(0x1e9)]),_0x1b876d(0x20f)),fs['existsSync'](_0x54d344)&&(_0x21f308=_0x54d344)),!_0x21f308&&(_0x54d344=path['join'](path[_0x1b876d(0x1e6)](_0x13f6c5[_0x1b876d(0x1e9)]),_0x1b876d(0x258)),fs[_0x1b876d(0x277)](_0x54d344)&&(_0x21f308=_0x54d344)),_0x21f308;}router[_0x3022ca(0x264)]('/getTvSeriesDetail',(_0x468f83,_0x4563b3,_0x512ec6)=>{const _0x459182=_0x3022ca;let _0xb922a9=_0x468f83[_0x459182(0x183)]['id'],_0x38ef07=dbFileIndexTable[_0x459182(0x285)](_0x468f83[_0x459182(0x250)]['dbFileIndex'],_0xb922a9,dbFileIndexTable[_0x459182(0x191)]);if(!_0x38ef07)return _0x468f83[_0x459182(0x250)][_0x459182(0x230)](_0x4563b3,_0x4563b3['__'](_0x459182(0x168)));if(dbUserTable[_0x459182(0x13b)](_0x468f83,_0x4563b3,_0x459182(0x1a9),_0x459182(0x188),_0x38ef07[_0x459182(0x1e9)])==!![]){let _0x883cf9=dbUserTable[_0x459182(0x265)](_0x468f83,'movie',_0x459182(0x188),!![]),_0x7c1fb0=_0x459182(0x1f6);_0x7c1fb0+=_0x883cf9,_0x7c1fb0+='\x20order\x20by\x20check_time\x20desc\x20limit\x2010\x20',nfoUtil[_0x459182(0x27b)](_0x38ef07)['then'](_0x274a8c=>{const _0x43be21=_0x459182;_0x38ef07=_0x274a8c,_0x468f83['body'][_0x43be21(0x22c)]=!![],_0x468f83['body'][_0x43be21(0x1c3)]=0x1,_0x38ef07=addFolderCoverPath(_0x4563b3,_0x468f83,_0x38ef07),_0x5558ba();})[_0x459182(0x1bd)](_0x44a2d4=>{const _0x381863=_0x459182;console[_0x381863(0x1d4)](_0x381863(0x135),_0x44a2d4),_0x38ef07=addFolderCoverPath(_0x4563b3,_0x468f83,_0x38ef07),_0x38ef07[_0x381863(0x171)]=_0x38ef07[_0x381863(0x212)],_0x5558ba();});function _0x5558ba(){const _0x43a1bf=_0x459182;addTvFolderPathAndName(_0x38ef07),setLogoAndFanart(_0x468f83,_0x38ef07,_0x38ef07[_0x43a1bf(0x197)]);let _0x3fe18a=dbMovieFavorite[_0x43a1bf(0x16c)](_0x468f83[_0x43a1bf(0x250)][_0x43a1bf(0x21a)],_0x468f83[_0x43a1bf(0x1a0)]['id'],_0x38ef07['id']);_0x3fe18a?_0x38ef07[_0x43a1bf(0x12c)]=0x1:_0x38ef07[_0x43a1bf(0x12c)]=0x0;let _0x415ccc={'code':0x0,'movieIndex':_0x38ef07};fs[_0x43a1bf(0x142)](_0x38ef07[_0x43a1bf(0x197)],(_0xdf2d91,_0x13e3b8)=>{const _0x567ad5=_0x43a1bf;_0x415ccc[_0x567ad5(0x269)]=_0xdf2d91?0x0:0x1,_0x4563b3[_0x567ad5(0x1d8)](_0x415ccc),_0x38ef07['is_tvplay']==0x1&&_0x38ef07[_0x567ad5(0x197)]&&(dbScanTaskTable['addScanTask'](_0x468f83['app'][_0x567ad5(0x1f8)],_0x567ad5(0x1a9),_0x38ef07['tvFolderPath']),process[_0x567ad5(0x25b)]({'type':_0x567ad5(0x1e3),'source_type':'movie','restartWatcher':![]}));});}}}),router[_0x3022ca(0x264)](_0x3022ca(0x204),(_0x43adc7,_0x5211d6,_0x292fd6)=>{const _0xf3aeee=_0x3022ca;let _0xb86d2d=_0x43adc7['body']['id'],_0x4e74f9=dbFileIndexTable[_0xf3aeee(0x285)](_0x43adc7[_0xf3aeee(0x250)][_0xf3aeee(0x21a)],_0xb86d2d,dbFileIndexTable[_0xf3aeee(0x191)]);if(!_0x4e74f9)return _0x43adc7['app'][_0xf3aeee(0x230)](_0x5211d6,_0x5211d6['__'](_0xf3aeee(0x168)));if(dbUserTable[_0xf3aeee(0x13b)](_0x43adc7,_0x5211d6,_0xf3aeee(0x1a9),_0xf3aeee(0x188),_0x4e74f9[_0xf3aeee(0x1e9)])==!![]){let _0x5172eb=dbUserTable[_0xf3aeee(0x265)](_0x43adc7,_0xf3aeee(0x1a9),_0xf3aeee(0x188),!![]),_0x3e3481=_0xf3aeee(0x1f6);_0x3e3481+=_0x5172eb,_0x3e3481+=_0xf3aeee(0x1e2),nfoUtil['parseNfo'](_0x4e74f9,!![],![])[_0xf3aeee(0x165)](_0xc211f6=>{const _0x23355f=_0xf3aeee;_0x4e74f9=_0xc211f6,_0x43adc7[_0x23355f(0x183)][_0x23355f(0x22c)]=!![],_0x4e74f9=addFolderCoverPath(_0x5211d6,_0x43adc7,_0x4e74f9),movieInfoUtil['saveMovieInfoToDb'](_0x43adc7[_0x23355f(0x250)][_0x23355f(0x21a)],_0x4e74f9['id'],_0xc211f6),_0xa906c0();})[_0xf3aeee(0x1bd)](()=>{_0x4e74f9=addFolderCoverPath(_0x5211d6,_0x43adc7,_0x4e74f9),_0xa906c0();});function _0xa906c0(){const _0x4a3d86=_0xf3aeee;let _0x54080b=dbMovieFavorite[_0x4a3d86(0x16c)](_0x43adc7['app'][_0x4a3d86(0x21a)],_0x43adc7['currentUser']['id'],_0x4e74f9['id']);_0x54080b?_0x4e74f9[_0x4a3d86(0x12c)]=0x1:_0x4e74f9['favorite']=0x0;let _0x376ffe=null;if(_0x4e74f9[_0x4a3d86(0x136)]==0x1){let _0x1b15f6=_0x43adc7[_0x4a3d86(0x250)][_0x4a3d86(0x21a)][_0x4a3d86(0x281)](_0x4a3d86(0x242)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20')[_0x4a3d86(0x205)](_0x4e74f9[_0x4a3d86(0x1e9)]),_0x570ce1='(';for(let _0x3073be in _0x1b15f6){_0x570ce1+=_0x1b15f6[_0x3073be]['id'],_0x3073be!=_0x1b15f6[_0x4a3d86(0x275)]-0x1&&(_0x570ce1+=',');}_0x570ce1+=')';let _0x5354ad=_0x43adc7[_0x4a3d86(0x250)]['dbFileIndex']['prepare'](_0x4a3d86(0x15c)+_0x570ce1+_0x4a3d86(0x284))[_0x4a3d86(0x153)]();_0x5354ad&&(_0x376ffe=dbFileIndexTable['getById'](_0x43adc7[_0x4a3d86(0x250)][_0x4a3d86(0x21a)],_0x5354ad[_0x4a3d86(0x278)],dbFileIndexTable[_0x4a3d86(0x191)]));}let _0x22a94e={'code':0x0,'movieIndex':_0x4e74f9,'lastTvEpisodeIndex':_0x376ffe},_0x2735bf=[];try{let _0x41b016=_0x43adc7[_0x4a3d86(0x250)]['dbFileIndex'][_0x4a3d86(0x281)](_0x4a3d86(0x18b)+_0x4e74f9[_0x4a3d86(0x1e9)]+_0x4a3d86(0x1f3))[_0x4a3d86(0x205)]();for(let _0x2babf9 in _0x41b016){let _0x542286=path[_0x4a3d86(0x14f)](_0x41b016[_0x2babf9][_0x4a3d86(0x1e9)],_0x41b016[_0x2babf9][_0x4a3d86(0x287)]);(_0x43adc7[_0x4a3d86(0x1a0)][_0x4a3d86(0x156)]==0x1||dbUserTable[_0x4a3d86(0x13b)](_0x43adc7,_0x5211d6,_0x4a3d86(0x211),_0x4a3d86(0x188),_0x542286,!![])==!![])&&_0x2735bf[_0x4a3d86(0x14e)](_0x542286);}_0x22a94e[_0x4a3d86(0x1ff)]=_0x2735bf;}catch(_0x338f71){}let _0x2544d3=path['join'](_0x4e74f9[_0x4a3d86(0x1e9)],_0x4e74f9[_0x4a3d86(0x287)]);fs[_0x4a3d86(0x142)](_0x2544d3,(_0x3cbef7,_0x3c0914)=>{const _0x5d707e=_0x4a3d86;_0x22a94e['fileExist']=_0x3cbef7?0x0:0x1,_0x22a94e[_0x5d707e(0x223)]=_0x2544d3,_0x5211d6[_0x5d707e(0x1d8)](_0x22a94e),_0x4e74f9[_0x5d707e(0x136)]==0x1&&_0x4e74f9['tvFolderPath']&&_0x4e74f9[_0x5d707e(0x1be)]!=0x1&&(dbScanTaskTable[_0x5d707e(0x1ac)](_0x43adc7[_0x5d707e(0x250)][_0x5d707e(0x1f8)],_0x5d707e(0x1a9),_0x4e74f9[_0x5d707e(0x197)]),process[_0x5d707e(0x25b)]({'type':_0x5d707e(0x1e3),'source_type':_0x5d707e(0x1a9),'restartWatcher':![]}));});}}}),router[_0x3022ca(0x264)](_0x3022ca(0x26c),(_0xb7a7a0,_0x2c4d2f,_0x3727fe)=>{const _0x3da592=_0x3022ca;let _0x58d422=_0xb7a7a0[_0x3da592(0x183)]['id'],_0x2da95b=_0xb7a7a0[_0x3da592(0x183)][_0x3da592(0x1bf)]||0x0,_0x15014f=_0xb7a7a0[_0x3da592(0x183)][_0x3da592(0x214)]||0xa,_0x55e29c=_0xb7a7a0['body'][_0x3da592(0x1d0)],_0x3ad74b=_0xb7a7a0['body'][_0x3da592(0x17b)],_0x44820b=_0xb7a7a0[_0x3da592(0x183)][_0x3da592(0x22d)],_0x5b2516=_0xb7a7a0['body'][_0x3da592(0x1cf)],_0x359e6e=dbFileIndexTable[_0x3da592(0x285)](_0xb7a7a0[_0x3da592(0x250)][_0x3da592(0x21a)],_0x58d422,dbFileIndexTable[_0x3da592(0x191)]);if(!_0x359e6e)return _0xb7a7a0['app']['returnErrMsg'](_0x2c4d2f,_0x2c4d2f['__'](_0x3da592(0x168)));let _0x346193=movieFieldStr,_0x74fc11=[],_0x23a4a3=0x0;if(dbUserTable['doUserCanGet'](_0xb7a7a0,_0x2c4d2f,_0x3da592(0x1a9),'power_get',_0x359e6e[_0x3da592(0x1e9)])==!![]){if(_0x44820b==0x1)return _0x45e587();let _0x515923=_0xb7a7a0[_0x3da592(0x250)][_0x3da592(0x21a)][_0x3da592(0x281)](_0x3da592(0x24d)+dbFileIndexTable[_0x3da592(0x191)]+_0x3da592(0x132))[_0x3da592(0x205)](_0x359e6e['path']);for(let _0x25f397 in _0x515923){let _0x3b5552=_0x515923[_0x25f397];if(_0x3b5552[_0x3da592(0x287)]){let _0x5686a4=movieUtil[_0x3da592(0x1aa)](_0x3b5552[_0x3da592(0x287)]);_0xb7a7a0[_0x3da592(0x250)][_0x3da592(0x21a)][_0x3da592(0x281)](_0x3da592(0x154)+dbFileIndexTable[_0x3da592(0x191)]+_0x3da592(0x22b))[_0x3da592(0x1de)](_0x5686a4,_0x3b5552['id']);}}let _0x368929=dbUserTable[_0x3da592(0x265)](_0xb7a7a0,_0x3da592(0x1a9),_0x3da592(0x188),!![]),_0x4c6ff9=_0x3da592(0x1b0);_0x4c6ff9+=_0x368929,_0x4c6ff9+='\x20and\x20path=?\x20and\x20is_tvplay=1\x20';_0x55e29c&&(_0x4c6ff9+=_0x3da592(0x1ca));if(_0x3ad74b){let _0x3b589b=movieUtil[_0x3da592(0x1aa)](_0x3ad74b);_0x3b589b?_0x4c6ff9+='\x20and\x20filename_number\x20>=\x20?\x20':_0x4c6ff9+='\x20and\x20filename\x20>=\x20?\x20';}let _0x4141ed=_0x4c6ff9;_0x4c6ff9+=_0x3da592(0x255);let _0x46518d=_0x3da592(0x17c)+_0x346193+_0x3da592(0x13f)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x3da592(0x13e)+_0x4c6ff9+'\x20LIMIT\x20'+_0x15014f+'\x20OFFSET\x20'+_0x2da95b*_0x15014f;_0x74fc11=_0xb7a7a0[_0x3da592(0x250)][_0x3da592(0x21a)][_0x3da592(0x281)](_0x46518d);if(_0x55e29c&&_0x3ad74b)_0x74fc11=_0x74fc11[_0x3da592(0x205)](_0x359e6e['path'],'%'+_0x55e29c+'%','%'+_0x55e29c+'%');else{if(_0x55e29c)_0x74fc11=_0x74fc11['all'](_0x359e6e[_0x3da592(0x1e9)],'%'+_0x55e29c+'%','%'+_0x55e29c+'%');else{if(_0x3ad74b){let _0x12502e=movieUtil['getFilenameNumber'](_0x3ad74b);_0x74fc11=_0x74fc11[_0x3da592(0x205)](_0x359e6e[_0x3da592(0x1e9)],_0x12502e?_0x12502e:_0x3ad74b);}else _0x74fc11=_0x74fc11[_0x3da592(0x205)](_0x359e6e[_0x3da592(0x1e9)]);}}let _0x3279e8=_0x3da592(0x226)+dbFileIndexTable[_0x3da592(0x191)]+_0x3da592(0x1d3)+_0x4141ed+'\x20',_0x525c2c=_0xb7a7a0['app'][_0x3da592(0x21a)][_0x3da592(0x281)](_0x3279e8);if(_0x55e29c&&_0x3ad74b)_0x525c2c=_0x525c2c['get'](_0x359e6e[_0x3da592(0x1e9)],'%'+_0x55e29c+'%','%'+_0x55e29c+'%');else{if(_0x55e29c)_0x525c2c=_0x525c2c[_0x3da592(0x153)](_0x359e6e[_0x3da592(0x1e9)],'%'+_0x55e29c+'%','%'+_0x55e29c+'%');else _0x3ad74b?_0x525c2c=_0x525c2c[_0x3da592(0x153)](_0x359e6e[_0x3da592(0x1e9)],_0x3ad74b):_0x525c2c=_0x525c2c[_0x3da592(0x153)](_0x359e6e[_0x3da592(0x1e9)]);}_0x23a4a3=_0x525c2c[_0x3da592(0x202)];if(_0x74fc11[_0x3da592(0x275)]>0x0){let _0x1739ff=0x0;for(let _0x1c55d6 in _0x74fc11){let _0x1d4566=_0x74fc11[_0x1c55d6];nfoUtil['parseNfo'](_0x1d4566,!![],!![])['then'](_0x3fae29=>{_0x1739ff+=0x1,_0x74fc11[_0x1c55d6]=_0x3fae29,_0x74fc11[_0x1c55d6]=addFolderCoverPath(_0x2c4d2f,_0xb7a7a0,_0x74fc11[_0x1c55d6],!![]),_0x1739ff>=_0x74fc11['length']&&_0x45e587();})[_0x3da592(0x1bd)](()=>{const _0x1298a2=_0x3da592;_0x1739ff+=0x1,_0x74fc11[_0x1c55d6]=addFolderCoverPath(_0x2c4d2f,_0xb7a7a0,_0x74fc11[_0x1c55d6],!![]),_0x1739ff>=_0x74fc11[_0x1298a2(0x275)]&&_0x45e587();});}}else _0x45e587();function _0x45e587(){const _0xa4c367=_0x3da592;let _0x1359cc={'code':0x0,'tvplayList':_0x74fc11,'count':_0x23a4a3,'pageSize':_0x15014f};if(!_0x5b2516){let _0xde52ad=path[_0xa4c367(0x13d)](_0x359e6e[_0xa4c367(0x1e9)]),_0x2d153a=movieSeasonUtil[_0xa4c367(0x1bc)](_0xde52ad);if(_0x2d153a>-0x1){let _0x399a6c=_0xa4c367(0x17c)+_0x346193+_0xa4c367(0x13f)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20as\x20f\x20WHERE\x20path\x20like\x20?\x20and\x20is_tvplay=1\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20limit\x20200',_0x3f4e81=_0xb7a7a0['app'][_0xa4c367(0x21a)][_0xa4c367(0x281)](_0x399a6c)[_0xa4c367(0x205)](path[_0xa4c367(0x1e6)](_0x359e6e[_0xa4c367(0x1e9)])+path[_0xa4c367(0x1ae)]+'%'),_0x509e7c=[];for(let _0x40b2e1 of _0x3f4e81){let _0x5bfc70=path['basename'](_0x40b2e1[_0xa4c367(0x1e9)]),_0x218013=movieSeasonUtil[_0xa4c367(0x1bc)](_0x5bfc70);_0x218013>-0x1&&(_0x40b2e1['seasonNumber']=_0x218013,_0x509e7c[_0xa4c367(0x14e)](_0x40b2e1));}for(let _0x135f0d of _0x509e7c){_0x135f0d=addFolderCoverPath(_0x2c4d2f,_0xb7a7a0,_0x135f0d);let _0x231e88=dbFileIndexTable['getTvCount'](_0xb7a7a0[_0xa4c367(0x250)]['dbFileIndex'],_0x135f0d);_0x135f0d['tvCount']=_0x231e88['count'];}_0x509e7c['length']>0x0&&(_0x509e7c[_0xa4c367(0x221)](function(_0x49cdbc,_0x382ce6){const _0x376997=_0xa4c367;return _0x49cdbc[_0x376997(0x254)]-_0x382ce6[_0x376997(0x254)];}),_0x1359cc[_0xa4c367(0x14a)]=_0x509e7c);}}return _0x2c4d2f[_0xa4c367(0x1d8)](_0x1359cc);}}}),router['post'](_0x3022ca(0x220),(_0x4b38c6,_0x43c097,_0x2a0645)=>{const _0x111d53=_0x3022ca;let _0x658ff2=_0x4b38c6[_0x111d53(0x183)]['indexIdList'],_0x17f100=[];for(let _0x847796 of _0x658ff2){let _0xfafe53=dbFileIndexTable[_0x111d53(0x285)](_0x4b38c6[_0x111d53(0x250)]['dbFileIndex'],_0x847796,dbFileIndexTable[_0x111d53(0x191)]);if(!_0xfafe53)continue;if(dbUserTable['doUserCanGet'](_0x4b38c6,_0x43c097,'',_0x111d53(0x213),_0xfafe53['path'])!==!![])continue;let _0x557d6a=path[_0x111d53(0x13d)](_0xfafe53[_0x111d53(0x1e9)]),_0xf4795=movieSeasonUtil[_0x111d53(0x1bc)](_0x557d6a);if(_0xf4795>-0x1){let _0x4c1c15=path[_0x111d53(0x14f)](path[_0x111d53(0x1e6)](_0xfafe53[_0x111d53(0x1e9)])),_0x2b66df=_0x4b38c6[_0x111d53(0x250)][_0x111d53(0x21a)][_0x111d53(0x281)]('select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2')['all'](_0x4c1c15+path[_0x111d53(0x1ae)]+'%',_0x4c1c15);for(let _0xc9bf0c of _0x2b66df){_0x17f100['push'](_0xc9bf0c['id']);}}}_0x17f100['length']>0x0&&(_0x658ff2=[..._0x658ff2,..._0x17f100]);if(_0x658ff2[_0x111d53(0x275)]<0x1)return _0x43c097[_0x111d53(0x1d8)]({'code':0x0});let _0xe8eddb='(';for(let _0x24615b in _0x658ff2){_0xe8eddb+=_0x658ff2[_0x24615b],_0x24615b!=_0x658ff2[_0x111d53(0x275)]-0x1&&(_0xe8eddb+=',');}return _0xe8eddb+=')',_0x4b38c6[_0x111d53(0x250)][_0x111d53(0x21a)]['prepare']('UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20WHERE\x20id\x20in\x20'+_0xe8eddb)[_0x111d53(0x1de)](),_0x43c097[_0x111d53(0x1d8)]({'code':0x0});}),router['post']('/addIndexToCollection',(_0x4f7cc2,_0x38a704,_0x45550c)=>{const _0xf04179=_0x3022ca;let _0xe17eb2=_0x4f7cc2[_0xf04179(0x183)][_0xf04179(0x174)],_0x261f8d=_0x4f7cc2[_0xf04179(0x183)][_0xf04179(0x1b3)],_0x556bf9=_0x4f7cc2['body']['filepath'];function _0x421614(_0x5ab469){const _0x1a176f=_0xf04179;let _0x40aed7=[];for(let _0x3381fa in _0x5ab469){_0x40aed7['push'](_0x5ab469[_0x3381fa]['id']);}inSql='(';for(let _0x569871 in _0x40aed7){inSql+=_0x40aed7[_0x569871],_0x569871!=_0x40aed7[_0x1a176f(0x275)]-0x1&&(inSql+=',');}return inSql+=')',inSql;}if(_0xe17eb2&&_0x261f8d){let _0x14bcd3=dbFileIndexTable['getById'](_0x4f7cc2[_0xf04179(0x250)]['dbFileIndex'],_0x261f8d,dbFileIndexTable[_0xf04179(0x191)]),_0x38984d='('+_0x261f8d+')';if(!_0x14bcd3)return _0x4f7cc2[_0xf04179(0x250)][_0xf04179(0x230)](_0x38a704,_0x38a704['__']('operationFail'),_0xf04179(0x18a));if(dbUserTable[_0xf04179(0x13b)](_0x4f7cc2,_0x38a704,'','power_change',_0x14bcd3[_0xf04179(0x1e9)])!==!![])return;let _0x5c972a=path[_0xf04179(0x13d)](_0x14bcd3['path']),_0x459b24=movieSeasonUtil[_0xf04179(0x1bc)](_0x5c972a);_0x459b24>-0x1&&(_0x14bcd3['is_file']=0x0,_0x14bcd3[_0xf04179(0x1e9)]=path[_0xf04179(0x1e6)](_0x14bcd3[_0xf04179(0x1e9)]),_0x14bcd3[_0xf04179(0x287)]='');if(_0x14bcd3[_0xf04179(0x1cc)]!=0x1){let _0x574a95=path[_0xf04179(0x14f)](_0x14bcd3[_0xf04179(0x1e9)],_0x14bcd3['filename']);console['log'](_0xf04179(0x272),_0x574a95);let _0x3eba80=_0x4f7cc2[_0xf04179(0x250)][_0xf04179(0x21a)][_0xf04179(0x281)]('select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2')['all'](_0x574a95+path[_0xf04179(0x1ae)]+'%',_0x574a95);if(_0x3eba80['length']<0x1)return _0x38a704[_0xf04179(0x1d8)]({'code':0x0});_0x38984d=_0x421614(_0x3eba80);}return _0x4f7cc2[_0xf04179(0x250)][_0xf04179(0x21a)][_0xf04179(0x281)](_0xf04179(0x27a)+_0x38984d+'\x20and\x20show_in_list=1')[_0xf04179(0x1de)](_0xe17eb2),_0x38a704[_0xf04179(0x1d8)]({'code':0x0});}else{if(_0xe17eb2&&_0x556bf9){let _0x430730=_0x4f7cc2[_0xf04179(0x250)]['dbFileIndex'][_0xf04179(0x281)](_0xf04179(0x266))[_0xf04179(0x205)](_0x556bf9+path['sep']+'%',_0x556bf9),_0x4fd701=_0x421614(_0x430730);return _0x4f7cc2[_0xf04179(0x250)][_0xf04179(0x21a)][_0xf04179(0x281)](_0xf04179(0x27a)+_0x4fd701+'\x20and\x20show_in_list=1')[_0xf04179(0x1de)](_0xe17eb2),_0x38a704[_0xf04179(0x1d8)]({'code':0x0});}else return _0x4f7cc2[_0xf04179(0x250)][_0xf04179(0x230)](_0x38a704,_0x38a704['__'](_0xf04179(0x1ce)),'dialog');}});function getCollectionList(_0x1d4746,_0x300cc2,_0x48ac14){const _0x403ef0=_0x3022ca;let _0x4a8b78=[],_0x2e4fa3=_0x1d4746[_0x403ef0(0x183)]['count']||0x32,_0x157713=_0x1d4746[_0x403ef0(0x183)][_0x403ef0(0x208)]||0x0,_0x13246b=_0x1d4746[_0x403ef0(0x183)][_0x403ef0(0x1a5)]||'id',_0x22ae14=_0x1d4746[_0x403ef0(0x183)]['orderType']||'desc',_0x282e93=_0x1d4746[_0x403ef0(0x183)][_0x403ef0(0x268)],_0x3bab10=_0x403ef0(0x241),_0x35e831=_0x403ef0(0x133)+_0x3bab10+_0x403ef0(0x195),_0xd94e0c=[_0x48ac14];_0x282e93&&(_0x35e831+='\x20AND\x20title\x20like\x20?\x20',_0xd94e0c[_0x403ef0(0x14e)]('%'+_0x282e93+'%'));_0x1d4746[_0x403ef0(0x1a0)][_0x403ef0(0x156)]!=0x1&&(_0x35e831+=_0x403ef0(0x210),_0xd94e0c[_0x403ef0(0x14e)](0x1));_0x35e831+=_0x403ef0(0x1f5)+_0x13246b+'\x20'+_0x22ae14+'\x20LIMIT\x20?\x20OFFSET\x20?',_0xd94e0c['push'](_0x2e4fa3),_0xd94e0c['push'](_0x157713),_0x4a8b78=_0x1d4746['app']['dbFileIndex'][_0x403ef0(0x281)](_0x35e831)[_0x403ef0(0x205)](_0xd94e0c);for(let _0x1d0100 of _0x4a8b78){if(_0x1d0100['enable_pwd']==0x1)continue;let _0x300364=getMoviesByParams(_0x300cc2,_0x1d4746,null,'id',0x1,0x0,_0x403ef0(0x177),null,null,null,null,null,null,_0x1d0100['id']);_0x300364[_0x403ef0(0x275)]>0x0&&(_0x1d0100[_0x403ef0(0x17a)]=_0x300364[0x0]);}return _0x4a8b78;}function _0x204f(_0x1960b2,_0x33e109){const _0x2e7b4b=_0x2e7b();return _0x204f=function(_0x204f22,_0x1f0dcf){_0x204f22=_0x204f22-0x12b;let _0x3ddfd7=_0x2e7b4b[_0x204f22];return _0x3ddfd7;},_0x204f(_0x1960b2,_0x33e109);}router[_0x3022ca(0x264)](_0x3022ca(0x147),(_0x43e450,_0x3d72e6,_0x5837f0)=>{const _0x1fe0c6=_0x3022ca;let _0x17345a=_0x43e450[_0x1fe0c6(0x183)][_0x1fe0c6(0x26e)]||'ordinary',_0x2af660=getCollectionList(_0x43e450,_0x3d72e6,_0x17345a);return _0x3d72e6[_0x1fe0c6(0x1d8)]({'code':0x0,'data':_0x2af660});}),router[_0x3022ca(0x264)](_0x3022ca(0x1fa),(_0x2539d6,_0x15f2e8,_0xe49a5)=>{const _0x5c1704=_0x3022ca;let _0x1eb348=_0x2539d6[_0x5c1704(0x183)][_0x5c1704(0x1c6)],_0x29a0ec=_0x2539d6[_0x5c1704(0x183)]['collectionId'];if(!_0x1eb348)return _0x2539d6[_0x5c1704(0x250)][_0x5c1704(0x230)](_0x15f2e8,_0x15f2e8['__']('pwdCanNotBeNull'),_0x5c1704(0x18a));_0x1eb348=sha256(_0x1eb348);let _0x3e6931=_0x2539d6[_0x5c1704(0x250)][_0x5c1704(0x21a)][_0x5c1704(0x281)](_0x5c1704(0x20a))[_0x5c1704(0x153)](_0x29a0ec,_0x1eb348);if(!_0x3e6931)return _0x2539d6['app'][_0x5c1704(0x230)](_0x15f2e8,_0x15f2e8['__'](_0x5c1704(0x1a1)),_0x5c1704(0x18a));return _0x15f2e8[_0x5c1704(0x1d8)]({'code':0x0,'data':_0x3e6931});}),router[_0x3022ca(0x264)](_0x3022ca(0x23b),(_0x194c97,_0x2de60f,_0x1370b6)=>{const _0x4b832d=_0x3022ca;let _0x5cbc6c=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x243)],_0x91157f=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x164)],_0x25aaba=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x1c6)],_0x252836=_0x194c97['body'][_0x4b832d(0x174)],_0x101c3a=_0x194c97[_0x4b832d(0x183)]['type']?_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x26e)]:'ordinary',_0x63b5b3=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x1b2)]?_0x194c97[_0x4b832d(0x183)]['data']:'',_0x4407bc=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x1f4)]?_0x194c97[_0x4b832d(0x183)]['coverPath']:'',_0x56c91c=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x259)];_0x56c91c==null&&(_0x56c91c=0x1);if(_0x101c3a=='smart'){if(!_0x63b5b3||!_0x63b5b3[_0x4b832d(0x148)]||sqliteUtil['checkSqlInjection'](_0x63b5b3[_0x4b832d(0x148)])==!![])return _0x194c97[_0x4b832d(0x250)][_0x4b832d(0x230)](_0x2de60f,_0x4b832d(0x247));}let _0x4a2eff=_0x194c97[_0x4b832d(0x183)][_0x4b832d(0x1e7)]?_0x194c97[_0x4b832d(0x183)]['dataValue']:'';if(_0x194c97['currentUser'][_0x4b832d(0x156)]!=0x1)return _0x194c97[_0x4b832d(0x250)]['returnErrMsg'](_0x2de60f,_0x2de60f['__'](_0x4b832d(0x251)));if(_0x91157f=='1'){if(!_0x25aaba)return _0x194c97[_0x4b832d(0x250)][_0x4b832d(0x230)](_0x2de60f,_0x2de60f['__']('pwdCanNotBeNull'),_0x4b832d(0x18a));_0x25aaba=sha256(_0x25aaba);}return _0x252836?_0x194c97['app'][_0x4b832d(0x21a)][_0x4b832d(0x281)](_0x4b832d(0x1e5))['run'](_0x5cbc6c,JSON[_0x4b832d(0x25d)](_0x63b5b3),_0x91157f+'',_0x25aaba,_0x4407bc,_0x4a2eff,_0x56c91c,_0x252836):_0x194c97['app']['dbFileIndex']['prepare'](_0x4b832d(0x14b))['run'](_0x5cbc6c,_0x91157f+'',_0x25aaba,_0x194c97[_0x4b832d(0x1a0)]['id']+'',_0x101c3a,JSON[_0x4b832d(0x25d)](_0x63b5b3),_0x4407bc,_0x4a2eff,_0x56c91c),_0x2de60f[_0x4b832d(0x1d8)]({'code':0x0});}),router['post'](_0x3022ca(0x261),(_0x20a117,_0x25678b,_0x20a819)=>{const _0x443cfe=_0x3022ca;let _0x107a43=_0x20a117['body'][_0x443cfe(0x174)];if(_0x20a117[_0x443cfe(0x1a0)][_0x443cfe(0x156)]!=0x1)return _0x20a117[_0x443cfe(0x250)]['returnErrMsg'](_0x25678b,_0x25678b['__']('noPermission'));return _0x20a117['app'][_0x443cfe(0x21a)]['prepare'](_0x443cfe(0x1ea))[_0x443cfe(0x1de)](_0x107a43),_0x20a117[_0x443cfe(0x250)]['dbFileIndex']['prepare'](_0x443cfe(0x1c5))[_0x443cfe(0x1de)](_0x107a43),_0x25678b['json']({'code':0x0});}),router[_0x3022ca(0x264)](_0x3022ca(0x134),(_0x93a95d,_0x3be978,_0x4fbb89)=>{const _0x538839=_0x3022ca;return _0x93a95d[_0x538839(0x250)][_0x538839(0x21a)][_0x538839(0x281)](_0x538839(0x286)+_0x93a95d[_0x538839(0x1a0)]['id'])[_0x538839(0x1de)](),_0x3be978[_0x538839(0x1d8)]({'code':0x0});}),router[_0x3022ca(0x264)](_0x3022ca(0x1d2),(_0x19e984,_0x33f0f8,_0x12c2a2)=>{const _0x48dbbd=_0x3022ca;let _0x12dabd=_0x19e984[_0x48dbbd(0x183)][_0x48dbbd(0x1b3)],_0x90028f=_0x19e984[_0x48dbbd(0x183)]['time'],_0x45358c=dbFileIndexTable[_0x48dbbd(0x285)](_0x19e984['app']['dbFileIndex'],_0x12dabd,dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);if(!_0x45358c)return _0x33f0f8[_0x48dbbd(0x1d8)]({'code':0x0});if(_0x45358c[_0x48dbbd(0x262)]){let _0x5af194=_0x19e984[_0x48dbbd(0x250)][_0x48dbbd(0x21a)][_0x48dbbd(0x281)](_0x48dbbd(0x16a))['get'](_0x45358c[_0x48dbbd(0x262)]);if(_0x5af194&&_0x5af194[_0x48dbbd(0x271)]==0x1)return _0x33f0f8[_0x48dbbd(0x1d8)]({'code':0x0});}let _0x4e19b0=_0x19e984[_0x48dbbd(0x250)][_0x48dbbd(0x21a)]['prepare'](_0x48dbbd(0x18d))['get'](_0x12dabd+'',_0x19e984['currentUser']['id']+'');return _0x4e19b0?_0x19e984['app']['dbFileIndex']['prepare'](_0x48dbbd(0x15e))[_0x48dbbd(0x1de)](_0x90028f,new Date()[_0x48dbbd(0x20e)](),_0x12dabd+'',_0x19e984['currentUser']['id']+''):_0x19e984[_0x48dbbd(0x250)][_0x48dbbd(0x21a)][_0x48dbbd(0x281)](_0x48dbbd(0x1eb))[_0x48dbbd(0x1de)](_0x12dabd+'',_0x19e984['currentUser']['id']+'',_0x90028f,new Date()['getTime']()),_0x33f0f8['json']({'code':0x0});}),router['post'](_0x3022ca(0x22a),(_0x31c811,_0x438cc5,_0x18850f)=>{const _0x1c259f=_0x3022ca;let _0x106044=_0x31c811['body']['indexId'],_0x3d9a6a=_0x1c259f(0x22e);if(_0x106044){let _0x35cc17=_0x31c811[_0x1c259f(0x250)]['dbFileIndex']['prepare'](_0x1c259f(0x245))['get'](_0x31c811[_0x1c259f(0x1a0)]['id']+'',_0x106044+'');return _0x438cc5[_0x1c259f(0x1d8)]({'code':0x0,'data':_0x35cc17});}else{let _0x1694a6='SELECT\x20'+_0x3d9a6a+_0x1c259f(0x175)+_0x31c811[_0x1c259f(0x1a0)]['id']+'\x20order\x20by\x20m.create_time\x20desc\x20limit\x2050',_0x3c33b9=_0x31c811[_0x1c259f(0x250)][_0x1c259f(0x21a)][_0x1c259f(0x281)](_0x1694a6)[_0x1c259f(0x205)]();return _0x438cc5[_0x1c259f(0x1d8)]({'code':0x0,'data':_0x3c33b9});}}),router['post'](_0x3022ca(0x1c9),(_0xa5f21c,_0x283baa,_0x4eb1a6)=>{const _0x4205f8=_0x3022ca;let _0x3480c5=_0xa5f21c['body']['id'],_0x79b6dd=dbFileIndexTable[_0x4205f8(0x285)](_0xa5f21c[_0x4205f8(0x250)]['dbFileIndex'],_0x3480c5,dbFileIndexTable[_0x4205f8(0x191)]);if(dbUserTable[_0x4205f8(0x13b)](_0xa5f21c,_0x283baa,_0x4205f8(0x1a9),'power_get',_0x79b6dd[_0x4205f8(0x1e9)])==!![]){let _0x1adbcb={'code':0x0,'data':_0x79b6dd};return _0x283baa[_0x4205f8(0x1d8)](_0x1adbcb);}}),router[_0x3022ca(0x264)](_0x3022ca(0x1d5),(_0x5d5653,_0x595dae,_0x58ac6b)=>{const _0x2e361a=_0x3022ca;let _0x3cb581=_0x5d5653[_0x2e361a(0x183)][_0x2e361a(0x16e)],_0x2245e8=_0x5d5653[_0x2e361a(0x183)][_0x2e361a(0x1f2)];if(dbUserTable['isAdmin'](_0x5d5653,_0x595dae)===!![]){let _0x8881a6=dbSourceFolderTable[_0x2e361a(0x285)](_0x5d5653[_0x2e361a(0x250)][_0x2e361a(0x1f8)],_0x3cb581);if(!_0x8881a6)return _0x595dae[_0x2e361a(0x1e8)](0x194)[_0x2e361a(0x24a)]();return _0x2245e8==0x1?(_0x5d5653[_0x2e361a(0x250)]['dbFileIndex'][_0x2e361a(0x281)](_0x2e361a(0x224))[_0x2e361a(0x1de)](_0x8881a6['path']+path[_0x2e361a(0x1ae)]+'%',_0x8881a6['path']),dbSourceFolderTable[_0x2e361a(0x1da)](_0x5d5653[_0x2e361a(0x250)][_0x2e361a(0x1f8)],_0x2e361a(0x20d),_0x2245e8,_0x3cb581),process[_0x2e361a(0x25b)]({'type':_0x2e361a(0x169)}),_0x595dae['json']({'code':0x0})):(dbSourceFolderTable[_0x2e361a(0x1da)](_0x5d5653[_0x2e361a(0x250)][_0x2e361a(0x1f8)],'ignore_match_info',_0x2245e8,_0x3cb581),_0x5d5653[_0x2e361a(0x250)][_0x2e361a(0x21a)][_0x2e361a(0x281)]('UPDATE\x20file_index_movie\x20SET\x20movie_info_state=0\x20WHERE\x20(path\x20like\x20?\x20OR\x20path=?)')['run'](_0x8881a6[_0x2e361a(0x1e9)]+path[_0x2e361a(0x1ae)]+'%',_0x8881a6[_0x2e361a(0x1e9)]),process[_0x2e361a(0x25b)]({'type':'SWITCH_MOVIE_INFO'}),_0x595dae['json']({'code':0x0}));}}),router[_0x3022ca(0x264)](_0x3022ca(0x1d6),(_0x56db77,_0x3efc19,_0x4b45ca)=>{const _0x35cba8=_0x3022ca;let _0x143355=_0x56db77['body'][_0x35cba8(0x22f)],_0x2683ca=_0x56db77['body']['indexId'],_0x421aac=_0x56db77['body'][_0x35cba8(0x16e)];function _0xace284(_0xd64d6f){const _0x2a1d43=_0x35cba8;let _0x64086d=_0x56db77[_0x2a1d43(0x250)][_0x2a1d43(0x21a)][_0x2a1d43(0x281)](_0x2a1d43(0x24b)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+'\x20WHERE\x20path=?\x20and\x20is_file=1\x20and\x20type=2\x20order\x20by\x20filename')['get'](_0xd64d6f);if(!_0x64086d)return;_0x56db77[_0x2a1d43(0x250)][_0x2a1d43(0x21a)][_0x2a1d43(0x281)]('UPDATE\x20'+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x2a1d43(0x1ee))[_0x2a1d43(0x1de)](_0xd64d6f),_0x56db77[_0x2a1d43(0x250)]['dbFileIndex'][_0x2a1d43(0x281)](_0x2a1d43(0x154)+dbFileIndexTable[_0x2a1d43(0x191)]+_0x2a1d43(0x1c1))[_0x2a1d43(0x1de)](_0x64086d['id']),movieUtil['dealFirstLetterSingle'](_0x56db77['app']['dbFileIndex'],_0x64086d);}if(_0x2683ca){let _0x483ec1=dbFileIndexTable[_0x35cba8(0x285)](_0x56db77[_0x35cba8(0x250)][_0x35cba8(0x21a)],_0x2683ca,dbFileIndexTable[_0x35cba8(0x191)]);if(dbUserTable[_0x35cba8(0x13b)](_0x56db77,_0x3efc19,_0x35cba8(0x1a9),_0x35cba8(0x213),_0x483ec1[_0x35cba8(0x1e9)])==!![])return _0x143355==0x1?_0xace284(_0x483ec1['path']):_0x56db77[_0x35cba8(0x250)][_0x35cba8(0x21a)]['prepare'](_0x35cba8(0x154)+dbFileIndexTable[_0x35cba8(0x191)]+_0x35cba8(0x1a6)+_0x483ec1[_0x35cba8(0x1e9)]+'\x27')[_0x35cba8(0x1de)](),_0x3efc19[_0x35cba8(0x1d8)]({'code':0x0});}else{if(_0x421aac){let _0x170a2d=dbSourceFolderTable['getById'](_0x56db77['app'][_0x35cba8(0x1f8)],_0x421aac);if(!_0x170a2d||_0x170a2d['type']!=_0x35cba8(0x1a9))return _0x56db77['app'][_0x35cba8(0x230)](_0x3efc19,_0x3efc19['__']('operationFail'),_0x35cba8(0x18a));if(_0x143355==0x1){dbSourceFolderTable[_0x35cba8(0x1da)](_0x56db77[_0x35cba8(0x250)][_0x35cba8(0x1f8)],_0x35cba8(0x236),'tvplay',_0x421aac),_0xace284(_0x170a2d[_0x35cba8(0x1e9)]);let _0x3c2db6=_0x56db77['app'][_0x35cba8(0x21a)]['prepare']('SELECT\x20path,filename\x20from\x20'+dbFileIndexTable[_0x35cba8(0x191)]+_0x35cba8(0x19a))['all'](_0x170a2d['path'],''+_0x170a2d[_0x35cba8(0x1e9)]+path[_0x35cba8(0x1ae)]+'%');for(let _0x36af06 in _0x3c2db6){let _0x1cb92b=path[_0x35cba8(0x14f)](_0x3c2db6[_0x36af06][_0x35cba8(0x1e9)],_0x3c2db6[_0x36af06][_0x35cba8(0x287)]);_0xace284(_0x1cb92b);}}else{dbSourceFolderTable[_0x35cba8(0x1da)](_0x56db77['app']['dbOther'],_0x35cba8(0x236),_0x35cba8(0x1a9),_0x421aac);let _0x458d0e=_0x56db77[_0x35cba8(0x250)][_0x35cba8(0x21a)][_0x35cba8(0x281)](_0x35cba8(0x154)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x35cba8(0x13c))[_0x35cba8(0x1de)](_0x170a2d['path'],''+_0x170a2d[_0x35cba8(0x1e9)]+path[_0x35cba8(0x1ae)]+'%');}return _0x3efc19[_0x35cba8(0x1d8)]({'code':0x0});}else return _0x56db77[_0x35cba8(0x250)]['returnErrMsg'](_0x3efc19,_0x3efc19['__'](_0x35cba8(0x1ce)),'dialog');}});function setLogoAndFanart(_0x4108c4,_0x2d0159,_0x363fee,_0x16e41e){const _0x14df40=_0x3022ca;if(_0x4108c4[_0x14df40(0x183)][_0x14df40(0x22c)]){let _0x1efcd9=_0x14df40(0x1dd),_0x16e6fa=[_0x363fee];_0x16e41e?(_0x1efcd9+='(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20\x20or\x20filename\x20like\x20?)',_0x16e6fa[_0x14df40(0x14e)](_0x14df40(0x257)),_0x16e6fa[_0x14df40(0x14e)](_0x16e41e+'-clearlogo.%'),_0x16e6fa[_0x14df40(0x14e)](_0x16e41e+_0x14df40(0x16b))):(_0x1efcd9+=_0x14df40(0x206),_0x16e6fa['push'](_0x14df40(0x257)));let _0x10725e=_0x4108c4[_0x14df40(0x250)][_0x14df40(0x21a)]['prepare'](_0x1efcd9)[_0x14df40(0x153)](_0x16e6fa);if(_0x10725e){let _0x386b00=path[_0x14df40(0x14f)](_0x10725e[_0x14df40(0x1e9)],_0x10725e[_0x14df40(0x287)]);_0x2d0159['logo_path']=_0x386b00;}let _0x23b39c=_0x14df40(0x1dd),_0x395b4c=[_0x363fee];_0x16e41e?(_0x23b39c+=_0x14df40(0x1af),_0x395b4c[_0x14df40(0x14e)]('fanart.%'),_0x395b4c[_0x14df40(0x14e)](_0x16e41e+'-fanart.%'),_0x395b4c[_0x14df40(0x14e)](_0x16e41e+_0x14df40(0x256))):(_0x23b39c+=_0x14df40(0x206),_0x395b4c['push'](_0x14df40(0x140)));let _0x135abd=_0x4108c4[_0x14df40(0x250)][_0x14df40(0x21a)][_0x14df40(0x281)](_0x23b39c)[_0x14df40(0x153)](_0x395b4c);if(_0x135abd){let _0x476e52=path[_0x14df40(0x14f)](_0x135abd[_0x14df40(0x1e9)],_0x135abd[_0x14df40(0x287)]);_0x2d0159[_0x14df40(0x155)]=_0x476e52;}}}function _0x2e7b(){const _0x26e694=['-seriesPoster','movie_info_name','express','%season','collectionId','\x20from\x20movie_history\x20as\x20m\x20inner\x20join\x20file_index_movie\x20as\x20f\x20on\x20m.index_id=f.id\x20where\x20m.user_id=','./photoApiUtils','desc','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name','defaultTranscodeResolution','coverMovie','fromName','SELECT\x20','firstLetter','movieHomeShowLibrary','id,username','getAllByWhereAndField','/getMoviesByGenres','\x20AND\x20(path\x20like\x20?\x20OR\x20filename\x20like\x20?\x20OR\x20movie_info_name\x20like\x20?\x20)','body','listType','904SDXVNt','needSeasonCount','\x27\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27','power_get','movieHomeShowMyMedia','dialog','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=\x27','\x20WHERE\x20title\x20like\x20?','SELECT\x20*\x20from\x20movie_history\x20WHERE\x20index_id=?\x20and\x20user_id=?','\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1','movieRegion','excludeFilenameMovie','INDEX_TABLE_NAME_MOVIE','path_list','needTvCount','ALL','\x20FROM\x20\x20movie_collection\x20WHERE\x20type=?','movieActors','tvFolderPath','error\x20pathList','genresType','\x20WHERE\x20is_file=0\x20and\x20(path=?\x20or\x20path\x20like\x20?)\x20','extname','\x20LIKE\x20\x27%','../../db/dbScanTaskTable','../../db/dbUserTable','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20share_for_subuser=1','currentUser','login.pwdErr','tvCount','getCountByWhere','smart','orderField','\x20SET\x20show_in_list\x20=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=\x27','addFavorite','-HD','movie','getFilenameNumber','\x20order\x20by\x20m.create_time\x20desc\x20limit\x2010','addScanTask','movieDirectors','sep','(filename\x20like\x20?\x20or\x20filename\x20like\x20?\x20or\x20filename\x20like\x20?)','\x20type=2\x20and\x20is_file=1','.srt','data','indexId','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20?\x20or\x20filename\x20like\x20?)\x20and\x20filename\x20not\x20like\x20?','movie_language','179498KNpVjN','endDuration','../../db/dbMovieFavorite','\x20AND\x20(filename_fl=?\x20OR\x20show_name_fl=?\x20OR\x20movie_info_name_fl=?)','pageCount','movieHomeShowHistory','getSeasonNumber','catch','isTvSeries','page','findWithField','\x20SET\x20show_in_list=1\x20WHERE\x20id=?','502904XfCkXm','useTvSeriesInfo','movieGenres','DELETE\x20FROM\x20movie_collection\x20WHERE\x20id=?','pwd','movie_actor','/getSameNameSubtitles','/getIndexDetail','\x20and\x20(filename\x20like\x20?\x20or\x20movie_info_name\x20like\x20?)\x20','poster.jpg','is_file','SELECT\x20*\x20FROM\x20movie_library\x20WHERE\x20id=?','operationFail','ignoreSeasonList','searchStr','Router','/addHistory','\x20\x20WHERE\x20','log','/switchMatchInfo','/setTvplay','index_count','json','is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay!=1','updateByWhere','timestamp','check_time','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20','run','sortType','250oboqXe','\x20AND\x20collection_id\x20=\x20','\x20order\x20by\x20check_time\x20desc\x20limit\x2010\x20','startScanPath','power_delete','UPDATE\x20movie_collection\x20SET\x20title=?,data=?,enable_pwd=?,pwd=?,collection_cover_path=?,data_value=?,share_for_subuser=?\x20WHERE\x20id=?','dirname','dataValue','status','path','UPDATE\x20file_index_movie\x20SET\x20collection_id=0\x20where\x20collection_id=?','REPLACE\x20INTO\x20movie_history(index_id,user_id,time,create_time)\x20VALUES(\x20?,?,?,?)','../../db/dbFileIndexTable','trim','\x20SET\x20show_in_list\x20=0,is_tvplay=1\x20WHERE\x20path=?','-seasonCount-','../utils/nasAccountUtils','openDuration','ignoreMatchInfo','\x27\x20and\x20type=1\x20and\x20is_file=1\x20limit\x2020','coverPath','\x20order\x20by\x20','\x20type=2\x20and\x20is_file=1\x20and\x20id!=?\x20and\x20collection_id=0\x20','excludeIds','dbOther','\x20LIMIT\x20?\x20OFFSET\x20?','/checkCollectionPwd','../utils/fileUtils','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20','excludePathMovie','%fanart%','sameFolderImgList','readdir','folder_cover_path','count','replaceAll','/getMovieDetail','all','(filename\x20like\x20?)','SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_regions\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100','offset','SELECT\x20*\x20FROM\x20movie_library\x20','SELECT\x20id,title,enable_pwd,create_time\x20FROM\x20movie_collection\x20where\x20id=?\x20and\x20pwd=?','UPDATE\x20file_index_movie\x20set\x20check_time=?\x20WHERE\x20id=?','seasonCount','ignore_match_info','getTime','folder.jpg','\x20AND\x20share_for_subuser\x20=\x20?\x20','folder','tvFolderName','power_change','pageSize','\x20type=2','\x20like\x20?\x20','SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_movie\x20WHERE\x20path\x20like\x20?\x20and\x20is_file=1\x20and\x20type=2\x20and\x20show_in_list=1','36YYSYOL','getFavoriteList','dbFileIndex','movie_director','287qpOpuf','../../db/dbConfigTable','includes','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20filename\x20like\x20?','/removeIndexFromCollection','sort','videoPath','fileFullPath','UPDATE\x20file_index_movie\x20SET\x20movie_info_state=3\x20WHERE\x20path\x20like\x20?\x20OR\x20path=?','getPhotoByParams','SELECT\x20count(*)\x20as\x20count\x20FROM\x20','FAVORITE','sha256','create_time','/getHistory','\x20SET\x20filename_number=?\x20\x20WHERE\x20\x20id=?','needLogoPathAndFanart','ignoreTvList','m.time,\x20f.id,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id','isTvPlay','returnErrMsg','dataPreview','delete','/getMovies','exports','replace','media_type','movieShowMatchName','DELETE','DELETE\x20FROM\x20movie_library\x20\x20WHERE\x20id=?','\x20AND\x20is_tvplay==0','/addCollection','.vtt','EDIT','\x20AND\x20(filename_fl=?\x20AND\x20show_name_fl=?\x20AND\x20movie_info_name_fl=?)','decodePath','findByTitle','\x20id,title,data,enable_pwd,collection_cover_path,data_value,create_time,share_for_subuser\x20','SELECT\x20id\x20FROM\x20','title','\x20AND\x20id\x20NOT\x20IN\x20(','SELECT\x20*\x20from\x20movie_history\x20where\x20user_id=?\x20and\x20index_id=?','libraryId','error\x20data','\x20order\x20by\x20m.create_time\x20desc\x20limit\x201','\x20AND\x20(','end','SELECT\x20*\x20from\x20','startsWith','SELECT\x20id,filename\x20FROM\x20','subtitleSize','UPDATE\x20movie_library\x20SET\x20title=?,path_list=?,share_for_subuser=?,share_uid=?\x20WHERE\x20id=?','app','noPermission','movie_index_id','../../db/dbSourceFolderTable','seasonNumber','\x20order\x20by\x20filename_number,filename','.fanart.%','clearlogo.%','thumb.jpg','shareForSubUser','checkSqlInjection','send','SELECT\x20path,filename\x20FROM\x20file_index_movie\x20WHERE\x20path=?\x20and\x20type=1\x20and\x20is_file=1\x20and\x20(filename\x20like\x20\x27poster.%\x27\x20or\x20filename\x20like\x20\x27POSTER.%\x27\x20or\x20filename\x20like\x20\x27movie.%\x27\x20or\x20filename\x20like\x20\x27folder.%\x27\x20or\x20filename\x20like\x20\x27cover.%\x27\x20or\x20filename\x20like\x20\x27thumb.%\x27)','stringify','UPDATE\x20file_index_movie\x20set\x20open_duration=?,end_duration=?,skip_open_end=?\x20WHERE\x20id\x20in\x20','sortField','-FHD','/deleteCollection','collection_id','REPLACE\x20INTO\x20movie_library(title,path_list,share_for_subuser,share_uid,user_id)\x20VALUES(\x20?,?,?,?,?)','post','getUserPathWhere','select\x20id\x20from\x20file_index_movie\x20where\x20(\x20path\x20like\x20?\x20OR\x20path=?)\x20and\x20is_file=1\x20and\x20type=2','pathList','search','fileExist','\x20id,movie_douban_score,movie_info_name,movie_year,movie_info_state,path,is_tvplay,filename,ext,type,width,height,duration,size,movie_douban_id,movie_imdb_id,show_name,show_in_list','/getTvHomeData2','/getTvList','duration','type','.ass','Value\x20out\x20of\x20limit','enable_pwd','checkPath','poster.jpeg','now','length','763TDWSHr','existsSync','index_id','GET','UPDATE\x20file_index_movie\x20SET\x20collection_id=?\x20WHERE\x20id\x20in\x20','parseNfoTvSeries','\x20AND\x20','592383VnSBLA','SELECT\x20*\x20FROM\x20source_folder\x20WHERE\x20type=?\x20LIMIT\x2010','../../utils/movieInfoUtil','-coverCache-','prepare','movie_regions','history','\x20order\x20by\x20create_time\x20desc','getById','DELETE\x20FROM\x20movie_history\x20where\x20user_id=','filename','\x20AND\x20is_tvplay==1','favorite','is_file=1\x20and\x20type=2\x20and\x20show_in_list=1\x20and\x20is_tvplay==1','ADD','2001123qOVWWu','1126TxJehS','show_name','\x20\x20WHERE\x20\x20type=2\x20and\x20is_file=1\x20and\x20path=?\x20and\x20is_tvplay=1\x20and\x20filename_number\x20is\x20null','\x20SELECT\x20','/clearHistory','未找到NFO信息','is_tvplay','collectionPwd','\x20and\x20title\x20like\x20?','/movieFavorite','movie_genres','doUserCanGet','\x20SET\x20show_in_list=1,is_tvplay=0,show_name\x20=\x27\x27,show_name_fl=null\x20WHERE\x20path=?\x20or\x20path\x20like\x20?','basename','\x20as\x20f\x20WHERE\x20','\x20FROM\x20','fanart.%','endsWith','stat','/deleteIndex','\x20or\x20','../utils/movieUtil','parse','/getCollection','searchValue','getAllFavoriteByWhere','seasonList','REPLACE\x20INTO\x20movie_collection(title,enable_pwd,pwd,user_id,type,data,collection_cover_path,data_value,share_for_subuser)\x20VALUES(\x20?,?,?,?,?,?,?,?,?)','sourceType','axios','push','join','../../myConfig/config','set','has','get','UPDATE\x20','fanart_path','is_admin','trash','99745OuXAlo','substr','heic','sourceFolderList','SELECT\x20index_id\x20FROM\x20movie_history\x20where\x20index_id\x20in\x20','order\x20field\x20error','UPDATE\x20movie_history\x20SET\x20time=?,create_time=?\x20where\x20index_id=?\x20AND\x20user_id=?','m.time,\x20f.id,f.is_tvplay,f.path,f.filename,f.ext,f.type,f.width,f.height,f.duration,f.size,f.movie_info_state,f.movie_douban_id,f.movie_imdb_id,f.movie_douban_score,f.movie_info_name,f.show_name','autoSkip','.jpg','\x20AND\x20collection_id=0','movieTvCache','enablePwd','then','value','%poster%','index.videoInfoReadFail','SWITCH_MOVIE_INFO','SELECT\x20*\x20from\x20movie_collection\x20where\x20id=?','.clearlogo.%','getFavorite','getExcludePathWhereStr','sourceFolderId','/getMovieKeys'];_0x2e7b=function(){return _0x26e694;};return _0x2e7b();}function addTvFolderPathAndName(_0x24e96c){const _0x5345fa=_0x3022ca;_0x24e96c[_0x5345fa(0x212)]=path[_0x5345fa(0x13d)](_0x24e96c[_0x5345fa(0x1e9)]),_0x24e96c[_0x5345fa(0x197)]=_0x24e96c[_0x5345fa(0x1e9)];if(_0x24e96c['is_tvplay']==0x1){let _0x5915cc=path['basename'](_0x24e96c[_0x5345fa(0x1e9)]),_0x4a94ec=path[_0x5345fa(0x1e6)](_0x24e96c['path']),_0x494fd6=movieSeasonUtil[_0x5345fa(0x1bc)](_0x5915cc);_0x494fd6>-0x1&&(_0x24e96c[_0x5345fa(0x212)]=path[_0x5345fa(0x13d)](_0x4a94ec),_0x24e96c[_0x5345fa(0x197)]=_0x4a94ec);if(!_0x24e96c[_0x5345fa(0x131)])_0x24e96c[_0x5345fa(0x131)]=_0x24e96c[_0x5345fa(0x212)];}}function addFolderCoverPath(_0x42e216,_0x29bda6,_0x15ac11,_0x2427b4=![]){const _0x1ea890=_0x3022ca;let _0x183f3c;addTvFolderPathAndName(_0x15ac11);let _0x4282b1=_0x15ac11['id']+_0x1ea890(0x280)+_0x2427b4;!_0x29bda6['movieTvCache']&&(_0x29bda6['movieTvCache']=new Map());try{if(_0x15ac11[_0x1ea890(0x136)]==0x1&&!_0x2427b4)try{let _0x590ac8=path['basename'](_0x15ac11[_0x1ea890(0x1e9)]),_0x1c2136=path['dirname'](_0x15ac11[_0x1ea890(0x1e9)]),_0x292edf=movieSeasonUtil['getSeasonNumber'](_0x590ac8);if(_0x292edf>-0x1){_0x15ac11['isTvSeries']=0x1,_0x15ac11['seasonNumber']=_0x292edf;if(_0x29bda6[_0x1ea890(0x183)][_0x1ea890(0x186)]){let _0x4f960f=_0x1c2136+_0x1ea890(0x1ef)+_0x2427b4;_0x29bda6[_0x1ea890(0x163)]['has'](_0x4f960f)?_0x15ac11['seasonCount']=_0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x153)](_0x4f960f):(_0x15ac11[_0x1ea890(0x20c)]=_0x29bda6['app']['dbFileIndex'][_0x1ea890(0x281)](_0x1ea890(0x217))[_0x1ea890(0x153)](''+_0x1c2136+path['sep']+'%')['count'],_0x29bda6['movieTvCache'][_0x1ea890(0x151)](_0x4f960f,_0x15ac11[_0x1ea890(0x20c)]));}}setLogoAndFanart(_0x29bda6,_0x15ac11,_0x15ac11['tvFolderPath']);if(_0x29bda6[_0x1ea890(0x183)][_0x1ea890(0x1c3)]==0x1&&_0x292edf>-0x1){let _0x3609a2=_0x15ac11[_0x1ea890(0x197)]+_0x1ea890(0x170);if(_0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x152)](_0x3609a2))return _0x15ac11['folder_cover_path']=_0x29bda6['movieTvCache'][_0x1ea890(0x153)](_0x3609a2),_0x15ac11;let _0x81d99b=getTvSeriesPoster(_0x15ac11);if(_0x81d99b)return _0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x151)](_0x3609a2,_0x81d99b),_0x15ac11['folder_cover_path']=_0x81d99b,_0x15ac11;}if(!_0x183f3c&&_0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x152)](_0x4282b1))return _0x15ac11[_0x1ea890(0x201)]=_0x29bda6[_0x1ea890(0x163)]['get'](_0x4282b1),_0x15ac11;if(!_0x183f3c&&_0x292edf>-0x1){parseInt(_0x292edf)<0xa&&(_0x292edf='0'+_0x292edf);let _0x3bb2e9=_0x1ea890(0x173)+_0x292edf+_0x1ea890(0x167),_0x386293='%s'+_0x292edf+_0x1ea890(0x167),_0x43706b=_0x1ea890(0x18b)+_0x1c2136+_0x1ea890(0x187)+_0x3bb2e9+'\x27\x20or\x20filename\x20like\x20\x27'+_0x386293+'\x27)';_0x183f3c=_0x29bda6[_0x1ea890(0x250)][_0x1ea890(0x21a)][_0x1ea890(0x281)](_0x43706b)[_0x1ea890(0x153)]();}!_0x183f3c&&(_0x183f3c=_0x29bda6[_0x1ea890(0x250)]['dbFileIndex'][_0x1ea890(0x281)](_0x1ea890(0x25c))[_0x1ea890(0x153)](_0x15ac11[_0x1ea890(0x1e9)]));}catch(_0x4c13e6){console[_0x1ea890(0x1d4)](_0x4c13e6);}else{if(_0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x152)](_0x4282b1))return _0x15ac11[_0x1ea890(0x201)]=_0x29bda6[_0x1ea890(0x163)][_0x1ea890(0x153)](_0x4282b1),_0x15ac11;let _0x4689bc=path['parse'](_0x15ac11[_0x1ea890(0x287)]),_0x2e2d85=_0x4689bc['name'],_0x5accfa=path[_0x1ea890(0x14f)](_0x15ac11[_0x1ea890(0x1e9)],_0x2e2d85+_0x1ea890(0x161));if(fs[_0x1ea890(0x277)](_0x5accfa))return _0x15ac11[_0x1ea890(0x201)]=_0x5accfa,_0x15ac11;!_0x183f3c&&(_0x183f3c=_0x29bda6[_0x1ea890(0x250)]['dbFileIndex'][_0x1ea890(0x281)](_0x1ea890(0x21f))['get'](_0x15ac11['path'],'%'+_0x2e2d85+_0x1ea890(0x167)));if(!_0x183f3c){let _0x683834=_0x2e2d85;(_0x2e2d85[_0x1ea890(0x141)](_0x1ea890(0x1a8))||_0x2e2d85[_0x1ea890(0x141)](_0x1ea890(0x260))||_0x2e2d85[_0x1ea890(0x141)]('-QHD')||_0x2e2d85['endsWith']('-UHD'))&&(_0x2e2d85[_0x1ea890(0x141)](_0x1ea890(0x1a8))?_0x683834=_0x683834[_0x1ea890(0x159)](0x0,_0x683834[_0x1ea890(0x275)]-0x3):_0x683834=_0x683834['substr'](0x0,_0x683834['length']-0x4)),_0x183f3c=_0x29bda6[_0x1ea890(0x250)]['dbFileIndex'][_0x1ea890(0x281)](_0x1ea890(0x1b4))[_0x1ea890(0x153)](_0x15ac11['path'],_0x2e2d85+'%',_0x683834+'%',_0x1ea890(0x1fe));}!_0x183f3c&&(_0x183f3c=_0x29bda6['app']['dbFileIndex'][_0x1ea890(0x281)](_0x1ea890(0x25c))[_0x1ea890(0x153)](_0x15ac11[_0x1ea890(0x1e9)]));let {name:_0x44dbca}=path[_0x1ea890(0x146)](_0x15ac11['filename']);setLogoAndFanart(_0x29bda6,_0x15ac11,_0x15ac11[_0x1ea890(0x1e9)],_0x44dbca);}if(_0x183f3c){let _0x59002f=path[_0x1ea890(0x14f)](_0x183f3c[_0x1ea890(0x1e9)],_0x183f3c[_0x1ea890(0x287)]);!_0x59002f[_0x1ea890(0x141)]('HEIC')&&!_0x59002f[_0x1ea890(0x141)](_0x1ea890(0x15a))&&fs[_0x1ea890(0x277)](_0x59002f)?(_0x15ac11[_0x1ea890(0x201)]=_0x59002f,_0x29bda6['movieTvCache']['set'](_0x4282b1,_0x15ac11[_0x1ea890(0x201)])):_0x29bda6['movieTvCache'][_0x1ea890(0x151)](_0x4282b1,'');}return _0x15ac11;}catch(_0x1e769c){return console[_0x1ea890(0x1d4)](_0x1e769c),_0x15ac11;}}function getMoviesByParams(_0x4191d8,_0x244e0f,_0x549c6f,_0x47249b,_0x5b09f1,_0x2553a8,_0x451445,_0x45f165,_0x3fc8f7,_0x5d5a11,_0x16d0ba,_0x3cd1b8,_0x475d57,_0x342de9,_0x41823b,_0x3955b7,_0x32d26a,_0x15013a){const _0x266370=_0x3022ca;let _0x2c6e24=movieFieldStr;_0x15013a&&(_0x2c6e24=_0x15013a);!_0x41823b&&(_0x41823b=_0x266370(0x194));let _0x10e8cd='',_0xb87272=[],_0x5e5bda=dbUserTable['getUserPathWhere'](_0x244e0f,_0x266370(0x1a9),_0x266370(0x188),!![],_0x5d5a11);if(_0x244e0f[_0x266370(0x1a0)][_0x266370(0x156)]!=0x1&&!_0x5e5bda)return[];_0x10e8cd+=_0x266370(0x215);_0x3fc8f7&&(_0x3fc8f7=_0x3fc8f7[_0x266370(0x235)]('\x27','')[_0x266370(0x235)]('’',''),_0x10e8cd+=_0x266370(0x182),_0xb87272['push']('%'+_0x3fc8f7+'%'),_0xb87272['push']('%'+_0x3fc8f7+'%'),_0xb87272[_0x266370(0x14e)]('%'+_0x3fc8f7+'%'));let _0x11d14b=dbSourceFolderTable[_0x266370(0x16d)](_0x244e0f['app'][_0x266370(0x1f8)],_0x266370(0x1e9),_0x266370(0x1fd));_0x11d14b&&(_0x10e8cd+='\x20AND\x20'+_0x11d14b);let _0x5bedba=dbSourceFolderTable[_0x266370(0x16d)](_0x244e0f[_0x266370(0x250)]['dbOther'],_0x266370(0x287),_0x266370(0x190));_0x5bedba&&(_0x10e8cd+=_0x266370(0x27c)+_0x5bedba);function _0x444ec6(_0x40e174,_0x222f95){const _0x41c84a=_0x266370;let _0x5acfa6=_0x41c84a(0x249);try{let _0xb2bc7a=JSON[_0x41c84a(0x146)](_0x222f95),_0x225e70=![];for(let _0x389de1=0x0;_0x389de1<_0xb2bc7a['length'];_0x389de1++){if(!_0xb2bc7a[_0x389de1])continue;_0x225e70=!![],_0x5acfa6+='\x20'+_0x40e174+_0x41c84a(0x216),_0xb87272[_0x41c84a(0x14e)]('%'+_0xb2bc7a[_0x389de1][_0x41c84a(0x1ed)]()+'%'),_0x389de1!=_0xb2bc7a['length']-0x1&&(_0x5acfa6+=_0x41c84a(0x144));}_0x5acfa6+=')',_0x225e70&&(_0x10e8cd+=_0x5acfa6);}catch(_0xe4e5b0){console[_0x41c84a(0x1d4)](_0xe4e5b0);}}_0x16d0ba&&_0x444ec6(_0x266370(0x282),_0x16d0ba);_0x3cd1b8&&_0x444ec6(_0x266370(0x1b5),_0x3cd1b8);_0x475d57&&_0x444ec6(_0x266370(0x13a),_0x475d57);_0x244e0f['body'][_0x266370(0x196)]&&_0x244e0f['body'][_0x266370(0x196)]['length']>0x0&&_0x244e0f[_0x266370(0x183)][_0x266370(0x196)][0x0]!=''&&_0x444ec6(_0x266370(0x1c7),_0x244e0f['body'][_0x266370(0x196)]);_0x244e0f[_0x266370(0x183)][_0x266370(0x1ad)]&&_0x244e0f[_0x266370(0x183)][_0x266370(0x1ad)]['length']>0x0&&_0x244e0f[_0x266370(0x183)][_0x266370(0x1ad)][0x0]!=''&&_0x444ec6(_0x266370(0x21b),_0x244e0f[_0x266370(0x183)][_0x266370(0x1ad)]);if(_0x32d26a){let _0x1bad25=_0x244e0f[_0x266370(0x250)][_0x266370(0x21a)]['prepare'](_0x266370(0x1cd))['get'](_0x32d26a);if(_0x1bad25)try{let _0xf138f0=JSON[_0x266370(0x146)](_0x1bad25[_0x266370(0x192)]),_0x8143f3=dbUserTable['getPathWhere'](!![],_0xf138f0);_0x10e8cd+=_0x8143f3;}catch(_0x129fe6){console['log'](_0x129fe6);}}else{!_0x342de9&&(_0x342de9=0x0);let _0x14c082;if(_0x342de9!=0x0){_0x14c082=_0x244e0f[_0x266370(0x250)][_0x266370(0x21a)]['prepare']('SELECT\x20*\x20from\x20movie_collection\x20where\x20id=?')[_0x266370(0x153)](_0x342de9);if(!_0x14c082)return _0x244e0f['app'][_0x266370(0x230)](_0x4191d8,_0x4191d8['__']('movieCollectionNotExist'));if(_0x14c082[_0x266370(0x271)]==0x1){let _0x95ecff=_0x244e0f[_0x266370(0x183)][_0x266370(0x137)];if(!_0x95ecff||_0x14c082[_0x266370(0x1c6)]!=sha256(_0x95ecff))return _0x244e0f[_0x266370(0x250)][_0x266370(0x230)](_0x4191d8,_0x4191d8['__'](_0x266370(0x1a1)));}}if(_0x14c082&&_0x14c082[_0x266370(0x26e)]=='smart')try{_0x14c082['data']=JSON[_0x266370(0x146)](_0x14c082[_0x266370(0x1b2)]),_0x10e8cd+=_0x266370(0x27c)+_0x14c082[_0x266370(0x1b2)][_0x266370(0x148)];}catch(_0x1dec2b){console[_0x266370(0x1d4)](_0x1dec2b);}else _0x10e8cd+=_0x266370(0x1e1)+_0x342de9;}if(_0x549c6f){if(_0x549c6f==0x1)_0x10e8cd+='\x20AND\x20is_tvplay==0';else _0x549c6f==0x2&&(_0x10e8cd+=_0x266370(0x12b));}_0x3955b7&&(_0x3955b7=='#'?(_0x10e8cd+=_0x266370(0x23e),_0xb87272[_0x266370(0x14e)](_0x3955b7),_0xb87272[_0x266370(0x14e)](_0x3955b7),_0xb87272[_0x266370(0x14e)](_0x3955b7)):(_0x10e8cd+=_0x266370(0x1b9),_0xb87272[_0x266370(0x14e)](_0x3955b7),_0xb87272['push'](_0x3955b7),_0xb87272['push'](_0x3955b7)));if(_0x45f165&&_0x45f165['length']>0x0){_0x10e8cd+=_0x266370(0x244);for(let _0x507d78=0x0;_0x507d78<_0x45f165[_0x266370(0x275)];_0x507d78++){_0x10e8cd+=_0x45f165[_0x507d78],_0x507d78!=_0x45f165[_0x266370(0x275)]-0x1&&(_0x10e8cd+=',');}_0x10e8cd+=')';}_0x10e8cd+=_0x5e5bda;_0x47249b&&_0x451445?_0x10e8cd+='\x20\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20'+_0x47249b+'\x20'+_0x451445:_0x10e8cd+=_0x266370(0x18e);!_0x5b09f1&&(_0x5b09f1=0x32);_0x10e8cd+=_0x266370(0x1f9),_0xb87272[_0x266370(0x14e)](_0x5b09f1),_0xb87272[_0x266370(0x14e)](_0x2553a8);let _0x2feab0=[];if(_0x41823b==_0x266370(0x227))_0x2feab0=dbMovieFavorite[_0x266370(0x149)](_0x244e0f[_0x266370(0x250)][_0x266370(0x21a)],_0x244e0f[_0x266370(0x1a0)]['id'],_0x10e8cd,_0x2c6e24,_0xb87272);else _0x41823b==_0x266370(0x194)&&(_0x2feab0=dbFileIndexTable[_0x266370(0x180)](_0x244e0f[_0x266370(0x250)][_0x266370(0x21a)],_0x10e8cd,_0x2c6e24,dbFileIndexTable[_0x266370(0x191)],_0xb87272));if(_0x2feab0[_0x266370(0x275)]<0x1)return _0x2feab0;let _0x281bf8=[];for(let _0x4c2fd0 in _0x2feab0){_0x281bf8[_0x266370(0x14e)](_0x2feab0[_0x4c2fd0]['id']);}let _0x538dd2=dbMovieFavorite[_0x266370(0x219)](_0x244e0f[_0x266370(0x250)][_0x266370(0x21a)],_0x244e0f['currentUser']['id'],_0x281bf8);for(let _0x3ae280=0x0;_0x3ae280<_0x2feab0[_0x266370(0x275)];_0x3ae280++){_0x2feab0[_0x3ae280][_0x266370(0x12c)]=0x0;for(let _0x29cf09 in _0x538dd2){if(_0x538dd2[_0x29cf09][_0x266370(0x252)]==_0x2feab0[_0x3ae280]['id']){_0x2feab0[_0x3ae280][_0x266370(0x12c)]=0x1;break;}}let _0x447458=_0x244e0f[_0x266370(0x250)]['dbFileIndex']['prepare'](_0x266370(0x245))[_0x266370(0x153)](_0x244e0f[_0x266370(0x1a0)]['id']+'',_0x2feab0[_0x3ae280]['id']+'');_0x447458&&(_0x2feab0[_0x3ae280][_0x266370(0x283)]=_0x447458);_0x2feab0[_0x3ae280]=addFolderCoverPath(_0x4191d8,_0x244e0f,_0x2feab0[_0x3ae280]);if(_0x2feab0[_0x3ae280][_0x266370(0x136)]==0x1&&_0x244e0f[_0x266370(0x183)][_0x266370(0x193)]){let _0x399e94=dbFileIndexTable['getTvCount'](_0x244e0f[_0x266370(0x250)]['dbFileIndex'],_0x2feab0[_0x3ae280]);_0x2feab0[_0x3ae280][_0x266370(0x1a2)]=_0x399e94[_0x266370(0x202)];}}return _0x2feab0;}function getShowMatchName(_0x1151eb){const _0x3a9936=_0x3022ca;let _0x583a58=dbConfigTable[_0x3a9936(0x240)](_0x1151eb,_0x3a9936(0x237));return!_0x583a58||_0x583a58&&_0x583a58[_0x3a9936(0x166)]!=0x0?0x1:0x0;}router[_0x3022ca(0x264)](_0x3022ca(0x233),(_0x479842,_0x15d190,_0x5ecb3d)=>{const _0x2b35fb=_0x3022ca;if(dbUserTable[_0x2b35fb(0x13b)](_0x479842,_0x15d190,_0x2b35fb(0x1a9),_0x2b35fb(0x188))==!![]){let _0x4d1b66=_0x479842['body'][_0x2b35fb(0x202)],_0x5c979c=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x208)],_0x3bc786=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x25f)],_0x84a16f=_0x479842['body'][_0x2b35fb(0x1df)],_0x1165d4=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x1f7)],_0x2abe85=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x1d0)],_0x238a2d=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x15b)],_0x51c89b=_0x479842['body'][_0x2b35fb(0x18f)],_0x20cbed=_0x479842[_0x2b35fb(0x183)]['movieLanguage'],_0x5688d3=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x1c4)],_0x32f898=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x14c)],_0x2667e9=_0x479842['body'][_0x2b35fb(0x174)],_0xfa3874=_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x184)],_0x40b904=_0x479842['body'][_0x2b35fb(0x17d)],_0x380b6f=_0x479842['body'][_0x2b35fb(0x246)];_0x479842[_0x2b35fb(0x183)]['needTvCount']=!![],_0x479842[_0x2b35fb(0x183)][_0x2b35fb(0x186)]=!![];let _0x46a09e=getMoviesByParams(_0x15d190,_0x479842,_0x32f898,_0x3bc786,_0x4d1b66,_0x5c979c,_0x84a16f,_0x1165d4,_0x2abe85,_0x238a2d,_0x51c89b,_0x20cbed,_0x5688d3,_0x2667e9,_0xfa3874,_0x40b904,_0x380b6f);return _0x15d190[_0x2b35fb(0x1d8)]({'movieShowMatchName':getShowMatchName(_0x479842['app'][_0x2b35fb(0x1f8)]),'code':0x0,'data':_0x46a09e});}}),router[_0x3022ca(0x264)](_0x3022ca(0x181),(_0x4c43fb,_0x22ab08,_0x2dba12)=>{const _0x49e3cb=_0x3022ca;if(dbUserTable[_0x49e3cb(0x13b)](_0x4c43fb,_0x22ab08,'movie',_0x49e3cb(0x188))==!![]){let _0x3461f6=_0x4c43fb[_0x49e3cb(0x183)][_0x49e3cb(0x15b)],_0x2668d8=_0x4c43fb['body'][_0x49e3cb(0x1ba)],_0x2d709e=_0x4c43fb[_0x49e3cb(0x183)][_0x49e3cb(0x14c)];!_0x2668d8&&(_0x2668d8=0x9);let _0x5918f1=_0x49e3cb(0x26a),_0x384f46='';_0x3461f6?_0x384f46=dbUserTable[_0x49e3cb(0x265)](_0x4c43fb,_0x49e3cb(0x1a9),'power_get',!![],_0x3461f6):_0x384f46=dbUserTable[_0x49e3cb(0x265)](_0x4c43fb,_0x49e3cb(0x1a9),_0x49e3cb(0x188),!![]);let _0x2694c3=_0x4c43fb[_0x49e3cb(0x183)][_0x49e3cb(0x199)];!_0x2694c3&&(_0x2694c3=_0x49e3cb(0x13a));let _0x2d9dc9=_0x4c43fb[_0x49e3cb(0x250)][_0x49e3cb(0x21a)]['prepare']('SELECT\x20*\x20FROM\x20movie_keys\x20WHERE\x20key_type=?\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20200')[_0x49e3cb(0x205)](_0x2694c3),_0x15a092=[];for(let _0xdc7dab of _0x2d9dc9){let _0x4b33a5=_0xdc7dab['key_value'],_0x15ff2d=_0x49e3cb(0x215);_0x15ff2d+=_0x384f46,_0x15ff2d+=_0x49e3cb(0x162);if(_0x2d709e){if(_0x2d709e==0x1)_0x15ff2d+=_0x49e3cb(0x23a);else _0x2d709e==0x2&&(_0x15ff2d+=_0x49e3cb(0x12b));}_0x15ff2d+=_0x49e3cb(0x27c)+_0x2694c3+_0x49e3cb(0x19c)+_0x4b33a5+'%\x27',_0x15ff2d+='\x20AND\x20is_file=1\x20AND\x20show_in_list=1\x20ORDER\x20BY\x20check_time\x20DESC\x20LIMIT\x20'+_0x2668d8;let _0x27a89d=dbFileIndexTable[_0x49e3cb(0x180)](_0x4c43fb[_0x49e3cb(0x250)][_0x49e3cb(0x21a)],_0x15ff2d,_0x5918f1,dbFileIndexTable[_0x49e3cb(0x191)]),_0x24eb76=[];for(let _0xcfa223 in _0x27a89d){_0x24eb76['push'](_0x27a89d[_0xcfa223]['id']);}let _0x38b868=dbMovieFavorite[_0x49e3cb(0x219)](_0x4c43fb[_0x49e3cb(0x250)][_0x49e3cb(0x21a)],_0x4c43fb[_0x49e3cb(0x1a0)]['id'],_0x24eb76);for(let _0x3b859c=0x0;_0x3b859c<_0x27a89d[_0x49e3cb(0x275)];_0x3b859c++){_0x27a89d[_0x3b859c][_0x49e3cb(0x12c)]=0x0;for(let _0x26b31c in _0x38b868){if(_0x38b868[_0x26b31c][_0x49e3cb(0x252)]==_0x27a89d[_0x3b859c]['id']){_0x27a89d[_0x3b859c][_0x49e3cb(0x12c)]=0x1;break;}}_0x27a89d[_0x3b859c]=addFolderCoverPath(_0x22ab08,_0x4c43fb,_0x27a89d[_0x3b859c]);}_0x27a89d[_0x49e3cb(0x275)]>0x0&&_0x15a092[_0x49e3cb(0x14e)]({'genresType':_0x2694c3,'genresValue':_0x4b33a5,'movieList':_0x27a89d,'indexCount':_0xdc7dab[_0x49e3cb(0x1d7)]});}_0x22ab08[_0x49e3cb(0x1d8)]({'code':0x0,'data':_0x15a092,'movieShowMatchName':getShowMatchName(_0x4c43fb[_0x49e3cb(0x250)]['dbOther'])});}}),router[_0x3022ca(0x264)]('/getMovieHomeData',(_0x20d09c,_0x161bc,_0xf6efbc)=>{const _0x3f4ad2=_0x3022ca;if(dbUserTable[_0x3f4ad2(0x13b)](_0x20d09c,_0x161bc,'movie',_0x3f4ad2(0x188))==!![]){let _0x58e36e=getMoviesByParams(_0x161bc,_0x20d09c,0x1,_0x3f4ad2(0x229),0xf,0x0,_0x3f4ad2(0x177));_0x20d09c['body']['needTvCount']=!![],_0x20d09c['body'][_0x3f4ad2(0x186)]=!![],_0x20d09c[_0x3f4ad2(0x183)][_0x3f4ad2(0x1c3)]=0x1;let _0x7e2a40=getMoviesByParams(_0x161bc,_0x20d09c,0x2,_0x3f4ad2(0x229),0x32,0x0,_0x3f4ad2(0x177));_0x20d09c[_0x3f4ad2(0x183)]['needTvCount']=![],_0x20d09c['body'][_0x3f4ad2(0x186)]=![],_0x20d09c[_0x3f4ad2(0x183)]['useTvSeriesInfo']=0x0;let _0x5543cc=dbConfigTable[_0x3f4ad2(0x240)](_0x20d09c['app']['dbOther'],_0x3f4ad2(0x189));_0x5543cc=!_0x5543cc||_0x5543cc&&_0x5543cc['value']==0x1;let _0x45f8bb=dbConfigTable['findByTitle'](_0x20d09c['app'][_0x3f4ad2(0x1f8)],_0x3f4ad2(0x17e));_0x45f8bb=!_0x45f8bb||_0x45f8bb&&_0x45f8bb[_0x3f4ad2(0x166)]==0x1;let _0x341495=dbConfigTable[_0x3f4ad2(0x240)](_0x20d09c['app'][_0x3f4ad2(0x1f8)],_0x3f4ad2(0x1bb));_0x341495=!_0x341495||_0x341495&&_0x341495['value']==0x1;let _0x414656=[];if(_0x341495){let _0x4418c1=_0x3f4ad2(0x15f),_0x9c6d5b=_0x3f4ad2(0x17c)+_0x4418c1+_0x3f4ad2(0x175)+_0x20d09c[_0x3f4ad2(0x1a0)]['id']+_0x3f4ad2(0x1ab);_0x414656=_0x20d09c[_0x3f4ad2(0x250)][_0x3f4ad2(0x21a)][_0x3f4ad2(0x281)](_0x9c6d5b)[_0x3f4ad2(0x205)]();let _0x397c69=[];for(let _0x1d8068 in _0x414656){_0x397c69[_0x3f4ad2(0x14e)](_0x414656[_0x1d8068]['id']);}let _0x20fa65=dbMovieFavorite['getFavoriteList'](_0x20d09c['app'][_0x3f4ad2(0x21a)],_0x20d09c[_0x3f4ad2(0x1a0)]['id'],_0x397c69);for(let _0x39e9e1=0x0;_0x39e9e1<_0x414656[_0x3f4ad2(0x275)];_0x39e9e1++){_0x414656[_0x39e9e1]['favorite']=0x0;for(let _0xe92a48 in _0x20fa65){if(_0x20fa65[_0xe92a48]['movie_index_id']==_0x414656[_0x39e9e1]['id']){_0x414656[_0x39e9e1][_0x3f4ad2(0x12c)]=0x1;break;}}}}let _0x1e4de3=[];_0x45f8bb&&(_0x1e4de3=getMovieLibrary(_0x20d09c,_0x161bc,0x6));let _0x26f0d1={'code':0x0,'movies':_0x58e36e,'tv':_0x7e2a40,'history':_0x414656,'libraryList':_0x1e4de3,'sourceList':[]};_0x26f0d1[_0x3f4ad2(0x237)]=getShowMatchName(_0x20d09c[_0x3f4ad2(0x250)][_0x3f4ad2(0x1f8)]);if(_0x5543cc){let _0x345a11=_0x20d09c[_0x3f4ad2(0x250)][_0x3f4ad2(0x1f8)][_0x3f4ad2(0x281)](_0x3f4ad2(0x27e))['all']('movie');for(let _0xa39960 of _0x345a11){let _0x3d3eb5=getMoviesByParams(_0x161bc,_0x20d09c,null,'check_time',0x4,0x0,_0x3f4ad2(0x177),null,null,JSON[_0x3f4ad2(0x25d)]([path[_0x3f4ad2(0x14f)](_0xa39960[_0x3f4ad2(0x1e9)])]));if(_0x3d3eb5[_0x3f4ad2(0x275)]<0x1)continue;_0x26f0d1['sourceList']['push']({'mediaType':_0xa39960['media_type'],'path':_0xa39960[_0x3f4ad2(0x1e9)],'name':path[_0x3f4ad2(0x13d)](_0xa39960[_0x3f4ad2(0x1e9)]),'sourceMovies':_0x3d3eb5});}}return _0x161bc['json'](_0x26f0d1);}}),router['post']('/getTvHomeData',(_0x30faae,_0x393f6a,_0x5cae64)=>{const _0x3024ee=_0x3022ca;if(dbUserTable[_0x3024ee(0x13b)](_0x30faae,_0x393f6a,_0x3024ee(0x1a9),_0x3024ee(0x188))==!![]){let _0x58efac=getMoviesByParams(_0x393f6a,_0x30faae,0x1,_0x3024ee(0x1dc),0xa,0x0,_0x3024ee(0x177)),_0x370105=getMoviesByParams(_0x393f6a,_0x30faae,0x2,_0x3024ee(0x1dc),0xa,0x0,'desc'),_0x2141f4=_0x3024ee(0x178),_0x4b6bb0='SELECT\x20'+_0x2141f4+_0x3024ee(0x175)+_0x30faae[_0x3024ee(0x1a0)]['id']+_0x3024ee(0x1ab),_0x1fc904=_0x30faae[_0x3024ee(0x250)]['dbFileIndex'][_0x3024ee(0x281)](_0x4b6bb0)[_0x3024ee(0x205)](),_0x39b5c6=getCollectionList(_0x30faae,_0x393f6a,'ordinary'),_0x4b4ab4=getCollectionList(_0x30faae,_0x393f6a,_0x3024ee(0x1a4)),_0x3817eb=getMoviesByParams(_0x393f6a,_0x30faae,null,_0x3024ee(0x1dc),0xa,0x0,_0x3024ee(0x177),null,null,null,null,null,null,null,_0x3024ee(0x227)),_0x5c2791=getMovieLibrary(_0x30faae,_0x393f6a),_0x175788={'code':0x0,'movies':_0x58efac,'tv':_0x370105,'history':_0x1fc904,'favorites':_0x3817eb,'collectionList':_0x39b5c6,'aiCollectionList':_0x4b4ab4,'libraryList':_0x5c2791};return _0x393f6a[_0x3024ee(0x1d8)](_0x175788);}}),router[_0x3022ca(0x264)](_0x3022ca(0x26b),(_0x577cf9,_0x4c7dde,_0x59bffa)=>{const _0x3f57d7=_0x3022ca;if(dbUserTable[_0x3f57d7(0x13b)](_0x577cf9,_0x4c7dde,_0x3f57d7(0x1a9),_0x3f57d7(0x188))==!![]){let _0x11792b=getMoviesByParams(_0x4c7dde,_0x577cf9,0x1,_0x3f57d7(0x1dc),0x1,0x0,_0x3f57d7(0x177)),_0x103c4a=getMoviesByParams(_0x4c7dde,_0x577cf9,0x2,'check_time',0x1,0x0,'desc'),_0x3a0b3c=_0x3f57d7(0x178),_0x4bbd95=_0x3f57d7(0x17c)+_0x3a0b3c+_0x3f57d7(0x175)+_0x577cf9[_0x3f57d7(0x1a0)]['id']+_0x3f57d7(0x248),_0x5e1fbe=_0x577cf9[_0x3f57d7(0x250)][_0x3f57d7(0x21a)][_0x3f57d7(0x281)](_0x4bbd95)['all'](),_0x453bc8=getMoviesByParams(_0x4c7dde,_0x577cf9,null,'check_time',0x1,0x0,'desc',null,null,null,null,null,null,null,_0x3f57d7(0x227)),_0x58c385=dbFileIndexTable[_0x3f57d7(0x1a3)](_0x577cf9['app']['dbFileIndex'],_0x3f57d7(0x1d9),dbFileIndexTable[_0x3f57d7(0x191)]),_0x84fb7b=dbFileIndexTable[_0x3f57d7(0x1a3)](_0x577cf9['app'][_0x3f57d7(0x21a)],_0x3f57d7(0x12d),dbFileIndexTable[_0x3f57d7(0x191)]);_0x577cf9[_0x3f57d7(0x183)][_0x3f57d7(0x1db)]=0x5af3107a3fff,_0x577cf9[_0x3f57d7(0x183)]['timeType']=0x1,_0x577cf9['body']['sortField']='check_time',_0x577cf9[_0x3f57d7(0x183)][_0x3f57d7(0x1df)]=_0x3f57d7(0x177),_0x577cf9[_0x3f57d7(0x183)][_0x3f57d7(0x157)]=0x0,_0x577cf9[_0x3f57d7(0x183)]['count']=0x1;let _0x3ffebf=photoApiUtils[_0x3f57d7(0x225)](_0x577cf9,_0x4c7dde),_0x370200=getMovieLibrary(_0x577cf9,_0x4c7dde),_0x21bdb6={'movieCount':_0x58c385[_0x3f57d7(0x202)],'tvCount':_0x84fb7b['count'],'code':0x0,'movies':_0x11792b,'tv':_0x103c4a,'history':_0x5e1fbe,'favorites':_0x453bc8,'photos':_0x3ffebf,'libraryList':_0x370200};return _0x4c7dde['json'](_0x21bdb6);}});let subtitleExtList=[_0x3022ca(0x1b1),_0x3022ca(0x26f),_0x3022ca(0x23c)];router[_0x3022ca(0x264)](_0x3022ca(0x1c8),(_0x2f8af6,_0x5c7e90,_0x31980c)=>{const _0x4463f3=_0x3022ca;let _0x126991=[],_0x3b77ea=null;if(_0x2f8af6[_0x4463f3(0x183)][_0x4463f3(0x222)])_0x3b77ea=_0x2f8af6[_0x4463f3(0x183)]['videoPath'],_0x3b77ea=fileUtil[_0x4463f3(0x23f)](_0x3b77ea);else{if(_0x2f8af6[_0x4463f3(0x183)]['id']){let _0x5a8c50=_0x2f8af6['body']['id'],_0x2f5042=dbFileIndexTable[_0x4463f3(0x285)](_0x2f8af6[_0x4463f3(0x250)][_0x4463f3(0x21a)],_0x5a8c50,dbFileIndexTable[_0x4463f3(0x191)]);_0x2f5042&&(_0x3b77ea=path['join'](_0x2f5042[_0x4463f3(0x1e9)],_0x2f5042[_0x4463f3(0x287)]),_0x2f8af6[_0x4463f3(0x250)][_0x4463f3(0x21a)][_0x4463f3(0x281)](_0x4463f3(0x20b))['run'](Date[_0x4463f3(0x274)](),_0x2f5042['id']));}}function _0x8bbed5(){const _0x1754ce=_0x4463f3;let _0xa26a6b=dbConfigTable[_0x1754ce(0x240)](_0x2f8af6[_0x1754ce(0x250)][_0x1754ce(0x1f8)],_0x1754ce(0x24e)),_0x215ac0=dbConfigTable[_0x1754ce(0x240)](_0x2f8af6[_0x1754ce(0x250)][_0x1754ce(0x1f8)],_0x1754ce(0x179));return _0x5c7e90[_0x1754ce(0x1d8)]({'code':0x0,'data':_0x126991,'defaultTranscodeResolution':_0x215ac0?_0x215ac0[_0x1754ce(0x166)]:'1080p\x203mbps','userFontSize':_0xa26a6b?_0xa26a6b['value']:1.5});}_0x3b77ea?fs['stat'](_0x3b77ea,(_0x39e749,_0x4da7ee)=>{const _0x4351c9=_0x4463f3;if(_0x39e749)return _0x8bbed5();let _0x9e092e=path[_0x4351c9(0x1e6)](_0x3b77ea);fs[_0x4351c9(0x200)](_0x9e092e,(_0x5734b9,_0x3a2b97)=>{const _0x1dbbb8=_0x4351c9;if(_0x5734b9)return _0x8bbed5();let _0x581876=path[_0x1dbbb8(0x13d)](_0x3b77ea)[_0x1dbbb8(0x235)](path['extname'](_0x3b77ea),''),_0x5b29e2=_0x581876[_0x1dbbb8(0x203)]('\x20','_');for(let _0x109fe4 in _0x3a2b97){let _0x2e769f=_0x3a2b97[_0x109fe4],_0x2f4a78=path[_0x1dbbb8(0x19b)](_0x2e769f);(_0x2e769f[_0x1dbbb8(0x24c)](_0x581876)||_0x2e769f['startsWith'](_0x5b29e2))&&subtitleExtList[_0x1dbbb8(0x21e)](_0x2f4a78)&&_0x126991['push']({'fileName':path[_0x1dbbb8(0x13d)](_0x2e769f),'filePath':path[_0x1dbbb8(0x14f)](_0x9e092e,_0x2e769f)});}return _0x8bbed5();});}):_0x8bbed5();}),router[_0x3022ca(0x264)](_0x3022ca(0x16f),(_0x473b5b,_0x2e5b0d,_0x367ece)=>{const _0x438d1c=_0x3022ca;let _0x3d30c2=_0x473b5b['app'][_0x438d1c(0x21a)][_0x438d1c(0x281)]('SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_genres\x27\x20and\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100')[_0x438d1c(0x205)](),_0x5acf74=_0x473b5b[_0x438d1c(0x250)][_0x438d1c(0x21a)][_0x438d1c(0x281)]('SELECT\x20*\x20FROM\x20movie_keys\x20where\x20key_type=\x27movie_language\x27\x20and\x20\x20index_count>0\x20ORDER\x20BY\x20index_count\x20DESC\x20LIMIT\x20100')['all'](),_0xfff161=_0x473b5b[_0x438d1c(0x250)][_0x438d1c(0x21a)][_0x438d1c(0x281)](_0x438d1c(0x207))[_0x438d1c(0x205)]();_0x2e5b0d[_0x438d1c(0x1d8)]({'code':0x0,'data':_0x3d30c2['concat'](_0x5acf74,_0xfff161)});}),router[_0x3022ca(0x264)](_0x3022ca(0x143),(_0x3226ff,_0x2589e0,_0x1ceeb1)=>{const _0x4d9d44=_0x3022ca;let _0x1479af=_0x3226ff[_0x4d9d44(0x183)]['indexId'],_0x1ce8ac=dbFileIndexTable[_0x4d9d44(0x285)](_0x3226ff['app'][_0x4d9d44(0x21a)],_0x1479af,dbFileIndexTable[_0x4d9d44(0x191)]);if(!_0x1ce8ac)return _0x2589e0[_0x4d9d44(0x1d8)]({'code':0x0});if(dbUserTable['doUserCanGet'](_0x3226ff,_0x2589e0,'movie',_0x4d9d44(0x1e4),_0x1ce8ac[_0x4d9d44(0x1e9)])==!![])return dbFileIndexTable[_0x4d9d44(0x232)](_0x3226ff[_0x4d9d44(0x250)][_0x4d9d44(0x21a)],_0x1479af,dbFileIndexTable[_0x4d9d44(0x191)]),_0x2589e0[_0x4d9d44(0x1d8)]({'code':0x0});}),router['post'](_0x3022ca(0x139),(_0x2e388c,_0x4d791a,_0x5ebc5c)=>{const _0x2cab6c=_0x3022ca;let _0x1dfdc=_0x2e388c[_0x2cab6c(0x1a0)]['id'],_0x34236e=parseInt(_0x2e388c[_0x2cab6c(0x183)]['movieIndexId']),_0x4520b5=dbMovieFavorite['getFavorite'](_0x2e388c[_0x2cab6c(0x250)]['dbFileIndex'],_0x1dfdc,_0x34236e),_0x3a5469=0x0;if(_0x4520b5)dbMovieFavorite['deleteFavorite'](_0x2e388c[_0x2cab6c(0x250)][_0x2cab6c(0x21a)],_0x1dfdc,_0x34236e);else{_0x3a5469=0x1;let _0x5375a2=new Date()[_0x2cab6c(0x20e)]();_0x2e388c['app']['dbFileIndex']['prepare'](_0x2cab6c(0x20b))[_0x2cab6c(0x1de)](_0x5375a2,_0x34236e),dbMovieFavorite[_0x2cab6c(0x1a7)](_0x2e388c['app'][_0x2cab6c(0x21a)],_0x1dfdc,_0x34236e);}return _0x4d791a[_0x2cab6c(0x1d8)]({'code':0x0,'favorite':_0x3a5469});}),router[_0x3022ca(0x264)]('/setTitleAndEnding',(_0x2185f2,_0x10d124,_0x29d98d)=>{const _0x568137=_0x3022ca;try{let _0x2ec0f3=parseInt(_0x2185f2[_0x568137(0x183)][_0x568137(0x1b3)]),_0x2a2d6=dbFileIndexTable[_0x568137(0x285)](_0x2185f2[_0x568137(0x250)][_0x568137(0x21a)],_0x2ec0f3,dbFileIndexTable[_0x568137(0x191)]);if(!_0x2a2d6)return _0x10d124[_0x568137(0x1d8)]({'code':0x0});let _0x464930=parseInt(_0x2185f2['body'][_0x568137(0x1f1)]),_0x305b1a=parseInt(_0x2185f2[_0x568137(0x183)][_0x568137(0x1b7)]);!_0x305b1a&&(_0x305b1a=0x0);!_0x464930&&(_0x464930=0x0);let _0x511f8a=parseInt(_0x2185f2[_0x568137(0x183)][_0x568137(0x160)]);if(_0x464930<0x0||_0x305b1a<0x0||_0x464930>_0x2a2d6[_0x568137(0x26d)]||_0x305b1a>_0x2a2d6[_0x568137(0x26d)]||_0x511f8a!=0x0&&_0x511f8a!=0x1)return _0x2185f2[_0x568137(0x250)][_0x568137(0x230)](_0x10d124,_0x568137(0x270));let _0x15dce8=[_0x2a2d6];_0x2a2d6[_0x568137(0x136)]==0x1&&(_0x15dce8=_0x2185f2[_0x568137(0x250)][_0x568137(0x21a)][_0x568137(0x281)](_0x568137(0x242)+dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']+_0x568137(0x1fc))[_0x568137(0x205)](_0x2a2d6[_0x568137(0x1e9)]));let _0x4bd8c7='(';for(let _0x119dd2 in _0x15dce8){_0x4bd8c7+=_0x15dce8[_0x119dd2]['id'],_0x119dd2!=_0x15dce8['length']-0x1&&(_0x4bd8c7+=',');}return _0x4bd8c7+=')',_0x2185f2[_0x568137(0x250)][_0x568137(0x21a)][_0x568137(0x281)](_0x568137(0x25e)+_0x4bd8c7)[_0x568137(0x1de)](_0x464930,_0x305b1a,_0x511f8a),_0x10d124[_0x568137(0x1d8)]({'code':0x0});}catch(_0x2e30fe){return console[_0x568137(0x1d4)](_0x2e30fe),_0x2185f2[_0x568137(0x250)][_0x568137(0x230)](_0x10d124,_0x10d124['__'](_0x568137(0x1ce)));}});function getMovieLibrary(_0x250c8c,_0x41dcae,_0x4a26d4){const _0x2059a6=_0x3022ca;let _0x4d530b=_0x250c8c['body'][_0x2059a6(0x208)]||0x0,_0x544d34=_0x4a26d4||_0x250c8c['body']['count']||0x32,_0x208a07=_0x250c8c[_0x2059a6(0x183)]['search']||'',_0x3db69b=_0x250c8c[_0x2059a6(0x183)][_0x2059a6(0x1a5)]||_0x2059a6(0x229),_0x440237=_0x250c8c[_0x2059a6(0x183)]['orderType']||_0x2059a6(0x177);if(![_0x2059a6(0x229),'title'][_0x2059a6(0x21e)](_0x3db69b))return console[_0x2059a6(0x1d4)](_0x2059a6(0x15d),_0x3db69b),[];let _0x3f632a=[],_0x1d7ba0=[],_0x1c68f3=_0x2059a6(0x209);_0x250c8c[_0x2059a6(0x1a0)][_0x2059a6(0x156)]==0x1?_0x208a07&&(_0x1c68f3+=_0x2059a6(0x18c),_0x1d7ba0['push']('%'+_0x208a07+'%')):(_0x1c68f3=_0x2059a6(0x19f),_0x208a07&&(_0x1c68f3+=_0x2059a6(0x138),_0x1d7ba0[_0x2059a6(0x14e)]('%'+_0x208a07+'%')));_0x1c68f3+='\x20ORDER\x20BY\x20'+_0x3db69b+'\x20'+_0x440237+_0x2059a6(0x1f9),_0x1d7ba0[_0x2059a6(0x14e)](_0x544d34),_0x1d7ba0[_0x2059a6(0x14e)](_0x4d530b),_0x3f632a=_0x250c8c[_0x2059a6(0x250)][_0x2059a6(0x21a)]['prepare'](_0x1c68f3)['all'](_0x1d7ba0);if(_0x3f632a['length']<0x1)return[];for(let _0x154e8a in _0x3f632a){let _0x3a5b8e=_0x3f632a[_0x154e8a];try{let _0x475376=JSON[_0x2059a6(0x146)](_0x3a5b8e['share_uid']),_0x57052f=[];for(let _0x335794 of _0x475376){let _0x3ee008=dbUserTable[_0x2059a6(0x1c0)](_0x250c8c[_0x2059a6(0x250)][_0x2059a6(0x1f8)],_0x335794,_0x2059a6(0x17f));_0x57052f['push'](_0x3ee008);}_0x3f632a[_0x154e8a]['user_list']=_0x57052f;}catch(_0x7c59bf){console[_0x2059a6(0x1d4)](_0x7c59bf);}let _0x3f5dd3=getMoviesByParams(_0x41dcae,_0x250c8c,null,'check_time',0x4,0x0,_0x2059a6(0x177),null,null,null,null,null,null,null,null,null,_0x3f632a[_0x154e8a]['id']);_0x3f632a[_0x154e8a][_0x2059a6(0x231)]=_0x3f5dd3;}return _0x3f632a;}router[_0x3022ca(0x264)]('/operationLibrary',(_0x3d0fed,_0x29ac4e,_0x125090)=>{const _0x3faeb3=_0x3022ca;let _0x192816=_0x3d0fed[_0x3faeb3(0x183)][_0x3faeb3(0x243)],_0x3f68fe=_0x3d0fed[_0x3faeb3(0x183)]['libraryId'],_0x329ccc=_0x3d0fed[_0x3faeb3(0x183)][_0x3faeb3(0x267)],_0x464a79=_0x3d0fed['body']['shareUidList'],_0xeffb76=_0x3d0fed[_0x3faeb3(0x183)]['shareForSubUser'],_0x3f6ee4=_0x3d0fed[_0x3faeb3(0x183)]['operation'];if(_0x3f6ee4==_0x3faeb3(0x279)){let _0x120d77=getMovieLibrary(_0x3d0fed,_0x29ac4e);return _0x29ac4e[_0x3faeb3(0x1d8)]({'code':0x0,'data':_0x120d77});}else{if(_0x3d0fed[_0x3faeb3(0x1a0)][_0x3faeb3(0x156)]!=0x1)return _0x3d0fed[_0x3faeb3(0x250)]['returnErrMsg'](_0x29ac4e,_0x29ac4e['__'](_0x3faeb3(0x251)));if(_0x3f6ee4==_0x3faeb3(0x12e)||_0x3f6ee4=='EDIT'){if(!_0x329ccc||!_0x329ccc instanceof Array||_0x329ccc[_0x3faeb3(0x275)]<0x1)return _0x3d0fed[_0x3faeb3(0x250)][_0x3faeb3(0x230)](_0x29ac4e,_0x29ac4e['__'](_0x3faeb3(0x1ce)));if(_0xeffb76){if(_0x464a79!=null&&!_0x464a79 instanceof Array)return _0x3d0fed[_0x3faeb3(0x250)][_0x3faeb3(0x230)](_0x29ac4e,_0x29ac4e['__']('operationFail'));}if(sqliteUtil[_0x3faeb3(0x25a)](JSON[_0x3faeb3(0x25d)](_0x329ccc))==!![])return _0x3d0fed[_0x3faeb3(0x250)][_0x3faeb3(0x230)](_0x29ac4e,_0x3faeb3(0x198));}if(_0x3f6ee4==_0x3faeb3(0x23d)&&_0x3f68fe)_0x3d0fed['app'][_0x3faeb3(0x21a)][_0x3faeb3(0x281)](_0x3faeb3(0x24f))['run'](_0x192816,JSON[_0x3faeb3(0x25d)](_0x329ccc),_0xeffb76,JSON['stringify'](_0x464a79),_0x3f68fe);else{if(_0x3f6ee4==_0x3faeb3(0x238)&&_0x3f68fe)_0x3d0fed['app']['dbFileIndex'][_0x3faeb3(0x281)](_0x3faeb3(0x239))[_0x3faeb3(0x1de)](_0x3f68fe);else{if(_0x3f6ee4==_0x3faeb3(0x12e))_0x3d0fed[_0x3faeb3(0x250)][_0x3faeb3(0x21a)][_0x3faeb3(0x281)](_0x3faeb3(0x263))[_0x3faeb3(0x1de)](_0x192816,JSON['stringify'](_0x329ccc),_0xeffb76,JSON['stringify'](_0x464a79),_0x3d0fed['currentUser']['id']);else return _0x3d0fed[_0x3faeb3(0x250)][_0x3faeb3(0x230)](_0x29ac4e,_0x29ac4e['__'](_0x3faeb3(0x251)));}}return _0x29ac4e[_0x3faeb3(0x1d8)]({'code':0x0});}}),module[_0x3022ca(0x234)]=router;