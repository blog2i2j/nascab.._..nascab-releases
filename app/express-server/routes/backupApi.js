function _0x16d9(){const _0x295b4d=['access','6hBjtVI','noReadPermission','\x20status=\x27waiting\x27','create','taskTime','cannotUseRootPathAsBackupTarget','W_OK','running','update','getAllByTaskType','../../db/dbBackupTask','373745GhJmch','getAllRecordMsgByWhere','stop','log','/operationTask','initBackupWorker','2159030bnskgk','taskAlreadyRunning','/getTaskById','getRecordByWhere','8WNsmUG','currentUser','/getRunningTaskList','moment','isDirectory','type','/deleteTask','17SIJsNg','getAllRecordByWhere','send','dbOther','noRunningTasks','\x20status=\x27stop\x27','YYYY-MM-DD\x20HH:mm:ss','/getTaskRecords','/createTask','2667497mIxUxb','body','exports','constants','taskId','getAll','format','app','taskAlreadQueued','createRecord','taskDay','\x20task_id=?\x20and\x20status=\x27done\x27\x20order\x20by\x20id\x20desc\x20limit\x20100','noWritePermission','task\x20id\x20is\x20error','updateRecord','returnErrMsg','path','recordId','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','\x20task_id=?\x20and\x20(status=\x27stop\x27\x20or\x20status=\x27waiting\x27\x20or\x20status=\x27running\x27)','287720QZULyl','/getAllTask','\x20task_record_id=?\x20order\x20by\x20id\x20desc\x20limit\x20100','waiting','126TldLAL','86810EJvJBq','status','Router','\x20task_id=?\x20order\x20by\x20id\x20desc\x20limit\x201','lastRecord','post','taskType','is_admin','sourceList','R_OK','express','dialog','12024496MZBDEb','1221504ItjjUk','json','getById','delete','stringify','test'];_0x16d9=function(){return _0x295b4d;};return _0x16d9();}const _0xfc549c=_0x48c8;(function(_0x2ae03b,_0x42a446){const _0x3dde46=_0x48c8,_0x527538=_0x2ae03b();while(!![]){try{const _0x30ed57=-parseInt(_0x3dde46(0xfb))/0x1*(-parseInt(_0x3dde46(0xcb))/0x2)+-parseInt(_0x3dde46(0xd8))/0x3+parseInt(_0x3dde46(0xf4))/0x4*(parseInt(_0x3dde46(0xea))/0x5)+-parseInt(_0x3dde46(0xdf))/0x6*(-parseInt(_0x3dde46(0xb2))/0x7)+parseInt(_0x3dde46(0xc6))/0x8*(parseInt(_0x3dde46(0xca))/0x9)+parseInt(_0x3dde46(0xf0))/0xa+-parseInt(_0x3dde46(0xd7))/0xb;if(_0x30ed57===_0x42a446)break;else _0x527538['push'](_0x527538['shift']());}catch(_0x3f0e97){_0x527538['push'](_0x527538['shift']());}}}(_0x16d9,0x7708b));var express=require(_0xfc549c(0xd5)),router=express[_0xfc549c(0xcd)]();function _0x48c8(_0x3702d1,_0x315522){const _0x16d997=_0x16d9();return _0x48c8=function(_0x48c8b1,_0x333239){_0x48c8b1=_0x48c8b1-0xab;let _0x3a0bcb=_0x16d997[_0x48c8b1];return _0x3a0bcb;},_0x48c8(_0x3702d1,_0x315522);}let path=require(_0xfc549c(0xc2)),fs=require('fs');const dbBackupTask=require(_0xfc549c(0xe9));let moment=require(_0xfc549c(0xf7));router[_0xfc549c(0xd0)](_0xfc549c(0xb1),(_0x51b641,_0x574266,_0x4fd404)=>{const _0x4911bf=_0xfc549c;if(_0x51b641[_0x4911bf(0xf5)][_0x4911bf(0xd2)]!=0x1)return _0x574266[_0x4911bf(0xd9)]({'code':0x66});let _0x25727f=_0x51b641[_0x4911bf(0xb3)][_0x4911bf(0xf9)],_0x57cc6e=_0x51b641[_0x4911bf(0xb3)]['taskName'],_0x207cd6=_0x51b641[_0x4911bf(0xb3)][_0x4911bf(0xd3)],_0x1fd517=_0x51b641[_0x4911bf(0xb3)]['excludeList'],_0x4d0054=path['join'](_0x51b641[_0x4911bf(0xb3)]['targetPath']),_0xb27e20=_0x51b641[_0x4911bf(0xb3)][_0x4911bf(0xd1)],_0x442f6c=_0x51b641[_0x4911bf(0xb3)][_0x4911bf(0xbc)],_0x21cf08=_0x51b641[_0x4911bf(0xb3)][_0x4911bf(0xe3)];if(/^\w\:\\$/['test'](_0x4d0054))return _0x51b641[_0x4911bf(0xb9)]['returnErrMsg'](_0x574266,_0x574266['__'](_0x4911bf(0xe4)),_0x4911bf(0xd6));let _0x4968fe=0x0;for(let _0x767a79 in _0x207cd6){_0x207cd6[_0x767a79]=path['join'](_0x207cd6[_0x767a79]);if(/^\w\:\\$/[_0x4911bf(0xdd)](_0x207cd6[_0x767a79]))return _0x51b641[_0x4911bf(0xb9)][_0x4911bf(0xc1)](_0x574266,_0x574266['__'](_0x4911bf(0xe4)),'dialog');fs[_0x4911bf(0xde)](_0x207cd6[_0x767a79],fs[_0x4911bf(0xb5)][_0x4911bf(0xd4)],_0x222a63=>{const _0x5d5a31=_0x4911bf;if(_0x222a63)return _0x51b641[_0x5d5a31(0xb9)][_0x5d5a31(0xc1)](_0x574266,_0x574266['__'](_0x5d5a31(0xe0))+':'+_0x207cd6[_0x767a79]);_0x4968fe+=0x1,_0x4968fe==_0x207cd6['length']&&_0x1d77b9();});}function _0x1d77b9(){const _0x10dfdf=_0x4911bf;fs[_0x10dfdf(0xde)](_0x4d0054,fs[_0x10dfdf(0xb5)][_0x10dfdf(0xe5)]|fs[_0x10dfdf(0xb5)][_0x10dfdf(0xd4)],_0x4232c5=>{const _0x472942=_0x10dfdf;if(_0x4232c5)return console[_0x472942(0xed)](_0x4232c5),_0x51b641[_0x472942(0xb9)]['returnErrMsg'](_0x574266,_0x574266['__'](_0x472942(0xbe))+':'+_0x4d0054);fs['stat'](_0x4d0054,(_0x711c0,_0x5130b3)=>{const _0x2361ec=_0x472942;if(_0x711c0||!_0x5130b3[_0x2361ec(0xf8)]())return _0x51b641[_0x2361ec(0xb9)]['returnErrMsg'](_0x574266,_0x574266['__']('noGetFolderStat'));let _0x417bec={'task_name':_0x57cc6e,'source_list':JSON[_0x2361ec(0xdc)](_0x207cd6),'exclude_list':JSON[_0x2361ec(0xdc)](_0x1fd517),'target_path':_0x4d0054,'task_type':_0xb27e20,'task_day':_0x442f6c,'task_time':_0x21cf08};if(_0x25727f==_0x2361ec(0xe2))dbBackupTask[_0x2361ec(0xe2)](_0x51b641[_0x2361ec(0xb9)][_0x2361ec(0xac)],_0x417bec);else{if(_0x25727f==_0x2361ec(0xe7)){let _0x49cf03=_0x51b641[_0x2361ec(0xb3)]['id'];dbBackupTask[_0x2361ec(0xe7)](_0x51b641[_0x2361ec(0xb9)]['dbOther'],_0x417bec,_0x49cf03);}}return process['send']({'type':_0x2361ec(0xef)}),_0x574266[_0x2361ec(0xd9)]({'code':0x0});});});}}),router[_0xfc549c(0xd0)](_0xfc549c(0xfa),(_0x3ae9f9,_0x4acbfe,_0x265e79)=>{const _0x4fc3aa=_0xfc549c;if(_0x3ae9f9[_0x4fc3aa(0xf5)]['is_admin']!=0x1)return _0x4acbfe[_0x4fc3aa(0xd9)]({'code':0x66});let _0x2b7959=_0x3ae9f9['body']['id'];dbBackupTask[_0x4fc3aa(0xdb)](_0x3ae9f9['app'][_0x4fc3aa(0xac)],_0x2b7959),process[_0x4fc3aa(0xab)]({'type':_0x4fc3aa(0xef)}),_0x4acbfe[_0x4fc3aa(0xd9)]({'code':0x0});}),router[_0xfc549c(0xd0)](_0xfc549c(0xee),(_0x39d1e7,_0x59efe5,_0x1b4d76)=>{const _0x207926=_0xfc549c;if(_0x39d1e7[_0x207926(0xf5)]['is_admin']!=0x1)return _0x59efe5[_0x207926(0xd9)]({'code':0x66});let _0x19e0ff=_0x39d1e7['body'][_0x207926(0xf9)],_0x26a5bc=_0x39d1e7['body'][_0x207926(0xb6)],_0x156686=dbBackupTask[_0x207926(0xda)](_0x39d1e7[_0x207926(0xb9)][_0x207926(0xac)],_0x26a5bc);if(!_0x156686)return _0x59efe5[_0x207926(0xd9)]({'code':0x1,'message':_0x207926(0xbf)});if(_0x19e0ff=='start'){let _0x127ceb=dbBackupTask['getRecordByWhere'](_0x39d1e7['app'][_0x207926(0xac)],_0x207926(0xc5),[_0x26a5bc]);if(_0x127ceb){if(_0x127ceb['status']=='waiting')return _0x59efe5[_0x207926(0xd9)]({'code':0x1,'message':_0x59efe5['__'](_0x207926(0xba)),'task_record':_0x127ceb});else{if(_0x127ceb[_0x207926(0xcc)]==_0x207926(0xe6))return _0x59efe5[_0x207926(0xd9)]({'code':0x1,'message':_0x59efe5['__'](_0x207926(0xf1)),'task_record':_0x127ceb});else _0x127ceb[_0x207926(0xcc)]==_0x207926(0xec)&&dbBackupTask[_0x207926(0xc0)](_0x39d1e7[_0x207926(0xb9)][_0x207926(0xac)],_0x127ceb['id'],_0x207926(0xe1));}}else{let _0x34be19=moment()[_0x207926(0xb8)](_0x207926(0xaf));dbBackupTask[_0x207926(0xbb)](_0x39d1e7[_0x207926(0xb9)][_0x207926(0xac)],_0x26a5bc,_0x207926(0xc9),_0x34be19);}}else{if(_0x19e0ff==_0x207926(0xec)){let _0x16dc78=dbBackupTask[_0x207926(0xf3)](_0x39d1e7[_0x207926(0xb9)]['dbOther'],'\x20task_id=?\x20and\x20status=\x27running\x27',[_0x26a5bc]);if(!_0x16dc78)return _0x59efe5[_0x207926(0xd9)]({'code':0x1,'message':_0x59efe5['__'](_0x207926(0xad)),'task_record':_0x16dc78});else dbBackupTask[_0x207926(0xc0)](_0x39d1e7['app'][_0x207926(0xac)],_0x16dc78['id'],_0x207926(0xae));}}process[_0x207926(0xab)]({'type':_0x207926(0xef)}),_0x59efe5['json']({'code':0x0});}),router[_0xfc549c(0xd0)](_0xfc549c(0xc7),(_0x2df690,_0x2f9cd9,_0x2768cc)=>{const _0x36350a=_0xfc549c;if(_0x2df690['currentUser']['is_admin']!=0x1)return _0x2f9cd9[_0x36350a(0xd9)]({'code':0x66});let _0x12cc77=_0x2df690['body'][_0x36350a(0xd1)],_0x23400f=[];_0x12cc77=parseInt(_0x12cc77);_0x12cc77?_0x23400f=dbBackupTask[_0x36350a(0xe8)](_0x2df690[_0x36350a(0xb9)]['dbOther'],_0x12cc77):_0x23400f=dbBackupTask[_0x36350a(0xb7)](_0x2df690[_0x36350a(0xb9)][_0x36350a(0xac)]);for(let _0x84dbd0 in _0x23400f){let _0x34600f=dbBackupTask[_0x36350a(0xf3)](_0x2df690[_0x36350a(0xb9)][_0x36350a(0xac)],_0x36350a(0xce),[_0x23400f[_0x84dbd0]['id']]);_0x23400f[_0x84dbd0][_0x36350a(0xcf)]=_0x34600f;}_0x2f9cd9[_0x36350a(0xd9)]({'code':0x0,'data':_0x23400f});}),router[_0xfc549c(0xd0)](_0xfc549c(0xf2),(_0x48c632,_0x394eed,_0x50468c)=>{const _0x198800=_0xfc549c;if(_0x48c632['currentUser'][_0x198800(0xd2)]!=0x1)return _0x394eed[_0x198800(0xd9)]({'code':0x66});let _0xe30404=_0x48c632[_0x198800(0xb3)]['id'],_0x2f1011=dbBackupTask[_0x198800(0xda)](_0x48c632['app'][_0x198800(0xac)],_0xe30404);_0x394eed[_0x198800(0xd9)]({'code':0x0,'data':_0x2f1011});}),router[_0xfc549c(0xd0)](_0xfc549c(0xb0),(_0x5e2146,_0x235713,_0x5a0d28)=>{const _0x2cc3f9=_0xfc549c;if(_0x5e2146[_0x2cc3f9(0xf5)][_0x2cc3f9(0xd2)]!=0x1)return _0x235713['json']({'code':0x66});let _0x36b68a=_0x5e2146[_0x2cc3f9(0xb3)]['id'],_0x427903=dbBackupTask[_0x2cc3f9(0xfc)](_0x5e2146[_0x2cc3f9(0xb9)][_0x2cc3f9(0xac)],_0x2cc3f9(0xbd),[_0x36b68a]);_0x235713[_0x2cc3f9(0xd9)]({'code':0x0,'data':_0x427903});}),router[_0xfc549c(0xd0)]('/getTaskRecordMsg',(_0x45a081,_0x2f397b,_0x4c30a7)=>{const _0x1b0f94=_0xfc549c;if(_0x45a081[_0x1b0f94(0xf5)][_0x1b0f94(0xd2)]!=0x1)return _0x2f397b[_0x1b0f94(0xd9)]({'code':0x66});let _0x4e73db=_0x45a081['body'][_0x1b0f94(0xc3)],_0x6063ae=dbBackupTask[_0x1b0f94(0xeb)](_0x45a081[_0x1b0f94(0xb9)][_0x1b0f94(0xac)],_0x1b0f94(0xc8),[_0x4e73db]);_0x2f397b[_0x1b0f94(0xd9)]({'code':0x0,'data':_0x6063ae});}),router[_0xfc549c(0xd0)](_0xfc549c(0xf6),(_0x563bf5,_0x2c35fb,_0x31c118)=>{const _0x294db3=_0xfc549c;if(_0x563bf5[_0x294db3(0xf5)][_0x294db3(0xd2)]!=0x1)return _0x2c35fb[_0x294db3(0xd9)]({'code':0x66});let _0x3f798a=_0x563bf5[_0x294db3(0xb3)][_0x294db3(0xc3)],_0x2a1230=dbBackupTask[_0x294db3(0xfc)](_0x563bf5['app'][_0x294db3(0xac)],_0x294db3(0xc4),[]);_0x2c35fb['json']({'code':0x0,'data':_0x2a1230});}),module[_0xfc549c(0xb4)]=router;