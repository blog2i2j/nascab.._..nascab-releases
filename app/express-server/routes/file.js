const _0x1e58b8=_0x3557;(function(_0x1fe56c,_0x50d833){const _0x458930=_0x3557,_0x471152=_0x1fe56c();while(!![]){try{const _0x1dcac1=-parseInt(_0x458930(0x21c))/0x1*(-parseInt(_0x458930(0x23e))/0x2)+-parseInt(_0x458930(0x224))/0x3*(parseInt(_0x458930(0x19b))/0x4)+parseInt(_0x458930(0x230))/0x5+-parseInt(_0x458930(0x1c8))/0x6*(parseInt(_0x458930(0x168))/0x7)+-parseInt(_0x458930(0x1ca))/0x8*(-parseInt(_0x458930(0x20c))/0x9)+parseInt(_0x458930(0x15b))/0xa+parseInt(_0x458930(0x190))/0xb;if(_0x1dcac1===_0x50d833)break;else _0x471152['push'](_0x471152['shift']());}catch(_0x286cba){_0x471152['push'](_0x471152['shift']());}}}(_0x2c96,0x901af));function _0x2c96(){const _0x24a77f=['startsWith','sourceFolderMovie','getTransSizeStr','write','../../db/dbNoticeCenterTable','all','delete','add','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','custom','sourcePath','code','atimeMs','fileFullPath','getTempShareObj','pathName','/getPathState','select\x20id,type,url,name,remark\x20from\x20path_mount','exports','$RECYCLE.BIN','/operationPathMount','addFileOperationRecord','photo','replace','pipe','/Users','username','level','delete\x20from\x20path_mount\x20where\x20id=?','cut','SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?','fullPath','res\x20closed,destroy\x20zip\x20stream','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?','5222028ncrRVF','mtimeMs','4597552FpisMT','Downloads','Convert\x20to\x20utf8\x20','operationType','userDataFolder','error','query','/zipFile','finalize','cwd','then','unpipe','append','app','SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?','zip\x20error','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','/tempShare','.zip','unzip','localPathIsReadable','isDirectory','dbOther','create','url','includes','searchStr','createReadStream','currentUser','end','zip','sort','noReadPermission','TYPE_RENMAE','folderName','Unable\x20to\x20read\x20file','findByTitleArr','raw','getUtf8FileStream','toLowerCase','operationFail','read','returnDealedFile','close','subType','utf8','sep','R_OK','floor','push','sourceFolderBook','body','../../db/dbUserTable','$WinREAgent','children','.sys','../../utils/fileStatUtil','endsWith','getPathByType','/clearOperationRecord','getWindowsDiskList','sourcePathList','LEVEL_MAIN_OPERATION','/addNewFolder','/operationFileList','size','9saWijC','sameNameFileAlreadExist','localeCompare','post','returnFileError','putInSystemTrash','birthtimeMs','darwin','decodePath','STATE_SUC','isFile','headersSent','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?','cannotCopyToSelf','destroy','stringify','907WmXVim','attachment;\x20filename*=UTF-8\x27\x27','cachePathRoot','SELECT\x20*\x20FROM\x20share_temp','prepare','length','returnErrMsg','targetPathInvalid','2364rIBfFI','/operationFolder','get','mkdir','express','/getOperationRecord','checkPath','lastInsertRowid','/customImageFile','../../db/dbSourceFolderTable','sendFile','result','603820GgbiLC','Content-Disposition','newName','deleteSuccess','days','shell','statSync','path','Documents','../utils/sharpUtils','platform','parent','power_change','setHeader','246mezsvl','existsSync','is_admin','FILE_OPERATION','targetPath','log','zip\x20finish','664290qnRAuA','err','stack','win32','doUserCanGetTempShare','/rawFile*','type','no\x20permission\x20','deleteId','../../myConfig/config','toUpperCase','Documents\x20and\x20Settings','data','7uXwiNz','folder','local','password','deleteFileRecordAll','send','/getPathTree','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','doUserCanGet','sourceFolderMusic','/getTempShareFiles','STATE_FAIL','test','quality','status','basename','W_OK','sizeStr','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','message','/deleteByPath','join','PerfLogs','fileName','parse','root','constants','TYPE_DELETE','/fileExist','json','download','rename','/getTempShare','Router','power_get','START_WORKER_FILE_OPERATION','folderNotExist','$Recycle.Bin','webdav','getUserPower','14632519hlGQUm','copy','run','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)','noWritePermission','EXIST','sourceFolderPhoto','/checkFolderPower','/zipFile/*','stat','name','3772MGFKLA','random','access','power_add','../../db/dbConfigTable','\x20->\x20','music','../utils/fileUtils','getTime','readdir','pageSize'];_0x2c96=function(){return _0x24a77f;};return _0x2c96();}let express=require(_0x1e58b8(0x228)),router=express[_0x1e58b8(0x189)](),path=require('path'),fs=require('fs'),sha256=require('sha256'),fileUtil=require(_0x1e58b8(0x1a2));function _0x3557(_0x503d69,_0x528624){const _0x2c96fd=_0x2c96();return _0x3557=function(_0x35574f,_0x2c426b){_0x35574f=_0x35574f-0x15b;let _0x81329b=_0x2c96fd[_0x35574f];return _0x81329b;},_0x3557(_0x503d69,_0x528624);}const sharp=require('sharp'),os=require('os');let platform=os[_0x1e58b8(0x23a)]();const dbUserTable=require(_0x1e58b8(0x1fe)),dbNoticeCenterTable=require(_0x1e58b8(0x1aa)),dbConfigTable=require(_0x1e58b8(0x19f)),dbSourceFolderTable=require(_0x1e58b8(0x22d)),dbFileOperationRecord=require('../../db/dbFileOperationRecord'),fileStatUtil=require(_0x1e58b8(0x202)),config=require(_0x1e58b8(0x164)),sharpUtil=require(_0x1e58b8(0x239)),globalInfoUtil=require('../../utils/globalInfoUtil'),archiver=require('archiver'),encodingUtil=require('../../utils/encodingUtil');let macPowerDetected=![],win32ExcludeList=['System\x20Volume\x20Information',_0x1e58b8(0x18d),_0x1e58b8(0x1b9),_0x1e58b8(0x1ff),_0x1e58b8(0x166),_0x1e58b8(0x17e)];router[_0x1e58b8(0x226)](_0x1e58b8(0x198),(_0x387845,_0x2b478a,_0x2187c5)=>{const _0x13866e=_0x1e58b8;if(!_0x387845[_0x13866e(0x1d0)][_0x13866e(0x237)])return _0x2b478a[_0x13866e(0x176)](0x194)[_0x13866e(0x1e7)]();let _0x3cda72=fileUtil[_0x13866e(0x214)](_0x387845[_0x13866e(0x1d0)][_0x13866e(0x237)]),_0x36f4f1=_0x387845[_0x13866e(0x1d0)]['filename'];_0x36f4f1&&(_0x3cda72=path[_0x13866e(0x17d)](_0x3cda72,_0x36f4f1)),dbUserTable['doUserCanGet'](_0x387845,_0x2b478a,'',_0x13866e(0x18a),_0x3cda72)==!![]&&fs[_0x13866e(0x199)](_0x3cda72,(_0x400875,_0x581040)=>{const _0x404796=_0x13866e;if(_0x400875)return _0x2b478a[_0x404796(0x176)](0x194)[_0x404796(0x1e7)]();let _0x583c48=path[_0x404796(0x177)](_0x3cda72)+_0x404796(0x1dc);try{const _0x4fc129=encodeURIComponent(_0x583c48)['replace'](/%([0-9A-F]{2})/g,(_0x3b70d3,_0xd82b1f)=>'%'+_0xd82b1f[_0x404796(0x165)]());_0x2b478a[_0x404796(0x23d)]('Content-Disposition',_0x404796(0x21d)+_0x4fc129);}catch(_0x411f61){console['log'](_0x411f61);}const _0x23791b=archiver(_0x404796(0x1e8),{'zlib':{'level':0x0}});_0x23791b['on'](_0x404796(0x1cf),function(_0x42c963){const _0x618500=_0x404796;console['log'](_0x618500(0x1d9),_0x42c963[_0x618500(0x17b)]||_0x42c963[_0x618500(0x15d)]),_0x23791b[_0x618500(0x1d5)](),!_0x2b478a['headersSent']?(_0x2b478a['removeHeader'](_0x618500(0x231)),_0x2b478a[_0x618500(0x176)](0x1f4)['send']('An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.')):_0x2b478a[_0x618500(0x21a)]();}),_0x23791b['on'](_0x404796(0x1e7),function(){const _0x3ea9f9=_0x404796;console[_0x3ea9f9(0x243)](_0x3ea9f9(0x244)),_0x23791b[_0x3ea9f9(0x21a)]();});try{fs[_0x404796(0x1a4)](_0x3cda72,(_0x1e84dd,_0x3ba238)=>{const _0x3e83ea=_0x404796;for(let _0x5674a1 in _0x3ba238){let _0x3c188f=_0x3ba238[_0x5674a1];const _0x2767da=path['join'](_0x3cda72,_0x3c188f);let _0x4c3a05=fs[_0x3e83ea(0x236)](_0x2767da);_0x4c3a05[_0x3e83ea(0x1df)]()?_0x23791b['directory'](_0x2767da,_0x3c188f):_0x23791b[_0x3e83ea(0x1d6)](fs[_0x3e83ea(0x1e5)](_0x2767da),{'name':_0x3c188f});}_0x23791b[_0x3e83ea(0x1d2)](),_0x23791b[_0x3e83ea(0x1be)](_0x2b478a);});}catch(_0x29a243){!_0x2b478a[_0x404796(0x217)]&&_0x2b478a['status'](0x1f4)[_0x404796(0x16d)]({'error':_0x404796(0x1da)}),console[_0x404796(0x1cf)](_0x29a243);}_0x2b478a['on'](_0x404796(0x1f5),()=>{const _0x414890=_0x404796;console['log'](_0x414890(0x1c6)),_0x23791b[_0x414890(0x21a)]();});});}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x16e),(_0x6e4397,_0x3b915c,_0x571617)=>{const _0x22304a=_0x1e58b8;let _0x1ad61e=_0x6e4397[_0x22304a(0x1fd)][_0x22304a(0x23b)],_0x55966f=path[_0x22304a(0x1f8)],_0xb6440=_0x6e4397[_0x22304a(0x1fd)][_0x22304a(0x161)],_0x52633e=_0x6e4397[_0x22304a(0x1fd)][_0x22304a(0x1e4)],_0x419c17=[],_0x597cb0=parseInt(_0x6e4397[_0x22304a(0x1e6)]['is_admin'])==0x1,_0x32009c=fileUtil['getExcludePathList'](_0x6e4397[_0x22304a(0x1d7)][_0x22304a(0x1e0)]);try{function _0x3ead46(){const _0x178bb2=_0x22304a;let _0x39663a=dbUserTable[_0x178bb2(0x18f)](_0x6e4397[_0x178bb2(0x1d7)]['dbOther'],_0x6e4397[_0x178bb2(0x1e6)][_0x178bb2(0x1c0)],_0x178bb2(0x169),_0x178bb2(0x18a));for(let _0x36826c of _0x39663a){if(_0x32009c[_0x178bb2(0x1e3)](_0x36826c[_0x178bb2(0x237)]))continue;_0x419c17[_0x178bb2(0x1fb)]({'type':0x2,'name':_0x36826c[_0x178bb2(0x237)],'fileFullPath':_0x36826c[_0x178bb2(0x237)]});}return _0x3b915c[_0x178bb2(0x185)]({'code':0x0,'data':{'parent':'','children':_0x419c17,'sep':_0x55966f,'platform':platform}});}if(!_0x1ad61e){if(_0x597cb0){if(platform==_0x22304a(0x15e)){function _0x22f0f6(_0x22afab){const _0x1a4868=_0x22304a;let _0x442be3=[];for(let _0x22989b of _0x22afab){if(_0x32009c[_0x1a4868(0x1e3)](_0x22989b['name']))continue;_0x22989b['type']=0x2,_0x442be3[_0x1a4868(0x1fb)](_0x22989b);}for(let _0x2792cb in _0x442be3){_0x442be3[_0x2792cb][_0x1a4868(0x1b3)]=_0x442be3[_0x2792cb][_0x1a4868(0x19a)];}return _0x3b915c['json']({'code':0x0,'data':{'parent':_0x1ad61e,'children':_0x442be3,'sep':path[_0x1a4868(0x1f8)],'platform':platform}});}let _0x22bdda=dbConfigTable['findByTitle'](_0x6e4397[_0x22304a(0x1d7)][_0x22304a(0x1e0)],_0x22304a(0x21e));if(_0x22bdda)try{_0x22bdda=JSON[_0x22304a(0x180)](_0x22bdda['value']),_0x3bf43c(![]),_0x22f0f6(_0x22bdda);}catch(_0x2687e0){_0x3bf43c(!![]);}else _0x3bf43c(!![]);function _0x3bf43c(_0x2bcb51){const _0x8d5d6c=_0x22304a;globalInfoUtil[_0x8d5d6c(0x206)](_0x10c95a=>{const _0x35c90e=_0x8d5d6c;_0x10c95a=_0x10c95a[_0x35c90e(0x1e9)]((_0x284262,_0x2695b7)=>{const _0x2378a1=_0x35c90e;if(!_0x284262['name']||!_0x2695b7[_0x2378a1(0x19a)])return;return _0x284262[_0x2378a1(0x19a)][_0x2378a1(0x20e)](_0x2695b7[_0x2378a1(0x19a)]);}),dbConfigTable[_0x35c90e(0x1e1)](_0x6e4397[_0x35c90e(0x1d7)][_0x35c90e(0x1e0)],{'title':_0x35c90e(0x21e),'value':JSON[_0x35c90e(0x21b)](_0x10c95a)}),_0x2bcb51&&_0x22f0f6(_0x10c95a);});}}else{if(platform==_0x22304a(0x213)){if(!macPowerDetected){macPowerDetected=!![];try{const _0x91d36=process['env']['USER'];let _0x33c98a=[path['join'](_0x22304a(0x1bf),_0x91d36,_0x22304a(0x238)),path[_0x22304a(0x17d)](_0x22304a(0x1bf),_0x91d36,_0x22304a(0x1cb)),path[_0x22304a(0x17d)](_0x22304a(0x1bf),_0x91d36,'Desktop')];for(let _0x1bd73b in _0x33c98a){fs[_0x22304a(0x199)](_0x33c98a[_0x1bd73b],(_0x3f06a8,_0x163ea6)=>{});}}catch(_0x45f555){}}let _0x2b6bc7=path[_0x22304a(0x180)](process[_0x22304a(0x1d3)]())[_0x22304a(0x181)];_0xa29197(_0x2b6bc7);}else _0x1ad61e=path[_0x22304a(0x180)](process[_0x22304a(0x1d3)]())[_0x22304a(0x181)],_0xa29197(_0x1ad61e);}}else return _0x3ead46();}else _0xa29197(_0x1ad61e);function _0xa29197(_0x394049){const _0x3b20e4=_0x22304a;if(!_0x597cb0){if(!dbUserTable['doUserCanGet'](_0x6e4397,_0x3b915c,_0x3b20e4(0x169),_0x3b20e4(0x18a),_0x394049,!![]))return _0x3ead46();}if(_0x394049==_0x3b20e4(0x196)||_0x394049==_0x3b20e4(0x1a7)||_0x394049=='sourceFolderMusic'||_0x394049==_0x3b20e4(0x1fc)){let _0x46335f=_0x3b20e4(0x1bc);if(_0x394049=='sourceFolderMovie')_0x46335f='movie';else{if(_0x394049==_0x3b20e4(0x171))_0x46335f=_0x3b20e4(0x1a1);else _0x394049==_0x3b20e4(0x1fc)&&(_0x46335f='book');}let _0xee5dc3=dbSourceFolderTable[_0x3b20e4(0x204)](_0x6e4397['app'][_0x3b20e4(0x1e0)],_0x46335f);for(let _0x361cbf in _0xee5dc3){_0x419c17[_0x3b20e4(0x1fb)]({'type':0x2,'name':path['basename'](_0xee5dc3[_0x361cbf][_0x3b20e4(0x237)]),'fileFullPath':_0xee5dc3[_0x361cbf][_0x3b20e4(0x237)]});}return _0x3b915c[_0x3b20e4(0x185)]({'code':0x0,'data':{'parent':_0x394049,'children':_0x419c17,'sep':_0x55966f,'platform':platform}});}fs[_0x3b20e4(0x1a4)](_0x394049,{'withFileTypes':!![]},(_0x3819ce,_0x4a3cde)=>{const _0x219fde=_0x3b20e4;if(_0x3819ce)return console['log'](_0x3819ce),fileUtil[_0x219fde(0x210)](_0x3b915c,_0x3819ce);for(let _0x34562a=0x0;_0x34562a<_0x4a3cde['length'];_0x34562a++){let _0x54124f=_0x4a3cde[_0x34562a],_0x1227fc=_0x4a3cde[_0x34562a]['name'];if(_0x1227fc[_0x219fde(0x221)]>0x0){if(_0x1227fc[0x0]=='.')continue;if(/[A-Z]:\\/i[_0x219fde(0x174)](_0x394049)&&_0x394049['length']<=0x3){if(win32ExcludeList[_0x219fde(0x1e3)](_0x1227fc)||_0x1227fc[_0x219fde(0x203)](_0x219fde(0x201))||_0x1227fc[_0x219fde(0x203)]('.tmp'))continue;}}let _0x2380c1=path[_0x219fde(0x17d)](_0x394049,_0x1227fc);if(_0x32009c[_0x219fde(0x1e3)](_0x2380c1))continue;let _0x55ac50=_0x54124f[_0x219fde(0x216)](),_0x35b1e9=_0x54124f['isDirectory']();function _0x32f2b9(){const _0x18a9b5=_0x219fde;if(_0x55ac50)(_0xb6440==0x0||_0xb6440==0x1)&&_0x419c17[_0x18a9b5(0x1fb)]({'type':0x1,'name':_0x1227fc,'fileFullPath':_0x2380c1});else _0x35b1e9&&_0x419c17[_0x18a9b5(0x1fb)]({'type':0x2,'name':_0x1227fc,'fileFullPath':_0x2380c1});}_0x52633e?_0x1227fc['includes'](_0x52633e)&&_0x32f2b9():_0x32f2b9();try{if(_0x419c17[_0x219fde(0x221)]>0x1770)break;}catch(_0x5f1ad1){continue;}}let _0x55b135=_0x419c17['length'],_0x155fa7=0x0;if(_0x419c17[_0x219fde(0x221)]<0x1)return _0x3b915c[_0x219fde(0x185)]({'code':0x0,'data':{'parent':_0x394049,'children':_0x419c17,'sep':_0x55966f,'platform':platform}});for(let _0x2fc3ed of _0x419c17){fs[_0x219fde(0x199)](_0x2fc3ed[_0x219fde(0x1b3)],(_0x3aad1d,_0x217f43)=>{const _0x42bba8=_0x219fde;_0x155fa7+=0x1;!_0x3aad1d&&(_0x2fc3ed[_0x42bba8(0x1b2)]=_0x217f43[_0x42bba8(0x1b2)],_0x2fc3ed[_0x42bba8(0x1c9)]=_0x217f43[_0x42bba8(0x1c9)],_0x2fc3ed[_0x42bba8(0x212)]=_0x217f43[_0x42bba8(0x212)],_0x2fc3ed[_0x42bba8(0x20b)]=_0x217f43[_0x42bba8(0x20b)]);if(_0x155fa7>=_0x55b135)return _0x3b915c[_0x42bba8(0x185)]({'code':0x0,'data':{'parent':_0x394049,'children':_0x419c17,'sep':_0x55966f,'platform':platform}});});}});}}catch(_0x415fb3){return fileUtil[_0x22304a(0x210)](_0x3b915c,_0x415fb3);}}),router[_0x1e58b8(0x226)](_0x1e58b8(0x22c),(_0x221b99,_0x304638,_0x36a1f3)=>{const _0x314299=_0x1e58b8;let _0x2061db=fileUtil[_0x314299(0x214)](_0x221b99[_0x314299(0x1d0)][_0x314299(0x237)]);if(!_0x2061db)return _0x304638[_0x314299(0x176)](0x194)[_0x314299(0x1e7)]();_0x2061db=path[_0x314299(0x17d)](_0x2061db);let _0x391139=path[_0x314299(0x17d)](config[_0x314299(0x1ce)],_0x314299(0x1af),path[_0x314299(0x1f8)]);return _0x2061db['startsWith'](_0x391139)?_0x304638[_0x314299(0x22e)](_0x2061db):_0x304638[_0x314299(0x176)](0x194)['end']();}),router[_0x1e58b8(0x226)](_0x1e58b8(0x160),(_0x207383,_0x56eb92,_0x2b7145)=>{const _0x179d8f=_0x1e58b8;let _0x2e063a=_0x207383[_0x179d8f(0x1d0)][_0x179d8f(0x237)],_0x1ad173=_0x207383['query'][_0x179d8f(0x186)]==0x1,_0x1607d2=fileUtil[_0x179d8f(0x214)](_0x2e063a),_0x17d7c9=_0x207383[_0x179d8f(0x1d0)][_0x179d8f(0x20b)],_0x7ad104=_0x207383[_0x179d8f(0x1d0)][_0x179d8f(0x175)];if(dbUserTable[_0x179d8f(0x170)](_0x207383,_0x56eb92,'',_0x179d8f(0x18a),_0x1607d2)==!![])try{let _0x1bbb88=_0x207383['query'][_0x179d8f(0x1ef)];if(_0x1bbb88&&_0x1bbb88==0x1){if(_0x1ad173){const _0x41eabc=encodeURIComponent(path[_0x179d8f(0x177)](_0x1607d2))[_0x179d8f(0x1bd)](/%([0-9A-F]{2})/g,(_0x2f79d7,_0x57d9aa)=>'%'+_0x57d9aa[_0x179d8f(0x165)]());_0x56eb92[_0x179d8f(0x23d)]('Content-Disposition',_0x179d8f(0x21d)+_0x41eabc);}return _0x56eb92[_0x179d8f(0x22e)](_0x1607d2);}else _0x207383[_0x179d8f(0x1d0)][_0x179d8f(0x1b1)]&&_0x207383['query'][_0x179d8f(0x1b1)]==_0x179d8f(0x1f7)&&path['extname'](_0x1607d2)&&path['extname'](_0x1607d2)[_0x179d8f(0x1f1)]()=='.txt'?(console['log'](_0x179d8f(0x1cc),_0x1607d2),encodingUtil[_0x179d8f(0x1f0)](_0x1607d2)[_0x179d8f(0x1d4)](_0x50eda1=>{const _0x5f3548=_0x179d8f;return _0x50eda1?_0x50eda1['pipe'](_0x56eb92):(console[_0x5f3548(0x243)](_0x5f3548(0x1ed),_0x1607d2),_0x56eb92['sendFile'](_0x1607d2));})):sharpUtil[_0x179d8f(0x1f4)](_0x56eb92,_0x1607d2,_0x1ad173,_0x17d7c9,_0x7ad104);}catch(_0x5ac159){return console[_0x179d8f(0x243)](_0x5ac159),fileUtil[_0x179d8f(0x210)](_0x56eb92,_0x5ac159);}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x197),(_0x9d8d2e,_0x424045,_0x3d73df)=>{const _0xc97de6=_0x1e58b8;let _0x31d0dd=fileUtil[_0xc97de6(0x214)](_0x9d8d2e[_0xc97de6(0x1fd)][_0xc97de6(0x22a)]),_0x36a46e=_0x9d8d2e[_0xc97de6(0x1fd)]['checkPower'];if(_0x36a46e==_0xc97de6(0x1a9))_0x36a46e=fs[_0xc97de6(0x182)]['W_OK'];else _0x36a46e==_0xc97de6(0x1f3)&&(_0x36a46e=fs[_0xc97de6(0x182)]['R_OK']);try{_0x36a46e==_0xc97de6(0x1ab)?fs[_0xc97de6(0x19d)](_0x31d0dd,fs[_0xc97de6(0x182)][_0xc97de6(0x178)],_0x5db989=>{const _0x499862=_0xc97de6;if(_0x5db989)return fileUtil[_0x499862(0x210)](_0x424045,_0x5db989);return _0x424045[_0x499862(0x185)]({'code':0x0,'access':!![]});}):fs[_0xc97de6(0x19d)](_0x31d0dd,_0x36a46e,_0x4e6ffb=>{const _0x1ab344=_0xc97de6;if(_0x4e6ffb)return fileUtil[_0x1ab344(0x210)](_0x424045,_0x4e6ffb);return _0x424045[_0x1ab344(0x185)]({'code':0x0,'access':!![]});});}catch(_0x5c6b2f){return _0x424045[_0xc97de6(0x185)]({'code':0x0,'access':![]});}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x209),(_0x1ac1f5,_0x464868,_0x6b0d9d)=>{const _0xf72a51=_0x1e58b8;let _0x147769=fileUtil['decodePath'](_0x1ac1f5[_0xf72a51(0x1fd)]['parentPath']),_0x4ce8e4=_0x1ac1f5[_0xf72a51(0x1fd)][_0xf72a51(0x1ec)],_0x1b1c26=path[_0xf72a51(0x17d)](_0x147769,_0x4ce8e4);if(dbUserTable[_0xf72a51(0x170)](_0x1ac1f5,_0x464868,_0xf72a51(0x169),'power_add',_0x1b1c26)==!![])try{fs[_0xf72a51(0x199)](_0x1b1c26,_0x2f8762=>{const _0x3d21f5=_0xf72a51;if(!_0x2f8762)return _0x1ac1f5[_0x3d21f5(0x1d7)]['returnErrMsg'](_0x464868,_0x464868['__']('sameNameFileAlreadExist')+':'+_0x1b1c26);else fs[_0x3d21f5(0x227)](_0x1b1c26,{'recursive':!![]},_0x481f7e=>{const _0x49cce0=_0x3d21f5;return _0x481f7e?fileUtil['returnFileError'](_0x464868,_0x481f7e):_0x464868[_0x49cce0(0x185)]({'code':0x0});});});}catch(_0x2cdee8){return fileUtil[_0xf72a51(0x210)](_0x464868,_0x2cdee8);}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x1d1),(_0x120a99,_0x4177de,_0xe5e77e)=>{const _0x49a63d=_0x1e58b8;let _0x8c26ab=_0x120a99[_0x49a63d(0x1fd)][_0x49a63d(0x1b0)],_0x632ca9=_0x120a99['body'][_0x49a63d(0x242)],_0x522e4c=_0x120a99[_0x49a63d(0x1fd)][_0x49a63d(0x161)];if(_0x522e4c!=_0x49a63d(0x1e8)&&_0x522e4c!=_0x49a63d(0x1dd))return _0x120a99['app'][_0x49a63d(0x222)](_0x4177de,_0x4177de['__'](_0x49a63d(0x1f2)));if(dbUserTable[_0x49a63d(0x170)](_0x120a99,_0x4177de,_0x49a63d(0x169),'power_get',_0x8c26ab)==!![]&&dbUserTable[_0x49a63d(0x170)](_0x120a99,_0x4177de,_0x49a63d(0x169),'power_add',_0x632ca9)==!![]){let _0x2f667d=_0x120a99[_0x49a63d(0x1d7)][_0x49a63d(0x1e0)][_0x49a63d(0x220)]('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')[_0x49a63d(0x192)](_0x49a63d(0x241),JSON[_0x49a63d(0x21b)]({'sourcePath':_0x8c26ab,'targetPath':_0x632ca9,'type':_0x522e4c,'username':_0x120a99[_0x49a63d(0x1e6)][_0x49a63d(0x1c0)]}));return process[_0x49a63d(0x16d)]({'type':_0x49a63d(0x18b),'taskIdList':[_0x2f667d['lastInsertRowid']]}),_0x4177de['json']({'code':0x0});}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x20a),(_0x57eb8d,_0x11da9e,_0x576592)=>{const _0x566273=_0x1e58b8;let _0x18759d=_0x57eb8d[_0x566273(0x1fd)][_0x566273(0x207)],_0x2b8b4c=_0x57eb8d[_0x566273(0x1fd)][_0x566273(0x242)],_0x13b390=_0x57eb8d[_0x566273(0x1fd)][_0x566273(0x161)];if(_0x18759d[_0x566273(0x221)]<0x1)return _0x57eb8d[_0x566273(0x1d7)][_0x566273(0x222)](_0x11da9e,_0x11da9e['__'](_0x566273(0x1f2)));if(dbUserTable[_0x566273(0x170)](_0x57eb8d,_0x11da9e,'folder',_0x566273(0x18a),_0x18759d[0x0])==!![]&&dbUserTable['doUserCanGet'](_0x57eb8d,_0x11da9e,_0x566273(0x169),_0x566273(0x19e),_0x2b8b4c)==!![])try{let _0x39f317=[];for(let _0x3f2278 in _0x18759d){let _0x48ef05=_0x18759d[_0x3f2278],_0x32a92c=path[_0x566273(0x177)](_0x48ef05),_0x268897=path[_0x566273(0x17d)](_0x2b8b4c,_0x32a92c),_0x545e64=_0x57eb8d[_0x566273(0x1d7)][_0x566273(0x1e0)]['prepare']('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')[_0x566273(0x192)]('FILE_OPERATION',JSON['stringify']({'sourcePath':_0x48ef05,'targetPath':_0x268897,'type':_0x13b390,'username':_0x57eb8d['currentUser'][_0x566273(0x1c0)]}));_0x39f317[_0x566273(0x1fb)](_0x545e64['lastInsertRowid']);}return process[_0x566273(0x16d)]({'type':_0x566273(0x18b),'taskIdList':_0x39f317}),_0x11da9e['json']({'code':0x0});}catch(_0x350767){return _0x57eb8d[_0x566273(0x1d7)][_0x566273(0x222)](_0x11da9e,_0x11da9e['__'](_0x566273(0x1f2)));}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x225),(_0x35c5e7,_0x407c71,_0x3d173d)=>{const _0x500d80=_0x1e58b8;let _0x2d6c56=fileUtil['decodePath'](_0x35c5e7['body']['sourcePath']),_0x340b6c=fileUtil[_0x500d80(0x214)](_0x35c5e7[_0x500d80(0x1fd)][_0x500d80(0x242)]),_0x14c2b8=path[_0x500d80(0x177)](_0x2d6c56),_0x523b7c=_0x35c5e7[_0x500d80(0x1fd)][_0x500d80(0x161)],_0x1f9b20=path[_0x500d80(0x17d)](_0x340b6c,_0x14c2b8);if(_0x523b7c==_0x500d80(0x191)||_0x523b7c==_0x500d80(0x1c3)){if(fs[_0x500d80(0x23f)](_0x1f9b20))return _0x35c5e7[_0x500d80(0x1d7)][_0x500d80(0x222)](_0x407c71,_0x407c71['__'](_0x500d80(0x20d))+':'+_0x1f9b20);}let _0x4e68f2=_0x35c5e7[_0x500d80(0x1fd)][_0x500d80(0x232)];function _0x303352(_0x57131c,_0x3a4810){const _0x396c0c=_0x500d80;let _0x32ad1f=_0x35c5e7[_0x396c0c(0x1d7)][_0x396c0c(0x1e0)][_0x396c0c(0x220)](_0x396c0c(0x1ae))[_0x396c0c(0x192)](_0x396c0c(0x241),JSON[_0x396c0c(0x21b)]({'sourcePath':_0x57131c,'targetPath':_0x3a4810,'type':_0x523b7c,'username':_0x35c5e7['currentUser'][_0x396c0c(0x1c0)]}));return _0x32ad1f[_0x396c0c(0x22b)];}try{_0x2d6c56=path[_0x500d80(0x17d)](_0x2d6c56),_0x340b6c=path[_0x500d80(0x17d)](_0x340b6c);if(_0x340b6c==_0x2d6c56||_0x340b6c[_0x500d80(0x1a6)](_0x2d6c56+path['sep']))return _0x35c5e7[_0x500d80(0x1d7)][_0x500d80(0x222)](_0x407c71,_0x407c71['__'](_0x500d80(0x219)));if(dbUserTable['doUserCanGet'](_0x35c5e7,_0x407c71,_0x500d80(0x169),_0x500d80(0x18a),_0x2d6c56)==!![]){let _0x312993=![];fs[_0x500d80(0x199)](_0x2d6c56,(_0x328705,_0x4f25f4)=>{const _0x3c0f93=_0x500d80;if(_0x328705)return _0x35c5e7[_0x3c0f93(0x1d7)][_0x3c0f93(0x222)](_0x407c71,_0x407c71['__'](_0x3c0f93(0x1ea))+':'+_0x2d6c56);let _0x3a8a49=path['basename'](_0x2d6c56);fs[_0x3c0f93(0x19d)](_0x340b6c,fs[_0x3c0f93(0x182)][_0x3c0f93(0x1f9)]|fs[_0x3c0f93(0x182)][_0x3c0f93(0x178)],_0x398807=>{const _0x108370=_0x3c0f93;if(_0x398807)return _0x35c5e7[_0x108370(0x1d7)]['returnErrMsg'](_0x407c71,_0x407c71['__'](_0x108370(0x194))+':'+_0x340b6c);if(_0x523b7c==_0x108370(0x187))dbUserTable[_0x108370(0x170)](_0x35c5e7,_0x407c71,_0x108370(0x169),_0x108370(0x23c),_0x340b6c)==!![]&&(_0x340b6c=path['join'](_0x340b6c,_0x4e68f2),fs['stat'](_0x340b6c,_0x250dec=>{const _0x2dce3f=_0x108370;if(!_0x250dec)return _0x35c5e7['app']['returnErrMsg'](_0x407c71,_0x407c71['__']('sameNameFileAlreadExist')+':'+_0x340b6c);else fs[_0x2dce3f(0x187)](_0x2d6c56,_0x340b6c,_0x3b07e3=>{const _0x136af8=_0x2dce3f;if(_0x3b07e3)return dbFileOperationRecord[_0x136af8(0x1bb)](_0x35c5e7[_0x136af8(0x1d7)][_0x136af8(0x1e0)],{'username':_0x35c5e7[_0x136af8(0x1e6)][_0x136af8(0x1c0)],'sourcePath':_0x2d6c56,'targetPath':_0x340b6c,'level':dbFileOperationRecord[_0x136af8(0x208)],'belongId':null,'type':dbFileOperationRecord[_0x136af8(0x1eb)],'subType':null,'state':dbFileOperationRecord[_0x136af8(0x173)],'remark':fileUtil[_0x136af8(0x210)](_0x407c71,_0x3b07e3,!![])}),dbNoticeCenterTable[_0x136af8(0x1e1)](_0x35c5e7[_0x136af8(0x1d7)][_0x136af8(0x1e0)],{'title':_0x407c71['__'](_0x136af8(0x1f2)),'level':_0x136af8(0x1cf),'content':_0x407c71['__']('fileRenameFail')+':'+(_0x2d6c56+_0x136af8(0x1a0)+_0x340b6c)});_0x312993=!![],dbFileOperationRecord[_0x136af8(0x1bb)](_0x35c5e7['app'][_0x136af8(0x1e0)],{'username':_0x35c5e7[_0x136af8(0x1e6)][_0x136af8(0x1c0)],'sourcePath':_0x2d6c56,'targetPath':_0x340b6c,'level':dbFileOperationRecord[_0x136af8(0x208)],'belongId':null,'type':dbFileOperationRecord['TYPE_RENMAE'],'subType':null,'state':dbFileOperationRecord[_0x136af8(0x215)]});}),setTimeout(()=>{const _0x4aa364=_0x2dce3f;return _0x407c71[_0x4aa364(0x185)]({'code':0x0,'isOver':_0x312993?0x1:0x0});},0x3e8);}));else{if(_0x523b7c==_0x108370(0x1c3)){if(dbUserTable[_0x108370(0x170)](_0x35c5e7,_0x407c71,_0x108370(0x169),'power_delete',_0x340b6c)!==!![])return;}if(dbUserTable[_0x108370(0x170)](_0x35c5e7,_0x407c71,_0x108370(0x169),_0x108370(0x19e),_0x340b6c)==!![]){_0x340b6c=path[_0x108370(0x17d)](_0x340b6c,_0x3a8a49);let _0x5ec3bb=_0x303352(_0x2d6c56,_0x340b6c);return process['send']({'type':'START_WORKER_FILE_OPERATION','taskIdList':[_0x5ec3bb]}),_0x407c71['json']({'code':0x0});}}});});}}catch(_0x385693){return _0x35c5e7['app'][_0x500d80(0x222)](_0x407c71,_0x407c71['__']('operationFail'));}}),router['post'](_0x1e58b8(0x1b6),(_0x248bdb,_0x3609c6,_0x5c6c78)=>{const _0x591e2d=_0x1e58b8;let _0x60c095=_0x248bdb[_0x591e2d(0x1fd)][_0x591e2d(0x1c5)];if(!_0x60c095)return _0x3609c6[_0x591e2d(0x176)](0x194)[_0x591e2d(0x1e7)]();dbUserTable['doUserCanGet'](_0x248bdb,_0x3609c6,_0x591e2d(0x169),_0x591e2d(0x18a),_0x60c095)==!![]&&fs[_0x591e2d(0x199)](_0x60c095,(_0x15b040,_0x2eac0a)=>{const _0xf46c77=_0x591e2d;if(_0x15b040)return fileUtil[_0xf46c77(0x210)](_0x3609c6,_0x15b040);return _0x2eac0a[_0xf46c77(0x179)]=fileUtil[_0xf46c77(0x1a8)](_0x2eac0a['size']),_0x3609c6[_0xf46c77(0x185)]({'code':0x0,'data':_0x2eac0a});});}),router['post'](_0x1e58b8(0x184),(_0x2954e2,_0x6d9e1c,_0x560ce0)=>{const _0x3c846a=_0x1e58b8;let _0x206486=_0x2954e2[_0x3c846a(0x1fd)]['folderPath'],_0x47ea87=_0x2954e2[_0x3c846a(0x1fd)][_0x3c846a(0x17f)];_0x47ea87&&(_0x47ea87=_0x47ea87[_0x3c846a(0x1bd)](/[<>\\\/:\*\?\"\|]/g,'_')),_0x206486&&(_0x206486=fileUtil[_0x3c846a(0x214)](_0x206486)),fs[_0x3c846a(0x19d)](_0x206486,fs['constants'][_0x3c846a(0x178)]|fs[_0x3c846a(0x182)][_0x3c846a(0x1f9)],_0x312476=>{const _0x191e7b=_0x3c846a;if(_0x312476)return _0x6d9e1c['json']({'code':0x1,'message':_0x6d9e1c['__'](_0x191e7b(0x194))+':'+_0x206486});else{let _0x4aa4dc='';if(_0x206486&&_0x47ea87)_0x4aa4dc=path[_0x191e7b(0x17d)](_0x206486,_0x47ea87);else{if(_0x206486)_0x4aa4dc=path[_0x191e7b(0x17d)](_0x206486);else return _0x6d9e1c[_0x191e7b(0x185)]({'code':0x1,'message':_0x6d9e1c['__'](_0x191e7b(0x18c))+':'+_0x206486});}fs[_0x191e7b(0x199)](_0x4aa4dc,_0x2dd0e9=>{const _0x2aa049=_0x191e7b;return _0x2dd0e9?(console[_0x2aa049(0x243)](_0x2aa049(0x15c),_0x4aa4dc),_0x6d9e1c[_0x2aa049(0x185)]({'code':0x0})):_0x6d9e1c[_0x2aa049(0x185)]({'code':0x1,'remark':_0x2aa049(0x195)});});}});}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x17c),(_0x11b962,_0x45fcf8,_0x3faab0)=>{const _0x395fa0=_0x1e58b8;let _0x108abf=_0x11b962[_0x395fa0(0x1fd)][_0x395fa0(0x1c5)],_0x3c2e5c=_0x11b962[_0x395fa0(0x1fd)][_0x395fa0(0x211)];if(!_0x108abf)return _0x45fcf8[_0x395fa0(0x176)](0x194)[_0x395fa0(0x1e7)]();_0x108abf=path[_0x395fa0(0x17d)](_0x108abf);if(dbUserTable[_0x395fa0(0x170)](_0x11b962,_0x45fcf8,_0x395fa0(0x169),'power_delete',_0x108abf)==!![]){if(_0x3c2e5c==0x1)return process['send']({'type':_0x395fa0(0x235),'shellType':'trash','path':_0x108abf}),dbFileOperationRecord[_0x395fa0(0x1bb)](_0x11b962[_0x395fa0(0x1d7)][_0x395fa0(0x1e0)],{'username':_0x11b962['currentUser'][_0x395fa0(0x1c0)],'targetPath':_0x108abf,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0x395fa0(0x183)],'state':dbFileOperationRecord['STATE_SUC']}),_0x45fcf8[_0x395fa0(0x185)]({'code':0x0,'message':_0x45fcf8['__'](_0x395fa0(0x233))});else fs['rm'](_0x108abf,{'recursive':!![]},_0xe0b60f=>{const _0xb63d2e=_0x395fa0;if(_0xe0b60f)return dbFileOperationRecord[_0xb63d2e(0x1bb)](_0x11b962['app'][_0xb63d2e(0x1e0)],{'username':_0x11b962['currentUser'][_0xb63d2e(0x1c0)],'targetPath':_0x108abf,'level':dbFileOperationRecord[_0xb63d2e(0x208)],'type':dbFileOperationRecord['TYPE_DELETE'],'state':dbFileOperationRecord['STATE_FAIL'],'remark':fileUtil['returnFileError'](_0x45fcf8,_0xe0b60f,!![])}),fileUtil[_0xb63d2e(0x210)](_0x45fcf8,_0xe0b60f);return dbFileOperationRecord['addFileOperationRecord'](_0x11b962[_0xb63d2e(0x1d7)]['dbOther'],{'username':_0x11b962[_0xb63d2e(0x1e6)][_0xb63d2e(0x1c0)],'targetPath':_0x108abf,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0xb63d2e(0x183)],'state':dbFileOperationRecord[_0xb63d2e(0x215)]}),_0x45fcf8[_0xb63d2e(0x185)]({'code':0x0,'message':_0x45fcf8['__'](_0xb63d2e(0x233))});});}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x205),(_0x1fbcad,_0x2bf2fd,_0x54830a)=>{const _0x56ee0=_0x1e58b8;if(_0x1fbcad[_0x56ee0(0x1e6)]['is_admin']!=0x1)return _0x2bf2fd['json']({'code':0x66});return dbFileOperationRecord[_0x56ee0(0x16c)](_0x1fbcad['app']['dbOther']),_0x2bf2fd[_0x56ee0(0x185)]({'code':0x0});}),router['post'](_0x1e58b8(0x229),(_0x9761bc,_0x44538b,_0x1fa2e6)=>{const _0x30d20f=_0x1e58b8;let _0xd17d10=_0x9761bc[_0x30d20f(0x1fd)]['page'],_0x1d7766=_0x9761bc['body'][_0x30d20f(0x1a5)],_0xa51a47=_0x9761bc[_0x30d20f(0x1fd)][_0x30d20f(0x161)],_0x24c318=_0x9761bc['body'][_0x30d20f(0x1c1)],_0x5bdb75=_0x9761bc[_0x30d20f(0x1fd)][_0x30d20f(0x1f6)],_0xda9c7=_0x9761bc['body'][_0x30d20f(0x22f)],_0x6a6b38=_0x9761bc[_0x30d20f(0x1fd)][_0x30d20f(0x1e4)],_0x35a5d9;return _0x9761bc['currentUser']['is_admin']==0x1?_0x35a5d9=dbFileOperationRecord['getByPage'](_0x9761bc[_0x30d20f(0x1d7)][_0x30d20f(0x1e0)],_0xd17d10,_0x1d7766,_0x24c318,_0xa51a47,_0x5bdb75,_0xda9c7,_0x6a6b38):_0x35a5d9=dbFileOperationRecord['getByPage'](_0x9761bc['app'][_0x30d20f(0x1e0)],_0xd17d10,_0x1d7766,_0x24c318,_0xa51a47,_0x5bdb75,_0xda9c7,_0x6a6b38,_0x9761bc['currentUser']['username']),_0x44538b[_0x30d20f(0x185)]({'code':0x0,'data':_0x35a5d9});}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x1ba),(_0x5f18a1,_0xeaf9ab,_0x4c743c)=>{const _0xede32a=_0x1e58b8;let _0x13d2d4=_0x5f18a1[_0xede32a(0x1fd)][_0xede32a(0x1cd)];if(_0x13d2d4=='add'||_0x13d2d4==_0xede32a(0x1ac)){if(_0x5f18a1[_0xede32a(0x1e6)][_0xede32a(0x240)]!=0x1)return _0xeaf9ab[_0xede32a(0x185)]({'code':0x66});}if(_0x13d2d4=='add'){let _0x9df19d=_0x5f18a1['body'][_0xede32a(0x161)],_0x1f356e=_0x5f18a1[_0xede32a(0x1fd)]['url'],_0x1404ef=_0x5f18a1[_0xede32a(0x1fd)][_0xede32a(0x1c0)],_0x10beed=_0x5f18a1[_0xede32a(0x1fd)][_0xede32a(0x1b5)],_0xeef3c2=_0x5f18a1[_0xede32a(0x1fd)][_0xede32a(0x1c0)],_0x529b3c=_0x5f18a1[_0xede32a(0x1fd)][_0xede32a(0x16b)],_0x5af48b=[_0xede32a(0x16a),_0xede32a(0x18e),'samba'];if(!_0x9df19d||!_0x1f356e||!_0x5af48b['includes'](_0x9df19d))return _0x5f18a1[_0xede32a(0x1d7)][_0xede32a(0x222)](_0xeaf9ab,_0xeaf9ab['__'](_0xede32a(0x1f2)));_0x9df19d==_0xede32a(0x16a)&&fileStatUtil['localPathIsFolder'](_0x1f356e,()=>{const _0x5ea5a1=_0xede32a;fileStatUtil[_0x5ea5a1(0x1de)](_0x1f356e,()=>{const _0x1275dd=_0x5ea5a1,_0x11e9d0=_0x1275dd(0x193);return _0x5f18a1[_0x1275dd(0x1d7)][_0x1275dd(0x1e0)][_0x1275dd(0x220)](_0x11e9d0)[_0x1275dd(0x192)](_0x9df19d,_0x1f356e,_0x1404ef,_0xeef3c2,_0x529b3c,_0x10beed),_0xeaf9ab[_0x1275dd(0x185)]({'code':0x0});},()=>{const _0x5dd945=_0x5ea5a1;return _0x5f18a1['app']['returnErrMsg'](_0xeaf9ab,_0xeaf9ab['__'](_0x5dd945(0x1ea)));});},()=>{const _0x482e02=_0xede32a;return _0x5f18a1['app'][_0x482e02(0x222)](_0xeaf9ab,_0xeaf9ab['__'](_0x482e02(0x223)));});}else{if(_0x13d2d4==_0xede32a(0x1ac)){let _0x4bac4d=_0x5f18a1[_0xede32a(0x1fd)]['id'];return _0x5f18a1[_0xede32a(0x1d7)]['dbOther']['prepare'](_0xede32a(0x1c2))['run'](_0x4bac4d),_0xeaf9ab[_0xede32a(0x185)]({'code':0x0});}else{if(_0x13d2d4==_0xede32a(0x226)){let _0x47d3b7=[],_0x50ca58=_0x5f18a1[_0xede32a(0x1d7)][_0xede32a(0x1e0)][_0xede32a(0x220)](_0xede32a(0x1b7))[_0xede32a(0x1ab)]();if(_0x5f18a1['currentUser'][_0xede32a(0x240)]==0x1)_0x47d3b7=_0x50ca58;else{let _0x29dd0f=dbUserTable[_0xede32a(0x18f)](_0x5f18a1[_0xede32a(0x1d7)][_0xede32a(0x1e0)],_0x5f18a1['currentUser']['username'],_0xede32a(0x169),'power_get');for(let _0x3779a6 in _0x29dd0f){let _0x21da2a=_0x29dd0f[_0x3779a6][_0xede32a(0x237)][_0xede32a(0x1f1)]();_0x21da2a=path[_0xede32a(0x17d)](_0x21da2a);for(let _0x196476 in _0x50ca58){try{if(_0x50ca58[_0x196476][_0xede32a(0x1e2)]&&_0x21da2a){let _0x13315f=_0x50ca58[_0x196476][_0xede32a(0x1e2)]['toLowerCase']();_0x13315f[_0xede32a(0x203)](':')&&_0x13315f['length']==0x2&&(_0x13315f=_0x13315f+path['sep']),_0x13315f=path[_0xede32a(0x17d)](_0x13315f)[_0xede32a(0x1f1)](),(_0x21da2a==_0x13315f||_0x13315f['startsWith'](path[_0xede32a(0x17d)](_0x21da2a+path[_0xede32a(0x1f8)])))&&_0x47d3b7[_0xede32a(0x1fb)](_0x50ca58[_0x196476]);}}catch(_0x29f9a7){continue;}}}}return _0xeaf9ab[_0xede32a(0x185)]({'code':0x0,'data':_0x47d3b7});}}}});function getRandomString(_0x3330e6){const _0x32b301=_0x1e58b8;let _0x45d3b6='';const _0x1c096b=_0x32b301(0x16f),_0x37bbd4=_0x1c096b['length'];for(let _0x3c62aa=0x0;_0x3c62aa<_0x3330e6;_0x3c62aa++){_0x45d3b6+=_0x1c096b['charAt'](Math[_0x32b301(0x1fa)](Math[_0x32b301(0x19c)]()*_0x37bbd4));}return _0x45d3b6;}router[_0x1e58b8(0x20f)](_0x1e58b8(0x188),(_0x1ecca0,_0x51d320,_0x116e29)=>{const _0x25fc10=_0x1e58b8;let _0xeb228=[];return _0x1ecca0[_0x25fc10(0x1e6)][_0x25fc10(0x240)]==0x1?_0xeb228=_0x1ecca0[_0x25fc10(0x1d7)][_0x25fc10(0x1e0)][_0x25fc10(0x220)](_0x25fc10(0x21f))[_0x25fc10(0x1ab)]():_0xeb228=_0x1ecca0[_0x25fc10(0x1d7)][_0x25fc10(0x1e0)][_0x25fc10(0x220)](_0x25fc10(0x1d8))['all'](_0x1ecca0[_0x25fc10(0x1e6)]['id']),_0x51d320['json']({'code':0x0,'data':_0xeb228});}),router['post'](_0x1e58b8(0x1db),(_0x3fcffe,_0x29aa82,_0x5dce00)=>{const _0x5dce1f=_0x1e58b8;let _0x389b20=_0x3fcffe['body']['operationType'];if(_0x389b20==_0x5dce1f(0x1ad))try{if(!_0x3fcffe[_0x5dce1f(0x1fd)][_0x5dce1f(0x237)])return _0x3fcffe[_0x5dce1f(0x1d7)][_0x5dce1f(0x222)](_0x29aa82,_0x5dce1f(0x1cf));let _0x2cd016=fileUtil[_0x5dce1f(0x214)](_0x3fcffe['body']['path']);function _0x4a5082(){const _0x5f534b=_0x5dce1f;if(dbUserTable['doUserCanGet'](_0x3fcffe,_0x29aa82,'','power_get',_0x2cd016)==!![]){let _0x157a05=_0x3fcffe[_0x5f534b(0x1fd)][_0x5f534b(0x16b)]?_0x3fcffe[_0x5f534b(0x1fd)][_0x5f534b(0x16b)]:'',_0x3da8d6=new Date()[_0x5f534b(0x1a3)](),_0x4d035b=getRandomString(0x5),_0x4846b0=_0x3fcffe[_0x5f534b(0x1d7)][_0x5f534b(0x1e0)][_0x5f534b(0x220)](_0x5f534b(0x1c4))[_0x5f534b(0x226)](_0x4d035b);if(_0x4846b0)return _0x4a5082();let _0x3004f2=_0x3fcffe[_0x5f534b(0x1fd)][_0x5f534b(0x234)]?_0x3fcffe[_0x5f534b(0x1fd)][_0x5f534b(0x234)]:0x1e,_0x1c486e=0xe10*0x3e8*0x18*_0x3004f2+_0x3da8d6;return _0x3fcffe[_0x5f534b(0x1d7)][_0x5f534b(0x1e0)]['prepare'](_0x5f534b(0x17a))[_0x5f534b(0x192)](_0x2cd016,_0x157a05,_0x4d035b,_0x3da8d6,_0x1c486e,_0x3fcffe[_0x5f534b(0x1e6)]['id']),_0x29aa82[_0x5f534b(0x185)]({'code':0x0,'token':_0x4d035b});}}return _0x4a5082();}catch(_0x3ebc3a){return console[_0x5dce1f(0x243)](_0x3ebc3a),_0x3fcffe[_0x5dce1f(0x1d7)]['returnErrMsg'](_0x29aa82,'error');}else{if(_0x389b20==_0x5dce1f(0x1ac)){let _0x461bdf=_0x3fcffe[_0x5dce1f(0x1fd)][_0x5dce1f(0x163)];return _0x3fcffe[_0x5dce1f(0x1e6)][_0x5dce1f(0x240)]==0x1?_0x3fcffe[_0x5dce1f(0x1d7)]['dbOther'][_0x5dce1f(0x220)](_0x5dce1f(0x1c7))[_0x5dce1f(0x192)](_0x461bdf):_0x3fcffe[_0x5dce1f(0x1d7)][_0x5dce1f(0x1e0)][_0x5dce1f(0x220)](_0x5dce1f(0x218))['run'](_0x461bdf,_0x3fcffe[_0x5dce1f(0x1e6)]['id']),_0x29aa82[_0x5dce1f(0x185)]({'code':0x0});}}}),router[_0x1e58b8(0x20f)](_0x1e58b8(0x172),(_0x11d7ff,_0x4fd628,_0x370979)=>{const _0x5a9a0a=_0x1e58b8;let _0x32f02b=_0x11d7ff[_0x5a9a0a(0x1fd)]['shareToken']||_0x11d7ff['body']['st'],_0x2376ca=_0x11d7ff[_0x5a9a0a(0x1fd)][_0x5a9a0a(0x23b)],_0x4b44ec=_0x11d7ff[_0x5a9a0a(0x1fd)][_0x5a9a0a(0x16b)],_0x3ffe6f=[],_0x38a4ba=dbConfigTable[_0x5a9a0a(0x1ee)](_0x11d7ff['app'][_0x5a9a0a(0x1e0)],'(\x27customLogoImage\x27,\x27customHomeBgImage\x27)'),_0x2e63db={'code':0x0,'data':{'customConfig':_0x38a4ba,'parent':_0x2376ca,'children':_0x3ffe6f,'sep':path['sep'],'platform':platform}};if(!_0x32f02b)return _0x4fd628['json'](_0x2e63db);let _0x17e266=dbUserTable[_0x5a9a0a(0x1b4)](_0x11d7ff['app'][_0x5a9a0a(0x1e0)],_0x32f02b);if(!_0x17e266)return _0x4fd628['json'](_0x2e63db);if(_0x17e266['password']){if(!_0x4b44ec)return _0x4fd628[_0x5a9a0a(0x185)]({'code':0x2});if(_0x17e266['password']!=_0x4b44ec)return _0x4fd628[_0x5a9a0a(0x185)]({'code':0x2,'message':_0x4fd628['__']('login.pwdErr')});}function _0x2fa235(){const _0x1acad8=_0x5a9a0a;fs[_0x1acad8(0x199)](_0x17e266['path'],(_0x244289,_0x1eb2ca)=>{const _0x4148ec=_0x1acad8;if(_0x244289)return _0x4fd628[_0x4148ec(0x185)](_0x2e63db);return _0x2e63db[_0x4148ec(0x167)][_0x4148ec(0x200)][_0x4148ec(0x1fb)]({'type':_0x1eb2ca['isFile']()?0x1:0x2,'name':path[_0x4148ec(0x177)](_0x17e266[_0x4148ec(0x237)]),'fileFullPath':_0x17e266[_0x4148ec(0x237)]}),_0x4fd628[_0x4148ec(0x185)](_0x2e63db);});}if(!_0x2376ca)_0x2fa235();else{let _0xef174a=dbUserTable[_0x5a9a0a(0x15f)](_0x11d7ff[_0x5a9a0a(0x1d7)][_0x5a9a0a(0x1e0)],_0x32f02b,_0x2376ca,_0x4b44ec);if(!_0xef174a)return console[_0x5a9a0a(0x243)](_0x5a9a0a(0x162),_0x2376ca),_0x2fa235();fs['readdir'](_0x2376ca,{'withFileTypes':!![]},(_0x532ee6,_0x3bf4de)=>{const _0x9715a3=_0x5a9a0a;if(_0x532ee6)return _0x4fd628['json'](_0x2e63db);let _0x2658cf=0x0;if(_0x3bf4de[_0x9715a3(0x221)]<0x1)return _0x4fd628[_0x9715a3(0x185)](_0x2e63db);for(let _0x14a0e3=0x0;_0x14a0e3<_0x3bf4de[_0x9715a3(0x221)];_0x14a0e3++){let _0x3ee657=_0x3bf4de[_0x14a0e3],_0x417a90=_0x3bf4de[_0x14a0e3]['name'];if(_0x417a90[_0x9715a3(0x221)]>0x0){if(_0x417a90[0x0]=='.'){_0x2658cf+=0x1;continue;}if(/[A-Z]:\\/i[_0x9715a3(0x174)](_0x2376ca)&&_0x2376ca[_0x9715a3(0x221)]<=0x3){if(win32ExcludeList[_0x9715a3(0x1e3)](_0x417a90)||_0x417a90[_0x9715a3(0x203)](_0x9715a3(0x201))||_0x417a90[_0x9715a3(0x203)]('.tmp')){_0x2658cf+=0x1;continue;}}}let _0x47bcdc=path[_0x9715a3(0x17d)](_0x2376ca,_0x417a90);fs[_0x9715a3(0x199)](_0x47bcdc,(_0x2ca992,_0x366637)=>{const _0x1a8820=_0x9715a3;_0x2658cf+=0x1;let _0x31dcd0=_0x3ee657[_0x1a8820(0x216)](),_0x4eaafc=_0x3ee657[_0x1a8820(0x1df)](),_0x43a888={'name':_0x417a90,'fileFullPath':_0x47bcdc};!_0x2ca992&&_0x366637&&(_0x43a888['size']=_0x366637[_0x1a8820(0x20b)],_0x43a888['createTime']=_0x366637[_0x1a8820(0x212)]||_0x366637['ctimeMs']);_0x31dcd0?_0x43a888[_0x1a8820(0x161)]=0x1:_0x43a888['type']=0x2;_0x2e63db[_0x1a8820(0x167)][_0x1a8820(0x200)][_0x1a8820(0x1fb)](_0x43a888);if(_0x2658cf>=_0x3bf4de['length'])return _0x4fd628[_0x1a8820(0x185)](_0x2e63db);});}});}}),module[_0x1e58b8(0x1b8)]=router;