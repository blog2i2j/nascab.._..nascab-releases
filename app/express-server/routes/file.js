function _0x47f9(_0x15307e,_0x424e8a){const _0x578fed=_0x578f();return _0x47f9=function(_0x47f9b6,_0x595593){_0x47f9b6=_0x47f9b6-0x1a7;let _0x548a97=_0x578fed[_0x47f9b6];return _0x548a97;},_0x47f9(_0x15307e,_0x424e8a);}function _0x578f(){const _0x506ade=['random','query','days','removeHeader','constants','Content-Disposition','finalize','deleteSuccess','dbOther','\x20->\x20','pipe','movie','../../db/dbNoticeCenterTable','sep','cut','$WinREAgent','cwd','../../db/dbSourceFolderTable','sharp','getExcludePathList','isDirectory','Router','stack','platform','Convert\x20to\x20utf8\x20','get','log','SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?','err','sourceFolderMusic','pathName','sourceFolderPhoto','floor','$RECYCLE.BIN','STATE_FAIL','send','/deleteByPath','noReadPermission','shell','root','then','.zip','9465840dvWlgo','fileName','folder','24170dYLcha','doUserCanGet','local','is_admin','push','findByTitle','checkPath','path','sourceFolderMovie','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','startsWith','toUpperCase','(\x27customLogoImage\x27,\x27customHomeBgImage\x27)','../../utils/fileStatUtil','error','fullPath','close','R_OK','post','birthtimeMs','zip\x20error','json','.sys','localPathIsReadable','all','charAt','localPathIsFolder','quality','endsWith','returnDealedFile','join','/getPathState','login.pwdErr','raw','getTransSizeStr','returnFileError','fileFullPath','../../db/dbConfigTable','STATE_SUC','result','getUtf8FileStream','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','64765qmbqyr','TYPE_RENMAE','level','password','folderPath','exports','checkPower','/getPathTree','isFile','operationType','app','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?','zip\x20finish','Unable\x20to\x20read\x20file','parent','targetPath','getPathByType','samba','currentUser','access','existsSync','../../db/dbUserTable','lastInsertRowid','EXIST','stringify','read','custom','/customImageFile','zip','SELECT\x20*\x20FROM\x20share_temp','photo','decodePath','unzip','statSync','toLowerCase','102CCuCPw','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','/getTempShareFiles','headersSent','START_WORKER_FILE_OPERATION','/operationFileList','parse','prepare','attachment;\x20filename*=UTF-8\x27\x27','basename','utf8','getByPage','createReadStream','Downloads','body','type','USER','localeCompare','../utils/sharpUtils','../../utils/globalInfoUtil','targetPathInvalid','124812IzUFsm','name','music','Desktop','/tempShare','FILE_OPERATION','.tmp','win32','stat','end','write','Documents\x20and\x20Settings','LEVEL_MAIN_OPERATION','../utils/fileUtils','length','power_change','mtimeMs','select\x20id,type,url,name,remark\x20from\x20path_mount','/Users','/getOperationRecord','sendFile','message','children','sizeStr','returnErrMsg','setHeader','putInSystemTrash','4998504qrwiMw','power_add','ctimeMs','sourcePathList','addFileOperationRecord','searchStr','folderNotExist','operationFail','PerfLogs','extname','sourceFolderBook','/operationPathMount','atimeMs','System\x20Volume\x20Information','data','unpipe','getWindowsDiskList','5GHgqxm','power_get','sameNameFileAlreadExist','size','no\x20permission\x20','destroy','SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?','Documents','status','/checkFolderPower','$Recycle.Bin','/addNewFolder','An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.','TYPE_DELETE','noWritePermission','filename','/fileExist','test','/clearOperationRecord','replace','2890521BJeArR','/operationFolder','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','includes','../../myConfig/config','W_OK','doUserCanGetTempShare','8295630JHDFLR','add','value','code','delete','cachePathRoot','sourcePath','create','webdav','152wTXlon','copy','getTempShareObj','url','newName','username','cannotCopyToSelf','readdir','deleteId','run','getUserPower'];_0x578f=function(){return _0x506ade;};return _0x578f();}const _0x3ce239=_0x47f9;(function(_0x11fd97,_0x209458){const _0x422a02=_0x47f9,_0x5e3867=_0x11fd97();while(!![]){try{const _0x2d090a=-parseInt(_0x422a02(0x1da))/0x1*(-parseInt(_0x422a02(0x238))/0x2)+parseInt(_0x422a02(0x1ee))/0x3+parseInt(_0x422a02(0x1c9))/0x4+parseInt(_0x422a02(0x262))/0x5*(parseInt(_0x422a02(0x285))/0x6)+-parseInt(_0x422a02(0x1f6))/0x7+parseInt(_0x422a02(0x1ff))/0x8*(parseInt(_0x422a02(0x1ae))/0x9)+-parseInt(_0x422a02(0x235))/0xa;if(_0x2d090a===_0x209458)break;else _0x5e3867['push'](_0x5e3867['shift']());}catch(_0x2e0480){_0x5e3867['push'](_0x5e3867['shift']());}}}(_0x578f,0x98ba9));let express=require('express'),router=express[_0x3ce239(0x21f)](),path=require(_0x3ce239(0x23f)),fs=require('fs'),sha256=require('sha256'),fileUtil=require(_0x3ce239(0x1bb));const sharp=require(_0x3ce239(0x21c)),os=require('os');let platform=os[_0x3ce239(0x221)]();const dbUserTable=require(_0x3ce239(0x277)),dbNoticeCenterTable=require(_0x3ce239(0x216)),dbConfigTable=require(_0x3ce239(0x25d)),dbSourceFolderTable=require(_0x3ce239(0x21b)),dbFileOperationRecord=require('../../db/dbFileOperationRecord'),fileStatUtil=require(_0x3ce239(0x245)),config=require(_0x3ce239(0x1f3)),sharpUtil=require(_0x3ce239(0x1ab)),globalInfoUtil=require(_0x3ce239(0x1ac)),archiver=require('archiver'),encodingUtil=require('../../utils/encodingUtil');let macPowerDetected=![],win32ExcludeList=[_0x3ce239(0x1d6),_0x3ce239(0x1e4),_0x3ce239(0x22c),_0x3ce239(0x219),_0x3ce239(0x1b9),_0x3ce239(0x1d1)];router[_0x3ce239(0x223)]('/zipFile/*',(_0x375443,_0x256d0d,_0x5b1745)=>{const _0xce190d=_0x3ce239;if(!_0x375443['query'][_0xce190d(0x23f)])return _0x256d0d[_0xce190d(0x1e2)](0x194)[_0xce190d(0x1b7)]();let _0x288136=fileUtil[_0xce190d(0x281)](_0x375443['query'][_0xce190d(0x23f)]),_0x5f38e1=_0x375443[_0xce190d(0x20b)][_0xce190d(0x1e9)];_0x5f38e1&&(_0x288136=path[_0xce190d(0x256)](_0x288136,_0x5f38e1)),dbUserTable[_0xce190d(0x239)](_0x375443,_0x256d0d,'',_0xce190d(0x1db),_0x288136)==!![]&&fs[_0xce190d(0x1b6)](_0x288136,(_0x49201b,_0x5310a1)=>{const _0x574a1f=_0xce190d;if(_0x49201b)return _0x256d0d['status'](0x194)[_0x574a1f(0x1b7)]();let _0x2a8563=path[_0x574a1f(0x28e)](_0x288136)+_0x574a1f(0x234);try{const _0x10a4f6=encodeURIComponent(_0x2a8563)[_0x574a1f(0x1ed)](/%([0-9A-F]{2})/g,(_0x13c48a,_0x559283)=>'%'+_0x559283[_0x574a1f(0x243)]());_0x256d0d[_0x574a1f(0x1c7)](_0x574a1f(0x20f),_0x574a1f(0x28d)+_0x10a4f6);}catch(_0x1aed5c){console[_0x574a1f(0x224)](_0x1aed5c);}const _0x5837cf=archiver('zip',{'zlib':{'level':0x0}});_0x5837cf['on']('error',function(_0x1dc807){const _0x5ca6f9=_0x574a1f;console[_0x5ca6f9(0x224)](_0x5ca6f9(0x24c),_0x1dc807[_0x5ca6f9(0x1c3)]||_0x1dc807[_0x5ca6f9(0x220)]),_0x5837cf[_0x5ca6f9(0x1d8)](),!_0x256d0d[_0x5ca6f9(0x288)]?(_0x256d0d[_0x5ca6f9(0x20d)]('Content-Disposition'),_0x256d0d['status'](0x1f4)[_0x5ca6f9(0x22e)](_0x5ca6f9(0x1e6))):_0x256d0d[_0x5ca6f9(0x1df)]();}),_0x5837cf['on'](_0x574a1f(0x1b7),function(){const _0x58db2f=_0x574a1f;console[_0x58db2f(0x224)](_0x58db2f(0x26e)),_0x5837cf[_0x58db2f(0x1df)]();});try{fs[_0x574a1f(0x206)](_0x288136,(_0x50f67a,_0x5076e9)=>{const _0xfb7d21=_0x574a1f;for(let _0x32d62f in _0x5076e9){let _0x5b6b4c=_0x5076e9[_0x32d62f];const _0x2ddd97=path['join'](_0x288136,_0x5b6b4c);let _0x26a32a=fs[_0xfb7d21(0x283)](_0x2ddd97);_0x26a32a[_0xfb7d21(0x21e)]()?_0x5837cf['directory'](_0x2ddd97,_0x5b6b4c):_0x5837cf['append'](fs[_0xfb7d21(0x291)](_0x2ddd97),{'name':_0x5b6b4c});}_0x5837cf[_0xfb7d21(0x210)](),_0x5837cf[_0xfb7d21(0x214)](_0x256d0d);});}catch(_0x2493f5){!_0x256d0d[_0x574a1f(0x288)]&&_0x256d0d[_0x574a1f(0x1e2)](0x1f4)[_0x574a1f(0x22e)]({'error':_0x574a1f(0x1f1)}),console[_0x574a1f(0x246)](_0x2493f5);}_0x256d0d['on'](_0x574a1f(0x248),()=>{const _0x50d6d2=_0x574a1f;console[_0x50d6d2(0x224)]('res\x20closed,destroy\x20zip\x20stream'),_0x5837cf[_0x50d6d2(0x1df)]();});});}),router[_0x3ce239(0x24a)](_0x3ce239(0x269),(_0x306164,_0x23b5e8,_0x2ffd9f)=>{const _0x527b6a=_0x3ce239;let _0x2a8f46=_0x306164[_0x527b6a(0x1a7)][_0x527b6a(0x270)],_0x35e66e=path['sep'],_0x2b4acf=_0x306164[_0x527b6a(0x1a7)]['type'],_0x3c92b6=_0x306164[_0x527b6a(0x1a7)][_0x527b6a(0x1ce)],_0x2bccb7=[],_0x5ac751=parseInt(_0x306164['currentUser'][_0x527b6a(0x23b)])==0x1,_0x1c4b90=fileUtil[_0x527b6a(0x21d)](_0x306164[_0x527b6a(0x26c)][_0x527b6a(0x212)]);try{function _0x2e24ab(){const _0x41ae7f=_0x527b6a;let _0x820b37=dbUserTable[_0x41ae7f(0x209)](_0x306164[_0x41ae7f(0x26c)][_0x41ae7f(0x212)],_0x306164[_0x41ae7f(0x274)][_0x41ae7f(0x204)],_0x41ae7f(0x237),_0x41ae7f(0x1db));for(let _0x3fd2f4 of _0x820b37){if(_0x1c4b90[_0x41ae7f(0x1f2)](_0x3fd2f4[_0x41ae7f(0x23f)]))continue;_0x2bccb7[_0x41ae7f(0x23c)]({'type':0x2,'name':_0x3fd2f4[_0x41ae7f(0x23f)],'fileFullPath':_0x3fd2f4[_0x41ae7f(0x23f)]});}return _0x23b5e8[_0x41ae7f(0x24d)]({'code':0x0,'data':{'parent':'','children':_0x2bccb7,'sep':_0x35e66e,'platform':platform}});}if(!_0x2a8f46){if(_0x5ac751){if(platform==_0x527b6a(0x1b5)){function _0x3d157f(_0x356913){const _0x53044c=_0x527b6a;let _0x2d805c=[];for(let _0x2f69cf of _0x356913){if(_0x1c4b90[_0x53044c(0x1f2)](_0x2f69cf[_0x53044c(0x1af)]))continue;_0x2f69cf['type']=0x2,_0x2d805c[_0x53044c(0x23c)](_0x2f69cf);}for(let _0x4d777b in _0x2d805c){_0x2d805c[_0x4d777b][_0x53044c(0x25c)]=_0x2d805c[_0x4d777b][_0x53044c(0x1af)];}return _0x23b5e8[_0x53044c(0x24d)]({'code':0x0,'data':{'parent':_0x2a8f46,'children':_0x2d805c,'sep':path[_0x53044c(0x217)],'platform':platform}});}let _0x40a429=dbConfigTable[_0x527b6a(0x23d)](_0x306164[_0x527b6a(0x26c)]['dbOther'],_0x527b6a(0x1fb));if(_0x40a429)try{_0x40a429=JSON[_0x527b6a(0x28b)](_0x40a429[_0x527b6a(0x1f8)]),_0x1fd5fb(![]),_0x3d157f(_0x40a429);}catch(_0x234bfe){_0x1fd5fb(!![]);}else _0x1fd5fb(!![]);function _0x1fd5fb(_0x2deda8){const _0x4b8099=_0x527b6a;globalInfoUtil[_0x4b8099(0x1d9)](_0xa00767=>{const _0x22451e=_0x4b8099;_0xa00767=_0xa00767['sort']((_0xd89ad2,_0x440da4)=>{const _0x52ebd6=_0x47f9;if(!_0xd89ad2['name']||!_0x440da4[_0x52ebd6(0x1af)])return;return _0xd89ad2['name'][_0x52ebd6(0x1aa)](_0x440da4[_0x52ebd6(0x1af)]);}),dbConfigTable['create'](_0x306164[_0x22451e(0x26c)][_0x22451e(0x212)],{'title':'cachePathRoot','value':JSON['stringify'](_0xa00767)}),_0x2deda8&&_0x3d157f(_0xa00767);});}}else{if(platform=='darwin'){if(!macPowerDetected){macPowerDetected=!![];try{const _0x38e106=process['env'][_0x527b6a(0x1a9)];let _0x16025a=[path[_0x527b6a(0x256)](_0x527b6a(0x1c0),_0x38e106,_0x527b6a(0x1e1)),path[_0x527b6a(0x256)](_0x527b6a(0x1c0),_0x38e106,_0x527b6a(0x292)),path[_0x527b6a(0x256)](_0x527b6a(0x1c0),_0x38e106,_0x527b6a(0x1b1))];for(let _0x2da3bc in _0x16025a){fs['stat'](_0x16025a[_0x2da3bc],(_0x160b7f,_0x3506d4)=>{});}}catch(_0x5b9bc3){}}let _0x18ca2b=path[_0x527b6a(0x28b)](process[_0x527b6a(0x21a)]())[_0x527b6a(0x232)];_0x5269f1(_0x18ca2b);}else _0x2a8f46=path[_0x527b6a(0x28b)](process['cwd']())['root'],_0x5269f1(_0x2a8f46);}}else return _0x2e24ab();}else _0x5269f1(_0x2a8f46);function _0x5269f1(_0x2257ce){const _0x13b764=_0x527b6a;if(!_0x5ac751){if(!dbUserTable[_0x13b764(0x239)](_0x306164,_0x23b5e8,_0x13b764(0x237),_0x13b764(0x1db),_0x2257ce,!![]))return _0x2e24ab();}if(_0x2257ce==_0x13b764(0x22a)||_0x2257ce==_0x13b764(0x240)||_0x2257ce==_0x13b764(0x228)||_0x2257ce==_0x13b764(0x1d3)){let _0x3496c1=_0x13b764(0x280);if(_0x2257ce==_0x13b764(0x240))_0x3496c1=_0x13b764(0x215);else{if(_0x2257ce==_0x13b764(0x228))_0x3496c1=_0x13b764(0x1b0);else _0x2257ce=='sourceFolderBook'&&(_0x3496c1='book');}let _0x1214af=dbSourceFolderTable[_0x13b764(0x272)](_0x306164[_0x13b764(0x26c)][_0x13b764(0x212)],_0x3496c1);for(let _0x533db1 in _0x1214af){_0x2bccb7[_0x13b764(0x23c)]({'type':0x2,'name':path[_0x13b764(0x28e)](_0x1214af[_0x533db1]['path']),'fileFullPath':_0x1214af[_0x533db1][_0x13b764(0x23f)]});}return _0x23b5e8['json']({'code':0x0,'data':{'parent':_0x2257ce,'children':_0x2bccb7,'sep':_0x35e66e,'platform':platform}});}fs[_0x13b764(0x206)](_0x2257ce,{'withFileTypes':!![]},(_0x12dc56,_0x2183d4)=>{const _0x23b8f5=_0x13b764;if(_0x12dc56)return console[_0x23b8f5(0x224)](_0x12dc56),fileUtil[_0x23b8f5(0x25b)](_0x23b5e8,_0x12dc56);for(let _0x27fcd5=0x0;_0x27fcd5<_0x2183d4['length'];_0x27fcd5++){let _0x2f1900=_0x2183d4[_0x27fcd5],_0x4d4368=_0x2183d4[_0x27fcd5][_0x23b8f5(0x1af)];if(_0x4d4368[_0x23b8f5(0x1bc)]>0x0){if(_0x4d4368[0x0]=='.')continue;if(/[A-Z]:\\/i['test'](_0x2257ce)&&_0x2257ce['length']<=0x3){if(win32ExcludeList[_0x23b8f5(0x1f2)](_0x4d4368)||_0x4d4368[_0x23b8f5(0x254)](_0x23b8f5(0x24e))||_0x4d4368[_0x23b8f5(0x254)](_0x23b8f5(0x1b4)))continue;}}let _0xfb40e=path[_0x23b8f5(0x256)](_0x2257ce,_0x4d4368);if(_0x1c4b90[_0x23b8f5(0x1f2)](_0xfb40e))continue;let _0xede44b=_0x2f1900[_0x23b8f5(0x26a)](),_0x270251=_0x2f1900['isDirectory']();function _0x5bdfdb(){const _0x42a071=_0x23b8f5;if(_0xede44b)(_0x2b4acf==0x0||_0x2b4acf==0x1)&&_0x2bccb7[_0x42a071(0x23c)]({'type':0x1,'name':_0x4d4368,'fileFullPath':_0xfb40e});else _0x270251&&_0x2bccb7[_0x42a071(0x23c)]({'type':0x2,'name':_0x4d4368,'fileFullPath':_0xfb40e});}_0x3c92b6?_0x4d4368[_0x23b8f5(0x1f2)](_0x3c92b6)&&_0x5bdfdb():_0x5bdfdb();try{if(_0x2bccb7['length']>0x1770)break;}catch(_0x4f20d3){continue;}}let _0x5345d3=_0x2bccb7[_0x23b8f5(0x1bc)],_0x45d614=0x0;if(_0x2bccb7[_0x23b8f5(0x1bc)]<0x1)return _0x23b5e8['json']({'code':0x0,'data':{'parent':_0x2257ce,'children':_0x2bccb7,'sep':_0x35e66e,'platform':platform}});for(let _0x5c338e of _0x2bccb7){fs[_0x23b8f5(0x1b6)](_0x5c338e[_0x23b8f5(0x25c)],(_0x40d7f2,_0x4f8fe7)=>{const _0x173568=_0x23b8f5;_0x45d614+=0x1;!_0x40d7f2&&(_0x5c338e[_0x173568(0x1d5)]=_0x4f8fe7['atimeMs'],_0x5c338e['mtimeMs']=_0x4f8fe7[_0x173568(0x1be)],_0x5c338e[_0x173568(0x24b)]=_0x4f8fe7[_0x173568(0x24b)],_0x5c338e[_0x173568(0x1dd)]=_0x4f8fe7['size']);if(_0x45d614>=_0x5345d3)return _0x23b5e8[_0x173568(0x24d)]({'code':0x0,'data':{'parent':_0x2257ce,'children':_0x2bccb7,'sep':_0x35e66e,'platform':platform}});});}});}}catch(_0x224c8f){return fileUtil['returnFileError'](_0x23b5e8,_0x224c8f);}}),router[_0x3ce239(0x223)](_0x3ce239(0x27d),(_0x58736a,_0x5355f6,_0x5c016f)=>{const _0x32cb2e=_0x3ce239;let _0x2162a1=fileUtil[_0x32cb2e(0x281)](_0x58736a[_0x32cb2e(0x20b)][_0x32cb2e(0x23f)]);if(!_0x2162a1)return _0x5355f6[_0x32cb2e(0x1e2)](0x194)[_0x32cb2e(0x1b7)]();_0x2162a1=path[_0x32cb2e(0x256)](_0x2162a1);let _0x4b65ff=path['join'](config['userDataFolder'],_0x32cb2e(0x27c),path['sep']);return _0x2162a1[_0x32cb2e(0x242)](_0x4b65ff)?_0x5355f6[_0x32cb2e(0x1c2)](_0x2162a1):_0x5355f6[_0x32cb2e(0x1e2)](0x194)[_0x32cb2e(0x1b7)]();}),router[_0x3ce239(0x223)]('/rawFile*',(_0x403043,_0x1d1c24,_0x39ee68)=>{const _0x4e0dcd=_0x3ce239;let _0x425359=_0x403043['query'][_0x4e0dcd(0x23f)],_0x437a7d=_0x403043[_0x4e0dcd(0x20b)]['download']==0x1,_0x31a8c2=fileUtil[_0x4e0dcd(0x281)](_0x425359),_0x2671a2=_0x403043[_0x4e0dcd(0x20b)][_0x4e0dcd(0x1dd)],_0x3b66b5=_0x403043[_0x4e0dcd(0x20b)][_0x4e0dcd(0x253)];if(dbUserTable[_0x4e0dcd(0x239)](_0x403043,_0x1d1c24,'',_0x4e0dcd(0x1db),_0x31a8c2)==!![])try{let _0x2bdcc5=_0x403043['query'][_0x4e0dcd(0x259)];if(_0x2bdcc5&&_0x2bdcc5==0x1){if(_0x437a7d){const _0x540467=encodeURIComponent(path[_0x4e0dcd(0x28e)](_0x31a8c2))[_0x4e0dcd(0x1ed)](/%([0-9A-F]{2})/g,(_0x47c610,_0x28e65c)=>'%'+_0x28e65c[_0x4e0dcd(0x243)]());_0x1d1c24[_0x4e0dcd(0x1c7)]('Content-Disposition','attachment;\x20filename*=UTF-8\x27\x27'+_0x540467);}return _0x1d1c24['sendFile'](_0x31a8c2);}else _0x403043[_0x4e0dcd(0x20b)][_0x4e0dcd(0x1f9)]&&_0x403043[_0x4e0dcd(0x20b)]['code']==_0x4e0dcd(0x28f)&&path[_0x4e0dcd(0x1d2)](_0x31a8c2)&&path[_0x4e0dcd(0x1d2)](_0x31a8c2)[_0x4e0dcd(0x284)]()=='.txt'?(console[_0x4e0dcd(0x224)](_0x4e0dcd(0x222),_0x31a8c2),encodingUtil[_0x4e0dcd(0x260)](_0x31a8c2)[_0x4e0dcd(0x233)](_0x123d7c=>{const _0x3b0e0c=_0x4e0dcd;return _0x123d7c?_0x123d7c[_0x3b0e0c(0x214)](_0x1d1c24):(console[_0x3b0e0c(0x224)](_0x3b0e0c(0x26f),_0x31a8c2),_0x1d1c24['sendFile'](_0x31a8c2));})):sharpUtil[_0x4e0dcd(0x255)](_0x1d1c24,_0x31a8c2,_0x437a7d,_0x2671a2,_0x3b66b5);}catch(_0x21de01){return console['log'](_0x21de01),fileUtil[_0x4e0dcd(0x25b)](_0x1d1c24,_0x21de01);}}),router[_0x3ce239(0x24a)](_0x3ce239(0x1e3),(_0x738527,_0x14f5e8,_0x55f3c5)=>{const _0x1c99de=_0x3ce239;let _0x3e964c=fileUtil[_0x1c99de(0x281)](_0x738527[_0x1c99de(0x1a7)][_0x1c99de(0x23e)]),_0x46b7eb=_0x738527[_0x1c99de(0x1a7)][_0x1c99de(0x268)];if(_0x46b7eb==_0x1c99de(0x1b8))_0x46b7eb=fs[_0x1c99de(0x20e)]['W_OK'];else _0x46b7eb==_0x1c99de(0x27b)&&(_0x46b7eb=fs[_0x1c99de(0x20e)][_0x1c99de(0x249)]);try{_0x46b7eb==_0x1c99de(0x250)?fs['access'](_0x3e964c,fs[_0x1c99de(0x20e)][_0x1c99de(0x1f4)],_0x580ea3=>{const _0xef8e15=_0x1c99de;if(_0x580ea3)return fileUtil[_0xef8e15(0x25b)](_0x14f5e8,_0x580ea3);return _0x14f5e8[_0xef8e15(0x24d)]({'code':0x0,'access':!![]});}):fs[_0x1c99de(0x275)](_0x3e964c,_0x46b7eb,_0x529bca=>{const _0x148018=_0x1c99de;if(_0x529bca)return fileUtil[_0x148018(0x25b)](_0x14f5e8,_0x529bca);return _0x14f5e8['json']({'code':0x0,'access':!![]});});}catch(_0x3e2826){return _0x14f5e8[_0x1c99de(0x24d)]({'code':0x0,'access':![]});}}),router[_0x3ce239(0x24a)](_0x3ce239(0x1e5),(_0x3a9a91,_0x486e27,_0x41f63f)=>{const _0x9c6f26=_0x3ce239;let _0xa0748c=fileUtil[_0x9c6f26(0x281)](_0x3a9a91['body']['parentPath']),_0x49955e=_0x3a9a91[_0x9c6f26(0x1a7)]['folderName'],_0x1ecfd0=path['join'](_0xa0748c,_0x49955e);if(dbUserTable['doUserCanGet'](_0x3a9a91,_0x486e27,_0x9c6f26(0x237),_0x9c6f26(0x1ca),_0x1ecfd0)==!![])try{fs[_0x9c6f26(0x1b6)](_0x1ecfd0,_0x499a9b=>{const _0x1337a6=_0x9c6f26;if(!_0x499a9b)return _0x3a9a91['app'][_0x1337a6(0x1c6)](_0x486e27,_0x486e27['__'](_0x1337a6(0x1dc))+':'+_0x1ecfd0);else fs['mkdir'](_0x1ecfd0,{'recursive':!![]},_0x4be397=>{const _0x495af7=_0x1337a6;return _0x4be397?fileUtil[_0x495af7(0x25b)](_0x486e27,_0x4be397):_0x486e27['json']({'code':0x0});});});}catch(_0x2f7f62){return fileUtil['returnFileError'](_0x486e27,_0x2f7f62);}}),router[_0x3ce239(0x24a)]('/zipFile',(_0x2c232f,_0x50decb,_0x3369fb)=>{const _0x319a86=_0x3ce239;let _0x58b02d=_0x2c232f[_0x319a86(0x1a7)][_0x319a86(0x1fc)],_0xf9d515=_0x2c232f['body'][_0x319a86(0x271)],_0x26cb24=_0x2c232f[_0x319a86(0x1a7)][_0x319a86(0x1a8)];if(_0x26cb24!=_0x319a86(0x27e)&&_0x26cb24!=_0x319a86(0x282))return _0x2c232f[_0x319a86(0x26c)][_0x319a86(0x1c6)](_0x50decb,_0x50decb['__'](_0x319a86(0x1d0)));if(dbUserTable['doUserCanGet'](_0x2c232f,_0x50decb,'folder',_0x319a86(0x1db),_0x58b02d)==!![]&&dbUserTable[_0x319a86(0x239)](_0x2c232f,_0x50decb,_0x319a86(0x237),_0x319a86(0x1ca),_0xf9d515)==!![]){let _0x3d48e7=_0x2c232f['app'][_0x319a86(0x212)][_0x319a86(0x28c)](_0x319a86(0x286))[_0x319a86(0x208)]('FILE_OPERATION',JSON[_0x319a86(0x27a)]({'sourcePath':_0x58b02d,'targetPath':_0xf9d515,'type':_0x26cb24,'username':_0x2c232f[_0x319a86(0x274)][_0x319a86(0x204)]}));return process[_0x319a86(0x22e)]({'type':'START_WORKER_FILE_OPERATION','taskIdList':[_0x3d48e7[_0x319a86(0x278)]]}),_0x50decb[_0x319a86(0x24d)]({'code':0x0});}}),router[_0x3ce239(0x24a)](_0x3ce239(0x28a),(_0x12620c,_0x3f3d2a,_0x25b2bb)=>{const _0x13c3d3=_0x3ce239;let _0x5a8d03=_0x12620c['body'][_0x13c3d3(0x1cc)],_0x1160fc=_0x12620c['body'][_0x13c3d3(0x271)],_0x122cb8=_0x12620c[_0x13c3d3(0x1a7)][_0x13c3d3(0x1a8)];if(_0x5a8d03['length']<0x1)return _0x12620c[_0x13c3d3(0x26c)][_0x13c3d3(0x1c6)](_0x3f3d2a,_0x3f3d2a['__'](_0x13c3d3(0x1d0)));if(dbUserTable['doUserCanGet'](_0x12620c,_0x3f3d2a,_0x13c3d3(0x237),'power_get',_0x5a8d03[0x0])==!![]&&dbUserTable['doUserCanGet'](_0x12620c,_0x3f3d2a,_0x13c3d3(0x237),_0x13c3d3(0x1ca),_0x1160fc)==!![])try{let _0x30ce45=[];for(let _0x41cdb8 in _0x5a8d03){let _0x4d17b4=_0x5a8d03[_0x41cdb8],_0x472902=path[_0x13c3d3(0x28e)](_0x4d17b4),_0x5b8cc6=path[_0x13c3d3(0x256)](_0x1160fc,_0x472902),_0x5a6ca9=_0x12620c[_0x13c3d3(0x26c)][_0x13c3d3(0x212)][_0x13c3d3(0x28c)](_0x13c3d3(0x286))['run'](_0x13c3d3(0x1b3),JSON[_0x13c3d3(0x27a)]({'sourcePath':_0x4d17b4,'targetPath':_0x5b8cc6,'type':_0x122cb8,'username':_0x12620c['currentUser']['username']}));_0x30ce45['push'](_0x5a6ca9[_0x13c3d3(0x278)]);}return process[_0x13c3d3(0x22e)]({'type':_0x13c3d3(0x289),'taskIdList':_0x30ce45}),_0x3f3d2a['json']({'code':0x0});}catch(_0x47a05b){return _0x12620c[_0x13c3d3(0x26c)]['returnErrMsg'](_0x3f3d2a,_0x3f3d2a['__']('operationFail'));}}),router[_0x3ce239(0x24a)](_0x3ce239(0x1ef),(_0x5e62e5,_0x73aeb9,_0x39fa0b)=>{const _0x42f83d=_0x3ce239;let _0x2c02b7=fileUtil['decodePath'](_0x5e62e5['body']['sourcePath']),_0x26534d=fileUtil[_0x42f83d(0x281)](_0x5e62e5['body'][_0x42f83d(0x271)]),_0x85ecc=path['basename'](_0x2c02b7),_0x841381=_0x5e62e5[_0x42f83d(0x1a7)][_0x42f83d(0x1a8)],_0x57b7c0=path['join'](_0x26534d,_0x85ecc);if(_0x841381==_0x42f83d(0x200)||_0x841381==_0x42f83d(0x218)){if(fs[_0x42f83d(0x276)](_0x57b7c0))return _0x5e62e5[_0x42f83d(0x26c)][_0x42f83d(0x1c6)](_0x73aeb9,_0x73aeb9['__'](_0x42f83d(0x1dc))+':'+_0x57b7c0);}let _0x285f91=_0x5e62e5[_0x42f83d(0x1a7)][_0x42f83d(0x203)];function _0x4b21ca(_0x3afb48,_0xed11db){const _0x4f75a8=_0x42f83d;let _0x2778a5=_0x5e62e5['app'][_0x4f75a8(0x212)][_0x4f75a8(0x28c)](_0x4f75a8(0x286))[_0x4f75a8(0x208)](_0x4f75a8(0x1b3),JSON[_0x4f75a8(0x27a)]({'sourcePath':_0x3afb48,'targetPath':_0xed11db,'type':_0x841381,'username':_0x5e62e5[_0x4f75a8(0x274)][_0x4f75a8(0x204)]}));return _0x2778a5[_0x4f75a8(0x278)];}try{_0x2c02b7=path['join'](_0x2c02b7),_0x26534d=path['join'](_0x26534d);if(_0x26534d==_0x2c02b7||_0x26534d['startsWith'](_0x2c02b7+path['sep']))return _0x5e62e5['app'][_0x42f83d(0x1c6)](_0x73aeb9,_0x73aeb9['__'](_0x42f83d(0x205)));if(dbUserTable['doUserCanGet'](_0x5e62e5,_0x73aeb9,_0x42f83d(0x237),'power_get',_0x2c02b7)==!![]){let _0x26199c=![];fs[_0x42f83d(0x1b6)](_0x2c02b7,(_0x3742f4,_0x1a60d9)=>{const _0x593c53=_0x42f83d;if(_0x3742f4)return _0x5e62e5[_0x593c53(0x26c)]['returnErrMsg'](_0x73aeb9,_0x73aeb9['__']('noReadPermission')+':'+_0x2c02b7);let _0x2f2a00=path[_0x593c53(0x28e)](_0x2c02b7);fs[_0x593c53(0x275)](_0x26534d,fs[_0x593c53(0x20e)][_0x593c53(0x249)]|fs['constants'][_0x593c53(0x1f4)],_0x9ca12d=>{const _0x32070d=_0x593c53;if(_0x9ca12d)return _0x5e62e5['app'][_0x32070d(0x1c6)](_0x73aeb9,_0x73aeb9['__']('noWritePermission')+':'+_0x26534d);if(_0x841381=='rename')dbUserTable[_0x32070d(0x239)](_0x5e62e5,_0x73aeb9,'folder',_0x32070d(0x1bd),_0x26534d)==!![]&&(_0x26534d=path[_0x32070d(0x256)](_0x26534d,_0x285f91),fs[_0x32070d(0x1b6)](_0x26534d,_0xf6574=>{const _0x341b2e=_0x32070d;if(!_0xf6574)return _0x5e62e5[_0x341b2e(0x26c)]['returnErrMsg'](_0x73aeb9,_0x73aeb9['__'](_0x341b2e(0x1dc))+':'+_0x26534d);else fs['rename'](_0x2c02b7,_0x26534d,_0x17f2cf=>{const _0x48f9b1=_0x341b2e;if(_0x17f2cf)return dbFileOperationRecord[_0x48f9b1(0x1cd)](_0x5e62e5[_0x48f9b1(0x26c)]['dbOther'],{'username':_0x5e62e5['currentUser'][_0x48f9b1(0x204)],'sourcePath':_0x2c02b7,'targetPath':_0x26534d,'level':dbFileOperationRecord[_0x48f9b1(0x1ba)],'belongId':null,'type':dbFileOperationRecord[_0x48f9b1(0x263)],'subType':null,'state':dbFileOperationRecord[_0x48f9b1(0x22d)],'remark':fileUtil['returnFileError'](_0x73aeb9,_0x17f2cf,!![])}),dbNoticeCenterTable[_0x48f9b1(0x1fd)](_0x5e62e5[_0x48f9b1(0x26c)]['dbOther'],{'title':_0x73aeb9['__'](_0x48f9b1(0x1d0)),'level':_0x48f9b1(0x246),'content':_0x73aeb9['__']('fileRenameFail')+':'+(_0x2c02b7+_0x48f9b1(0x213)+_0x26534d)});_0x26199c=!![],dbFileOperationRecord[_0x48f9b1(0x1cd)](_0x5e62e5[_0x48f9b1(0x26c)][_0x48f9b1(0x212)],{'username':_0x5e62e5[_0x48f9b1(0x274)][_0x48f9b1(0x204)],'sourcePath':_0x2c02b7,'targetPath':_0x26534d,'level':dbFileOperationRecord[_0x48f9b1(0x1ba)],'belongId':null,'type':dbFileOperationRecord[_0x48f9b1(0x263)],'subType':null,'state':dbFileOperationRecord[_0x48f9b1(0x25e)]});}),setTimeout(()=>{const _0x3d8a99=_0x341b2e;return _0x73aeb9[_0x3d8a99(0x24d)]({'code':0x0,'isOver':_0x26199c?0x1:0x0});},0x3e8);}));else{if(_0x841381==_0x32070d(0x218)){if(dbUserTable[_0x32070d(0x239)](_0x5e62e5,_0x73aeb9,_0x32070d(0x237),'power_delete',_0x26534d)!==!![])return;}if(dbUserTable['doUserCanGet'](_0x5e62e5,_0x73aeb9,'folder',_0x32070d(0x1ca),_0x26534d)==!![]){_0x26534d=path[_0x32070d(0x256)](_0x26534d,_0x2f2a00);let _0x139d46=_0x4b21ca(_0x2c02b7,_0x26534d);return process['send']({'type':_0x32070d(0x289),'taskIdList':[_0x139d46]}),_0x73aeb9[_0x32070d(0x24d)]({'code':0x0});}}});});}}catch(_0x3af53c){return _0x5e62e5[_0x42f83d(0x26c)]['returnErrMsg'](_0x73aeb9,_0x73aeb9['__']('operationFail'));}}),router[_0x3ce239(0x24a)](_0x3ce239(0x257),(_0x5bea9b,_0x36e021,_0x1e05bb)=>{const _0x59a4d5=_0x3ce239;let _0x2b0bc1=_0x5bea9b['body'][_0x59a4d5(0x247)];if(!_0x2b0bc1)return _0x36e021[_0x59a4d5(0x1e2)](0x194)[_0x59a4d5(0x1b7)]();dbUserTable[_0x59a4d5(0x239)](_0x5bea9b,_0x36e021,_0x59a4d5(0x237),_0x59a4d5(0x1db),_0x2b0bc1)==!![]&&fs['stat'](_0x2b0bc1,(_0x333047,_0xb189b9)=>{const _0x570234=_0x59a4d5;if(_0x333047)return fileUtil[_0x570234(0x25b)](_0x36e021,_0x333047);return _0xb189b9[_0x570234(0x1c5)]=fileUtil[_0x570234(0x25a)](_0xb189b9['size']),_0x36e021[_0x570234(0x24d)]({'code':0x0,'data':_0xb189b9});});}),router[_0x3ce239(0x24a)](_0x3ce239(0x1ea),(_0x7cf6fc,_0xde9874,_0x1aa51f)=>{const _0x413ef0=_0x3ce239;let _0x3ebf10=_0x7cf6fc['body'][_0x413ef0(0x266)],_0x2a29e8=_0x7cf6fc['body'][_0x413ef0(0x236)];_0x2a29e8&&(_0x2a29e8=_0x2a29e8['replace'](/[<>\\\/:\*\?\"\|]/g,'_')),_0x3ebf10&&(_0x3ebf10=fileUtil[_0x413ef0(0x281)](_0x3ebf10)),fs['access'](_0x3ebf10,fs['constants'][_0x413ef0(0x1f4)]|fs['constants'][_0x413ef0(0x249)],_0x3b17a9=>{const _0xe936a5=_0x413ef0;if(_0x3b17a9)return _0xde9874[_0xe936a5(0x24d)]({'code':0x1,'message':_0xde9874['__'](_0xe936a5(0x1e8))+':'+_0x3ebf10});else{let _0x1b3228='';if(_0x3ebf10&&_0x2a29e8)_0x1b3228=path['join'](_0x3ebf10,_0x2a29e8);else{if(_0x3ebf10)_0x1b3228=path[_0xe936a5(0x256)](_0x3ebf10);else return _0xde9874['json']({'code':0x1,'message':_0xde9874['__'](_0xe936a5(0x1cf))+':'+_0x3ebf10});}fs[_0xe936a5(0x1b6)](_0x1b3228,_0x4bcb36=>{const _0x109f67=_0xe936a5;return _0x4bcb36?(console[_0x109f67(0x224)](_0x109f67(0x227),_0x1b3228),_0xde9874[_0x109f67(0x24d)]({'code':0x0})):_0xde9874[_0x109f67(0x24d)]({'code':0x1,'remark':_0x109f67(0x279)});});}});}),router[_0x3ce239(0x24a)](_0x3ce239(0x22f),(_0x185f79,_0x3c889e,_0x480bfc)=>{const _0x17b5c8=_0x3ce239;let _0x544bd9=_0x185f79[_0x17b5c8(0x1a7)][_0x17b5c8(0x247)],_0x3faa4e=_0x185f79['body'][_0x17b5c8(0x1c8)];if(!_0x544bd9)return _0x3c889e[_0x17b5c8(0x1e2)](0x194)[_0x17b5c8(0x1b7)]();_0x544bd9=path[_0x17b5c8(0x256)](_0x544bd9);if(dbUserTable[_0x17b5c8(0x239)](_0x185f79,_0x3c889e,'folder','power_delete',_0x544bd9)==!![]){if(_0x3faa4e==0x1)return process['send']({'type':_0x17b5c8(0x231),'shellType':'trash','path':_0x544bd9}),dbFileOperationRecord[_0x17b5c8(0x1cd)](_0x185f79[_0x17b5c8(0x26c)][_0x17b5c8(0x212)],{'username':_0x185f79[_0x17b5c8(0x274)][_0x17b5c8(0x204)],'targetPath':_0x544bd9,'level':dbFileOperationRecord[_0x17b5c8(0x1ba)],'type':dbFileOperationRecord[_0x17b5c8(0x1e7)],'state':dbFileOperationRecord[_0x17b5c8(0x25e)]}),_0x3c889e[_0x17b5c8(0x24d)]({'code':0x0,'message':_0x3c889e['__'](_0x17b5c8(0x211))});else fs['rm'](_0x544bd9,{'recursive':!![]},_0x1d807d=>{const _0x1cf3b7=_0x17b5c8;if(_0x1d807d)return dbFileOperationRecord['addFileOperationRecord'](_0x185f79[_0x1cf3b7(0x26c)]['dbOther'],{'username':_0x185f79[_0x1cf3b7(0x274)]['username'],'targetPath':_0x544bd9,'level':dbFileOperationRecord[_0x1cf3b7(0x1ba)],'type':dbFileOperationRecord[_0x1cf3b7(0x1e7)],'state':dbFileOperationRecord['STATE_FAIL'],'remark':fileUtil[_0x1cf3b7(0x25b)](_0x3c889e,_0x1d807d,!![])}),fileUtil[_0x1cf3b7(0x25b)](_0x3c889e,_0x1d807d);return dbFileOperationRecord[_0x1cf3b7(0x1cd)](_0x185f79[_0x1cf3b7(0x26c)][_0x1cf3b7(0x212)],{'username':_0x185f79[_0x1cf3b7(0x274)][_0x1cf3b7(0x204)],'targetPath':_0x544bd9,'level':dbFileOperationRecord[_0x1cf3b7(0x1ba)],'type':dbFileOperationRecord['TYPE_DELETE'],'state':dbFileOperationRecord['STATE_SUC']}),_0x3c889e[_0x1cf3b7(0x24d)]({'code':0x0,'message':_0x3c889e['__'](_0x1cf3b7(0x211))});});}}),router['post'](_0x3ce239(0x1ec),(_0x4cbac9,_0x568334,_0x55e627)=>{const _0x5d8897=_0x3ce239;if(_0x4cbac9[_0x5d8897(0x274)]['is_admin']!=0x1)return _0x568334[_0x5d8897(0x24d)]({'code':0x66});return dbFileOperationRecord['deleteFileRecordAll'](_0x4cbac9['app'][_0x5d8897(0x212)]),_0x568334[_0x5d8897(0x24d)]({'code':0x0});}),router[_0x3ce239(0x24a)](_0x3ce239(0x1c1),(_0x47d138,_0x2f94c5,_0x5ce93b)=>{const _0x4ff1fe=_0x3ce239;let _0x2decbc=_0x47d138['body']['page'],_0x5de625=_0x47d138[_0x4ff1fe(0x1a7)]['pageSize'],_0x9cc7d0=_0x47d138[_0x4ff1fe(0x1a7)]['type'],_0x4632ce=_0x47d138[_0x4ff1fe(0x1a7)][_0x4ff1fe(0x264)],_0x16121f=_0x47d138['body']['subType'],_0x445fbb=_0x47d138[_0x4ff1fe(0x1a7)][_0x4ff1fe(0x25f)],_0x36aacb=_0x47d138['body'][_0x4ff1fe(0x1ce)],_0x267d86;return _0x47d138[_0x4ff1fe(0x274)][_0x4ff1fe(0x23b)]==0x1?_0x267d86=dbFileOperationRecord[_0x4ff1fe(0x290)](_0x47d138[_0x4ff1fe(0x26c)][_0x4ff1fe(0x212)],_0x2decbc,_0x5de625,_0x4632ce,_0x9cc7d0,_0x16121f,_0x445fbb,_0x36aacb):_0x267d86=dbFileOperationRecord[_0x4ff1fe(0x290)](_0x47d138[_0x4ff1fe(0x26c)][_0x4ff1fe(0x212)],_0x2decbc,_0x5de625,_0x4632ce,_0x9cc7d0,_0x16121f,_0x445fbb,_0x36aacb,_0x47d138[_0x4ff1fe(0x274)][_0x4ff1fe(0x204)]),_0x2f94c5[_0x4ff1fe(0x24d)]({'code':0x0,'data':_0x267d86});}),router[_0x3ce239(0x24a)](_0x3ce239(0x1d4),(_0x264338,_0x1bca6b,_0x1dd9e2)=>{const _0x5426d6=_0x3ce239;let _0x141462=_0x264338[_0x5426d6(0x1a7)][_0x5426d6(0x26b)];if(_0x141462=='add'||_0x141462==_0x5426d6(0x1fa)){if(_0x264338[_0x5426d6(0x274)][_0x5426d6(0x23b)]!=0x1)return _0x1bca6b[_0x5426d6(0x24d)]({'code':0x66});}if(_0x141462==_0x5426d6(0x1f7)){let _0x29143c=_0x264338['body'][_0x5426d6(0x1a8)],_0x230af3=_0x264338['body'][_0x5426d6(0x202)],_0x5bacf2=_0x264338[_0x5426d6(0x1a7)]['username'],_0x49894d=_0x264338['body'][_0x5426d6(0x229)],_0x4a2308=_0x264338['body'][_0x5426d6(0x204)],_0x3a8554=_0x264338[_0x5426d6(0x1a7)][_0x5426d6(0x265)],_0x4c20d6=['local',_0x5426d6(0x1fe),_0x5426d6(0x273)];if(!_0x29143c||!_0x230af3||!_0x4c20d6[_0x5426d6(0x1f2)](_0x29143c))return _0x264338[_0x5426d6(0x26c)]['returnErrMsg'](_0x1bca6b,_0x1bca6b['__']('operationFail'));_0x29143c==_0x5426d6(0x23a)&&fileStatUtil[_0x5426d6(0x252)](_0x230af3,()=>{const _0x3343e7=_0x5426d6;fileStatUtil[_0x3343e7(0x24f)](_0x230af3,()=>{const _0x52732d=_0x3343e7,_0x34dc33=_0x52732d(0x1f0);return _0x264338['app'][_0x52732d(0x212)][_0x52732d(0x28c)](_0x34dc33)[_0x52732d(0x208)](_0x29143c,_0x230af3,_0x5bacf2,_0x4a2308,_0x3a8554,_0x49894d),_0x1bca6b[_0x52732d(0x24d)]({'code':0x0});},()=>{const _0x3022e3=_0x3343e7;return _0x264338['app']['returnErrMsg'](_0x1bca6b,_0x1bca6b['__'](_0x3022e3(0x230)));});},()=>{const _0x5076b2=_0x5426d6;return _0x264338[_0x5076b2(0x26c)][_0x5076b2(0x1c6)](_0x1bca6b,_0x1bca6b['__'](_0x5076b2(0x1ad)));});}else{if(_0x141462==_0x5426d6(0x1fa)){let _0x100cb4=_0x264338['body']['id'];return _0x264338['app']['dbOther'][_0x5426d6(0x28c)]('delete\x20from\x20path_mount\x20where\x20id=?')[_0x5426d6(0x208)](_0x100cb4),_0x1bca6b['json']({'code':0x0});}else{if(_0x141462==_0x5426d6(0x223)){let _0x28b961=[],_0x56c7e8=_0x264338[_0x5426d6(0x26c)][_0x5426d6(0x212)][_0x5426d6(0x28c)](_0x5426d6(0x1bf))[_0x5426d6(0x250)]();if(_0x264338['currentUser'][_0x5426d6(0x23b)]==0x1)_0x28b961=_0x56c7e8;else{let _0x1fdb29=dbUserTable[_0x5426d6(0x209)](_0x264338[_0x5426d6(0x26c)]['dbOther'],_0x264338[_0x5426d6(0x274)][_0x5426d6(0x204)],_0x5426d6(0x237),'power_get');for(let _0x53f687 in _0x1fdb29){let _0x8f65f3=_0x1fdb29[_0x53f687]['path'][_0x5426d6(0x284)]();_0x8f65f3=path[_0x5426d6(0x256)](_0x8f65f3);for(let _0x553c85 in _0x56c7e8){try{if(_0x56c7e8[_0x553c85][_0x5426d6(0x202)]&&_0x8f65f3){let _0x1e8c91=_0x56c7e8[_0x553c85]['url'][_0x5426d6(0x284)]();_0x1e8c91[_0x5426d6(0x254)](':')&&_0x1e8c91['length']==0x2&&(_0x1e8c91=_0x1e8c91+path['sep']),_0x1e8c91=path['join'](_0x1e8c91)['toLowerCase'](),(_0x8f65f3==_0x1e8c91||_0x1e8c91['startsWith'](path[_0x5426d6(0x256)](_0x8f65f3+path[_0x5426d6(0x217)])))&&_0x28b961[_0x5426d6(0x23c)](_0x56c7e8[_0x553c85]);}}catch(_0xa5c80b){continue;}}}}return _0x1bca6b[_0x5426d6(0x24d)]({'code':0x0,'data':_0x28b961});}}}});function getRandomString(_0x5ca11e){const _0x40ce36=_0x3ce239;let _0x2d3a31='';const _0x2f6a06=_0x40ce36(0x261),_0x361f90=_0x2f6a06[_0x40ce36(0x1bc)];for(let _0x30fb2a=0x0;_0x30fb2a<_0x5ca11e;_0x30fb2a++){_0x2d3a31+=_0x2f6a06[_0x40ce36(0x251)](Math[_0x40ce36(0x22b)](Math[_0x40ce36(0x20a)]()*_0x361f90));}return _0x2d3a31;}router[_0x3ce239(0x24a)]('/getTempShare',(_0x3b11e1,_0x126693,_0x513ba7)=>{const _0xd24436=_0x3ce239;let _0x423141=[];return _0x3b11e1['currentUser'][_0xd24436(0x23b)]==0x1?_0x423141=_0x3b11e1[_0xd24436(0x26c)]['dbOther'][_0xd24436(0x28c)](_0xd24436(0x27f))[_0xd24436(0x250)]():_0x423141=_0x3b11e1[_0xd24436(0x26c)][_0xd24436(0x212)][_0xd24436(0x28c)](_0xd24436(0x1e0))['all'](_0x3b11e1[_0xd24436(0x274)]['id']),_0x126693[_0xd24436(0x24d)]({'code':0x0,'data':_0x423141});}),router[_0x3ce239(0x24a)](_0x3ce239(0x1b2),(_0x42105c,_0x4a6909,_0x44dde9)=>{const _0x470f4a=_0x3ce239;let _0x568595=_0x42105c[_0x470f4a(0x1a7)][_0x470f4a(0x26b)];if(_0x568595==_0x470f4a(0x1f7))try{if(!_0x42105c[_0x470f4a(0x1a7)][_0x470f4a(0x23f)])return _0x42105c[_0x470f4a(0x26c)][_0x470f4a(0x1c6)](_0x4a6909,_0x470f4a(0x246));let _0x17d2c3=fileUtil[_0x470f4a(0x281)](_0x42105c['body'][_0x470f4a(0x23f)]);function _0x2afe41(){const _0x28881c=_0x470f4a;if(dbUserTable['doUserCanGet'](_0x42105c,_0x4a6909,'','power_get',_0x17d2c3)==!![]){let _0x54b5c7=_0x42105c[_0x28881c(0x1a7)][_0x28881c(0x265)]?_0x42105c['body']['password']:'',_0x548362=new Date()['getTime'](),_0x4d78e8=getRandomString(0x5),_0x3f430c=_0x42105c[_0x28881c(0x26c)][_0x28881c(0x212)][_0x28881c(0x28c)](_0x28881c(0x225))['get'](_0x4d78e8);if(_0x3f430c)return _0x2afe41();let _0x2a9897=_0x42105c['body'][_0x28881c(0x20c)]?_0x42105c['body']['days']:0x1e,_0x19915f=0xe10*0x3e8*0x18*_0x2a9897+_0x548362;return _0x42105c['app'][_0x28881c(0x212)][_0x28881c(0x28c)](_0x28881c(0x241))[_0x28881c(0x208)](_0x17d2c3,_0x54b5c7,_0x4d78e8,_0x548362,_0x19915f,_0x42105c['currentUser']['id']),_0x4a6909[_0x28881c(0x24d)]({'code':0x0,'token':_0x4d78e8});}}return _0x2afe41();}catch(_0x2dc48c){return console[_0x470f4a(0x224)](_0x2dc48c),_0x42105c[_0x470f4a(0x26c)]['returnErrMsg'](_0x4a6909,'error');}else{if(_0x568595==_0x470f4a(0x1fa)){let _0x16e7d9=_0x42105c[_0x470f4a(0x1a7)][_0x470f4a(0x207)];return _0x42105c[_0x470f4a(0x274)][_0x470f4a(0x23b)]==0x1?_0x42105c[_0x470f4a(0x26c)][_0x470f4a(0x212)]['prepare'](_0x470f4a(0x226))[_0x470f4a(0x208)](_0x16e7d9):_0x42105c[_0x470f4a(0x26c)][_0x470f4a(0x212)][_0x470f4a(0x28c)](_0x470f4a(0x26d))['run'](_0x16e7d9,_0x42105c[_0x470f4a(0x274)]['id']),_0x4a6909[_0x470f4a(0x24d)]({'code':0x0});}}}),router[_0x3ce239(0x24a)](_0x3ce239(0x287),(_0x1f417e,_0x3a9a1c,_0x895ae3)=>{const _0xb404ce=_0x3ce239;let _0x259afc=_0x1f417e[_0xb404ce(0x1a7)]['shareToken']||_0x1f417e['body']['st'],_0x50468d=_0x1f417e[_0xb404ce(0x1a7)][_0xb404ce(0x270)],_0x4a95b7=_0x1f417e[_0xb404ce(0x1a7)][_0xb404ce(0x265)],_0x30d8f8=[],_0x8617f3=dbConfigTable['findByTitleArr'](_0x1f417e[_0xb404ce(0x26c)]['dbOther'],_0xb404ce(0x244)),_0x39bcd1={'code':0x0,'data':{'customConfig':_0x8617f3,'parent':_0x50468d,'children':_0x30d8f8,'sep':path[_0xb404ce(0x217)],'platform':platform}};if(!_0x259afc)return _0x3a9a1c[_0xb404ce(0x24d)](_0x39bcd1);let _0x411034=dbUserTable[_0xb404ce(0x201)](_0x1f417e['app'][_0xb404ce(0x212)],_0x259afc);if(!_0x411034)return _0x3a9a1c[_0xb404ce(0x24d)](_0x39bcd1);if(_0x411034[_0xb404ce(0x265)]){if(!_0x4a95b7)return _0x3a9a1c['json']({'code':0x2});if(_0x411034[_0xb404ce(0x265)]!=_0x4a95b7)return _0x3a9a1c['json']({'code':0x2,'message':_0x3a9a1c['__'](_0xb404ce(0x258))});}function _0x4db681(){const _0x3781cc=_0xb404ce;fs['stat'](_0x411034[_0x3781cc(0x23f)],(_0x563772,_0x3940f9)=>{const _0x1ff290=_0x3781cc;if(_0x563772)return _0x3a9a1c[_0x1ff290(0x24d)](_0x39bcd1);return _0x39bcd1[_0x1ff290(0x1d7)][_0x1ff290(0x1c4)]['push']({'type':_0x3940f9[_0x1ff290(0x26a)]()?0x1:0x2,'name':path['basename'](_0x411034[_0x1ff290(0x23f)]),'fileFullPath':_0x411034[_0x1ff290(0x23f)]}),_0x3a9a1c[_0x1ff290(0x24d)](_0x39bcd1);});}if(!_0x50468d)_0x4db681();else{let _0x40e3ec=dbUserTable[_0xb404ce(0x1f5)](_0x1f417e[_0xb404ce(0x26c)][_0xb404ce(0x212)],_0x259afc,_0x50468d,_0x4a95b7);if(!_0x40e3ec)return console[_0xb404ce(0x224)](_0xb404ce(0x1de),_0x50468d),_0x4db681();fs['readdir'](_0x50468d,{'withFileTypes':!![]},(_0x108134,_0x4078eb)=>{const _0x123d2c=_0xb404ce;if(_0x108134)return _0x3a9a1c[_0x123d2c(0x24d)](_0x39bcd1);let _0x215a82=0x0;if(_0x4078eb[_0x123d2c(0x1bc)]<0x1)return _0x3a9a1c[_0x123d2c(0x24d)](_0x39bcd1);for(let _0x1532ef=0x0;_0x1532ef<_0x4078eb[_0x123d2c(0x1bc)];_0x1532ef++){let _0x39bd68=_0x4078eb[_0x1532ef],_0xca6c62=_0x4078eb[_0x1532ef][_0x123d2c(0x1af)];if(_0xca6c62['length']>0x0){if(_0xca6c62[0x0]=='.'){_0x215a82+=0x1;continue;}if(/[A-Z]:\\/i[_0x123d2c(0x1eb)](_0x50468d)&&_0x50468d[_0x123d2c(0x1bc)]<=0x3){if(win32ExcludeList[_0x123d2c(0x1f2)](_0xca6c62)||_0xca6c62[_0x123d2c(0x254)](_0x123d2c(0x24e))||_0xca6c62[_0x123d2c(0x254)](_0x123d2c(0x1b4))){_0x215a82+=0x1;continue;}}}let _0x39717e=path[_0x123d2c(0x256)](_0x50468d,_0xca6c62);fs['stat'](_0x39717e,(_0x127a1f,_0x2a42de)=>{const _0x1772a2=_0x123d2c;_0x215a82+=0x1;let _0x2265c4=_0x39bd68[_0x1772a2(0x26a)](),_0x2b7169=_0x39bd68['isDirectory'](),_0x5674ee={'name':_0xca6c62,'fileFullPath':_0x39717e};!_0x127a1f&&_0x2a42de&&(_0x5674ee[_0x1772a2(0x1dd)]=_0x2a42de[_0x1772a2(0x1dd)],_0x5674ee['createTime']=_0x2a42de['birthtimeMs']||_0x2a42de[_0x1772a2(0x1cb)]);_0x2265c4?_0x5674ee[_0x1772a2(0x1a8)]=0x1:_0x5674ee[_0x1772a2(0x1a8)]=0x2;_0x39bcd1[_0x1772a2(0x1d7)]['children'][_0x1772a2(0x23c)](_0x5674ee);if(_0x215a82>=_0x4078eb['length'])return _0x3a9a1c['json'](_0x39bcd1);});}});}}),module[_0x3ce239(0x267)]=router;