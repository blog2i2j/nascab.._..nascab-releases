const _0x1ef233=_0x369e;(function(_0x589fcb,_0x195d93){const _0x33060f=_0x369e,_0x44e540=_0x589fcb();while(!![]){try{const _0xe1c463=-parseInt(_0x33060f(0x12a))/0x1+-parseInt(_0x33060f(0x170))/0x2+-parseInt(_0x33060f(0x1a8))/0x3*(-parseInt(_0x33060f(0xdd))/0x4)+parseInt(_0x33060f(0x117))/0x5*(parseInt(_0x33060f(0x111))/0x6)+parseInt(_0x33060f(0x175))/0x7*(parseInt(_0x33060f(0x18d))/0x8)+-parseInt(_0x33060f(0x12f))/0x9+parseInt(_0x33060f(0xf5))/0xa;if(_0xe1c463===_0x195d93)break;else _0x44e540['push'](_0x44e540['shift']());}catch(_0x552340){_0x44e540['push'](_0x44e540['shift']());}}}(_0x1cea,0x5819d));let express=require(_0x1ef233(0x163)),router=express[_0x1ef233(0x18a)](),path=require(_0x1ef233(0x10b)),fs=require('fs'),sha256=require(_0x1ef233(0x136)),fileUtil=require(_0x1ef233(0x15e));const sharp=require(_0x1ef233(0x17a)),os=require('os');function _0x369e(_0x4867a9,_0x433b75){const _0x1ceadc=_0x1cea();return _0x369e=function(_0x369e88,_0x55f99e){_0x369e88=_0x369e88-0xd7;let _0x33d076=_0x1ceadc[_0x369e88];return _0x33d076;},_0x369e(_0x4867a9,_0x433b75);}let platform=os['platform']();const dbUserTable=require(_0x1ef233(0x13c)),dbNoticeCenterTable=require(_0x1ef233(0xf9)),dbConfigTable=require('../../db/dbConfigTable'),dbSourceFolderTable=require('../../db/dbSourceFolderTable'),dbFileOperationRecord=require(_0x1ef233(0x135)),fileStatUtil=require(_0x1ef233(0x137)),config=require('../../myConfig/config'),sharpUtil=require(_0x1ef233(0x143)),globalInfoUtil=require(_0x1ef233(0xdc)),archiver=require('archiver'),encodingUtil=require('../../utils/encodingUtil');let macPowerDetected=![],win32ExcludeList=[_0x1ef233(0xe3),_0x1ef233(0x19c),_0x1ef233(0x1b6),_0x1ef233(0xeb),_0x1ef233(0xf0),_0x1ef233(0x177)];router['get'](_0x1ef233(0x154),(_0x23715c,_0x8e3f04,_0x39e1c7)=>{const _0x27baf6=_0x1ef233;if(!_0x23715c['query']['path'])return _0x8e3f04[_0x27baf6(0x17c)](0x194)[_0x27baf6(0x115)]();let _0x30c04b=fileUtil['decodePath'](_0x23715c[_0x27baf6(0x155)][_0x27baf6(0x10b)]),_0x4553da=_0x23715c[_0x27baf6(0x155)][_0x27baf6(0x106)];_0x4553da&&(_0x30c04b=path[_0x27baf6(0x15a)](_0x30c04b,_0x4553da)),dbUserTable[_0x27baf6(0x189)](_0x23715c,_0x8e3f04,'',_0x27baf6(0x15b),_0x30c04b)==!![]&&fs[_0x27baf6(0x186)](_0x30c04b,(_0x347133,_0x50d379)=>{const _0x52187b=_0x27baf6;if(_0x347133)return _0x8e3f04[_0x52187b(0x17c)](0x194)[_0x52187b(0x115)]();let _0x50e423=path[_0x52187b(0x185)](_0x30c04b)+_0x52187b(0x13f);try{const _0xa40e79=encodeURIComponent(_0x50e423)[_0x52187b(0x16c)](/%([0-9A-F]{2})/g,(_0x2cf574,_0x4abdfb)=>'%'+_0x4abdfb[_0x52187b(0x19e)]());_0x8e3f04['setHeader'](_0x52187b(0x105),'attachment;\x20filename*=UTF-8\x27\x27'+_0xa40e79);}catch(_0x252cde){console[_0x52187b(0xf7)](_0x252cde);}const _0x4c2746=archiver(_0x52187b(0x16a),{'zlib':{'level':0x0}});_0x4c2746['on'](_0x52187b(0x1b1),function(_0x1b5543){const _0x39da61=_0x52187b;console['log'](_0x39da61(0x122),_0x1b5543['message']||_0x1b5543[_0x39da61(0x13d)]),_0x4c2746[_0x39da61(0xe9)](),!_0x8e3f04[_0x39da61(0x1b8)]?(_0x8e3f04[_0x39da61(0xe4)](_0x39da61(0x105)),_0x8e3f04[_0x39da61(0x17c)](0x1f4)['send'](_0x39da61(0x1a3))):_0x8e3f04[_0x39da61(0x10a)]();}),_0x4c2746['on'](_0x52187b(0x115),function(){const _0x42c7fc=_0x52187b;console['log'](_0x42c7fc(0x18b)),_0x4c2746[_0x42c7fc(0x10a)]();});try{fs[_0x52187b(0x193)](_0x30c04b,(_0x51f4e1,_0x24771f)=>{const _0x2436b6=_0x52187b;for(let _0x5c8600 in _0x24771f){let _0x20a4f0=_0x24771f[_0x5c8600];const _0xd4d2e5=path[_0x2436b6(0x15a)](_0x30c04b,_0x20a4f0);let _0x24e410=fs[_0x2436b6(0x12e)](_0xd4d2e5);_0x24e410[_0x2436b6(0x16e)]()?_0x4c2746[_0x2436b6(0x1a4)](_0xd4d2e5,_0x20a4f0):_0x4c2746[_0x2436b6(0xd7)](fs[_0x2436b6(0xe5)](_0xd4d2e5),{'name':_0x20a4f0});}_0x4c2746[_0x2436b6(0x19d)](),_0x4c2746['pipe'](_0x8e3f04);});}catch(_0x4d768b){!_0x8e3f04[_0x52187b(0x1b8)]&&_0x8e3f04[_0x52187b(0x17c)](0x1f4)[_0x52187b(0x102)]({'error':_0x52187b(0x123)}),console[_0x52187b(0x1b1)](_0x4d768b);}_0x8e3f04['on'](_0x52187b(0xee),()=>{const _0x1af97d=_0x52187b;console[_0x1af97d(0xf7)](_0x1af97d(0x1b5)),_0x4c2746[_0x1af97d(0x10a)]();});});}),router[_0x1ef233(0x1b9)]('/getPathTree',(_0x8dd94b,_0x3adafa,_0x5c24be)=>{const _0x8eac68=_0x1ef233;let _0x127c66=_0x8dd94b[_0x8eac68(0xed)][_0x8eac68(0x19b)],_0xd895eb=path[_0x8eac68(0x1ac)],_0x56b4a1=_0x8dd94b[_0x8eac68(0xed)][_0x8eac68(0x118)],_0x5b8345=_0x8dd94b['body'][_0x8eac68(0x1b3)],_0x38d541=[],_0x47c98f=parseInt(_0x8dd94b[_0x8eac68(0x1a5)][_0x8eac68(0x12d)])==0x1,_0x5a713e=fileUtil[_0x8eac68(0xfb)](_0x8dd94b[_0x8eac68(0x11f)][_0x8eac68(0xec)]);try{function _0x86badc(){const _0x1b1a84=_0x8eac68;let _0x16f8cd=dbUserTable[_0x1b1a84(0xe8)](_0x8dd94b[_0x1b1a84(0x11f)][_0x1b1a84(0xec)],_0x8dd94b[_0x1b1a84(0x1a5)]['username'],_0x1b1a84(0x146),_0x1b1a84(0x15b));for(let _0x56647d of _0x16f8cd){if(_0x5a713e['includes'](_0x56647d['path']))continue;_0x38d541[_0x1b1a84(0x17d)]({'type':0x2,'name':_0x56647d[_0x1b1a84(0x10b)],'fileFullPath':_0x56647d[_0x1b1a84(0x10b)]});}return _0x3adafa['json']({'code':0x0,'data':{'parent':'','children':_0x38d541,'sep':_0xd895eb,'platform':platform}});}if(!_0x127c66){if(_0x47c98f){if(platform=='win32'){function _0x2c78f6(_0x2ac02e){const _0xc21951=_0x8eac68;let _0xfa9a9b=[];for(let _0x439328 of _0x2ac02e){if(_0x5a713e[_0xc21951(0x1aa)](_0x439328[_0xc21951(0x1b7)]))continue;_0x439328['type']=0x2,_0xfa9a9b[_0xc21951(0x17d)](_0x439328);}for(let _0xe06bca in _0xfa9a9b){_0xfa9a9b[_0xe06bca][_0xc21951(0x11c)]=_0xfa9a9b[_0xe06bca][_0xc21951(0x1b7)];}return _0x3adafa[_0xc21951(0x199)]({'code':0x0,'data':{'parent':_0x127c66,'children':_0xfa9a9b,'sep':path['sep'],'platform':platform}});}let _0x5a6b11=dbConfigTable[_0x8eac68(0xe7)](_0x8dd94b[_0x8eac68(0x11f)]['dbOther'],_0x8eac68(0x152));if(_0x5a6b11)try{_0x5a6b11=JSON[_0x8eac68(0x113)](_0x5a6b11[_0x8eac68(0x196)]),_0xcb5c38(![]),_0x2c78f6(_0x5a6b11);}catch(_0x2bfbf8){_0xcb5c38(!![]);}else _0xcb5c38(!![]);function _0xcb5c38(_0x5ea4c6){const _0x46e0c7=_0x8eac68;globalInfoUtil[_0x46e0c7(0x14c)](_0x98f02a=>{const _0x41d152=_0x46e0c7;_0x98f02a=_0x98f02a[_0x41d152(0x145)]((_0x21c852,_0x4ddd22)=>{const _0x15423d=_0x41d152;if(!_0x21c852[_0x15423d(0x1b7)]||!_0x4ddd22[_0x15423d(0x1b7)])return;return _0x21c852['name'][_0x15423d(0x159)](_0x4ddd22[_0x15423d(0x1b7)]);}),dbConfigTable[_0x41d152(0x148)](_0x8dd94b[_0x41d152(0x11f)][_0x41d152(0xec)],{'title':_0x41d152(0x152),'value':JSON['stringify'](_0x98f02a)}),_0x5ea4c6&&_0x2c78f6(_0x98f02a);});}}else{if(platform==_0x8eac68(0x109)){if(!macPowerDetected){macPowerDetected=!![];try{const _0x427a7a=process['env'][_0x8eac68(0x166)];let _0x5a952f=[path[_0x8eac68(0x15a)]('/Users',_0x427a7a,_0x8eac68(0x119)),path[_0x8eac68(0x15a)](_0x8eac68(0x1bd),_0x427a7a,_0x8eac68(0xd9)),path[_0x8eac68(0x15a)](_0x8eac68(0x1bd),_0x427a7a,_0x8eac68(0x13b))];for(let _0x4abb7a in _0x5a952f){fs[_0x8eac68(0x186)](_0x5a952f[_0x4abb7a],(_0x4555d5,_0x3313a0)=>{});}}catch(_0x597939){}}let _0x2e2d4f=path[_0x8eac68(0x113)](process['cwd']())['root'];_0x254c36(_0x2e2d4f);}else _0x127c66=path[_0x8eac68(0x113)](process[_0x8eac68(0x13a)]())[_0x8eac68(0x19f)],_0x254c36(_0x127c66);}}else return _0x86badc();}else _0x254c36(_0x127c66);function _0x254c36(_0x1652b8){const _0x804aa6=_0x8eac68;if(!_0x47c98f){if(!dbUserTable[_0x804aa6(0x189)](_0x8dd94b,_0x3adafa,_0x804aa6(0x146),_0x804aa6(0x15b),_0x1652b8,!![]))return _0x86badc();}if(_0x1652b8==_0x804aa6(0x112)||_0x1652b8=='sourceFolderMovie'||_0x1652b8==_0x804aa6(0x198)||_0x1652b8=='sourceFolderBook'){let _0x5e0947=_0x804aa6(0x1b4);if(_0x1652b8==_0x804aa6(0x167))_0x5e0947=_0x804aa6(0x130);else{if(_0x1652b8==_0x804aa6(0x198))_0x5e0947=_0x804aa6(0x1a9);else _0x1652b8=='sourceFolderBook'&&(_0x5e0947=_0x804aa6(0x14d));}let _0x278460=dbSourceFolderTable[_0x804aa6(0x174)](_0x8dd94b[_0x804aa6(0x11f)][_0x804aa6(0xec)],_0x5e0947);for(let _0x43c57f in _0x278460){_0x38d541['push']({'type':0x2,'name':path[_0x804aa6(0x185)](_0x278460[_0x43c57f][_0x804aa6(0x10b)]),'fileFullPath':_0x278460[_0x43c57f][_0x804aa6(0x10b)]});}return _0x3adafa[_0x804aa6(0x199)]({'code':0x0,'data':{'parent':_0x1652b8,'children':_0x38d541,'sep':_0xd895eb,'platform':platform}});}fs[_0x804aa6(0x193)](_0x1652b8,{'withFileTypes':!![]},(_0x213514,_0x5f3457)=>{const _0x3982b8=_0x804aa6;if(_0x213514)return console[_0x3982b8(0xf7)](_0x213514),fileUtil[_0x3982b8(0x1ba)](_0x3adafa,_0x213514);for(let _0xa14a2b=0x0;_0xa14a2b<_0x5f3457[_0x3982b8(0xf8)];_0xa14a2b++){let _0x5e12e7=_0x5f3457[_0xa14a2b],_0x156aec=_0x5f3457[_0xa14a2b]['name'];if(_0x156aec['length']>0x0){if(_0x156aec[0x0]=='.')continue;if(/[A-Z]:\\/i[_0x3982b8(0xdb)](_0x1652b8)&&_0x1652b8[_0x3982b8(0xf8)]<=0x3){if(win32ExcludeList[_0x3982b8(0x1aa)](_0x156aec)||_0x156aec[_0x3982b8(0xdf)](_0x3982b8(0x141))||_0x156aec['endsWith'](_0x3982b8(0xfc)))continue;}}let _0x23f69e=path[_0x3982b8(0x15a)](_0x1652b8,_0x156aec);if(_0x5a713e[_0x3982b8(0x1aa)](_0x23f69e))continue;let _0x421262=_0x5e12e7[_0x3982b8(0x10c)](),_0x18e16e=_0x5e12e7[_0x3982b8(0x16e)]();function _0xf43d40(){const _0x33700a=_0x3982b8;if(_0x421262)(_0x56b4a1==0x0||_0x56b4a1==0x1)&&_0x38d541[_0x33700a(0x17d)]({'type':0x1,'name':_0x156aec,'fileFullPath':_0x23f69e});else _0x18e16e&&_0x38d541[_0x33700a(0x17d)]({'type':0x2,'name':_0x156aec,'fileFullPath':_0x23f69e});}_0x5b8345?_0x156aec[_0x3982b8(0x1aa)](_0x5b8345)&&_0xf43d40():_0xf43d40();try{if(_0x38d541[_0x3982b8(0xf8)]>0x1770)break;}catch(_0x3f0a33){continue;}}let _0x59dfcc=_0x38d541['length'],_0x56f3fc=0x0;if(_0x38d541[_0x3982b8(0xf8)]<0x1)return _0x3adafa[_0x3982b8(0x199)]({'code':0x0,'data':{'parent':_0x1652b8,'children':_0x38d541,'sep':_0xd895eb,'platform':platform}});for(let _0x4a9714 of _0x38d541){fs['stat'](_0x4a9714['fileFullPath'],(_0x4438b8,_0xb1be6c)=>{const _0x3567d9=_0x3982b8;_0x56f3fc+=0x1;!_0x4438b8&&(_0x4a9714[_0x3567d9(0x1ad)]=_0xb1be6c['atimeMs'],_0x4a9714[_0x3567d9(0x14f)]=_0xb1be6c[_0x3567d9(0x14f)],_0x4a9714[_0x3567d9(0x184)]=_0xb1be6c[_0x3567d9(0x184)],_0x4a9714[_0x3567d9(0x169)]=_0xb1be6c[_0x3567d9(0x169)]);if(_0x56f3fc>=_0x59dfcc)return _0x3adafa[_0x3567d9(0x199)]({'code':0x0,'data':{'parent':_0x1652b8,'children':_0x38d541,'sep':_0xd895eb,'platform':platform}});});}});}}catch(_0x2503f2){return fileUtil[_0x8eac68(0x1ba)](_0x3adafa,_0x2503f2);}}),router[_0x1ef233(0x18f)](_0x1ef233(0x179),(_0x2c8446,_0xa95305,_0x53c850)=>{const _0x5e3b31=_0x1ef233;let _0x168cda=fileUtil[_0x5e3b31(0x157)](_0x2c8446[_0x5e3b31(0x155)][_0x5e3b31(0x10b)]);if(!_0x168cda)return _0xa95305[_0x5e3b31(0x17c)](0x194)[_0x5e3b31(0x115)]();_0x168cda=path[_0x5e3b31(0x15a)](_0x168cda);let _0x312376=path[_0x5e3b31(0x15a)](config[_0x5e3b31(0x131)],'custom',path[_0x5e3b31(0x1ac)]);return _0x168cda['startsWith'](_0x312376)?_0xa95305[_0x5e3b31(0xf1)](_0x168cda):_0xa95305[_0x5e3b31(0x17c)](0x194)[_0x5e3b31(0x115)]();}),router['get'](_0x1ef233(0xff),(_0x3f3511,_0x16eb21,_0x228d84)=>{const _0x1ad9c3=_0x1ef233;let _0x2f2dfa=_0x3f3511['query'][_0x1ad9c3(0x10b)],_0x4f5664=_0x3f3511[_0x1ad9c3(0x155)][_0x1ad9c3(0x187)]==0x1,_0x1bc5e0=fileUtil[_0x1ad9c3(0x157)](_0x2f2dfa),_0x44f259=_0x3f3511[_0x1ad9c3(0x155)][_0x1ad9c3(0x169)],_0x5be9d8=_0x3f3511[_0x1ad9c3(0x155)]['quality'];if(dbUserTable[_0x1ad9c3(0x189)](_0x3f3511,_0x16eb21,'',_0x1ad9c3(0x15b),_0x1bc5e0)==!![])try{let _0x43c273=_0x3f3511[_0x1ad9c3(0x155)][_0x1ad9c3(0x153)];if(_0x43c273&&_0x43c273==0x1){if(_0x4f5664){const _0x3587ed=encodeURIComponent(path[_0x1ad9c3(0x185)](_0x1bc5e0))['replace'](/%([0-9A-F]{2})/g,(_0x47039b,_0x8fd96f)=>'%'+_0x8fd96f[_0x1ad9c3(0x19e)]());_0x16eb21['setHeader'](_0x1ad9c3(0x105),_0x1ad9c3(0x11b)+_0x3587ed);}return _0x16eb21[_0x1ad9c3(0xf1)](_0x1bc5e0);}else _0x3f3511['query'][_0x1ad9c3(0xfe)]&&_0x3f3511['query'][_0x1ad9c3(0xfe)]==_0x1ad9c3(0x1a1)&&path[_0x1ad9c3(0x14a)](_0x1bc5e0)&&path[_0x1ad9c3(0x14a)](_0x1bc5e0)[_0x1ad9c3(0xfa)]()==_0x1ad9c3(0x13e)?(console['log'](_0x1ad9c3(0x142),_0x1bc5e0),encodingUtil['getUtf8FileStream'](_0x1bc5e0)[_0x1ad9c3(0xe1)](_0x31f0ae=>{const _0x436b9b=_0x1ad9c3;return _0x31f0ae?_0x31f0ae[_0x436b9b(0x151)](_0x16eb21):(console[_0x436b9b(0xf7)]('Unable\x20to\x20read\x20file',_0x1bc5e0),_0x16eb21['sendFile'](_0x1bc5e0));})):sharpUtil['returnDealedFile'](_0x16eb21,_0x1bc5e0,_0x4f5664,_0x44f259,_0x5be9d8);}catch(_0x1c6897){return console[_0x1ad9c3(0xf7)](_0x1c6897),fileUtil[_0x1ad9c3(0x1ba)](_0x16eb21,_0x1c6897);}}),router[_0x1ef233(0x1b9)](_0x1ef233(0x164),(_0x440822,_0x467cd,_0x949ec1)=>{const _0x31abc8=_0x1ef233;let _0x325989=fileUtil[_0x31abc8(0x157)](_0x440822[_0x31abc8(0xed)][_0x31abc8(0xe6)]),_0x50a1c6=_0x440822['body']['checkPower'];if(_0x50a1c6==_0x31abc8(0x138))_0x50a1c6=fs[_0x31abc8(0x1ab)][_0x31abc8(0x10d)];else _0x50a1c6==_0x31abc8(0x14e)&&(_0x50a1c6=fs[_0x31abc8(0x1ab)]['R_OK']);try{_0x50a1c6==_0x31abc8(0x144)?fs[_0x31abc8(0x126)](_0x325989,fs[_0x31abc8(0x1ab)][_0x31abc8(0x10d)],_0x4fd36b=>{const _0x504196=_0x31abc8;if(_0x4fd36b)return fileUtil['returnFileError'](_0x467cd,_0x4fd36b);return _0x467cd[_0x504196(0x199)]({'code':0x0,'access':!![]});}):fs[_0x31abc8(0x126)](_0x325989,_0x50a1c6,_0x52ec73=>{const _0x4d2d1b=_0x31abc8;if(_0x52ec73)return fileUtil[_0x4d2d1b(0x1ba)](_0x467cd,_0x52ec73);return _0x467cd[_0x4d2d1b(0x199)]({'code':0x0,'access':!![]});});}catch(_0x2659ca){return _0x467cd[_0x31abc8(0x199)]({'code':0x0,'access':![]});}}),router[_0x1ef233(0x1b9)](_0x1ef233(0x139),(_0x23da19,_0x4c92f7,_0x3084f8)=>{const _0x411800=_0x1ef233;let _0x1edd4=fileUtil[_0x411800(0x157)](_0x23da19['body'][_0x411800(0x12b)]),_0x310267=_0x23da19[_0x411800(0xed)][_0x411800(0x15f)],_0x56cdd5=path[_0x411800(0x15a)](_0x1edd4,_0x310267);if(dbUserTable['doUserCanGet'](_0x23da19,_0x4c92f7,'folder','power_add',_0x56cdd5)==!![])try{fs[_0x411800(0x186)](_0x56cdd5,_0x29948c=>{const _0x404f7a=_0x411800;if(!_0x29948c)return _0x23da19[_0x404f7a(0x11f)][_0x404f7a(0x133)](_0x4c92f7,_0x4c92f7['__'](_0x404f7a(0x12c))+':'+_0x56cdd5);else fs['mkdir'](_0x56cdd5,{'recursive':!![]},_0x3893eb=>{const _0x4695f6=_0x404f7a;return _0x3893eb?fileUtil[_0x4695f6(0x1ba)](_0x4c92f7,_0x3893eb):_0x4c92f7[_0x4695f6(0x199)]({'code':0x0});});});}catch(_0x1a8b2d){return fileUtil['returnFileError'](_0x4c92f7,_0x1a8b2d);}}),router[_0x1ef233(0x1b9)](_0x1ef233(0x128),(_0x1c5d3a,_0x5cd2da,_0x24577c)=>{const _0x1435d8=_0x1ef233;let _0x8a9941=_0x1c5d3a[_0x1435d8(0xed)][_0x1435d8(0x1ae)],_0x1b3534=_0x1c5d3a['body'][_0x1435d8(0x197)],_0x2b9106=_0x1c5d3a[_0x1435d8(0xed)][_0x1435d8(0x118)];if(_0x2b9106!=_0x1435d8(0x16a)&&_0x2b9106!='unzip')return _0x1c5d3a['app'][_0x1435d8(0x133)](_0x5cd2da,_0x5cd2da['__']('operationFail'));if(dbUserTable[_0x1435d8(0x189)](_0x1c5d3a,_0x5cd2da,'folder','power_get',_0x8a9941)==!![]&&dbUserTable[_0x1435d8(0x189)](_0x1c5d3a,_0x5cd2da,_0x1435d8(0x146),'power_add',_0x1b3534)==!![]){let _0x3b59b8=_0x1c5d3a[_0x1435d8(0x11f)][_0x1435d8(0xec)]['prepare'](_0x1435d8(0x134))[_0x1435d8(0x1a6)]('FILE_OPERATION',JSON['stringify']({'sourcePath':_0x8a9941,'targetPath':_0x1b3534,'type':_0x2b9106,'username':_0x1c5d3a[_0x1435d8(0x1a5)][_0x1435d8(0x191)]}));return process[_0x1435d8(0x102)]({'type':_0x1435d8(0x172),'taskIdList':[_0x3b59b8[_0x1435d8(0x100)]]}),_0x5cd2da[_0x1435d8(0x199)]({'code':0x0});}}),router[_0x1ef233(0x1b9)]('/operationFileList',(_0x3ca8b0,_0x37517b,_0x248cb7)=>{const _0x30f2d2=_0x1ef233;let _0x3e64fe=_0x3ca8b0['body'][_0x30f2d2(0x15c)],_0x3d9d51=_0x3ca8b0[_0x30f2d2(0xed)][_0x30f2d2(0x197)],_0x5861e7=_0x3ca8b0['body'][_0x30f2d2(0x118)];if(_0x3e64fe[_0x30f2d2(0xf8)]<0x1)return _0x3ca8b0[_0x30f2d2(0x11f)][_0x30f2d2(0x133)](_0x37517b,_0x37517b['__'](_0x30f2d2(0x162)));if(dbUserTable[_0x30f2d2(0x189)](_0x3ca8b0,_0x37517b,_0x30f2d2(0x146),_0x30f2d2(0x15b),_0x3e64fe[0x0])==!![]&&dbUserTable[_0x30f2d2(0x189)](_0x3ca8b0,_0x37517b,'folder','power_add',_0x3d9d51)==!![])try{let _0x1dbc80=[];for(let _0x2a3621 in _0x3e64fe){let _0x4a286e=_0x3e64fe[_0x2a3621],_0x561ff2=path['basename'](_0x4a286e),_0x56632a=path[_0x30f2d2(0x15a)](_0x3d9d51,_0x561ff2),_0x57c25e=_0x3ca8b0[_0x30f2d2(0x11f)][_0x30f2d2(0xec)][_0x30f2d2(0x140)]('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')[_0x30f2d2(0x1a6)](_0x30f2d2(0x165),JSON[_0x30f2d2(0x176)]({'sourcePath':_0x4a286e,'targetPath':_0x56632a,'type':_0x5861e7,'username':_0x3ca8b0[_0x30f2d2(0x1a5)][_0x30f2d2(0x191)]}));_0x1dbc80[_0x30f2d2(0x17d)](_0x57c25e['lastInsertRowid']);}return process['send']({'type':_0x30f2d2(0x172),'taskIdList':_0x1dbc80}),_0x37517b['json']({'code':0x0});}catch(_0x3199ad){return _0x3ca8b0[_0x30f2d2(0x11f)][_0x30f2d2(0x133)](_0x37517b,_0x37517b['__'](_0x30f2d2(0x162)));}}),router['post']('/operationFolder',(_0x367b19,_0xdc3bf7,_0x4cae4e)=>{const _0x2b3d91=_0x1ef233;let _0x38231b=fileUtil['decodePath'](_0x367b19[_0x2b3d91(0xed)][_0x2b3d91(0x1ae)]),_0x57b014=fileUtil['decodePath'](_0x367b19[_0x2b3d91(0xed)]['targetPath']),_0x5686fa=path['basename'](_0x38231b),_0x24120c=_0x367b19[_0x2b3d91(0xed)][_0x2b3d91(0x118)],_0x396fce=path[_0x2b3d91(0x15a)](_0x57b014,_0x5686fa);if(_0x24120c==_0x2b3d91(0x180)||_0x24120c==_0x2b3d91(0x194)){if(fs[_0x2b3d91(0x101)](_0x396fce))return _0x367b19['app']['returnErrMsg'](_0xdc3bf7,_0xdc3bf7['__'](_0x2b3d91(0x12c))+':'+_0x396fce);}let _0x3d90b9=_0x367b19[_0x2b3d91(0xed)]['newName'];function _0x3d4843(_0x45abc5,_0x3069da){const _0x40ef32=_0x2b3d91;let _0x3d0a6b=_0x367b19['app']['dbOther'][_0x40ef32(0x140)](_0x40ef32(0x134))[_0x40ef32(0x1a6)](_0x40ef32(0x165),JSON[_0x40ef32(0x176)]({'sourcePath':_0x45abc5,'targetPath':_0x3069da,'type':_0x24120c,'username':_0x367b19['currentUser'][_0x40ef32(0x191)]}));return _0x3d0a6b[_0x40ef32(0x100)];}try{_0x38231b=path[_0x2b3d91(0x15a)](_0x38231b),_0x57b014=path[_0x2b3d91(0x15a)](_0x57b014);if(_0x57b014==_0x38231b||_0x57b014[_0x2b3d91(0x1a2)](_0x38231b+path[_0x2b3d91(0x1ac)]))return _0x367b19['app']['returnErrMsg'](_0xdc3bf7,_0xdc3bf7['__'](_0x2b3d91(0x19a)));if(dbUserTable['doUserCanGet'](_0x367b19,_0xdc3bf7,'folder',_0x2b3d91(0x15b),_0x38231b)==!![]){let _0x5a6f34=![];fs[_0x2b3d91(0x186)](_0x38231b,(_0x39f2dc,_0x501c9f)=>{const _0x52b404=_0x2b3d91;if(_0x39f2dc)return _0x367b19[_0x52b404(0x11f)][_0x52b404(0x133)](_0xdc3bf7,_0xdc3bf7['__'](_0x52b404(0xda))+':'+_0x38231b);let _0x5098df=path[_0x52b404(0x185)](_0x38231b);fs[_0x52b404(0x126)](_0x57b014,fs[_0x52b404(0x1ab)]['R_OK']|fs[_0x52b404(0x1ab)][_0x52b404(0x10d)],_0x2c56e6=>{const _0x1bb3c8=_0x52b404;if(_0x2c56e6)return _0x367b19[_0x1bb3c8(0x11f)]['returnErrMsg'](_0xdc3bf7,_0xdc3bf7['__']('noWritePermission')+':'+_0x57b014);if(_0x24120c==_0x1bb3c8(0x116))dbUserTable[_0x1bb3c8(0x189)](_0x367b19,_0xdc3bf7,_0x1bb3c8(0x146),_0x1bb3c8(0x18c),_0x57b014)==!![]&&(_0x57b014=path[_0x1bb3c8(0x15a)](_0x57b014,_0x3d90b9),fs[_0x1bb3c8(0x186)](_0x57b014,_0x500c87=>{const _0x3b753d=_0x1bb3c8;if(!_0x500c87)return _0x367b19[_0x3b753d(0x11f)][_0x3b753d(0x133)](_0xdc3bf7,_0xdc3bf7['__'](_0x3b753d(0x12c))+':'+_0x57b014);else fs[_0x3b753d(0x116)](_0x38231b,_0x57b014,_0x11d0e7=>{const _0x62bc84=_0x3b753d;if(_0x11d0e7)return dbFileOperationRecord[_0x62bc84(0x161)](_0x367b19[_0x62bc84(0x11f)][_0x62bc84(0xec)],{'username':_0x367b19[_0x62bc84(0x1a5)][_0x62bc84(0x191)],'sourcePath':_0x38231b,'targetPath':_0x57b014,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'belongId':null,'type':dbFileOperationRecord['TYPE_RENMAE'],'subType':null,'state':dbFileOperationRecord[_0x62bc84(0xf3)],'remark':fileUtil['returnFileError'](_0xdc3bf7,_0x11d0e7,!![])}),dbNoticeCenterTable['create'](_0x367b19[_0x62bc84(0x11f)][_0x62bc84(0xec)],{'title':_0xdc3bf7['__'](_0x62bc84(0x162)),'level':_0x62bc84(0x1b1),'content':_0xdc3bf7['__']('fileRenameFail')+':'+(_0x38231b+'\x20->\x20'+_0x57b014)});_0x5a6f34=!![],dbFileOperationRecord[_0x62bc84(0x161)](_0x367b19[_0x62bc84(0x11f)][_0x62bc84(0xec)],{'username':_0x367b19[_0x62bc84(0x1a5)]['username'],'sourcePath':_0x38231b,'targetPath':_0x57b014,'level':dbFileOperationRecord[_0x62bc84(0xea)],'belongId':null,'type':dbFileOperationRecord[_0x62bc84(0x11a)],'subType':null,'state':dbFileOperationRecord[_0x62bc84(0x182)]});}),setTimeout(()=>{const _0x521b80=_0x3b753d;return _0xdc3bf7[_0x521b80(0x199)]({'code':0x0,'isOver':_0x5a6f34?0x1:0x0});},0x3e8);}));else{if(_0x24120c=='cut'){if(dbUserTable[_0x1bb3c8(0x189)](_0x367b19,_0xdc3bf7,_0x1bb3c8(0x146),'power_delete',_0x57b014)!==!![])return;}if(dbUserTable['doUserCanGet'](_0x367b19,_0xdc3bf7,_0x1bb3c8(0x146),_0x1bb3c8(0x10e),_0x57b014)==!![]){_0x57b014=path[_0x1bb3c8(0x15a)](_0x57b014,_0x5098df);let _0x56d04f=_0x3d4843(_0x38231b,_0x57b014);return process[_0x1bb3c8(0x102)]({'type':_0x1bb3c8(0x172),'taskIdList':[_0x56d04f]}),_0xdc3bf7[_0x1bb3c8(0x199)]({'code':0x0});}}});});}}catch(_0x2b8540){return _0x367b19['app'][_0x2b3d91(0x133)](_0xdc3bf7,_0xdc3bf7['__'](_0x2b3d91(0x162)));}}),router[_0x1ef233(0x1b9)](_0x1ef233(0xf2),(_0x7012d5,_0x5c361d,_0x2aea0a)=>{const _0x495487=_0x1ef233;let _0xd54d43=_0x7012d5[_0x495487(0xed)][_0x495487(0xe2)];if(!_0xd54d43)return _0x5c361d[_0x495487(0x17c)](0x194)[_0x495487(0x115)]();dbUserTable['doUserCanGet'](_0x7012d5,_0x5c361d,'folder','power_get',_0xd54d43)==!![]&&fs[_0x495487(0x186)](_0xd54d43,(_0x435ca5,_0x554883)=>{const _0x4d9de2=_0x495487;if(_0x435ca5)return fileUtil['returnFileError'](_0x5c361d,_0x435ca5);return _0x554883['sizeStr']=fileUtil[_0x4d9de2(0x16b)](_0x554883[_0x4d9de2(0x169)]),_0x5c361d[_0x4d9de2(0x199)]({'code':0x0,'data':_0x554883});});}),router[_0x1ef233(0x1b9)]('/fileExist',(_0x519327,_0x5b05ef,_0x1058a8)=>{const _0x2cf641=_0x1ef233;let _0x23fc38=_0x519327[_0x2cf641(0xed)][_0x2cf641(0xde)],_0x29d89b=_0x519327[_0x2cf641(0xed)][_0x2cf641(0x188)];_0x29d89b&&(_0x29d89b=_0x29d89b[_0x2cf641(0x16c)](/[<>\\\/:\*\?\"\|]/g,'_')),_0x23fc38&&(_0x23fc38=fileUtil[_0x2cf641(0x157)](_0x23fc38)),fs['access'](_0x23fc38,fs[_0x2cf641(0x1ab)]['W_OK']|fs['constants'][_0x2cf641(0xd8)],_0x1aa96c=>{const _0x284a1e=_0x2cf641;if(_0x1aa96c)return _0x5b05ef[_0x284a1e(0x199)]({'code':0x1,'message':_0x5b05ef['__'](_0x284a1e(0x18e))+':'+_0x23fc38});else{let _0x111be0='';if(_0x23fc38&&_0x29d89b)_0x111be0=path['join'](_0x23fc38,_0x29d89b);else{if(_0x23fc38)_0x111be0=path[_0x284a1e(0x15a)](_0x23fc38);else return _0x5b05ef['json']({'code':0x1,'message':_0x5b05ef['__'](_0x284a1e(0x1a7))+':'+_0x23fc38});}fs[_0x284a1e(0x186)](_0x111be0,_0x5d9a22=>{const _0x26799a=_0x284a1e;return _0x5d9a22?(console['log'](_0x26799a(0x14b),_0x111be0),_0x5b05ef[_0x26799a(0x199)]({'code':0x0})):_0x5b05ef[_0x26799a(0x199)]({'code':0x1,'remark':'EXIST'});});}});}),router['post'](_0x1ef233(0x1b2),(_0x398b93,_0x404e09,_0x36e73e)=>{const _0x123d4a=_0x1ef233;let _0x585105=_0x398b93[_0x123d4a(0xed)]['fullPath'],_0x131c48=_0x398b93['body'][_0x123d4a(0x11d)];if(!_0x585105)return _0x404e09['status'](0x194)[_0x123d4a(0x115)]();_0x585105=path[_0x123d4a(0x15a)](_0x585105);if(dbUserTable[_0x123d4a(0x189)](_0x398b93,_0x404e09,_0x123d4a(0x146),_0x123d4a(0x103),_0x585105)==!![]){if(_0x131c48==0x1)return process[_0x123d4a(0x102)]({'type':_0x123d4a(0xfd),'shellType':'trash','path':_0x585105}),dbFileOperationRecord[_0x123d4a(0x161)](_0x398b93[_0x123d4a(0x11f)][_0x123d4a(0xec)],{'username':_0x398b93[_0x123d4a(0x1a5)][_0x123d4a(0x191)],'targetPath':_0x585105,'level':dbFileOperationRecord[_0x123d4a(0xea)],'type':dbFileOperationRecord[_0x123d4a(0xe0)],'state':dbFileOperationRecord[_0x123d4a(0x182)]}),_0x404e09[_0x123d4a(0x199)]({'code':0x0,'message':_0x404e09['__']('deleteSuccess')});else fs['rm'](_0x585105,{'recursive':!![]},_0x1fd85d=>{const _0x2e0af1=_0x123d4a;if(_0x1fd85d)return dbFileOperationRecord['addFileOperationRecord'](_0x398b93[_0x2e0af1(0x11f)][_0x2e0af1(0xec)],{'username':_0x398b93[_0x2e0af1(0x1a5)][_0x2e0af1(0x191)],'targetPath':_0x585105,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0x2e0af1(0xe0)],'state':dbFileOperationRecord[_0x2e0af1(0xf3)],'remark':fileUtil[_0x2e0af1(0x1ba)](_0x404e09,_0x1fd85d,!![])}),fileUtil[_0x2e0af1(0x1ba)](_0x404e09,_0x1fd85d);return dbFileOperationRecord['addFileOperationRecord'](_0x398b93[_0x2e0af1(0x11f)][_0x2e0af1(0xec)],{'username':_0x398b93[_0x2e0af1(0x1a5)][_0x2e0af1(0x191)],'targetPath':_0x585105,'level':dbFileOperationRecord[_0x2e0af1(0xea)],'type':dbFileOperationRecord['TYPE_DELETE'],'state':dbFileOperationRecord['STATE_SUC']}),_0x404e09[_0x2e0af1(0x199)]({'code':0x0,'message':_0x404e09['__']('deleteSuccess')});});}}),router[_0x1ef233(0x1b9)](_0x1ef233(0x114),(_0x13048a,_0x38d466,_0x43e985)=>{const _0x3f5a92=_0x1ef233;if(_0x13048a[_0x3f5a92(0x1a5)]['is_admin']!=0x1)return _0x38d466[_0x3f5a92(0x199)]({'code':0x66});return dbFileOperationRecord[_0x3f5a92(0x171)](_0x13048a[_0x3f5a92(0x11f)][_0x3f5a92(0xec)]),_0x38d466[_0x3f5a92(0x199)]({'code':0x0});}),router[_0x1ef233(0x1b9)](_0x1ef233(0x168),(_0x298f35,_0x1583f8,_0x398175)=>{const _0x363f71=_0x1ef233;let _0x4ba304=_0x298f35[_0x363f71(0xed)][_0x363f71(0x17b)],_0x2980c1=_0x298f35[_0x363f71(0xed)]['pageSize'],_0x18bb31=_0x298f35[_0x363f71(0xed)][_0x363f71(0x118)],_0x2a5970=_0x298f35[_0x363f71(0xed)]['level'],_0x17bc7e=_0x298f35['body'][_0x363f71(0x17e)],_0x2ff7e4=_0x298f35[_0x363f71(0xed)][_0x363f71(0x1bb)],_0x14bd84=_0x298f35['body'][_0x363f71(0x1b3)],_0x4e2fed;return _0x298f35['currentUser'][_0x363f71(0x12d)]==0x1?_0x4e2fed=dbFileOperationRecord[_0x363f71(0x121)](_0x298f35['app'][_0x363f71(0xec)],_0x4ba304,_0x2980c1,_0x2a5970,_0x18bb31,_0x17bc7e,_0x2ff7e4,_0x14bd84):_0x4e2fed=dbFileOperationRecord[_0x363f71(0x121)](_0x298f35['app'][_0x363f71(0xec)],_0x4ba304,_0x2980c1,_0x2a5970,_0x18bb31,_0x17bc7e,_0x2ff7e4,_0x14bd84,_0x298f35[_0x363f71(0x1a5)][_0x363f71(0x191)]),_0x1583f8[_0x363f71(0x199)]({'code':0x0,'data':_0x4e2fed});}),router[_0x1ef233(0x1b9)](_0x1ef233(0x132),(_0x2ec4f6,_0x150060,_0x3f80a1)=>{const _0x1f5e55=_0x1ef233;let _0x5438f6=_0x2ec4f6[_0x1f5e55(0xed)][_0x1f5e55(0x108)];if(_0x5438f6==_0x1f5e55(0x190)||_0x5438f6==_0x1f5e55(0x17f)){if(_0x2ec4f6[_0x1f5e55(0x1a5)][_0x1f5e55(0x12d)]!=0x1)return _0x150060[_0x1f5e55(0x199)]({'code':0x66});}if(_0x5438f6==_0x1f5e55(0x190)){let _0x1c78a4=_0x2ec4f6[_0x1f5e55(0xed)][_0x1f5e55(0x118)],_0x2c149a=_0x2ec4f6[_0x1f5e55(0xed)]['url'],_0x25503d=_0x2ec4f6[_0x1f5e55(0xed)][_0x1f5e55(0x191)],_0x49a8a1=_0x2ec4f6['body']['pathName'],_0x29cbd2=_0x2ec4f6[_0x1f5e55(0xed)][_0x1f5e55(0x191)],_0x3ac19f=_0x2ec4f6['body'][_0x1f5e55(0x16d)],_0x4207eb=[_0x1f5e55(0x16f),_0x1f5e55(0x104),_0x1f5e55(0x15d)];if(!_0x1c78a4||!_0x2c149a||!_0x4207eb[_0x1f5e55(0x1aa)](_0x1c78a4))return _0x2ec4f6[_0x1f5e55(0x11f)][_0x1f5e55(0x133)](_0x150060,_0x150060['__'](_0x1f5e55(0x162)));_0x1c78a4=='local'&&fileStatUtil[_0x1f5e55(0x10f)](_0x2c149a,()=>{const _0x29b251=_0x1f5e55;fileStatUtil[_0x29b251(0x160)](_0x2c149a,()=>{const _0xa173c7=_0x29b251,_0xa157e2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)';return _0x2ec4f6[_0xa173c7(0x11f)][_0xa173c7(0xec)][_0xa173c7(0x140)](_0xa157e2)[_0xa173c7(0x1a6)](_0x1c78a4,_0x2c149a,_0x25503d,_0x29cbd2,_0x3ac19f,_0x49a8a1),_0x150060[_0xa173c7(0x199)]({'code':0x0});},()=>{const _0x2ff631=_0x29b251;return _0x2ec4f6[_0x2ff631(0x11f)][_0x2ff631(0x133)](_0x150060,_0x150060['__'](_0x2ff631(0xda)));});},()=>{const _0x3d7e5e=_0x1f5e55;return _0x2ec4f6[_0x3d7e5e(0x11f)][_0x3d7e5e(0x133)](_0x150060,_0x150060['__']('targetPathInvalid'));});}else{if(_0x5438f6==_0x1f5e55(0x17f)){let _0x3da4cf=_0x2ec4f6[_0x1f5e55(0xed)]['id'];return _0x2ec4f6[_0x1f5e55(0x11f)]['dbOther'][_0x1f5e55(0x140)](_0x1f5e55(0x178))[_0x1f5e55(0x1a6)](_0x3da4cf),_0x150060[_0x1f5e55(0x199)]({'code':0x0});}else{if(_0x5438f6==_0x1f5e55(0x18f)){let _0x129e68=[],_0x2fed80=_0x2ec4f6['app'][_0x1f5e55(0xec)]['prepare']('select\x20id,type,url,name,remark\x20from\x20path_mount')[_0x1f5e55(0x144)]();if(_0x2ec4f6[_0x1f5e55(0x1a5)][_0x1f5e55(0x12d)]==0x1)_0x129e68=_0x2fed80;else{let _0x4a70bc=dbUserTable[_0x1f5e55(0xe8)](_0x2ec4f6['app'][_0x1f5e55(0xec)],_0x2ec4f6[_0x1f5e55(0x1a5)][_0x1f5e55(0x191)],'folder',_0x1f5e55(0x15b));for(let _0x2dfd23 in _0x4a70bc){let _0x248599=_0x4a70bc[_0x2dfd23][_0x1f5e55(0x10b)][_0x1f5e55(0xfa)]();_0x248599=path['join'](_0x248599);for(let _0x3d8e5e in _0x2fed80){try{if(_0x2fed80[_0x3d8e5e]['url']&&_0x248599){let _0x5e3c63=_0x2fed80[_0x3d8e5e][_0x1f5e55(0x110)][_0x1f5e55(0xfa)]();_0x5e3c63[_0x1f5e55(0xdf)](':')&&_0x5e3c63[_0x1f5e55(0xf8)]==0x2&&(_0x5e3c63=_0x5e3c63+path[_0x1f5e55(0x1ac)]),_0x5e3c63=path[_0x1f5e55(0x15a)](_0x5e3c63)[_0x1f5e55(0xfa)](),(_0x248599==_0x5e3c63||_0x5e3c63[_0x1f5e55(0x1a2)](path[_0x1f5e55(0x15a)](_0x248599+path['sep'])))&&_0x129e68[_0x1f5e55(0x17d)](_0x2fed80[_0x3d8e5e]);}}catch(_0x27e4ea){continue;}}}}return _0x150060['json']({'code':0x0,'data':_0x129e68});}}}});function getRandomString(_0x79d58d){const _0x1305b2=_0x1ef233;let _0x5dbcc5='';const _0x910efd=_0x1305b2(0x124),_0x3b440d=_0x910efd[_0x1305b2(0xf8)];for(let _0x27798b=0x0;_0x27798b<_0x79d58d;_0x27798b++){_0x5dbcc5+=_0x910efd['charAt'](Math[_0x1305b2(0x107)](Math[_0x1305b2(0x125)]()*_0x3b440d));}return _0x5dbcc5;}function _0x1cea(){const _0x2ca432=['download','fileName','doUserCanGet','Router','zip\x20finish','power_change','48016lprjyD','noWritePermission','get','add','username','shareToken','readdir','cut','children','value','targetPath','sourceFolderMusic','json','cannotCopyToSelf','parent','$Recycle.Bin','finalize','toUpperCase','root','findByTitleArr','utf8','startsWith','An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.','directory','currentUser','run','folderNotExist','25572grfCOm','music','includes','constants','sep','atimeMs','sourcePath','getTime','/getTempShare','error','/deleteByPath','searchStr','photo','res\x20closed,destroy\x20zip\x20stream','$RECYCLE.BIN','name','headersSent','post','returnFileError','result','createTime','/Users','append','R_OK','Downloads','noReadPermission','test','../../utils/globalInfoUtil','208oAizqV','folderPath','endsWith','TYPE_DELETE','then','fullPath','System\x20Volume\x20Information','removeHeader','createReadStream','checkPath','findByTitle','getUserPower','unpipe','LEVEL_MAIN_OPERATION','$WinREAgent','dbOther','body','close','login.pwdErr','Documents\x20and\x20Settings','sendFile','/getPathState','STATE_FAIL','SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?','2344380EVWmJo','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?','log','length','../../db/dbNoticeCenterTable','toLowerCase','getExcludePathList','.tmp','shell','code','/rawFile*','lastInsertRowid','existsSync','send','power_delete','webdav','Content-Disposition','filename','floor','operationType','darwin','destroy','path','isFile','W_OK','power_add','localPathIsFolder','url','24jxrVCD','sourceFolderPhoto','parse','/clearOperationRecord','end','rename','253885tXeHHO','type','Documents','TYPE_RENMAE','attachment;\x20filename*=UTF-8\x27\x27','fileFullPath','putInSystemTrash','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?','app','SELECT\x20*\x20FROM\x20share_temp','getByPage','zip\x20error','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','random','access','days','/zipFile','(\x27customLogoImage\x27,\x27customHomeBgImage\x27)','358545dYDVIt','parentPath','sameNameFileAlreadExist','is_admin','statSync','428166NynIPd','movie','userDataFolder','/operationPathMount','returnErrMsg','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','../../db/dbFileOperationRecord','sha256','../../utils/fileStatUtil','write','/addNewFolder','cwd','Desktop','../../db/dbUserTable','stack','.txt','.zip','prepare','.sys','Convert\x20to\x20utf8\x20','../utils/sharpUtils','all','sort','folder','doUserCanGetTempShare','create','no\x20permission\x20','extname','err','getWindowsDiskList','book','read','mtimeMs','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','pipe','cachePathRoot','raw','/zipFile/*','query','getTempShareObj','decodePath','/getTempShareFiles','localeCompare','join','power_get','sourcePathList','samba','../utils/fileUtils','folderName','localPathIsReadable','addFileOperationRecord','operationFail','express','/checkFolderPower','FILE_OPERATION','USER','sourceFolderMovie','/getOperationRecord','size','zip','getTransSizeStr','replace','password','isDirectory','local','671776TWlWee','deleteFileRecordAll','START_WORKER_FILE_OPERATION','data','getPathByType','259gFQQah','stringify','PerfLogs','delete\x20from\x20path_mount\x20where\x20id=?','/customImageFile','sharp','page','status','push','subType','delete','copy','deleteId','STATE_SUC','/tempShare','birthtimeMs','basename','stat'];_0x1cea=function(){return _0x2ca432;};return _0x1cea();}router[_0x1ef233(0x1b9)](_0x1ef233(0x1b0),(_0x298f40,_0x48afea,_0x4bbf20)=>{const _0x48f7c8=_0x1ef233;let _0xea528f=[];return _0x298f40[_0x48f7c8(0x1a5)][_0x48f7c8(0x12d)]==0x1?_0xea528f=_0x298f40['app']['dbOther'][_0x48f7c8(0x140)](_0x48f7c8(0x120))[_0x48f7c8(0x144)]():_0xea528f=_0x298f40['app']['dbOther'][_0x48f7c8(0x140)](_0x48f7c8(0xf4))[_0x48f7c8(0x144)](_0x298f40[_0x48f7c8(0x1a5)]['id']),_0x48afea['json']({'code':0x0,'data':_0xea528f});}),router['post'](_0x1ef233(0x183),(_0x545ed8,_0xac53a2,_0x5f42eb)=>{const _0x3efea1=_0x1ef233;let _0x659b98=_0x545ed8['body'][_0x3efea1(0x108)];if(_0x659b98==_0x3efea1(0x190))try{if(!_0x545ed8[_0x3efea1(0xed)][_0x3efea1(0x10b)])return _0x545ed8[_0x3efea1(0x11f)][_0x3efea1(0x133)](_0xac53a2,_0x3efea1(0x1b1));let _0x3e2912=fileUtil[_0x3efea1(0x157)](_0x545ed8[_0x3efea1(0xed)][_0x3efea1(0x10b)]);function _0x51a9c6(){const _0x5ddeed=_0x3efea1;if(dbUserTable[_0x5ddeed(0x189)](_0x545ed8,_0xac53a2,'','power_get',_0x3e2912)==!![]){let _0x404959=_0x545ed8[_0x5ddeed(0xed)][_0x5ddeed(0x16d)]?_0x545ed8[_0x5ddeed(0xed)]['password']:'',_0x277b52=new Date()[_0x5ddeed(0x1af)](),_0x23617c=getRandomString(0x5),_0x5da029=_0x545ed8[_0x5ddeed(0x11f)][_0x5ddeed(0xec)][_0x5ddeed(0x140)]('SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?')[_0x5ddeed(0x18f)](_0x23617c);if(_0x5da029)return _0x51a9c6();let _0x8342ad=_0x545ed8['body'][_0x5ddeed(0x127)]?_0x545ed8[_0x5ddeed(0xed)]['days']:0x1e,_0x5cf98f=0xe10*0x3e8*0x18*_0x8342ad+_0x277b52;return _0x545ed8[_0x5ddeed(0x11f)][_0x5ddeed(0xec)][_0x5ddeed(0x140)](_0x5ddeed(0x150))[_0x5ddeed(0x1a6)](_0x3e2912,_0x404959,_0x23617c,_0x277b52,_0x5cf98f,_0x545ed8[_0x5ddeed(0x1a5)]['id']),_0xac53a2['json']({'code':0x0,'token':_0x23617c});}}return _0x51a9c6();}catch(_0x336609){return console[_0x3efea1(0xf7)](_0x336609),_0x545ed8[_0x3efea1(0x11f)][_0x3efea1(0x133)](_0xac53a2,_0x3efea1(0x1b1));}else{if(_0x659b98=='delete'){let _0x3c5c4f=_0x545ed8['body'][_0x3efea1(0x181)];return _0x545ed8['currentUser'][_0x3efea1(0x12d)]==0x1?_0x545ed8[_0x3efea1(0x11f)]['dbOther'][_0x3efea1(0x140)](_0x3efea1(0x11e))[_0x3efea1(0x1a6)](_0x3c5c4f):_0x545ed8[_0x3efea1(0x11f)][_0x3efea1(0xec)][_0x3efea1(0x140)](_0x3efea1(0xf6))[_0x3efea1(0x1a6)](_0x3c5c4f,_0x545ed8['currentUser']['id']),_0xac53a2[_0x3efea1(0x199)]({'code':0x0});}}}),router[_0x1ef233(0x1b9)](_0x1ef233(0x158),(_0x4bd2cf,_0x30accf,_0x1cafdc)=>{const _0x59c46a=_0x1ef233;let _0x41912d=_0x4bd2cf[_0x59c46a(0xed)][_0x59c46a(0x192)]||_0x4bd2cf['body']['st'],_0x5ba708=_0x4bd2cf['body'][_0x59c46a(0x19b)],_0x66435=_0x4bd2cf[_0x59c46a(0xed)]['password'],_0x500030=[],_0x486ac8=dbConfigTable[_0x59c46a(0x1a0)](_0x4bd2cf[_0x59c46a(0x11f)][_0x59c46a(0xec)],_0x59c46a(0x129)),_0x10ca55={'code':0x0,'data':{'customConfig':_0x486ac8,'parent':_0x5ba708,'children':_0x500030,'sep':path[_0x59c46a(0x1ac)],'platform':platform}};if(!_0x41912d)return _0x30accf[_0x59c46a(0x199)](_0x10ca55);let _0x27dd29=dbUserTable[_0x59c46a(0x156)](_0x4bd2cf[_0x59c46a(0x11f)][_0x59c46a(0xec)],_0x41912d);if(!_0x27dd29)return _0x30accf[_0x59c46a(0x199)](_0x10ca55);if(_0x27dd29[_0x59c46a(0x16d)]){if(!_0x66435)return _0x30accf[_0x59c46a(0x199)]({'code':0x2});if(_0x27dd29[_0x59c46a(0x16d)]!=_0x66435)return _0x30accf[_0x59c46a(0x199)]({'code':0x2,'message':_0x30accf['__'](_0x59c46a(0xef))});}function _0x2442a8(){const _0x1116f6=_0x59c46a;fs[_0x1116f6(0x186)](_0x27dd29['path'],(_0xe3d7d3,_0x371240)=>{const _0x4e7845=_0x1116f6;if(_0xe3d7d3)return _0x30accf[_0x4e7845(0x199)](_0x10ca55);return _0x10ca55[_0x4e7845(0x173)]['children'][_0x4e7845(0x17d)]({'type':_0x371240[_0x4e7845(0x10c)]()?0x1:0x2,'name':path[_0x4e7845(0x185)](_0x27dd29[_0x4e7845(0x10b)]),'fileFullPath':_0x27dd29['path']}),_0x30accf['json'](_0x10ca55);});}if(!_0x5ba708)_0x2442a8();else{let _0x5a1d95=dbUserTable[_0x59c46a(0x147)](_0x4bd2cf[_0x59c46a(0x11f)][_0x59c46a(0xec)],_0x41912d,_0x5ba708,_0x66435);if(!_0x5a1d95)return console[_0x59c46a(0xf7)](_0x59c46a(0x149),_0x5ba708),_0x2442a8();fs[_0x59c46a(0x193)](_0x5ba708,{'withFileTypes':!![]},(_0x2c90e7,_0xd3b8a1)=>{const _0x4c872b=_0x59c46a;if(_0x2c90e7)return _0x30accf[_0x4c872b(0x199)](_0x10ca55);let _0x375dc4=0x0;if(_0xd3b8a1[_0x4c872b(0xf8)]<0x1)return _0x30accf['json'](_0x10ca55);for(let _0xb2b943=0x0;_0xb2b943<_0xd3b8a1[_0x4c872b(0xf8)];_0xb2b943++){let _0x4e3b39=_0xd3b8a1[_0xb2b943],_0x11bacb=_0xd3b8a1[_0xb2b943][_0x4c872b(0x1b7)];if(_0x11bacb[_0x4c872b(0xf8)]>0x0){if(_0x11bacb[0x0]=='.'){_0x375dc4+=0x1;continue;}if(/[A-Z]:\\/i[_0x4c872b(0xdb)](_0x5ba708)&&_0x5ba708['length']<=0x3){if(win32ExcludeList['includes'](_0x11bacb)||_0x11bacb[_0x4c872b(0xdf)]('.sys')||_0x11bacb[_0x4c872b(0xdf)](_0x4c872b(0xfc))){_0x375dc4+=0x1;continue;}}}let _0x345375=path[_0x4c872b(0x15a)](_0x5ba708,_0x11bacb);fs[_0x4c872b(0x186)](_0x345375,(_0x48bc88,_0x10ce89)=>{const _0x37121e=_0x4c872b;_0x375dc4+=0x1;let _0x38a2bb=_0x4e3b39[_0x37121e(0x10c)](),_0x4cf594=_0x4e3b39[_0x37121e(0x16e)](),_0x5f234b={'name':_0x11bacb,'fileFullPath':_0x345375};!_0x48bc88&&_0x10ce89&&(_0x5f234b['size']=_0x10ce89[_0x37121e(0x169)],_0x5f234b[_0x37121e(0x1bc)]=_0x10ce89[_0x37121e(0x184)]||_0x10ce89['ctimeMs']);_0x38a2bb?_0x5f234b[_0x37121e(0x118)]=0x1:_0x5f234b[_0x37121e(0x118)]=0x2;_0x10ca55[_0x37121e(0x173)][_0x37121e(0x195)][_0x37121e(0x17d)](_0x5f234b);if(_0x375dc4>=_0xd3b8a1[_0x37121e(0xf8)])return _0x30accf[_0x37121e(0x199)](_0x10ca55);});}});}}),module['exports']=router;