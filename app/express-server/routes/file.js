const _0x87ea4c=_0x3f07;(function(_0x770a1,_0x39bd87){const _0xc7b5b9=_0x3f07,_0x5cc9ca=_0x770a1();while(!![]){try{const _0x31ccdf=-parseInt(_0xc7b5b9(0x234))/0x1*(parseInt(_0xc7b5b9(0x1e1))/0x2)+parseInt(_0xc7b5b9(0x22e))/0x3*(-parseInt(_0xc7b5b9(0x21b))/0x4)+-parseInt(_0xc7b5b9(0x246))/0x5+parseInt(_0xc7b5b9(0x1ec))/0x6+-parseInt(_0xc7b5b9(0x241))/0x7+parseInt(_0xc7b5b9(0x1a9))/0x8+parseInt(_0xc7b5b9(0x1a5))/0x9;if(_0x31ccdf===_0x39bd87)break;else _0x5cc9ca['push'](_0x5cc9ca['shift']());}catch(_0xf0d0b3){_0x5cc9ca['push'](_0x5cc9ca['shift']());}}}(_0x28d8,0xc6caf));let express=require('express'),router=express['Router'](),path=require(_0x87ea4c(0x211)),fs=require('fs'),sha256=require(_0x87ea4c(0x19a)),fileUtil=require(_0x87ea4c(0x1d3));const sharp=require(_0x87ea4c(0x193)),os=require('os');let platform=os['platform']();const dbUserTable=require(_0x87ea4c(0x235)),dbNoticeCenterTable=require(_0x87ea4c(0x1d0)),dbConfigTable=require(_0x87ea4c(0x210)),dbSourceFolderTable=require(_0x87ea4c(0x217)),dbFileOperationRecord=require('../../db/dbFileOperationRecord'),fileStatUtil=require('../../utils/fileStatUtil'),config=require('../../myConfig/config'),sharpUtil=require(_0x87ea4c(0x20c)),globalInfoUtil=require(_0x87ea4c(0x253)),archiver=require(_0x87ea4c(0x248)),encodingUtil=require('../../utils/encodingUtil');function _0x3f07(_0x333991,_0x224d9d){const _0x28d871=_0x28d8();return _0x3f07=function(_0x3f0783,_0x5c3d0b){_0x3f0783=_0x3f0783-0x17f;let _0x582b38=_0x28d871[_0x3f0783];return _0x582b38;},_0x3f07(_0x333991,_0x224d9d);}let macPowerDetected=![],win32ExcludeList=['System\x20Volume\x20Information','$Recycle.Bin',_0x87ea4c(0x1a2),_0x87ea4c(0x1a6),_0x87ea4c(0x229),_0x87ea4c(0x22b)];router['get'](_0x87ea4c(0x1e6),(_0x22eb9d,_0x5b84c6,_0x224e2c)=>{const _0x2bffb1=_0x87ea4c;if(!_0x22eb9d[_0x2bffb1(0x1e0)][_0x2bffb1(0x211)])return _0x5b84c6[_0x2bffb1(0x1de)](0x194)[_0x2bffb1(0x22c)]();let _0x4265f=fileUtil['decodePath'](_0x22eb9d[_0x2bffb1(0x1e0)]['path']),_0x5b4e13=_0x22eb9d[_0x2bffb1(0x1e0)]['filename'];_0x5b4e13&&(_0x4265f=path['join'](_0x4265f,_0x5b4e13)),dbUserTable['doUserCanGet'](_0x22eb9d,_0x5b84c6,'',_0x2bffb1(0x19c),_0x4265f)==!![]&&fs[_0x2bffb1(0x226)](_0x4265f,(_0x1cf346,_0x11df5d)=>{const _0x85c9dd=_0x2bffb1;if(_0x1cf346)return _0x5b84c6[_0x85c9dd(0x1de)](0x194)['end']();let _0x1d3591=path['basename'](_0x4265f)+_0x85c9dd(0x192);try{const _0x139218=encodeURIComponent(_0x1d3591)['replace'](/%([0-9A-F]{2})/g,(_0x555a37,_0x6e2a85)=>'%'+_0x6e2a85[_0x85c9dd(0x223)]());_0x5b84c6['setHeader'](_0x85c9dd(0x1ad),_0x85c9dd(0x25e)+_0x139218);}catch(_0x13f873){console['log'](_0x13f873);}const _0x17e095=archiver(_0x85c9dd(0x23e),{'zlib':{'level':0x0}});_0x17e095['on']('error',function(_0x1c24e1){const _0x2b3e96=_0x85c9dd;console['log'](_0x2b3e96(0x1a4),_0x1c24e1['message']||_0x1c24e1[_0x2b3e96(0x23a)]),_0x17e095[_0x2b3e96(0x24e)](),!_0x5b84c6['headersSent']?(_0x5b84c6[_0x2b3e96(0x1c3)](_0x2b3e96(0x1ad)),_0x5b84c6[_0x2b3e96(0x1de)](0x1f4)['send'](_0x2b3e96(0x182))):_0x5b84c6[_0x2b3e96(0x187)]();}),_0x17e095['on'](_0x85c9dd(0x22c),function(){const _0x154e9d=_0x85c9dd;console[_0x154e9d(0x1ab)](_0x154e9d(0x260)),_0x17e095[_0x154e9d(0x187)]();});try{fs['readdir'](_0x4265f,(_0x4230f7,_0x6fa5e5)=>{const _0x551364=_0x85c9dd;for(let _0x54c08d in _0x6fa5e5){let _0x4e5d2f=_0x6fa5e5[_0x54c08d];const _0x3e2a4a=path[_0x551364(0x1cd)](_0x4265f,_0x4e5d2f);let _0x122901=fs['statSync'](_0x3e2a4a);_0x122901['isDirectory']()?_0x17e095[_0x551364(0x257)](_0x3e2a4a,_0x4e5d2f):_0x17e095[_0x551364(0x1e8)](fs['createReadStream'](_0x3e2a4a),{'name':_0x4e5d2f});}_0x17e095[_0x551364(0x1c7)](),_0x17e095[_0x551364(0x1d8)](_0x5b84c6);});}catch(_0x248b00){!_0x5b84c6[_0x85c9dd(0x206)]&&_0x5b84c6[_0x85c9dd(0x1de)](0x1f4)['send']({'error':_0x85c9dd(0x1d2)}),console[_0x85c9dd(0x263)](_0x248b00);}_0x5b84c6['on'](_0x85c9dd(0x1e4),()=>{const _0x1617cb=_0x85c9dd;console[_0x1617cb(0x1ab)](_0x1617cb(0x201)),_0x17e095[_0x1617cb(0x187)]();});});}),router[_0x87ea4c(0x232)](_0x87ea4c(0x180),(_0x29af5f,_0x1ecef4,_0x18ac31)=>{const _0x13425f=_0x87ea4c;let _0x45355f=_0x29af5f[_0x13425f(0x1dc)]['parent'],_0x24696=path[_0x13425f(0x20e)],_0x6429bb=_0x29af5f[_0x13425f(0x1dc)][_0x13425f(0x1af)],_0x3b1d60=_0x29af5f['body'][_0x13425f(0x1e2)],_0x1ba4b7=[],_0x80b878=parseInt(_0x29af5f[_0x13425f(0x215)][_0x13425f(0x19f)])==0x1,_0x4f90fb=fileUtil[_0x13425f(0x18a)](_0x29af5f[_0x13425f(0x1ca)][_0x13425f(0x197)]);try{function _0x727d5d(){const _0x147aa5=_0x13425f;let _0x240eaf=dbUserTable[_0x147aa5(0x1f8)](_0x29af5f[_0x147aa5(0x1ca)][_0x147aa5(0x197)],_0x29af5f[_0x147aa5(0x215)][_0x147aa5(0x1eb)],_0x147aa5(0x188),_0x147aa5(0x19c));for(let _0x5c1fd5 of _0x240eaf){if(_0x4f90fb['includes'](_0x5c1fd5['path']))continue;_0x1ba4b7[_0x147aa5(0x23c)]({'type':0x2,'name':_0x5c1fd5[_0x147aa5(0x211)],'fileFullPath':_0x5c1fd5[_0x147aa5(0x211)]});}return _0x1ecef4[_0x147aa5(0x1f4)]({'code':0x0,'data':{'parent':'','children':_0x1ba4b7,'sep':_0x24696,'platform':platform}});}if(!_0x45355f){if(_0x80b878){if(platform=='win32'){function _0x351490(_0x17880c){const _0x498a5c=_0x13425f;let _0x56cff1=[];for(let _0xbbd382 of _0x17880c){if(_0x4f90fb[_0x498a5c(0x1f0)](_0xbbd382['name']))continue;_0xbbd382[_0x498a5c(0x1af)]=0x2,_0x56cff1[_0x498a5c(0x23c)](_0xbbd382);}for(let _0x37646c in _0x56cff1){_0x56cff1[_0x37646c][_0x498a5c(0x25b)]=_0x56cff1[_0x37646c][_0x498a5c(0x245)];}return _0x1ecef4[_0x498a5c(0x1f4)]({'code':0x0,'data':{'parent':_0x45355f,'children':_0x56cff1,'sep':path[_0x498a5c(0x20e)],'platform':platform}});}let _0x55d426=dbConfigTable[_0x13425f(0x1ce)](_0x29af5f[_0x13425f(0x1ca)][_0x13425f(0x197)],_0x13425f(0x225));if(_0x55d426)try{_0x55d426=JSON[_0x13425f(0x240)](_0x55d426[_0x13425f(0x1c5)]),_0x4366b2(![]),_0x351490(_0x55d426);}catch(_0x4a0726){_0x4366b2(!![]);}else _0x4366b2(!![]);function _0x4366b2(_0x5dffb3){const _0x50ac47=_0x13425f;globalInfoUtil[_0x50ac47(0x25c)](_0x146e9e=>{const _0x1c5130=_0x50ac47;_0x146e9e=_0x146e9e[_0x1c5130(0x190)]((_0x62d2bb,_0x1c5d52)=>{const _0x48fe59=_0x1c5130;if(!_0x62d2bb[_0x48fe59(0x245)]||!_0x1c5d52[_0x48fe59(0x245)])return;return _0x62d2bb[_0x48fe59(0x245)][_0x48fe59(0x184)](_0x1c5d52['name']);}),dbConfigTable[_0x1c5130(0x227)](_0x29af5f['app']['dbOther'],{'title':_0x1c5130(0x225),'value':JSON[_0x1c5130(0x1f9)](_0x146e9e)}),_0x5dffb3&&_0x351490(_0x146e9e);});}}else{if(platform=='darwin'){if(!macPowerDetected){macPowerDetected=!![];try{const _0x330b59=process[_0x13425f(0x24b)][_0x13425f(0x23d)];let _0x2cb1fa=[path['join']('/Users',_0x330b59,_0x13425f(0x233)),path[_0x13425f(0x1cd)](_0x13425f(0x195),_0x330b59,_0x13425f(0x183)),path[_0x13425f(0x1cd)](_0x13425f(0x195),_0x330b59,'Desktop')];for(let _0x589aa9 in _0x2cb1fa){fs['stat'](_0x2cb1fa[_0x589aa9],(_0x36449d,_0x1108ce)=>{});}}catch(_0x20f763){}}let _0x4ec40e=path[_0x13425f(0x240)](process[_0x13425f(0x1a8)]())[_0x13425f(0x22f)];_0x4e523a(_0x4ec40e);}else _0x45355f=path[_0x13425f(0x240)](process[_0x13425f(0x1a8)]())[_0x13425f(0x22f)],_0x4e523a(_0x45355f);}}else return _0x727d5d();}else _0x4e523a(_0x45355f);function _0x4e523a(_0x1878d2){const _0x454f38=_0x13425f;if(!_0x80b878){if(!dbUserTable[_0x454f38(0x213)](_0x29af5f,_0x1ecef4,_0x454f38(0x188),_0x454f38(0x19c),_0x1878d2,!![]))return _0x727d5d();}if(_0x1878d2=='sourceFolderPhoto'||_0x1878d2==_0x454f38(0x1b1)||_0x1878d2==_0x454f38(0x1fb)||_0x1878d2==_0x454f38(0x1a3)){let _0x202093=_0x454f38(0x1b2);if(_0x1878d2=='sourceFolderMovie')_0x202093=_0x454f38(0x20a);else{if(_0x1878d2=='sourceFolderMusic')_0x202093=_0x454f38(0x1d6);else _0x1878d2==_0x454f38(0x1a3)&&(_0x202093=_0x454f38(0x1a7));}let _0x1750bf=dbSourceFolderTable[_0x454f38(0x1f1)](_0x29af5f[_0x454f38(0x1ca)][_0x454f38(0x197)],_0x202093);for(let _0x136953 in _0x1750bf){_0x1ba4b7[_0x454f38(0x23c)]({'type':0x2,'name':path[_0x454f38(0x204)](_0x1750bf[_0x136953][_0x454f38(0x211)]),'fileFullPath':_0x1750bf[_0x136953][_0x454f38(0x211)]});}return _0x1ecef4[_0x454f38(0x1f4)]({'code':0x0,'data':{'parent':_0x1878d2,'children':_0x1ba4b7,'sep':_0x24696,'platform':platform}});}fs['readdir'](_0x1878d2,{'withFileTypes':!![]},(_0x1701a8,_0x364bb2)=>{const _0xffe456=_0x454f38;if(_0x1701a8)return console['log'](_0x1701a8),fileUtil[_0xffe456(0x203)](_0x1ecef4,_0x1701a8);for(let _0x5a9bdd=0x0;_0x5a9bdd<_0x364bb2[_0xffe456(0x19b)];_0x5a9bdd++){let _0x5ef768=_0x364bb2[_0x5a9bdd],_0x1105ce=_0x364bb2[_0x5a9bdd][_0xffe456(0x245)];if(_0x1105ce['length']>0x0){if(_0x1105ce[0x0]=='.')continue;if(/[A-Z]:\\/i[_0xffe456(0x198)](_0x1878d2)&&_0x1878d2['length']<=0x3){if(win32ExcludeList['includes'](_0x1105ce)||_0x1105ce[_0xffe456(0x25d)]('.sys')||_0x1105ce['endsWith'](_0xffe456(0x221)))continue;}}let _0x6eb4d6=path[_0xffe456(0x1cd)](_0x1878d2,_0x1105ce);if(_0x4f90fb['includes'](_0x6eb4d6))continue;let _0x53939e=_0x5ef768['isFile'](),_0x21a90c=_0x5ef768[_0xffe456(0x19e)]();function _0x56e8ce(){if(_0x53939e)(_0x6429bb==0x0||_0x6429bb==0x1)&&_0x1ba4b7['push']({'type':0x1,'name':_0x1105ce,'fileFullPath':_0x6eb4d6});else _0x21a90c&&_0x1ba4b7['push']({'type':0x2,'name':_0x1105ce,'fileFullPath':_0x6eb4d6});}_0x3b1d60?_0x1105ce[_0xffe456(0x1f0)](_0x3b1d60)&&_0x56e8ce():_0x56e8ce();try{if(_0x1ba4b7['length']>0x1770)break;}catch(_0x1df9ef){continue;}}let _0x4b6562=_0x1ba4b7['length'],_0x3bd28b=0x0;if(_0x1ba4b7[_0xffe456(0x19b)]<0x1)return _0x1ecef4[_0xffe456(0x1f4)]({'code':0x0,'data':{'parent':_0x1878d2,'children':_0x1ba4b7,'sep':_0x24696,'platform':platform}});for(let _0x2190c1 of _0x1ba4b7){fs[_0xffe456(0x226)](_0x2190c1[_0xffe456(0x25b)],(_0x2ffe30,_0x2684b3)=>{const _0x34eaaa=_0xffe456;_0x3bd28b+=0x1;!_0x2ffe30&&(_0x2190c1[_0x34eaaa(0x237)]=_0x2684b3['atimeMs'],_0x2190c1[_0x34eaaa(0x1bc)]=_0x2684b3[_0x34eaaa(0x1bc)],_0x2190c1['birthtimeMs']=_0x2684b3[_0x34eaaa(0x1ba)],_0x2190c1[_0x34eaaa(0x22a)]=_0x2684b3[_0x34eaaa(0x22a)]);if(_0x3bd28b>=_0x4b6562)return _0x1ecef4[_0x34eaaa(0x1f4)]({'code':0x0,'data':{'parent':_0x1878d2,'children':_0x1ba4b7,'sep':_0x24696,'platform':platform}});});}});}}catch(_0x3b0491){return fileUtil[_0x13425f(0x203)](_0x1ecef4,_0x3b0491);}}),router[_0x87ea4c(0x1f5)](_0x87ea4c(0x200),(_0x22b6a1,_0x2f71fb,_0x459601)=>{const _0x30b0a0=_0x87ea4c;let _0x2c63d4=fileUtil[_0x30b0a0(0x219)](_0x22b6a1[_0x30b0a0(0x1e0)]['path']);if(!_0x2c63d4)return _0x2f71fb[_0x30b0a0(0x1de)](0x194)[_0x30b0a0(0x22c)]();_0x2c63d4=path[_0x30b0a0(0x1cd)](_0x2c63d4);let _0x2b5d3a=path[_0x30b0a0(0x1cd)](config[_0x30b0a0(0x1cf)],_0x30b0a0(0x1d9),path[_0x30b0a0(0x20e)]);return _0x2c63d4[_0x30b0a0(0x1b5)](_0x2b5d3a)?_0x2f71fb[_0x30b0a0(0x214)](_0x2c63d4):_0x2f71fb[_0x30b0a0(0x1de)](0x194)[_0x30b0a0(0x22c)]();}),router[_0x87ea4c(0x1f5)]('/rawFile*',(_0x1089a8,_0x9bf762,_0x5dbcf3)=>{const _0x57dff7=_0x87ea4c;let _0x4091f0=_0x1089a8[_0x57dff7(0x1e0)]['path'],_0x491ee8=_0x1089a8[_0x57dff7(0x1e0)]['download']==0x1,_0x40e51c=fileUtil[_0x57dff7(0x219)](_0x4091f0),_0x4be162=_0x1089a8[_0x57dff7(0x1e0)][_0x57dff7(0x22a)],_0x24d92a=_0x1089a8['query'][_0x57dff7(0x1b7)];if(dbUserTable['doUserCanGet'](_0x1089a8,_0x9bf762,'','power_get',_0x40e51c)==!![])try{let _0x37aae3=_0x1089a8[_0x57dff7(0x1e0)][_0x57dff7(0x181)];if(_0x37aae3&&_0x37aae3==0x1){if(_0x491ee8){const _0x3cd94a=encodeURIComponent(path[_0x57dff7(0x204)](_0x40e51c))[_0x57dff7(0x244)](/%([0-9A-F]{2})/g,(_0x4e90a5,_0x4755cd)=>'%'+_0x4755cd['toUpperCase']());_0x9bf762['setHeader'](_0x57dff7(0x1ad),_0x57dff7(0x25e)+_0x3cd94a);}return _0x9bf762[_0x57dff7(0x214)](_0x40e51c);}else _0x1089a8[_0x57dff7(0x1e0)]['code']&&_0x1089a8[_0x57dff7(0x1e0)]['code']=='utf8'&&path[_0x57dff7(0x1b6)](_0x40e51c)&&path[_0x57dff7(0x1b6)](_0x40e51c)[_0x57dff7(0x1e7)]()=='.txt'?(console[_0x57dff7(0x1ab)]('Convert\x20to\x20utf8\x20',_0x40e51c),encodingUtil[_0x57dff7(0x25f)](_0x40e51c)['then'](_0x5d78af=>{const _0xb5bd25=_0x57dff7;return _0x5d78af?_0x5d78af['pipe'](_0x9bf762):(console[_0xb5bd25(0x1ab)](_0xb5bd25(0x18c),_0x40e51c),_0x9bf762[_0xb5bd25(0x214)](_0x40e51c));})):sharpUtil[_0x57dff7(0x1c0)](_0x9bf762,_0x40e51c,_0x491ee8,_0x4be162,_0x24d92a);}catch(_0xaa9ce){return console[_0x57dff7(0x1ab)](_0xaa9ce),fileUtil['returnFileError'](_0x9bf762,_0xaa9ce);}}),router[_0x87ea4c(0x232)]('/checkFolderPower',(_0x2dc571,_0x566349,_0x38b5a8)=>{const _0x2bbcb4=_0x87ea4c;let _0x39f8b4=fileUtil[_0x2bbcb4(0x219)](_0x2dc571[_0x2bbcb4(0x1dc)][_0x2bbcb4(0x20f)]),_0x4c9222=_0x2dc571['body'][_0x2bbcb4(0x1f6)];if(_0x4c9222==_0x2bbcb4(0x1dd))_0x4c9222=fs['constants'][_0x2bbcb4(0x196)];else _0x4c9222==_0x2bbcb4(0x24c)&&(_0x4c9222=fs[_0x2bbcb4(0x21f)][_0x2bbcb4(0x239)]);try{_0x4c9222==_0x2bbcb4(0x1fa)?fs[_0x2bbcb4(0x230)](_0x39f8b4,fs[_0x2bbcb4(0x21f)]['W_OK'],_0x4c3d23=>{const _0x3f7d42=_0x2bbcb4;if(_0x4c3d23)return fileUtil[_0x3f7d42(0x203)](_0x566349,_0x4c3d23);return _0x566349[_0x3f7d42(0x1f4)]({'code':0x0,'access':!![]});}):fs[_0x2bbcb4(0x230)](_0x39f8b4,_0x4c9222,_0x38332a=>{const _0x556510=_0x2bbcb4;if(_0x38332a)return fileUtil[_0x556510(0x203)](_0x566349,_0x38332a);return _0x566349[_0x556510(0x1f4)]({'code':0x0,'access':!![]});});}catch(_0x3acf70){return _0x566349['json']({'code':0x0,'access':![]});}}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1d1),(_0x11c0bb,_0x14e252,_0x4276e3)=>{const _0x4624f3=_0x87ea4c;let _0x3a0b1a=fileUtil[_0x4624f3(0x219)](_0x11c0bb[_0x4624f3(0x1dc)]['parentPath']),_0x265fdb=_0x11c0bb[_0x4624f3(0x1dc)][_0x4624f3(0x17f)],_0x2806ce=path[_0x4624f3(0x1cd)](_0x3a0b1a,_0x265fdb);if(dbUserTable['doUserCanGet'](_0x11c0bb,_0x14e252,'folder','power_add',_0x2806ce)==!![])try{fs[_0x4624f3(0x226)](_0x2806ce,_0x3caa62=>{const _0x5585c3=_0x4624f3;if(!_0x3caa62)return _0x11c0bb[_0x5585c3(0x1ca)][_0x5585c3(0x242)](_0x14e252,_0x14e252['__'](_0x5585c3(0x20b))+':'+_0x2806ce);else fs['mkdir'](_0x2806ce,{'recursive':!![]},_0x14a357=>{const _0x5a2c7f=_0x5585c3;return _0x14a357?fileUtil[_0x5a2c7f(0x203)](_0x14e252,_0x14a357):_0x14e252[_0x5a2c7f(0x1f4)]({'code':0x0});});});}catch(_0xf88de4){return fileUtil[_0x4624f3(0x203)](_0x14e252,_0xf88de4);}}),router['post'](_0x87ea4c(0x21a),(_0x1ea9bb,_0x4e8d59,_0x3ddcae)=>{const _0x40f43b=_0x87ea4c;let _0x3db70b=_0x1ea9bb[_0x40f43b(0x1dc)][_0x40f43b(0x1c4)],_0x28e695=_0x1ea9bb[_0x40f43b(0x1dc)]['targetPath'],_0x977df1=_0x1ea9bb['body'][_0x40f43b(0x1af)];if(_0x977df1!=_0x40f43b(0x23e)&&_0x977df1!=_0x40f43b(0x21e))return _0x1ea9bb[_0x40f43b(0x1ca)]['returnErrMsg'](_0x4e8d59,_0x4e8d59['__'](_0x40f43b(0x185)));if(dbUserTable[_0x40f43b(0x213)](_0x1ea9bb,_0x4e8d59,_0x40f43b(0x188),_0x40f43b(0x19c),_0x3db70b)==!![]&&dbUserTable[_0x40f43b(0x213)](_0x1ea9bb,_0x4e8d59,_0x40f43b(0x188),_0x40f43b(0x250),_0x28e695)==!![]){let _0x543c2f=_0x1ea9bb[_0x40f43b(0x1ca)][_0x40f43b(0x197)]['prepare']('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')[_0x40f43b(0x18e)](_0x40f43b(0x1d4),JSON[_0x40f43b(0x1f9)]({'sourcePath':_0x3db70b,'targetPath':_0x28e695,'type':_0x977df1,'username':_0x1ea9bb[_0x40f43b(0x215)]['username']}));return process[_0x40f43b(0x189)]({'type':_0x40f43b(0x1fc),'taskIdList':[_0x543c2f[_0x40f43b(0x202)]]}),_0x4e8d59[_0x40f43b(0x1f4)]({'code':0x0});}}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1b0),(_0xd67eff,_0x367ba4,_0x13b97c)=>{const _0x3c6a72=_0x87ea4c;let _0x439d30=_0xd67eff[_0x3c6a72(0x1dc)][_0x3c6a72(0x238)],_0x146281=_0xd67eff[_0x3c6a72(0x1dc)][_0x3c6a72(0x23b)],_0x5c57f3=_0xd67eff[_0x3c6a72(0x1dc)][_0x3c6a72(0x1af)];if(_0x439d30['length']<0x1)return _0xd67eff[_0x3c6a72(0x1ca)][_0x3c6a72(0x242)](_0x367ba4,_0x367ba4['__'](_0x3c6a72(0x185)));if(dbUserTable[_0x3c6a72(0x213)](_0xd67eff,_0x367ba4,_0x3c6a72(0x188),'power_get',_0x439d30[0x0])==!![]&&dbUserTable['doUserCanGet'](_0xd67eff,_0x367ba4,_0x3c6a72(0x188),_0x3c6a72(0x250),_0x146281)==!![])try{let _0x30fa37=[];for(let _0x400a71 in _0x439d30){let _0x763a94=_0x439d30[_0x400a71],_0x2e3317=path['basename'](_0x763a94),_0x423b76=path[_0x3c6a72(0x1cd)](_0x146281,_0x2e3317),_0x31572d=_0xd67eff[_0x3c6a72(0x1ca)][_0x3c6a72(0x197)][_0x3c6a72(0x254)](_0x3c6a72(0x261))[_0x3c6a72(0x18e)]('FILE_OPERATION',JSON[_0x3c6a72(0x1f9)]({'sourcePath':_0x763a94,'targetPath':_0x423b76,'type':_0x5c57f3,'username':_0xd67eff['currentUser'][_0x3c6a72(0x1eb)]}));_0x30fa37[_0x3c6a72(0x23c)](_0x31572d['lastInsertRowid']);}return process['send']({'type':_0x3c6a72(0x1fc),'taskIdList':_0x30fa37}),_0x367ba4[_0x3c6a72(0x1f4)]({'code':0x0});}catch(_0x68349e){return _0xd67eff[_0x3c6a72(0x1ca)][_0x3c6a72(0x242)](_0x367ba4,_0x367ba4['__']('operationFail'));}}),router[_0x87ea4c(0x232)](_0x87ea4c(0x236),(_0x18c271,_0x1f9108,_0x202a92)=>{const _0x4bb667=_0x87ea4c;let _0x6b7c45=fileUtil[_0x4bb667(0x219)](_0x18c271[_0x4bb667(0x1dc)][_0x4bb667(0x1c4)]),_0xc056cd=fileUtil[_0x4bb667(0x219)](_0x18c271[_0x4bb667(0x1dc)][_0x4bb667(0x23b)]),_0xbd153b=path[_0x4bb667(0x204)](_0x6b7c45),_0x11e775=_0x18c271[_0x4bb667(0x1dc)]['type'],_0x40793c=path['join'](_0xc056cd,_0xbd153b);if(_0x11e775==_0x4bb667(0x1e5)||_0x11e775=='cut'){if(fs[_0x4bb667(0x256)](_0x40793c))return _0x18c271[_0x4bb667(0x1ca)]['returnErrMsg'](_0x1f9108,_0x1f9108['__'](_0x4bb667(0x20b))+':'+_0x40793c);}let _0x402dc2=_0x18c271['body']['newName'];function _0x41650e(_0x5b713b,_0x50cd41){const _0x30aa57=_0x4bb667;let _0x5f2430=_0x18c271[_0x30aa57(0x1ca)]['dbOther'][_0x30aa57(0x254)]('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')['run'](_0x30aa57(0x1d4),JSON[_0x30aa57(0x1f9)]({'sourcePath':_0x5b713b,'targetPath':_0x50cd41,'type':_0x11e775,'username':_0x18c271[_0x30aa57(0x215)][_0x30aa57(0x1eb)]}));return _0x5f2430[_0x30aa57(0x202)];}try{_0x6b7c45=path['join'](_0x6b7c45),_0xc056cd=path[_0x4bb667(0x1cd)](_0xc056cd);if(_0xc056cd==_0x6b7c45||_0xc056cd[_0x4bb667(0x1b5)](_0x6b7c45+path[_0x4bb667(0x20e)]))return _0x18c271['app'][_0x4bb667(0x242)](_0x1f9108,_0x1f9108['__'](_0x4bb667(0x199)));if(dbUserTable[_0x4bb667(0x213)](_0x18c271,_0x1f9108,_0x4bb667(0x188),_0x4bb667(0x19c),_0x6b7c45)==!![]){let _0x55492a=![];fs[_0x4bb667(0x226)](_0x6b7c45,(_0x2f266,_0x45990a)=>{const _0x46c6ae=_0x4bb667;if(_0x2f266)return _0x18c271[_0x46c6ae(0x1ca)][_0x46c6ae(0x242)](_0x1f9108,_0x1f9108['__'](_0x46c6ae(0x1f3))+':'+_0x6b7c45);let _0x427d54=path[_0x46c6ae(0x204)](_0x6b7c45);fs[_0x46c6ae(0x230)](_0xc056cd,fs['constants'][_0x46c6ae(0x239)]|fs[_0x46c6ae(0x21f)][_0x46c6ae(0x196)],_0xb69a41=>{const _0x133fde=_0x46c6ae;if(_0xb69a41)return _0x18c271['app'][_0x133fde(0x242)](_0x1f9108,_0x1f9108['__'](_0x133fde(0x1bd))+':'+_0xc056cd);if(_0x11e775==_0x133fde(0x25a))dbUserTable[_0x133fde(0x213)](_0x18c271,_0x1f9108,'folder',_0x133fde(0x1e9),_0xc056cd)==!![]&&(_0xc056cd=path[_0x133fde(0x1cd)](_0xc056cd,_0x402dc2),fs[_0x133fde(0x226)](_0xc056cd,_0x4e9de5=>{const _0x457435=_0x133fde;if(!_0x4e9de5)return _0x18c271[_0x457435(0x1ca)][_0x457435(0x242)](_0x1f9108,_0x1f9108['__'](_0x457435(0x20b))+':'+_0xc056cd);else fs[_0x457435(0x25a)](_0x6b7c45,_0xc056cd,_0x4d6cba=>{const _0x46efbe=_0x457435;if(_0x4d6cba)return dbFileOperationRecord[_0x46efbe(0x24f)](_0x18c271[_0x46efbe(0x1ca)][_0x46efbe(0x197)],{'username':_0x18c271['currentUser'][_0x46efbe(0x1eb)],'sourcePath':_0x6b7c45,'targetPath':_0xc056cd,'level':dbFileOperationRecord[_0x46efbe(0x1a0)],'belongId':null,'type':dbFileOperationRecord['TYPE_RENMAE'],'subType':null,'state':dbFileOperationRecord[_0x46efbe(0x222)],'remark':fileUtil['returnFileError'](_0x1f9108,_0x4d6cba,!![])}),dbNoticeCenterTable[_0x46efbe(0x227)](_0x18c271['app'][_0x46efbe(0x197)],{'title':_0x1f9108['__'](_0x46efbe(0x185)),'level':_0x46efbe(0x263),'content':_0x1f9108['__']('fileRenameFail')+':'+(_0x6b7c45+_0x46efbe(0x1ae)+_0xc056cd)});_0x55492a=!![],dbFileOperationRecord[_0x46efbe(0x24f)](_0x18c271[_0x46efbe(0x1ca)][_0x46efbe(0x197)],{'username':_0x18c271[_0x46efbe(0x215)]['username'],'sourcePath':_0x6b7c45,'targetPath':_0xc056cd,'level':dbFileOperationRecord[_0x46efbe(0x1a0)],'belongId':null,'type':dbFileOperationRecord[_0x46efbe(0x218)],'subType':null,'state':dbFileOperationRecord[_0x46efbe(0x1ef)]});}),setTimeout(()=>{const _0x24658f=_0x457435;return _0x1f9108[_0x24658f(0x1f4)]({'code':0x0,'isOver':_0x55492a?0x1:0x0});},0x3e8);}));else{if(_0x11e775==_0x133fde(0x1c8)){if(dbUserTable[_0x133fde(0x213)](_0x18c271,_0x1f9108,_0x133fde(0x188),_0x133fde(0x1b9),_0xc056cd)!==!![])return;}if(dbUserTable[_0x133fde(0x213)](_0x18c271,_0x1f9108,_0x133fde(0x188),_0x133fde(0x250),_0xc056cd)==!![]){_0xc056cd=path[_0x133fde(0x1cd)](_0xc056cd,_0x427d54);let _0x455e87=_0x41650e(_0x6b7c45,_0xc056cd);return process[_0x133fde(0x189)]({'type':_0x133fde(0x1fc),'taskIdList':[_0x455e87]}),_0x1f9108[_0x133fde(0x1f4)]({'code':0x0});}}});});}}catch(_0x41d4c8){return _0x18c271[_0x4bb667(0x1ca)][_0x4bb667(0x242)](_0x1f9108,_0x1f9108['__']('operationFail'));}}),router[_0x87ea4c(0x232)]('/getPathState',(_0x1c4301,_0x580c60,_0x23705b)=>{const _0x41fbe2=_0x87ea4c;let _0x44b528=_0x1c4301[_0x41fbe2(0x1dc)][_0x41fbe2(0x251)];if(!_0x44b528)return _0x580c60[_0x41fbe2(0x1de)](0x194)[_0x41fbe2(0x22c)]();dbUserTable['doUserCanGet'](_0x1c4301,_0x580c60,_0x41fbe2(0x188),'power_get',_0x44b528)==!![]&&fs['stat'](_0x44b528,(_0x346042,_0x36012b)=>{const _0xbb0077=_0x41fbe2;if(_0x346042)return fileUtil['returnFileError'](_0x580c60,_0x346042);return _0x36012b[_0xbb0077(0x1c1)]=fileUtil[_0xbb0077(0x1b3)](_0x36012b['size']),_0x580c60[_0xbb0077(0x1f4)]({'code':0x0,'data':_0x36012b});});}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1f7),(_0x4aeb36,_0x1ccbdd,_0x48b196)=>{const _0x49297f=_0x87ea4c;let _0x39277e=_0x4aeb36['body'][_0x49297f(0x1be)],_0x1fcc9e=_0x4aeb36[_0x49297f(0x1dc)][_0x49297f(0x1cb)];_0x1fcc9e&&(_0x1fcc9e=_0x1fcc9e[_0x49297f(0x244)](/[<>\\\/:\*\?\"\|]/g,'_')),_0x39277e&&(_0x39277e=fileUtil[_0x49297f(0x219)](_0x39277e)),fs[_0x49297f(0x230)](_0x39277e,fs[_0x49297f(0x21f)][_0x49297f(0x196)]|fs[_0x49297f(0x21f)]['R_OK'],_0x313ee5=>{const _0x1252e2=_0x49297f;if(_0x313ee5)return _0x1ccbdd[_0x1252e2(0x1f4)]({'code':0x1,'message':_0x1ccbdd['__']('noWritePermission')+':'+_0x39277e});else{let _0x21f723='';if(_0x39277e&&_0x1fcc9e)_0x21f723=path[_0x1252e2(0x1cd)](_0x39277e,_0x1fcc9e);else{if(_0x39277e)_0x21f723=path['join'](_0x39277e);else return _0x1ccbdd[_0x1252e2(0x1f4)]({'code':0x1,'message':_0x1ccbdd['__'](_0x1252e2(0x1d7))+':'+_0x39277e});}fs[_0x1252e2(0x226)](_0x21f723,_0x51193b=>{const _0x2a3d02=_0x1252e2;return _0x51193b?(console['log'](_0x2a3d02(0x1cc),_0x21f723),_0x1ccbdd['json']({'code':0x0})):_0x1ccbdd[_0x2a3d02(0x1f4)]({'code':0x1,'remark':'EXIST'});});}});}),router['post'](_0x87ea4c(0x1ff),(_0x2e2c99,_0x10c33c,_0x182a74)=>{const _0x1c6329=_0x87ea4c;let _0x4d0945=_0x2e2c99[_0x1c6329(0x1dc)][_0x1c6329(0x251)],_0x5ac777=_0x2e2c99[_0x1c6329(0x1dc)][_0x1c6329(0x20d)];if(!_0x4d0945)return _0x10c33c['status'](0x194)[_0x1c6329(0x22c)]();_0x4d0945=path[_0x1c6329(0x1cd)](_0x4d0945);if(dbUserTable['doUserCanGet'](_0x2e2c99,_0x10c33c,_0x1c6329(0x188),'power_delete',_0x4d0945)==!![]){if(_0x5ac777==0x1)return process[_0x1c6329(0x189)]({'type':_0x1c6329(0x212),'shellType':_0x1c6329(0x255),'path':_0x4d0945}),dbFileOperationRecord[_0x1c6329(0x24f)](_0x2e2c99[_0x1c6329(0x1ca)][_0x1c6329(0x197)],{'username':_0x2e2c99['currentUser'][_0x1c6329(0x1eb)],'targetPath':_0x4d0945,'level':dbFileOperationRecord[_0x1c6329(0x1a0)],'type':dbFileOperationRecord[_0x1c6329(0x209)],'state':dbFileOperationRecord[_0x1c6329(0x1ef)]}),_0x10c33c[_0x1c6329(0x1f4)]({'code':0x0,'message':_0x10c33c['__'](_0x1c6329(0x243))});else fs['rm'](_0x4d0945,{'recursive':!![]},_0x3b004e=>{const _0x275c8f=_0x1c6329;if(_0x3b004e)return dbFileOperationRecord[_0x275c8f(0x24f)](_0x2e2c99['app'][_0x275c8f(0x197)],{'username':_0x2e2c99[_0x275c8f(0x215)][_0x275c8f(0x1eb)],'targetPath':_0x4d0945,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0x275c8f(0x209)],'state':dbFileOperationRecord['STATE_FAIL'],'remark':fileUtil[_0x275c8f(0x203)](_0x10c33c,_0x3b004e,!![])}),fileUtil[_0x275c8f(0x203)](_0x10c33c,_0x3b004e);return dbFileOperationRecord['addFileOperationRecord'](_0x2e2c99[_0x275c8f(0x1ca)]['dbOther'],{'username':_0x2e2c99['currentUser'][_0x275c8f(0x1eb)],'targetPath':_0x4d0945,'level':dbFileOperationRecord['LEVEL_MAIN_OPERATION'],'type':dbFileOperationRecord[_0x275c8f(0x209)],'state':dbFileOperationRecord[_0x275c8f(0x1ef)]}),_0x10c33c[_0x275c8f(0x1f4)]({'code':0x0,'message':_0x10c33c['__'](_0x275c8f(0x243))});});}}),router['post'](_0x87ea4c(0x1da),(_0x158d49,_0xb03499,_0x57e7dc)=>{const _0x54412d=_0x87ea4c;if(_0x158d49[_0x54412d(0x215)]['is_admin']!=0x1)return _0xb03499[_0x54412d(0x1f4)]({'code':0x66});return dbFileOperationRecord[_0x54412d(0x207)](_0x158d49[_0x54412d(0x1ca)]['dbOther']),_0xb03499[_0x54412d(0x1f4)]({'code':0x0});}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1fe),(_0x44d755,_0xddbf7e,_0x480365)=>{const _0x50d83f=_0x87ea4c;let _0x532541=_0x44d755[_0x50d83f(0x1dc)]['page'],_0x4c9cbf=_0x44d755[_0x50d83f(0x1dc)][_0x50d83f(0x258)],_0x14e179=_0x44d755[_0x50d83f(0x1dc)]['type'],_0x43cf43=_0x44d755[_0x50d83f(0x1dc)][_0x50d83f(0x1a1)],_0x4681ce=_0x44d755[_0x50d83f(0x1dc)]['subType'],_0x8f5195=_0x44d755[_0x50d83f(0x1dc)][_0x50d83f(0x205)],_0xc3752b=_0x44d755['body']['searchStr'],_0x5c34ac;return _0x44d755['currentUser']['is_admin']==0x1?_0x5c34ac=dbFileOperationRecord[_0x50d83f(0x224)](_0x44d755['app'][_0x50d83f(0x197)],_0x532541,_0x4c9cbf,_0x43cf43,_0x14e179,_0x4681ce,_0x8f5195,_0xc3752b):_0x5c34ac=dbFileOperationRecord[_0x50d83f(0x224)](_0x44d755['app'][_0x50d83f(0x197)],_0x532541,_0x4c9cbf,_0x43cf43,_0x14e179,_0x4681ce,_0x8f5195,_0xc3752b,_0x44d755[_0x50d83f(0x215)][_0x50d83f(0x1eb)]),_0xddbf7e[_0x50d83f(0x1f4)]({'code':0x0,'data':_0x5c34ac});}),router[_0x87ea4c(0x232)](_0x87ea4c(0x216),(_0x76b610,_0x58ea9a,_0x44d2f5)=>{const _0x4d4ba6=_0x87ea4c;let _0x1c3ed9=_0x76b610['body'][_0x4d4ba6(0x23f)];if(_0x1c3ed9=='add'||_0x1c3ed9=='delete'){if(_0x76b610['currentUser']['is_admin']!=0x1)return _0x58ea9a[_0x4d4ba6(0x1f4)]({'code':0x66});}if(_0x1c3ed9=='add'){let _0x55ab5f=_0x76b610[_0x4d4ba6(0x1dc)][_0x4d4ba6(0x1af)],_0x503960=_0x76b610['body'][_0x4d4ba6(0x24d)],_0x48e673=_0x76b610['body'][_0x4d4ba6(0x1eb)],_0x5cb223=_0x76b610[_0x4d4ba6(0x1dc)][_0x4d4ba6(0x186)],_0x35e634=_0x76b610[_0x4d4ba6(0x1dc)]['username'],_0x1e3185=_0x76b610[_0x4d4ba6(0x1dc)]['password'],_0x57228d=[_0x4d4ba6(0x22d),_0x4d4ba6(0x208),'samba'];if(!_0x55ab5f||!_0x503960||!_0x57228d[_0x4d4ba6(0x1f0)](_0x55ab5f))return _0x76b610[_0x4d4ba6(0x1ca)][_0x4d4ba6(0x242)](_0x58ea9a,_0x58ea9a['__'](_0x4d4ba6(0x185)));_0x55ab5f=='local'&&fileStatUtil[_0x4d4ba6(0x191)](_0x503960,()=>{const _0x1cd35b=_0x4d4ba6;fileStatUtil[_0x1cd35b(0x1ac)](_0x503960,()=>{const _0x2cfee0=_0x1cd35b,_0x36f09a='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path_mount(type,url,name,username,password,remark)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,?,?,?,?,?)';return _0x76b610['app'][_0x2cfee0(0x197)][_0x2cfee0(0x254)](_0x36f09a)[_0x2cfee0(0x18e)](_0x55ab5f,_0x503960,_0x48e673,_0x35e634,_0x1e3185,_0x5cb223),_0x58ea9a[_0x2cfee0(0x1f4)]({'code':0x0});},()=>{const _0x17b422=_0x1cd35b;return _0x76b610['app'][_0x17b422(0x242)](_0x58ea9a,_0x58ea9a['__'](_0x17b422(0x1f3)));});},()=>{const _0x19ea68=_0x4d4ba6;return _0x76b610[_0x19ea68(0x1ca)][_0x19ea68(0x242)](_0x58ea9a,_0x58ea9a['__']('targetPathInvalid'));});}else{if(_0x1c3ed9==_0x4d4ba6(0x1d5)){let _0x4f4359=_0x76b610['body']['id'];return _0x76b610[_0x4d4ba6(0x1ca)][_0x4d4ba6(0x197)][_0x4d4ba6(0x254)](_0x4d4ba6(0x1c9))[_0x4d4ba6(0x18e)](_0x4f4359),_0x58ea9a[_0x4d4ba6(0x1f4)]({'code':0x0});}else{if(_0x1c3ed9==_0x4d4ba6(0x1f5)){let _0x59d37a=[],_0x376fed=_0x76b610[_0x4d4ba6(0x1ca)][_0x4d4ba6(0x197)][_0x4d4ba6(0x254)](_0x4d4ba6(0x1bb))['all']();if(_0x76b610[_0x4d4ba6(0x215)][_0x4d4ba6(0x19f)]==0x1)_0x59d37a=_0x376fed;else{let _0x1b85c8=dbUserTable[_0x4d4ba6(0x1f8)](_0x76b610[_0x4d4ba6(0x1ca)][_0x4d4ba6(0x197)],_0x76b610[_0x4d4ba6(0x215)][_0x4d4ba6(0x1eb)],_0x4d4ba6(0x188),_0x4d4ba6(0x19c));for(let _0x24c178 in _0x1b85c8){let _0x366f2d=_0x1b85c8[_0x24c178][_0x4d4ba6(0x211)][_0x4d4ba6(0x1e7)]();_0x366f2d=path[_0x4d4ba6(0x1cd)](_0x366f2d);for(let _0x3d42d2 in _0x376fed){try{if(_0x376fed[_0x3d42d2][_0x4d4ba6(0x24d)]&&_0x366f2d){let _0x513849=_0x376fed[_0x3d42d2][_0x4d4ba6(0x24d)]['toLowerCase']();_0x513849[_0x4d4ba6(0x25d)](':')&&_0x513849[_0x4d4ba6(0x19b)]==0x2&&(_0x513849=_0x513849+path[_0x4d4ba6(0x20e)]),_0x513849=path[_0x4d4ba6(0x1cd)](_0x513849)[_0x4d4ba6(0x1e7)](),(_0x366f2d==_0x513849||_0x513849['startsWith'](path[_0x4d4ba6(0x1cd)](_0x366f2d+path[_0x4d4ba6(0x20e)])))&&_0x59d37a[_0x4d4ba6(0x23c)](_0x376fed[_0x3d42d2]);}}catch(_0xe3b4b5){continue;}}}}return _0x58ea9a[_0x4d4ba6(0x1f4)]({'code':0x0,'data':_0x59d37a});}}}});function getRandomString(_0x18d3ec){const _0x3f93d1=_0x87ea4c;let _0x5c79d2='';const _0x50b38c=_0x3f93d1(0x252),_0x2cff48=_0x50b38c[_0x3f93d1(0x19b)];for(let _0x12c436=0x0;_0x12c436<_0x18d3ec;_0x12c436++){_0x5c79d2+=_0x50b38c[_0x3f93d1(0x220)](Math[_0x3f93d1(0x1f2)](Math[_0x3f93d1(0x1b8)]()*_0x2cff48));}return _0x5c79d2;}router[_0x87ea4c(0x232)](_0x87ea4c(0x228),(_0x1c9aaa,_0x141086,_0x2ac5d4)=>{const _0x4a0254=_0x87ea4c;let _0x45c932=[];return _0x1c9aaa['currentUser'][_0x4a0254(0x19f)]==0x1?_0x45c932=_0x1c9aaa[_0x4a0254(0x1ca)][_0x4a0254(0x197)][_0x4a0254(0x254)](_0x4a0254(0x1ed))[_0x4a0254(0x1fa)]():_0x45c932=_0x1c9aaa['app'][_0x4a0254(0x197)]['prepare'](_0x4a0254(0x18f))[_0x4a0254(0x1fa)](_0x1c9aaa[_0x4a0254(0x215)]['id']),_0x141086['json']({'code':0x0,'data':_0x45c932});}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1aa),(_0x5a43dc,_0x53f618,_0x393a6e)=>{const _0x909a6e=_0x87ea4c;let _0x526045=_0x5a43dc[_0x909a6e(0x1dc)][_0x909a6e(0x23f)];if(_0x526045==_0x909a6e(0x21d))try{if(!_0x5a43dc[_0x909a6e(0x1dc)][_0x909a6e(0x211)])return _0x5a43dc['app'][_0x909a6e(0x242)](_0x53f618,_0x909a6e(0x263));let _0x25dc28=fileUtil['decodePath'](_0x5a43dc[_0x909a6e(0x1dc)][_0x909a6e(0x211)]);function _0x56d28b(){const _0x652c19=_0x909a6e;if(dbUserTable[_0x652c19(0x213)](_0x5a43dc,_0x53f618,'',_0x652c19(0x19c),_0x25dc28)==!![]){let _0x25b223=_0x5a43dc['body'][_0x652c19(0x249)]?_0x5a43dc[_0x652c19(0x1dc)][_0x652c19(0x249)]:'',_0xf4d39e=new Date()[_0x652c19(0x18b)](),_0x3002c1=getRandomString(0x5),_0x56def4=_0x5a43dc[_0x652c19(0x1ca)][_0x652c19(0x197)][_0x652c19(0x254)](_0x652c19(0x262))[_0x652c19(0x1f5)](_0x3002c1);if(_0x56def4)return _0x56d28b();let _0x967ba5=_0x5a43dc[_0x652c19(0x1dc)]['days']?_0x5a43dc[_0x652c19(0x1dc)][_0x652c19(0x259)]:0x1e,_0x63345e=0xe10*0x3e8*0x18*_0x967ba5+_0xf4d39e;return _0x5a43dc['app'][_0x652c19(0x197)]['prepare'](_0x652c19(0x1e3))[_0x652c19(0x18e)](_0x25dc28,_0x25b223,_0x3002c1,_0xf4d39e,_0x63345e,_0x5a43dc[_0x652c19(0x215)]['id']),_0x53f618[_0x652c19(0x1f4)]({'code':0x0,'token':_0x3002c1});}}return _0x56d28b();}catch(_0x9718d7){return console[_0x909a6e(0x1ab)](_0x9718d7),_0x5a43dc[_0x909a6e(0x1ca)]['returnErrMsg'](_0x53f618,'error');}else{if(_0x526045==_0x909a6e(0x1d5)){let _0x2e62dc=_0x5a43dc[_0x909a6e(0x1dc)][_0x909a6e(0x21c)];return _0x5a43dc[_0x909a6e(0x215)][_0x909a6e(0x19f)]==0x1?_0x5a43dc['app'][_0x909a6e(0x197)]['prepare'](_0x909a6e(0x1c6))[_0x909a6e(0x18e)](_0x2e62dc):_0x5a43dc[_0x909a6e(0x1ca)][_0x909a6e(0x197)][_0x909a6e(0x254)](_0x909a6e(0x231))[_0x909a6e(0x18e)](_0x2e62dc,_0x5a43dc['currentUser']['id']),_0x53f618['json']({'code':0x0});}}}),router[_0x87ea4c(0x232)](_0x87ea4c(0x1fd),(_0x1c0b57,_0x2bcfe9,_0x3624e6)=>{const _0x407e72=_0x87ea4c;let _0x3a311b=_0x1c0b57['body'][_0x407e72(0x1df)]||_0x1c0b57[_0x407e72(0x1dc)]['st'],_0x4fbeba=_0x1c0b57[_0x407e72(0x1dc)][_0x407e72(0x1ea)],_0x4fcc9e=_0x1c0b57[_0x407e72(0x1dc)][_0x407e72(0x249)],_0x43e62e=[],_0x1b6c05=dbConfigTable['findByTitleArr'](_0x1c0b57[_0x407e72(0x1ca)]['dbOther'],_0x407e72(0x1c2)),_0x2a29cf={'code':0x0,'data':{'customConfig':_0x1b6c05,'parent':_0x4fbeba,'children':_0x43e62e,'sep':path['sep'],'platform':platform}};if(!_0x3a311b)return _0x2bcfe9[_0x407e72(0x1f4)](_0x2a29cf);let _0x390efc=dbUserTable[_0x407e72(0x1db)](_0x1c0b57[_0x407e72(0x1ca)][_0x407e72(0x197)],_0x3a311b);if(!_0x390efc)return _0x2bcfe9[_0x407e72(0x1f4)](_0x2a29cf);if(_0x390efc[_0x407e72(0x249)]){if(!_0x4fcc9e)return _0x2bcfe9[_0x407e72(0x1f4)]({'code':0x2});if(_0x390efc[_0x407e72(0x249)]!=_0x4fcc9e)return _0x2bcfe9[_0x407e72(0x1f4)]({'code':0x2,'message':_0x2bcfe9['__'](_0x407e72(0x1b4))});}function _0x5ecfca(){const _0x528221=_0x407e72;fs['stat'](_0x390efc[_0x528221(0x211)],(_0x5ee43c,_0x5a8411)=>{const _0x19b27d=_0x528221;if(_0x5ee43c)return _0x2bcfe9[_0x19b27d(0x1f4)](_0x2a29cf);return _0x2a29cf[_0x19b27d(0x1bf)][_0x19b27d(0x19d)]['push']({'type':_0x5a8411[_0x19b27d(0x247)]()?0x1:0x2,'name':path[_0x19b27d(0x204)](_0x390efc[_0x19b27d(0x211)]),'fileFullPath':_0x390efc[_0x19b27d(0x211)]}),_0x2bcfe9[_0x19b27d(0x1f4)](_0x2a29cf);});}if(!_0x4fbeba)_0x5ecfca();else{let _0x1f1052=dbUserTable['doUserCanGetTempShare'](_0x1c0b57[_0x407e72(0x1ca)][_0x407e72(0x197)],_0x3a311b,_0x4fbeba,_0x4fcc9e);if(!_0x1f1052)return console[_0x407e72(0x1ab)]('no\x20permission\x20',_0x4fbeba),_0x5ecfca();fs['readdir'](_0x4fbeba,{'withFileTypes':!![]},(_0x214e32,_0xc4d781)=>{const _0x49aa9d=_0x407e72;if(_0x214e32)return _0x2bcfe9[_0x49aa9d(0x1f4)](_0x2a29cf);let _0x4b6401=0x0;if(_0xc4d781['length']<0x1)return _0x2bcfe9[_0x49aa9d(0x1f4)](_0x2a29cf);for(let _0x43a6c6=0x0;_0x43a6c6<_0xc4d781[_0x49aa9d(0x19b)];_0x43a6c6++){let _0x3a1788=_0xc4d781[_0x43a6c6],_0x525bb9=_0xc4d781[_0x43a6c6][_0x49aa9d(0x245)];if(_0x525bb9[_0x49aa9d(0x19b)]>0x0){if(_0x525bb9[0x0]=='.'){_0x4b6401+=0x1;continue;}if(/[A-Z]:\\/i[_0x49aa9d(0x198)](_0x4fbeba)&&_0x4fbeba['length']<=0x3){if(win32ExcludeList[_0x49aa9d(0x1f0)](_0x525bb9)||_0x525bb9[_0x49aa9d(0x25d)](_0x49aa9d(0x194))||_0x525bb9['endsWith'](_0x49aa9d(0x221))){_0x4b6401+=0x1;continue;}}}let _0x208b9a=path[_0x49aa9d(0x1cd)](_0x4fbeba,_0x525bb9);fs[_0x49aa9d(0x226)](_0x208b9a,(_0x50b6b2,_0x145b65)=>{const _0x160c84=_0x49aa9d;_0x4b6401+=0x1;let _0x3424f1=_0x3a1788[_0x160c84(0x247)](),_0x52817c=_0x3a1788[_0x160c84(0x19e)](),_0x5b2926={'name':_0x525bb9,'fileFullPath':_0x208b9a};!_0x50b6b2&&_0x145b65&&(_0x5b2926[_0x160c84(0x22a)]=_0x145b65[_0x160c84(0x22a)],_0x5b2926[_0x160c84(0x24a)]=_0x145b65['birthtimeMs']||_0x145b65[_0x160c84(0x1ee)]);_0x3424f1?_0x5b2926[_0x160c84(0x1af)]=0x1:_0x5b2926['type']=0x2;_0x2a29cf[_0x160c84(0x1bf)]['children'][_0x160c84(0x23c)](_0x5b2926);if(_0x4b6401>=_0xc4d781[_0x160c84(0x19b)])return _0x2bcfe9[_0x160c84(0x1f4)](_0x2a29cf);});}});}}),module[_0x87ea4c(0x18d)]=router;function _0x28d8(){const _0x94dc6b=['isFile','archiver','password','createTime','env','read','url','unpipe','addFileOperationRecord','power_add','fullPath','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','../../utils/globalInfoUtil','prepare','trash','existsSync','directory','pageSize','days','rename','fileFullPath','getWindowsDiskList','endsWith','attachment;\x20filename*=UTF-8\x27\x27','getUtf8FileStream','zip\x20finish','INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)','SELECT\x20*\x20FROM\x20share_temp\x20WHERE\x20token=?','error','folderName','/getPathTree','raw','An\x20error\x20occurred\x20while\x20compressing\x20the\x20files.','Downloads','localeCompare','operationFail','pathName','destroy','folder','send','getExcludePathList','getTime','Unable\x20to\x20read\x20file','exports','run','SELECT\x20*\x20FROM\x20share_temp\x20where\x20user_id=?','sort','localPathIsFolder','.zip','sharp','.sys','/Users','W_OK','dbOther','test','cannotCopyToSelf','sha256','length','power_get','children','isDirectory','is_admin','LEVEL_MAIN_OPERATION','level','$RECYCLE.BIN','sourceFolderBook','zip\x20error','20604843FyVvOT','$WinREAgent','book','cwd','5011840VHBJLI','/tempShare','log','localPathIsReadable','Content-Disposition','\x20->\x20','type','/operationFileList','sourceFolderMovie','photo','getTransSizeStr','login.pwdErr','startsWith','extname','quality','random','power_delete','birthtimeMs','select\x20id,type,url,name,remark\x20from\x20path_mount','mtimeMs','noWritePermission','folderPath','data','returnDealedFile','sizeStr','(\x27customLogoImage\x27,\x27customHomeBgImage\x27)','removeHeader','sourcePath','value','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?','finalize','cut','delete\x20from\x20path_mount\x20where\x20id=?','app','fileName','err','join','findByTitle','userDataFolder','../../db/dbNoticeCenterTable','/addNewFolder','An\x20error\x20occurred\x20while\x20reading\x20the\x20directory.','../utils/fileUtils','FILE_OPERATION','delete','music','folderNotExist','pipe','custom','/clearOperationRecord','getTempShareObj','body','write','status','shareToken','query','181954TRSUIE','searchStr','INSERT\x20INTO\x20share_temp(path,password,token,create_timestamp,end_timestamp,user_id)\x20VALUES(?,?,?,?,?,?)','close','copy','/zipFile/*','toLowerCase','append','power_change','parent','username','8356782mneOHz','SELECT\x20*\x20FROM\x20share_temp','ctimeMs','STATE_SUC','includes','getPathByType','floor','noReadPermission','json','get','checkPower','/fileExist','getUserPower','stringify','all','sourceFolderMusic','START_WORKER_FILE_OPERATION','/getTempShareFiles','/getOperationRecord','/deleteByPath','/customImageFile','res\x20closed,destroy\x20zip\x20stream','lastInsertRowid','returnFileError','basename','result','headersSent','deleteFileRecordAll','webdav','TYPE_DELETE','movie','sameNameFileAlreadExist','../utils/sharpUtils','putInSystemTrash','sep','checkPath','../../db/dbConfigTable','path','shell','doUserCanGet','sendFile','currentUser','/operationPathMount','../../db/dbSourceFolderTable','TYPE_RENMAE','decodePath','/zipFile','4555468eSIxlP','deleteId','add','unzip','constants','charAt','.tmp','STATE_FAIL','toUpperCase','getByPage','cachePathRoot','stat','create','/getTempShare','Documents\x20and\x20Settings','size','PerfLogs','end','local','3lglPgb','root','access','DELETE\x20FROM\x20share_temp\x20WHERE\x20id\x20=\x20?\x20and\x20user_id=?','post','Documents','4rVvFxm','../../db/dbUserTable','/operationFolder','atimeMs','sourcePathList','R_OK','stack','targetPath','push','USER','zip','operationType','parse','6754083zcCmro','returnErrMsg','deleteSuccess','replace','name','5134025TaXUAf'];_0x28d8=function(){return _0x94dc6b;};return _0x28d8();}