function _0x5637(_0x1bd335,_0x4bd4d9){const _0x423795=_0x4237();return _0x5637=function(_0x5637e5,_0x133ec7){_0x5637e5=_0x5637e5-0x18a;let _0x2ba824=_0x423795[_0x5637e5];return _0x2ba824;},_0x5637(_0x1bd335,_0x4bd4d9);}const _0x236900=_0x5637;(function(_0x3a0a69,_0x44556a){const _0x3b1354=_0x5637,_0x1aa795=_0x3a0a69();while(!![]){try{const _0x5a3ce2=-parseInt(_0x3b1354(0x218))/0x1*(-parseInt(_0x3b1354(0x1a6))/0x2)+-parseInt(_0x3b1354(0x1bb))/0x3*(-parseInt(_0x3b1354(0x1a9))/0x4)+-parseInt(_0x3b1354(0x193))/0x5+-parseInt(_0x3b1354(0x196))/0x6+parseInt(_0x3b1354(0x1e6))/0x7*(parseInt(_0x3b1354(0x1f8))/0x8)+parseInt(_0x3b1354(0x1b1))/0x9+parseInt(_0x3b1354(0x1d8))/0xa*(parseInt(_0x3b1354(0x1e2))/0xb);if(_0x5a3ce2===_0x44556a)break;else _0x1aa795['push'](_0x1aa795['shift']());}catch(_0x1f8911){_0x1aa795['push'](_0x1aa795['shift']());}}}(_0x4237,0xe0182));let express=require(_0x236900(0x1ba)),router=express[_0x236900(0x1b9)](),path=require(_0x236900(0x1d1)),fs=require('fs'),dbBookIndexTable=require('../../db/dbBookIndexTable'),dbFileIndexTable=require(_0x236900(0x1fc)),dbBookListTable=require(_0x236900(0x19e)),dbBookFavorite=require(_0x236900(0x249));const dbUserTable=require(_0x236900(0x238)),dbSourceFolderTable=require(_0x236900(0x1ac));function _0x4237(){const _0x18f059=['genre','1iCwIQj','recentReadList','.jpg','groupField','comicList','UPDATE\x20book_read_record\x20SET\x20progress=?,read_time=?\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?','log','removeBookList','prepare','replace','coverData','power_delete',',f.artist\x20','/setBookType','basename','exports','username','run','封面文件已删除','/bookFavorite','UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?','offset','check_time','configJson','UPDATE\x20book_reader_config\x20SET\x20remark=?\x20WHERE\x20uid=?','letterIndex','filePath','\x20FROM\x20file_index_book\x20WHERE\x20','getTime','returnErrMsg','/getBookDetail','remark','../../db/dbUserTable','lastIndexOf','doUserCanGet','operation','catch','index\x20id\x20error','fileName','addFavorite','bookIndexId','getUserPathWhere','currentUser','status','book_path','title','/refreshCheckTime','exist','tag','../../db/dbBookFavorite','getAllFavoriteByWhere','bookListId','platform','getBookListBookCount','file_cover_path','/getBookIndexFileTree','push','SELECT\x20id\x20from\x20file_index_book\x20where\x20is_file=1\x20and\x20path\x20=?\x20or\x20path\x20like\x20?','update','/operationBookListIndex','bookIsFavorite','extname','updateBook','sep','need\x20type/indexId','publisher','7446140hvijOM','need\x20type','INDEX_TABLE_NAME_BOOK','9782958WRVJwg','app','length','getBookListCount','get','isbn','getMediaCoverCachePath','dbOther','../../db/dbBookListTable','name','getBooklistCover','bookList','birthtime','NO\x20book\x20INDEX','fileExist','/getBookCover','1697598tgnPIZ','sharpWriteCover','book_filename','347948tpGMGw','addBookToBookList','need\x20\x27name\x27','../../db/dbSourceFolderTable','then','\x20order\x20by\x20f.','dbFileIndex','book','4848921zXzMaz','orderField','updateByFiled','checkOrderParams','updateBookList','delete','../../myConfig/config','favorite_time','Router','express','15buFZmC','substring','\x20AND\x20(filename_fl\x20=?\x20or\x20title_fl=?\x20)','cover_path','count','removeBookFromList','power_change','indexId','need\x20bookIndexId','error','parent','UPDATE\x20book_reader_config\x20SET\x20config_json=?\x20WHERE\x20uid=?','is_admin','getFavorite','all','/setReaderConfig','type','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20title\x20\x20LIKE\x20?)\x20','searchStr','favorite','SELECT\x20','add','path','\x20order\x20by\x20f.artist_fl\x20','getById','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_size=?','deleteFavorite','runGetBookInfoWorker','publish_date','1173580VfJKUl','orderField/orderType\x20error','book_count','end','need\x20index\x20id','getBookListById','nfo写入成功','power_get','封面写入成功','createBookList','187uXdTEP','year','\x20is_file=1','cover\x20format\x20error','7CsbZRi','filename','operation\x20error','orderType','folderNotExist','artist','need\x20config\x20json','asc','includes','sendFile','fileCount','../../utils/nfoUtil','getFavoriteCount',',f.filename_fl\x20','post','search','language','sortFileNamesByNumber','1760176WqhFLm','getBookList','\x20id,is_file,id,path,filename,type,size,title,artist,ext,cover_path,language,publisher,total_page,type,check_time,create_time','progress','../../db/dbFileIndexTable','REPLACE\x20INTO\x20book_read_record\x20(uid,book_filename,book_path,progress,read_time)\x20VALUES(?,?,?,?,?)','book\x20not\x20exist','recentAddList','body','bookListId\x20no\x20exists','getBookListList','desc','json','SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid\x20=\x20?','../../myWorkers/index/bookIndexUtil','\x20order\x20by\x20m.update_time\x20','endsWith','edit','.nfo','size','join','../../utils/arrayUtil','now','\x20LIMIT\x20?\x20OFFSET\x20?\x20','\x20order\x20by\x20f.title_fl\x20','stat','/getGroupList','list','\x20order\x20by\x20m.update_time\x20DESC\x20','getBookIndex','is_file'];_0x4237=function(){return _0x18f059;};return _0x4237();}let os=require('os'),config=require(_0x236900(0x1b7));const bookIndexUtil=require(_0x236900(0x206)),arrayUtil=require(_0x236900(0x20d)),nfoUtil=require(_0x236900(0x1f1));function getBookSameNameCover(_0x3096e3){return new Promise((_0x3c64e5,_0x5af6fb)=>{const _0x1624af=_0x5637;try{let _0x34c6cb=_0x3096e3['filename'][_0x1624af(0x221)](path[_0x1624af(0x18e)](_0x3096e3[_0x1624af(0x1e7)]),''),_0x53c1a5=path[_0x1624af(0x20c)](_0x3096e3['path'],_0x34c6cb+'.jpg'),_0x1d5cd6='';fs['existsSync'](_0x53c1a5)&&(_0x1d5cd6=_0x53c1a5),_0x3c64e5(_0x1d5cd6);}catch(_0x1b6ab7){_0x3c64e5('');}});}router['post'](_0x236900(0x1ca),(_0x399510,_0x6b776e,_0x25faed)=>{const _0x4e3cb4=_0x236900;let _0x295b5b=_0x399510['currentUser']['id'],_0x2be23f=_0x399510[_0x4e3cb4(0x200)][_0x4e3cb4(0x22f)],_0xcf27dc=_0x399510['body'][_0x4e3cb4(0x237)];if(!_0x2be23f&&!_0xcf27dc)return _0x399510[_0x4e3cb4(0x197)][_0x4e3cb4(0x235)](_0x6b776e,_0x4e3cb4(0x1ec));try{JSON['parse'](_0x2be23f);}catch(_0x91eced){return _0x399510[_0x4e3cb4(0x197)]['returnErrMsg'](_0x6b776e,'config\x20json\x20format\x20error');}let _0x45a181=_0x399510[_0x4e3cb4(0x197)]['dbOther'][_0x4e3cb4(0x220)]('SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid=?')['get'](_0x295b5b);if(_0x45a181){if(_0x2be23f)_0x399510[_0x4e3cb4(0x197)][_0x4e3cb4(0x19d)][_0x4e3cb4(0x220)](_0x4e3cb4(0x1c6))[_0x4e3cb4(0x229)](_0x2be23f,_0x295b5b);else _0xcf27dc&&_0x399510[_0x4e3cb4(0x197)][_0x4e3cb4(0x19d)][_0x4e3cb4(0x220)](_0x4e3cb4(0x230))['run'](_0xcf27dc,_0x295b5b);}else _0x399510[_0x4e3cb4(0x197)][_0x4e3cb4(0x19d)][_0x4e3cb4(0x220)]('REPLACE\x20INTO\x20book_reader_config\x20(uid,config_json,remark)\x20VALUES(?,?,?)')[_0x4e3cb4(0x229)](_0x295b5b,_0x2be23f,_0xcf27dc);return _0x6b776e[_0x4e3cb4(0x204)]({'code':0x0});}),router[_0x236900(0x1f4)]('/deleteSameNameCover',(_0x177b8b,_0x8fac83,_0x33d0fc)=>{const _0x2051c7=_0x236900;let _0x4e79d2=_0x177b8b[_0x2051c7(0x242)]['id'],_0x265c32=_0x177b8b[_0x2051c7(0x200)]['bookIndexId'];if(!_0x265c32)return _0x177b8b['app'][_0x2051c7(0x235)](_0x8fac83,_0x2051c7(0x1c3));let _0x2d7df0=dbFileIndexTable[_0x2051c7(0x1d3)](_0x177b8b[_0x2051c7(0x197)]['dbFileIndex'],_0x265c32,dbFileIndexTable[_0x2051c7(0x195)]);if(!_0x2d7df0)return _0x177b8b[_0x2051c7(0x197)][_0x2051c7(0x235)](_0x8fac83,_0x2051c7(0x1c3));dbUserTable[_0x2051c7(0x23a)](_0x177b8b,_0x8fac83,'',_0x2051c7(0x223),_0x2d7df0[_0x2051c7(0x1d1)])==!![]&&getBookSameNameCover(_0x2d7df0)['then'](_0x469e96=>{const _0x3c00c0=_0x2051c7;if(!_0x469e96[_0x3c00c0(0x208)](_0x3c00c0(0x21a)))return _0x177b8b['app'][_0x3c00c0(0x235)](_0x8fac83,_0x3c00c0(0x1e5));fs[_0x3c00c0(0x211)](_0x469e96,(_0x5d858c,_0x3f59e6)=>{const _0xe0b56c=_0x3c00c0;if(_0x5d858c)return console[_0xe0b56c(0x21e)]('封面文件已不存在'),_0x8fac83[_0xe0b56c(0x204)]({'code':0x0});fs['rm'](_0x469e96,_0x28f3d3=>{const _0x57b69f=_0xe0b56c;if(_0x28f3d3)return _0x177b8b['app'][_0x57b69f(0x235)](_0x8fac83,_0x8fac83['__']('deleteFail')+_0x469e96);return console[_0x57b69f(0x21e)](_0x57b69f(0x22a),_0x469e96),_0x8fac83[_0x57b69f(0x204)]({'code':0x0});});});});}),router['post'](_0x236900(0x246),(_0x37af2d,_0xe75c0b,_0x358408)=>{const _0x3ecb66=_0x236900;let _0xa7f8a0=_0x37af2d[_0x3ecb66(0x242)]['id'],_0x1e61d7=_0x37af2d[_0x3ecb66(0x200)][_0x3ecb66(0x240)];if(!_0x1e61d7)return _0xe75c0b[_0x3ecb66(0x243)](0x194)[_0x3ecb66(0x1db)]();return dbBookIndexTable[_0x3ecb66(0x1b3)](_0x37af2d[_0x3ecb66(0x197)]['dbFileIndex'],_0x1e61d7,_0x3ecb66(0x22e),new Date()[_0x3ecb66(0x234)]()),_0xe75c0b[_0x3ecb66(0x204)]({'code':0x0});}),router[_0x236900(0x1f4)]('/addReadRecord',(_0x2a1a97,_0x21b261,_0x1bbbe5)=>{const _0x2b77b4=_0x236900;let _0x343e39=_0x2a1a97[_0x2b77b4(0x242)]['id'];if(!_0x2a1a97[_0x2b77b4(0x200)][_0x2b77b4(0x23e)]||!_0x2a1a97[_0x2b77b4(0x200)][_0x2b77b4(0x232)]||!_0x2a1a97['body']['progress'])return _0x21b261[_0x2b77b4(0x204)]({'code':0x0});let _0x5d71f6=_0x2a1a97[_0x2b77b4(0x200)][_0x2b77b4(0x23e)];_0x5d71f6=path['basename'](_0x2a1a97[_0x2b77b4(0x200)]['fileName']);let _0x458f4b=path[_0x2b77b4(0x20c)](_0x2a1a97[_0x2b77b4(0x200)][_0x2b77b4(0x232)]),_0x411e2e=_0x2a1a97[_0x2b77b4(0x200)][_0x2b77b4(0x1fb)],_0x168206=_0x2a1a97['app'][_0x2b77b4(0x1af)]['prepare']('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')[_0x2b77b4(0x19a)](_0x343e39,_0x5d71f6,_0x458f4b);return _0x168206?_0x2a1a97[_0x2b77b4(0x197)][_0x2b77b4(0x1af)][_0x2b77b4(0x220)](_0x2b77b4(0x21d))['run'](_0x411e2e,Date['now'](),_0x343e39,_0x5d71f6,_0x458f4b):_0x2a1a97['app'][_0x2b77b4(0x1af)][_0x2b77b4(0x220)](_0x2b77b4(0x1fd))['run'](_0x343e39,_0x5d71f6,_0x458f4b,_0x411e2e,Date[_0x2b77b4(0x20e)]()),_0x21b261['json']({'code':0x0});}),router[_0x236900(0x1f4)]('/getReadRecord',(_0x32b6c5,_0x51eb04,_0x11f1f9)=>{const _0x2c5ab5=_0x236900;let _0x816d2f=_0x32b6c5[_0x2c5ab5(0x242)]['id'],_0x35f17e=_0x32b6c5[_0x2c5ab5(0x197)][_0x2c5ab5(0x19d)][_0x2c5ab5(0x220)](_0x2c5ab5(0x205))[_0x2c5ab5(0x19a)](_0x816d2f),_0x4ce1b4=0x0,_0x28a524=_0x32b6c5[_0x2c5ab5(0x200)][_0x2c5ab5(0x23e)],_0x106fc2=_0x32b6c5['body'][_0x2c5ab5(0x232)];if(_0x28a524&&_0x106fc2){_0x106fc2=path['join'](_0x106fc2+'');let _0x4e22a2=_0x32b6c5[_0x2c5ab5(0x197)][_0x2c5ab5(0x1af)][_0x2c5ab5(0x220)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')[_0x2c5ab5(0x19a)](_0x816d2f,_0x28a524,_0x106fc2);_0x4e22a2&&(_0x4ce1b4=_0x4e22a2[_0x2c5ab5(0x1fb)]);}return _0x51eb04['json']({'code':0x0,'progress':_0x4ce1b4,'readerConfig':_0x35f17e});}),router[_0x236900(0x1f4)](_0x236900(0x225),(_0x24f6dd,_0xe0069,_0x223af1)=>{const _0x5daa85=_0x236900;let _0x5713b0=_0x24f6dd[_0x5daa85(0x200)][_0x5daa85(0x1c2)],_0x137014=_0x24f6dd[_0x5daa85(0x200)][_0x5daa85(0x1cb)];if(!_0x137014||!_0x5713b0)return _0x24f6dd[_0x5daa85(0x197)]['returnErrMsg'](_0xe0069,_0x5daa85(0x191));if(_0x137014!=0x1&&_0x137014!=0x2)return _0x24f6dd[_0x5daa85(0x197)]['returnErrMsg'](_0xe0069,_0x5daa85(0x194));let _0x3e70a8=dbBookIndexTable[_0x5daa85(0x215)](_0x24f6dd[_0x5daa85(0x197)][_0x5daa85(0x1af)],_0x5713b0);if(!_0x3e70a8)return _0x24f6dd['app'][_0x5daa85(0x235)](_0xe0069,_0x5daa85(0x1fe));if(dbUserTable[_0x5daa85(0x23a)](_0x24f6dd,_0xe0069,_0x5daa85(0x1b0),_0x5daa85(0x1c1),_0x3e70a8[_0x5daa85(0x1d1)])==!![])return dbBookIndexTable['updateByFiled'](_0x24f6dd[_0x5daa85(0x197)][_0x5daa85(0x1af)],_0x5713b0,_0x5daa85(0x1cb),_0x137014),_0xe0069[_0x5daa85(0x204)]({'code':0x0});});function getListByParams(_0xbe4013,_0x120ac7,_0x42c2de,_0x83f3b0,_0x5cf7ce,_0x1cf2c1,_0x3f98ca,_0x43d0de,_0x5e1adc,_0x3f57e7,_0x3c18d9,_0x540bdf,_0x8b71a8){return new Promise((_0x186161,_0x439a64)=>{const _0x59f84c=_0x5637;let _0x2b6a9d=_0xbe4013[_0x59f84c(0x197)]['dbFileIndex'],_0xabf1f2=[];if(_0x83f3b0=='list'||_0x83f3b0==_0x59f84c(0x1a1))_0xabf1f2=dbBookIndexTable[_0x59f84c(0x1f9)](_0x2b6a9d,_0x42c2de,_0x5cf7ce,_0x1cf2c1,_0x3f98ca,_0x43d0de,_0x5e1adc,_0x3c18d9,_0x3f57e7,_0x540bdf,_0x8b71a8);else{if(_0x83f3b0=='favorite'){let _0x4abab9='',_0x26ce9d=[];_0x4abab9+=_0x59f84c(0x1e4);_0x3f57e7&&(_0x3f57e7=_0x3f57e7['replace']('\x27','')[_0x59f84c(0x221)]('’',''),_0x4abab9+='\x20AND\x20(filename\x20like\x20?\x20\x20OR\x20title\x20\x20like\x20?\x20OR\x20artist\x20like\x20?\x20OR\x20tag\x20like\x20?\x20OR\x20publisher\x20like\x20?\x20OR\x20isbn\x20like\x20?\x20OR\x20genre\x20like\x20?\x20OR\x20year\x20like\x20?)',_0x26ce9d[_0x59f84c(0x250)]('%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%','%'+_0x3f57e7+'%'));_0x540bdf&&(_0x4abab9+=_0x59f84c(0x1bd),_0x26ce9d[_0x59f84c(0x250)](_0x540bdf,_0x540bdf));if(_0x3f98ca&&_0x43d0de){if(_0x3f98ca==_0x59f84c(0x1eb))_0x4abab9+=_0x59f84c(0x1d2)+_0x43d0de+_0x59f84c(0x224)+_0x43d0de+'\x20';else{if(_0x3f98ca==_0x59f84c(0x245))_0x4abab9+=_0x59f84c(0x210)+_0x43d0de+',f.title\x20'+_0x43d0de+_0x59f84c(0x1f3)+_0x43d0de+'\x20';else _0x3f98ca==_0x59f84c(0x1b8)?_0x4abab9+=_0x59f84c(0x207)+_0x43d0de+'\x20':_0x4abab9+=_0x59f84c(0x1ae)+_0x3f98ca+'\x20'+_0x43d0de+'\x20';}}else _0x4abab9+=_0x59f84c(0x214);_0x4abab9+=_0x59f84c(0x20f),_0x26ce9d['push'](_0x5cf7ce),_0x26ce9d[_0x59f84c(0x250)](_0x1cf2c1),_0xabf1f2=dbBookFavorite[_0x59f84c(0x24a)](_0xbe4013[_0x59f84c(0x197)]['dbFileIndex'],_0xbe4013['currentUser']['id'],_0x4abab9,'*',_0x26ce9d);}}setBookListProps(_0xbe4013,_0xabf1f2)[_0x59f84c(0x1ad)](_0x4b9de7=>{_0x186161(_0x4b9de7);});});}function setBookListProps(_0x88bd01,_0x33294e){return new Promise(async(_0xdadae,_0x522c74)=>{const _0x75f2d=_0x5637;for(let _0x11db38 of _0x33294e){_0x11db38['favorite']=dbBookFavorite[_0x75f2d(0x18d)](_0x88bd01[_0x75f2d(0x197)]['dbFileIndex'],_0x11db38['id'],_0x88bd01['currentUser']['id'])?'1':'0',_0x11db38['filePath']=path['join'](_0x11db38['path'],_0x11db38[_0x75f2d(0x1e7)]),_0x11db38[_0x75f2d(0x24e)]=await getBookSameNameCover(_0x11db38);}_0xdadae(_0x33294e);});}router[_0x236900(0x1f4)]('/getHomeData',(_0x5352cf,_0x5e2c8b,_0x31435f)=>{const _0x4d2b9c=_0x236900;let _0x292b27=_0x5352cf['body'][_0x4d2b9c(0x1bf)]?_0x5352cf[_0x4d2b9c(0x200)][_0x4d2b9c(0x1bf)]:0xc,_0x8cd5=_0x5352cf[_0x4d2b9c(0x242)]['id'],_0x4220ab=dbUserTable[_0x4d2b9c(0x241)](_0x5352cf,_0x4d2b9c(0x1b0),_0x4d2b9c(0x1df),!![]);if(_0x5352cf[_0x4d2b9c(0x242)][_0x4d2b9c(0x1c7)]!=0x1&&!_0x4220ab)return _0x5e2c8b[_0x4d2b9c(0x204)]({'code':0x0,'data':null});let _0x232630=[],_0x1422e8=_0x5352cf[_0x4d2b9c(0x197)]['dbFileIndex'][_0x4d2b9c(0x220)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20ORDER\x20BY\x20read_time\x20desc\x20LIMIT\x20?')[_0x4d2b9c(0x1c9)](_0x8cd5,_0x292b27);for(let _0xdda2f9 of _0x1422e8){let _0x18509e=dbBookIndexTable['getBookIndexByFileName'](_0x5352cf[_0x4d2b9c(0x197)]['dbFileIndex'],_0xdda2f9[_0x4d2b9c(0x244)],_0xdda2f9[_0x4d2b9c(0x1a8)]);_0x18509e&&dbUserTable[_0x4d2b9c(0x23a)](_0x5352cf,_0x5e2c8b,_0x4d2b9c(0x1b0),'power_get',_0x18509e[_0x4d2b9c(0x1d1)],!![])==!![]&&(_0x18509e['progress']=_0xdda2f9[_0x4d2b9c(0x1fb)],_0x232630[_0x4d2b9c(0x250)](_0x18509e));}setBookListProps(_0x5352cf,_0x232630)[_0x4d2b9c(0x1ad)](_0xa0137=>{const _0x274a3e=_0x4d2b9c;_0x232630=_0xa0137,getListByParams(_0x5352cf,_0x5e2c8b,_0x4220ab,_0x274a3e(0x213),_0x292b27,0x0,_0x274a3e(0x22e),_0x274a3e(0x203),null,null,null,null,0x1)['then'](_0x2ea325=>{const _0x33dece=_0x274a3e;getListByParams(_0x5352cf,_0x5e2c8b,_0x4220ab,_0x33dece(0x213),_0x292b27,0x0,_0x33dece(0x22e),'desc',null,null,null,null,0x2)[_0x33dece(0x1ad)](_0x1be7b0=>{getListByParams(_0x5352cf,_0x5e2c8b,_0x4220ab,'list',_0x292b27,0x0,'id','desc')['then'](_0x261ef0=>{const _0x103217=_0x5637;let _0x2aafc0={};return _0x232630&&_0x232630['length']>0x0&&(_0x2aafc0[_0x103217(0x219)]=_0x232630),_0x261ef0&&_0x261ef0['length']>0x0&&(_0x2aafc0[_0x103217(0x1ff)]=_0x261ef0),_0x2ea325&&_0x2ea325[_0x103217(0x198)]>0x0&&(_0x2aafc0[_0x103217(0x1a1)]=_0x2ea325),_0x1be7b0&&_0x1be7b0[_0x103217(0x198)]>0x0&&(_0x2aafc0[_0x103217(0x21c)]=_0x1be7b0),_0x5e2c8b['json']({'code':0x0,'data':_0x2aafc0,'platform':os[_0x103217(0x24c)]()});});});});});}),router[_0x236900(0x1f4)]('/getBookList',(_0x48276c,_0x5aec7c,_0x377b38)=>{const _0x56a8d8=_0x236900;let _0x9dec5b=_0x48276c[_0x56a8d8(0x200)]['count']||0x32,_0x68416d=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x22d)]||0x0,_0x294c2e=_0x48276c['body']['artist'],_0x6b8bfd=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x1b2)]||_0x56a8d8(0x22e),_0x2bc1df=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x1e9)]||'desc',_0x256d7c=[_0x56a8d8(0x213),_0x56a8d8(0x1ce),_0x56a8d8(0x1a1)],_0x4acb68=_0x48276c['body']['listType']||_0x56a8d8(0x213),_0x45a7cf=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x1f5)],_0x3416ca=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x231)],_0x4334c9=_0x48276c['body'][_0x56a8d8(0x24b)],_0x5e8d34=_0x48276c[_0x56a8d8(0x200)][_0x56a8d8(0x1cb)];if(dbBookIndexTable['checkOrderParams'](_0x48276c,_0x5aec7c,_0x6b8bfd,_0x2bc1df)!==!![])return;if(_0x4acb68=='bookList'){if(!_0x4334c9)return _0x48276c[_0x56a8d8(0x197)][_0x56a8d8(0x235)](_0x5aec7c,'need\x20bookListId');}!_0x256d7c[_0x56a8d8(0x1ee)](_0x4acb68)&&(_0x4acb68='list');_0x9dec5b>0x1f4&&(_0x9dec5b=0x1f4);let _0x5c70da=dbUserTable[_0x56a8d8(0x241)](_0x48276c,'book',_0x56a8d8(0x1df),!![]);if(_0x48276c[_0x56a8d8(0x242)][_0x56a8d8(0x1c7)]!=0x1&&!_0x5c70da)return _0x5aec7c[_0x56a8d8(0x204)]({'code':0x0,'data':null});getListByParams(_0x48276c,_0x5aec7c,_0x5c70da,_0x4acb68,_0x9dec5b,_0x68416d,_0x6b8bfd,_0x2bc1df,_0x294c2e,_0x45a7cf,_0x4334c9,_0x3416ca,_0x5e8d34)[_0x56a8d8(0x1ad)](_0x36c1fb=>{const _0x10290e=_0x56a8d8;let _0x4923bd={'code':0x0,'data':_0x36c1fb};if(_0x4acb68==_0x10290e(0x1ce))_0x4923bd[_0x10290e(0x1da)]=dbBookFavorite[_0x10290e(0x1f2)](_0x48276c['app'][_0x10290e(0x1af)],_0x48276c[_0x10290e(0x242)]['id']);else{if(_0x4acb68==_0x10290e(0x213))_0x4923bd['book_count']=dbBookIndexTable[_0x10290e(0x199)](_0x48276c[_0x10290e(0x197)][_0x10290e(0x1af)],_0x5c70da,_0x294c2e,_0x45a7cf,_0x5e8d34);else _0x4acb68==_0x10290e(0x1a1)&&(_0x4923bd[_0x10290e(0x1da)]=dbBookListTable[_0x10290e(0x24d)](_0x48276c[_0x10290e(0x197)]['dbFileIndex'],_0x4334c9));}return _0x5aec7c[_0x10290e(0x204)](_0x4923bd);});}),router[_0x236900(0x1f4)](_0x236900(0x236),(_0x2d46ff,_0x567458,_0x5dc3c3)=>{const _0x45e4ca=_0x236900;let _0x2a978c=_0x2d46ff['body']['id'],_0x5381a3=dbFileIndexTable[_0x45e4ca(0x1d3)](_0x2d46ff[_0x45e4ca(0x197)]['dbFileIndex'],_0x2a978c,dbFileIndexTable[_0x45e4ca(0x195)]);if(!_0x5381a3)return _0x2d46ff[_0x45e4ca(0x197)][_0x45e4ca(0x235)](_0x567458,_0x45e4ca(0x1a3));if(dbUserTable[_0x45e4ca(0x23a)](_0x2d46ff,_0x567458,'book',_0x45e4ca(0x1df),_0x5381a3[_0x45e4ca(0x1d1)])==!![]){let _0x524b67=_0x2d46ff[_0x45e4ca(0x242)]['id'],_0x40c6a1=dbBookFavorite[_0x45e4ca(0x1c8)](_0x2d46ff['app'][_0x45e4ca(0x1af)],_0x524b67,_0x2a978c);_0x5381a3['favorite']=_0x40c6a1?0x1:0x0,_0x5381a3[_0x45e4ca(0x232)]=path[_0x45e4ca(0x20c)](_0x5381a3['path'],_0x5381a3['filename']);let _0x20f0a6=dbBookIndexTable['getBookListByPath'](_0x2d46ff['app'][_0x45e4ca(0x1af)],_0x5381a3['path']);_0x20f0a6['length']>0x0?(_0x20f0a6=arrayUtil[_0x45e4ca(0x1f7)](_0x20f0a6,_0x45e4ca(0x1e7)),setBookListProps(_0x2d46ff,_0x20f0a6)[_0x45e4ca(0x1ad)](_0x267249=>{_0x20f0a6=_0x267249,_0x2f8105();})):_0x2f8105;function _0x2f8105(){const _0x2a72f2=_0x45e4ca;let _0x7e8b27={'code':0x0,'data':_0x5381a3,'sameFolderBookList':_0x20f0a6};getBookSameNameCover(_0x5381a3)[_0x2a72f2(0x1ad)](_0x3889f3=>{const _0x3c8304=_0x2a72f2;_0x5381a3[_0x3c8304(0x24e)]=_0x3889f3;let _0x1a376d=_0x2d46ff[_0x3c8304(0x197)][_0x3c8304(0x1af)][_0x3c8304(0x220)](_0x3c8304(0x1d4))[_0x3c8304(0x19a)](_0x524b67,path[_0x3c8304(0x20c)](_0x5381a3[_0x3c8304(0x1d1)],_0x5381a3[_0x3c8304(0x1e7)]),_0x5381a3['size']);_0x1a376d&&(_0x7e8b27[_0x3c8304(0x1fb)]=_0x1a376d['progress']),_0x7e8b27[_0x3c8304(0x1a4)]=fs[_0x3c8304(0x211)](_0x5381a3['filePath'],(_0x5bd308,_0x3d221f)=>{const _0x12d52a=_0x3c8304;return _0x5bd308?_0x7e8b27[_0x12d52a(0x247)]=0x0:_0x7e8b27[_0x12d52a(0x247)]=0x1,_0x567458[_0x12d52a(0x204)](_0x7e8b27);});});}}}),router[_0x236900(0x1f4)](_0x236900(0x22b),(_0x2a19eb,_0xf51b7c,_0x27ff29)=>{const _0x7721c7=_0x236900;let _0x16ecbc=_0x2a19eb[_0x7721c7(0x242)]['id'];function _0x32137e(_0x3e0fe2){const _0x2addec=_0x7721c7;let _0x2539eb=dbFileIndexTable['getById'](_0x2a19eb['app'][_0x2addec(0x1af)],_0x3e0fe2,dbFileIndexTable[_0x2addec(0x195)]);if(!_0x2539eb)return;let _0x1f9f13=new Date()[_0x2addec(0x234)]();_0x2a19eb[_0x2addec(0x197)][_0x2addec(0x1af)][_0x2addec(0x220)](_0x2addec(0x22c))[_0x2addec(0x229)](_0x1f9f13,_0x3e0fe2),dbBookFavorite[_0x2addec(0x23f)](_0x2a19eb['app']['dbFileIndex'],_0x16ecbc,_0x3e0fe2);}if(_0x2a19eb[_0x7721c7(0x200)][_0x7721c7(0x1c2)]instanceof Array){let _0x59c832=_0x2a19eb[_0x7721c7(0x200)][_0x7721c7(0x23b)];if(_0x59c832==_0x7721c7(0x1d0))for(let _0x21d68d of _0x2a19eb[_0x7721c7(0x200)][_0x7721c7(0x1c2)]){_0x32137e(_0x21d68d);}else{if(_0x59c832=='delete')for(let _0x56403e of _0x2a19eb[_0x7721c7(0x200)][_0x7721c7(0x1c2)]){dbBookFavorite['deleteFavorite'](_0x2a19eb['app'][_0x7721c7(0x1af)],_0x16ecbc,_0x56403e);}}return _0xf51b7c[_0x7721c7(0x204)]({'code':0x0});}else{let _0x559fd1=parseInt(_0x2a19eb[_0x7721c7(0x200)][_0x7721c7(0x1c2)]),_0x264f78=dbBookFavorite[_0x7721c7(0x1c8)](_0x2a19eb['app']['dbFileIndex'],_0x16ecbc,_0x559fd1),_0x5c83d3=0x0;return _0x264f78?dbBookFavorite[_0x7721c7(0x1d5)](_0x2a19eb['app']['dbFileIndex'],_0x16ecbc,_0x559fd1):(_0x5c83d3=0x1,_0x32137e(_0x559fd1)),_0xf51b7c['json']({'code':0x0,'favorite':_0x5c83d3});}}),router[_0x236900(0x19a)](_0x236900(0x1a5),(_0x59f2c5,_0x25b784,_0x2a069a)=>{const _0x1c7811=_0x236900;let _0x554669=_0x59f2c5['query'][_0x1c7811(0x1c2)],_0x26f6a1=dbBookIndexTable[_0x1c7811(0x215)](_0x59f2c5[_0x1c7811(0x197)][_0x1c7811(0x1af)],_0x554669),_0x34c17e=_0x59f2c5['query'][_0x1c7811(0x20b)];!_0x34c17e&&(_0x34c17e=0x200);if(!_0x26f6a1||_0x26f6a1&&!_0x26f6a1['cover_path'])return _0x25b784[_0x1c7811(0x243)](0x194)[_0x1c7811(0x1db)]();dbUserTable[_0x1c7811(0x23a)](_0x59f2c5,_0x25b784,_0x1c7811(0x1b0),'power_get',_0x26f6a1['path'])==!![]&&fs[_0x1c7811(0x211)](_0x26f6a1[_0x1c7811(0x1be)],(_0x4ed803,_0x1f5d12)=>{const _0x33c632=_0x1c7811;if(_0x4ed803){let _0x2394ab=config[_0x33c632(0x19c)](_0x26f6a1);bookIndexUtil[_0x33c632(0x1d6)](_0x26f6a1,_0x2394ab)[_0x33c632(0x1ad)](_0x235d38=>{const _0x34f59d=_0x33c632;if(_0x235d38[_0x34f59d(0x222)])bookIndexUtil[_0x34f59d(0x1a7)](_0x235d38[_0x34f59d(0x222)],_0x2394ab)[_0x34f59d(0x1ad)](_0x3edfff=>{const _0x9eacad=_0x34f59d;return console[_0x9eacad(0x21e)](_0x9eacad(0x1e0),_0x3edfff),_0x25b784['sendFile'](_0x3edfff);})['catch'](_0x2870f2=>{const _0x5851e9=_0x34f59d;return _0x25b784[_0x5851e9(0x243)](0x194)[_0x5851e9(0x1db)]();});else return _0x25b784[_0x34f59d(0x243)](0x194)[_0x34f59d(0x1db)]();})[_0x33c632(0x23c)](_0x24a532=>{const _0x39334a=_0x33c632;return _0x25b784[_0x39334a(0x243)](0x194)[_0x39334a(0x1db)]();});}else return _0x25b784[_0x33c632(0x1ef)](_0x26f6a1['cover_path']);});}),router['post'](_0x236900(0x212),(_0xa70f70,_0x16c18d,_0xba8876)=>{const _0x449174=_0x236900;let _0x28ed31=_0xa70f70[_0x449174(0x200)][_0x449174(0x1bf)]||0x32,_0x377c67=_0xa70f70[_0x449174(0x200)][_0x449174(0x22d)]||0x0,_0x94399b=_0xa70f70[_0x449174(0x200)][_0x449174(0x21b)]||_0x449174(0x1a1),_0x51eaff=_0xa70f70[_0x449174(0x200)][_0x449174(0x1b2)]||_0x449174(0x22e),_0xe1a3a0=_0xa70f70[_0x449174(0x200)][_0x449174(0x1e9)]||_0x449174(0x203),_0x50149a=_0xa70f70['body']['search'],_0x7844bc=_0xa70f70['body'][_0x449174(0x231)];if(dbBookIndexTable[_0x449174(0x1b4)](_0xa70f70,_0x16c18d,_0x51eaff,_0xe1a3a0)!==!![])return;let _0x1dd24c=['check_time','play_count',_0x449174(0x22e),_0x449174(0x1e7),_0x449174(0x245),_0x449174(0x1eb),_0x449174(0x1a2),'id',_0x449174(0x192)],_0x5124df=[_0x449174(0x1ed),_0x449174(0x203)];if(!_0x1dd24c[_0x449174(0x1ee)](_0x51eaff)||!_0x5124df[_0x449174(0x1ee)](_0xe1a3a0))return _0xa70f70[_0x449174(0x197)][_0x449174(0x235)](_0x16c18d,_0x449174(0x1d9),_0x51eaff,_0xe1a3a0);let _0x2385b2=dbUserTable[_0x449174(0x241)](_0xa70f70,'book',_0x449174(0x1df),!![]);if(_0xa70f70['currentUser'][_0x449174(0x1c7)]!=0x1&&!_0x2385b2&&_0x94399b!=_0x449174(0x1a1))return _0x16c18d[_0x449174(0x204)]({'code':0x0,'data':null});let _0x5df4fd=[];if(_0x94399b==_0x449174(0x1eb))_0x5df4fd=dbBookIndexTable['getGroupList'](_0xa70f70[_0x449174(0x197)][_0x449174(0x1af)],_0x2385b2,_0x94399b,_0x28ed31,_0x377c67,_0x51eaff,_0xe1a3a0,_0x50149a,_0x7844bc);else{if(_0x94399b=='bookList'){_0x5df4fd=dbBookListTable[_0x449174(0x202)](_0xa70f70['app'][_0x449174(0x1af)],_0xa70f70['currentUser']['id'],_0x28ed31,_0x377c67,'id',_0x449174(0x203),_0x50149a);for(let _0x547b2a of _0x5df4fd){_0x547b2a['cover']=dbBookIndexTable[_0x449174(0x1a0)](_0xa70f70[_0x449174(0x197)]['dbFileIndex'],_0x547b2a['id']);}}}return _0x16c18d[_0x449174(0x204)]({'code':0x0,'data':_0x5df4fd});}),router[_0x236900(0x1f4)]('/operationBookList',(_0x94c389,_0x6137a1,_0x412e75)=>{const _0x41d791=_0x236900;let _0x20acef=_0x94c389[_0x41d791(0x200)][_0x41d791(0x19f)],_0x47f40f=_0x94c389[_0x41d791(0x200)][_0x41d791(0x23b)];if(_0x47f40f==_0x41d791(0x1d0)){if(!_0x20acef)return _0x94c389[_0x41d791(0x197)][_0x41d791(0x235)](_0x6137a1,_0x41d791(0x1ab));dbBookListTable[_0x41d791(0x1e1)](_0x94c389[_0x41d791(0x197)][_0x41d791(0x1af)],_0x94c389[_0x41d791(0x242)]['id'],_0x20acef);}else{if(_0x47f40f==_0x41d791(0x209)||_0x47f40f==_0x41d791(0x1b6)){let _0x414e10=_0x94c389[_0x41d791(0x200)][_0x41d791(0x24b)],_0x563a5c=dbBookListTable[_0x41d791(0x1dd)](_0x94c389[_0x41d791(0x197)][_0x41d791(0x1af)],_0x414e10),_0x545ba9=![];(_0x94c389[_0x41d791(0x242)][_0x41d791(0x1c7)]==0x1||_0x563a5c['uid']==_0x94c389[_0x41d791(0x242)]['id'])&&(_0x545ba9=!![]);if(!_0x545ba9)return _0x6137a1[_0x41d791(0x204)]({'code':0x66});if(_0x47f40f==_0x41d791(0x1b6))dbBookListTable[_0x41d791(0x21f)](_0x94c389[_0x41d791(0x197)][_0x41d791(0x1af)],_0x414e10);else{if(_0x47f40f=='edit'){if(!_0x20acef)return _0x94c389[_0x41d791(0x197)][_0x41d791(0x235)](_0x6137a1,_0x41d791(0x1ab));dbBookListTable[_0x41d791(0x1b5)](_0x94c389[_0x41d791(0x197)][_0x41d791(0x1af)],_0x414e10,_0x20acef);}}}else return _0x94c389[_0x41d791(0x197)][_0x41d791(0x235)](_0x6137a1,_0x41d791(0x1e8));}return _0x6137a1[_0x41d791(0x204)]({'code':0x0});}),router[_0x236900(0x1f4)](_0x236900(0x18c),(_0x3eb692,_0x2e9cd0,_0x51c99a)=>{const _0x48a02c=_0x236900;let _0x24ed05=_0x3eb692[_0x48a02c(0x200)][_0x48a02c(0x240)],_0x466953=_0x3eb692[_0x48a02c(0x200)][_0x48a02c(0x24b)];if(!_0x24ed05||!_0x466953)return _0x3eb692['app'][_0x48a02c(0x235)](_0x2e9cd0,'need\x20bookIndexId/bookListId');let _0xf9e4b7=dbBookListTable[_0x48a02c(0x1dd)](_0x3eb692[_0x48a02c(0x197)]['dbFileIndex'],_0x466953);if(!_0xf9e4b7)return _0x3eb692[_0x48a02c(0x197)][_0x48a02c(0x235)](_0x2e9cd0,_0x48a02c(0x201));let _0x432d21=_0x3eb692[_0x48a02c(0x200)][_0x48a02c(0x23b)];if(_0x432d21=='add'){function _0xa6549f(_0x2f5043){const _0xa02219=_0x48a02c;let _0xe51609=dbBookIndexTable['getBookIndex'](_0x3eb692[_0xa02219(0x197)]['dbFileIndex'],_0x2f5043);if(!_0xe51609)return;if(_0xe51609['is_file']==0x1){dbBookListTable['addBookToBookList'](_0x3eb692['app'][_0xa02219(0x1af)],_0x2f5043,_0x466953);let _0x160fa7=Date[_0xa02219(0x20e)]();_0x3eb692['app']['dbFileIndex'][_0xa02219(0x220)]('UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?')['run'](_0x160fa7,_0xe51609['id']);}else{let _0x35a3cf=path[_0xa02219(0x20c)](_0xe51609[_0xa02219(0x1d1)],_0xe51609[_0xa02219(0x1e7)]),_0x1fb673=_0x3eb692[_0xa02219(0x197)]['dbFileIndex'][_0xa02219(0x220)](_0xa02219(0x18a))[_0xa02219(0x1c9)](_0x35a3cf,_0x35a3cf+path[_0xa02219(0x190)]+'%');for(let _0x43e58a of _0x1fb673){dbBookListTable[_0xa02219(0x1aa)](_0x3eb692[_0xa02219(0x197)][_0xa02219(0x1af)],_0x43e58a['id'],_0x466953);}}}if(_0x24ed05 instanceof Array)for(let _0x96d2af of _0x24ed05){_0xa6549f(_0x96d2af);}else _0xa6549f(_0x24ed05);}else{if(_0x432d21==_0x48a02c(0x1b6)){if(_0x24ed05 instanceof Array)for(let _0x3b6346 of _0x24ed05){dbBookListTable[_0x48a02c(0x1c0)](_0x3eb692[_0x48a02c(0x197)]['dbFileIndex'],_0x3b6346,_0x466953);}else dbBookListTable[_0x48a02c(0x1c0)](_0x3eb692[_0x48a02c(0x197)][_0x48a02c(0x1af)],_0x24ed05,_0x466953);}else return _0x3eb692[_0x48a02c(0x197)][_0x48a02c(0x235)](_0x2e9cd0,_0x48a02c(0x1e8));}return _0x2e9cd0[_0x48a02c(0x204)]({'code':0x0,'data':{}});}),router['post'](_0x236900(0x24f),(_0x5abc86,_0x2c0057,_0x35fd86)=>{const _0x559dce=_0x236900;let _0x565d15=_0x5abc86['body'][_0x559dce(0x1c5)],_0x146d2a=_0x5abc86[_0x559dce(0x200)][_0x559dce(0x1cd)],_0x2b2fba='book';if(dbUserTable['doUserCanGet'](_0x5abc86,_0x2c0057,_0x2b2fba,'power_get')==!![]){let _0x466860=[];if(!_0x565d15){let _0x18a42d=[];_0x5abc86[_0x559dce(0x242)][_0x559dce(0x1c7)]==0x1?_0x18a42d=dbSourceFolderTable['getPathByType'](_0x5abc86['app'][_0x559dce(0x19d)],_0x2b2fba):_0x18a42d=dbUserTable['getUserPower'](_0x5abc86[_0x559dce(0x197)]['dbOther'],_0x5abc86[_0x559dce(0x242)][_0x559dce(0x228)],_0x2b2fba);if(_0x18a42d)for(let _0x35b757=0x0;_0x35b757<_0x18a42d[_0x559dce(0x198)];_0x35b757++){_0x466860[_0x559dce(0x250)]({'path':_0x18a42d[_0x35b757][_0x559dce(0x1d1)],'is_file':0x0,'filename':path[_0x559dce(0x226)](_0x18a42d[_0x35b757][_0x559dce(0x1d1)]),'root':!![]});}}else{let _0x151125=[];if(_0x5abc86['currentUser']['is_admin']!=0x1){if(dbUserTable['doUserCanGet'](_0x5abc86,_0x2c0057,_0x2b2fba,_0x559dce(0x1df),_0x565d15)!==!![])return;}_0x565d15=path[_0x559dce(0x20c)](_0x565d15);let _0x16998d='\x20path=?\x20\x20';_0x151125[_0x559dce(0x250)](_0x565d15);if(_0x146d2a){let _0x117d44=_0x559dce(0x1cc);_0x16998d+=_0x117d44,_0x151125['push']('%'+_0x146d2a+'%'),_0x151125['push']('%'+_0x146d2a+'%');}let _0x25d579=_0x559dce(0x1fa);_0x466860=_0x5abc86[_0x559dce(0x197)][_0x559dce(0x1af)][_0x559dce(0x220)](_0x559dce(0x1cf)+_0x25d579+_0x559dce(0x233)+_0x16998d)[_0x559dce(0x1c9)](_0x151125);}for(let _0x3cf23c of _0x466860){if(_0x3cf23c[_0x559dce(0x216)]==0x0){let _0x5c8d3b=path[_0x559dce(0x20c)](_0x3cf23c[_0x559dce(0x1d1)],_0x3cf23c['filename']),_0x319843=_0x5abc86[_0x559dce(0x197)][_0x559dce(0x1af)][_0x559dce(0x220)]('SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_book\x20WHERE\x20path=?\x20and\x20is_file=1')[_0x559dce(0x19a)](_0x5c8d3b);_0x3cf23c[_0x559dce(0x1f0)]=_0x319843[_0x559dce(0x1bf)];}}let _0x83a70d=path[_0x559dce(0x190)],_0x4fde60={'code':0x0,'data':_0x466860,'sep':_0x83a70d};return _0x2c0057[_0x559dce(0x204)](_0x4fde60);}}),router[_0x236900(0x1f4)]('/updateBookNfo',(_0x2ea29f,_0x31adbf,_0x180304)=>{const _0x368268=_0x236900;let _0x2ee9ea=_0x2ea29f[_0x368268(0x200)][_0x368268(0x240)],_0x204783=_0x2ea29f['body'][_0x368268(0x23b)];if(!_0x2ee9ea)return _0x2ea29f[_0x368268(0x197)][_0x368268(0x235)](_0x31adbf,_0x368268(0x1dc));let _0x1b58c3=dbBookIndexTable[_0x368268(0x215)](_0x2ea29f['app'][_0x368268(0x1af)],_0x2ee9ea);if(!_0x1b58c3)return _0x2ea29f[_0x368268(0x197)]['returnErrMsg'](_0x31adbf,_0x368268(0x23d));if(_0x204783==_0x368268(0x18b)){let _0x3ccc18={'title':_0x2ea29f[_0x368268(0x200)][_0x368268(0x245)],'publish_date':_0x2ea29f[_0x368268(0x200)][_0x368268(0x1d7)],'year':_0x2ea29f[_0x368268(0x200)][_0x368268(0x1e3)],'isbn':_0x2ea29f['body'][_0x368268(0x19b)],'language':_0x2ea29f[_0x368268(0x200)][_0x368268(0x1f6)],'genre':_0x2ea29f[_0x368268(0x200)][_0x368268(0x217)],'tag':_0x2ea29f['body'][_0x368268(0x248)],'publisher':_0x2ea29f[_0x368268(0x200)][_0x368268(0x192)],'artist':_0x2ea29f[_0x368268(0x200)]['artist'],'introduction':_0x2ea29f[_0x368268(0x200)]['introduction']},_0x15b7f6=path['join'](_0x1b58c3[_0x368268(0x1d1)],_0x1b58c3['filename']);fs[_0x368268(0x211)](_0x15b7f6,(_0x2eb6a3,_0x3e78d7)=>{const _0x23eff0=_0x368268;if(_0x2eb6a3)return _0x2ea29f[_0x23eff0(0x197)][_0x23eff0(0x235)](_0x31adbf,_0x31adbf['__'](_0x23eff0(0x1ea))+_0x15b7f6);let _0x5c289a=_0x15b7f6[_0x23eff0(0x1bc)](0x0,_0x15b7f6[_0x23eff0(0x239)]('.'))+_0x23eff0(0x20a);nfoUtil['saveBookNfo'](_0x3ccc18,_0x5c289a)[_0x23eff0(0x1ad)](()=>{const _0x35b05c=_0x23eff0;console['log'](_0x35b05c(0x1de)),dbBookIndexTable[_0x35b05c(0x18f)](_0x2ea29f['app'][_0x35b05c(0x1af)],_0x2ee9ea,_0x3ccc18),_0x1b58c3=dbBookIndexTable[_0x35b05c(0x215)](_0x2ea29f[_0x35b05c(0x197)][_0x35b05c(0x1af)],_0x2ee9ea),setBookListProps(_0x2ea29f,[_0x1b58c3])[_0x35b05c(0x1ad)](_0x2bdcbb=>{const _0x2c381b=_0x35b05c;return _0x31adbf[_0x2c381b(0x204)]({'code':0x0,'data':_0x2bdcbb[0x0]});});})['catch'](_0x18ab65=>{const _0xdbaa80=_0x23eff0;return console[_0xdbaa80(0x21e)]('nfo写入失败',_0x18ab65),_0x2ea29f[_0xdbaa80(0x197)][_0xdbaa80(0x235)](_0x31adbf,_0xdbaa80(0x1c4));});});}else{if(_0x204783==_0x368268(0x1b6)){let _0x11d4f1=path[_0x368268(0x20c)](_0x1b58c3['path'],_0x1b58c3['filename']),_0x1d9099=_0x11d4f1[_0x368268(0x1bc)](0x0,_0x11d4f1[_0x368268(0x239)]('.'))+_0x368268(0x20a);fs['stat'](_0x1d9099,(_0x45d4a8,_0x1ff27f)=>{const _0x4980ed=_0x368268;if(_0x45d4a8)return _0x2ea29f[_0x4980ed(0x197)][_0x4980ed(0x235)](_0x31adbf,_0x31adbf['__'](_0x4980ed(0x1ea))+_0x1d9099);fs['rm'](_0x1d9099,_0x408818=>{const _0x513ece=_0x4980ed;if(_0x408818)return _0x2ea29f[_0x513ece(0x197)][_0x513ece(0x235)](_0x31adbf,_0x31adbf['__']('deleteFail')+_0x1d9099);return dbBookIndexTable[_0x513ece(0x18f)](_0x2ea29f[_0x513ece(0x197)][_0x513ece(0x1af)],indexId,{}),_0x31adbf['json']({'code':0x0});});});}else return _0x2ea29f[_0x368268(0x197)]['returnErrMsg'](_0x31adbf,_0x368268(0x1e8));}}),module[_0x236900(0x227)]=router;