const _0x5a8fa1=_0x53d9;function _0x22d2(){const _0x2ed965=['\x20AND\x20(filename_fl\x20=?\x20or\x20title_fl=?\x20)','update','/bookFavorite','currentUser','year','index\x20id\x20error','title','publisher','indexId','../../db/dbBookFavorite','deleteFail','filePath','INDEX_TABLE_NAME_BOOK','extname','all','UPDATE\x20file_index_book\x20set\x20check_time=?\x20WHERE\x20id=?','add','Router','1209490JZImNt','orderField','orderType','book_filename','getTime','letterIndex','封面写入成功','getAllFavoriteByWhere','SELECT\x20','need\x20bookIndexId','power_get','offset','type','search','platform','removeBookFromList','../../db/dbFileIndexTable','NO\x20book\x20INDEX','getBookListBookCount','封面文件已不存在','orderField/orderType\x20error','getUserPower','folderNotExist','sep','sendFile','getBookListList','filename','configJson','stat','\x20FROM\x20file_index_book\x20WHERE\x20','getBookListByPath','file_cover_path','book_path','getById','/updateBookNfo','SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid=?','recentReadList','power_change','16CYMXAf','/getBookDetail','../../db/dbSourceFolderTable','edit','getBookList','need\x20type/indexId','/deleteSameNameCover','/getBookCover','power_delete','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_size=?','post','../../utils/arrayUtil','\x20order\x20by\x20m.update_time\x20DESC\x20','length','substring','is_file','bookIsFavorite','.jpg','UPDATE\x20book_reader_config\x20SET\x20config_json=?\x20WHERE\x20uid=?','need\x20config\x20json','addFavorite','need\x20bookIndexId/bookListId','size','run','../../db/dbBookListTable','1175169dAesae','isbn','/getBookIndexFileTree','book\x20not\x20exist','saveBookNfo','favorite','json','SELECT\x20count(*)\x20as\x20count\x20FROM\x20file_index_book\x20WHERE\x20path=?\x20and\x20is_file=1','end','bookListId\x20no\x20exists','need\x20type','\x20AND\x20(filename\x20like\x20?\x20\x20OR\x20title\x20\x20like\x20?\x20OR\x20artist\x20like\x20?\x20OR\x20tag\x20like\x20?\x20OR\x20publisher\x20like\x20?\x20OR\x20isbn\x20like\x20?\x20OR\x20genre\x20like\x20?\x20OR\x20year\x20like\x20?)','addBookToBookList','book','543336zpVnJC','genre','getMediaCoverCachePath','check_time','\x20order\x20by\x20f.artist_fl\x20','nfo写入成功','status','getBookIndex','/addReadRecord','body','UPDATE\x20book_reader_config\x20SET\x20remark=?\x20WHERE\x20uid=?','then','runGetBookInfoWorker','need\x20\x27name\x27','../../db/dbUserTable','exist','removeBookList','335582irDXLo','\x20LIMIT\x20?\x20OFFSET\x20?\x20','/getReadRecord','fileName',',f.filename_fl\x20','SELECT\x20id\x20from\x20file_index_book\x20where\x20is_file=1\x20and\x20path\x20=?\x20or\x20path\x20like\x20?','deleteFavorite','\x20is_file=1','error','path','prepare','checkOrderParams','desc','updateBookList','uid','delete','coverData','updateBook','progress','dbFileIndex','birthtime','getBookListById','returnErrMsg','getUserPathWhere','\x20id,is_file,id,path,filename,type,size,title,artist,ext,cover_path,language,publisher,total_page,type,check_time,create_time','/operationBookList','../../myConfig/config','operation\x20error','getFavorite','getBookListCount','parent','join','35622eTvDNO','SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?','remark','cover_path','operation','log','fileCount','existsSync','list','dbOther','now','publish_date','.nfo','/operationBookListIndex','introduction','config\x20json\x20format\x20error','push','/refreshCheckTime','get','doUserCanGet','username','artist','\x20order\x20by\x20f.','app','basename',',f.title\x20','sortFileNamesByNumber','cover\x20format\x20error','cover','favorite_time','catch','createBookList','getBooklistCover','getFavoriteCount','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20title\x20\x20LIKE\x20?)\x20','\x20order\x20by\x20m.update_time\x20','\x20path=?\x20\x20','groupField','bookIndexId','/getBookList','../../utils/nfoUtil','replace','play_count','../../db/dbBookIndexTable','listType','../../myWorkers/index/bookIndexUtil','query','getPathByType','REPLACE\x20INTO\x20book_read_record\x20(uid,book_filename,book_path,progress,read_time)\x20VALUES(?,?,?,?,?)','bookList','/getGroupList','parse','count','is_admin','2NaJmgS','821856uYnpkw','nfo写入失败','book_count','513345etpdMg',',f.artist\x20','exports','bookListId','language','8tHUBbz','/getHomeData'];_0x22d2=function(){return _0x2ed965;};return _0x22d2();}(function(_0x1c6177,_0x13970a){const _0x1a104d=_0x53d9,_0x2dcc0e=_0x1c6177();while(!![]){try{const _0x4d749d=parseInt(_0x1a104d(0x8a))/0x1*(parseInt(_0x1a104d(0xe0))/0x2)+-parseInt(_0x1a104d(0x13c))/0x3+parseInt(_0x1a104d(0xe9))/0x4*(parseInt(_0x1a104d(0xe4))/0x5)+parseInt(_0x1a104d(0x14a))/0x6+-parseInt(_0x1a104d(0xe1))/0x7+-parseInt(_0x1a104d(0x123))/0x8*(parseInt(_0x1a104d(0xaa))/0x9)+parseInt(_0x1a104d(0xfd))/0xa;if(_0x4d749d===_0x13970a)break;else _0x2dcc0e['push'](_0x2dcc0e['shift']());}catch(_0x7261d3){_0x2dcc0e['push'](_0x2dcc0e['shift']());}}}(_0x22d2,0x39772));let express=require('express'),router=express[_0x5a8fa1(0xfc)](),path=require(_0x5a8fa1(0x93)),fs=require('fs'),dbBookIndexTable=require(_0x5a8fa1(0xd5)),dbFileIndexTable=require(_0x5a8fa1(0x10d)),dbBookListTable=require(_0x5a8fa1(0x13b)),dbBookFavorite=require(_0x5a8fa1(0xf4));const dbUserTable=require(_0x5a8fa1(0x87)),dbSourceFolderTable=require(_0x5a8fa1(0x125));let os=require('os'),config=require(_0x5a8fa1(0xa4));const bookIndexUtil=require(_0x5a8fa1(0xd7)),arrayUtil=require(_0x5a8fa1(0x12e)),nfoUtil=require(_0x5a8fa1(0xd2));function getBookSameNameCover(_0x7f6b57){return new Promise((_0x1e0a72,_0x3b5994)=>{const _0x4f5961=_0x53d9;try{let _0x195532=_0x7f6b57[_0x4f5961(0x117)][_0x4f5961(0xd3)](path[_0x4f5961(0xf8)](_0x7f6b57[_0x4f5961(0x117)]),''),_0x220d43=path[_0x4f5961(0xa9)](_0x7f6b57[_0x4f5961(0x93)],_0x195532+'.jpg'),_0x1f1afb='';fs[_0x4f5961(0xb1)](_0x220d43)&&(_0x1f1afb=_0x220d43),_0x1e0a72(_0x1f1afb);}catch(_0x463b10){_0x1e0a72('');}});}router[_0x5a8fa1(0x12d)]('/setReaderConfig',(_0x47e5a7,_0x2b0cb7,_0x261e6b)=>{const _0x71ca3d=_0x5a8fa1;let _0x445541=_0x47e5a7['currentUser']['id'],_0x157366=_0x47e5a7[_0x71ca3d(0x82)][_0x71ca3d(0x118)],_0x203315=_0x47e5a7['body'][_0x71ca3d(0xac)];if(!_0x157366&&!_0x203315)return _0x47e5a7[_0x71ca3d(0xc1)][_0x71ca3d(0xa0)](_0x2b0cb7,_0x71ca3d(0x136));try{JSON[_0x71ca3d(0xdd)](_0x157366);}catch(_0x3ffb49){return _0x47e5a7['app'][_0x71ca3d(0xa0)](_0x2b0cb7,_0x71ca3d(0xb9));}let _0x2f332c=_0x47e5a7[_0x71ca3d(0xc1)][_0x71ca3d(0xb3)][_0x71ca3d(0x94)](_0x71ca3d(0x120))['get'](_0x445541);if(_0x2f332c){if(_0x157366)_0x47e5a7[_0x71ca3d(0xc1)][_0x71ca3d(0xb3)][_0x71ca3d(0x94)](_0x71ca3d(0x135))[_0x71ca3d(0x13a)](_0x157366,_0x445541);else _0x203315&&_0x47e5a7[_0x71ca3d(0xc1)][_0x71ca3d(0xb3)][_0x71ca3d(0x94)](_0x71ca3d(0x83))['run'](_0x203315,_0x445541);}else _0x47e5a7['app'][_0x71ca3d(0xb3)][_0x71ca3d(0x94)]('REPLACE\x20INTO\x20book_reader_config\x20(uid,config_json,remark)\x20VALUES(?,?,?)')[_0x71ca3d(0x13a)](_0x445541,_0x157366,_0x203315);return _0x2b0cb7[_0x71ca3d(0x142)]({'code':0x0});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0x129),(_0x4d4ca1,_0x34c70a,_0xff0605)=>{const _0x440da5=_0x5a8fa1;let _0x485651=_0x4d4ca1[_0x440da5(0xee)]['id'],_0x373d7c=_0x4d4ca1['body'][_0x440da5(0xd0)];if(!_0x373d7c)return _0x4d4ca1['app'][_0x440da5(0xa0)](_0x34c70a,_0x440da5(0x106));let _0x58376b=dbFileIndexTable[_0x440da5(0x11e)](_0x4d4ca1[_0x440da5(0xc1)][_0x440da5(0x9d)],_0x373d7c,dbFileIndexTable['INDEX_TABLE_NAME_BOOK']);if(!_0x58376b)return _0x4d4ca1[_0x440da5(0xc1)]['returnErrMsg'](_0x34c70a,'need\x20bookIndexId');dbUserTable[_0x440da5(0xbd)](_0x4d4ca1,_0x34c70a,'',_0x440da5(0x12b),_0x58376b[_0x440da5(0x93)])==!![]&&getBookSameNameCover(_0x58376b)[_0x440da5(0x84)](_0x4d2dac=>{const _0x21e934=_0x440da5;if(!_0x4d2dac['endsWith'](_0x21e934(0x134)))return _0x4d4ca1[_0x21e934(0xc1)]['returnErrMsg'](_0x34c70a,_0x21e934(0xc5));fs[_0x21e934(0x119)](_0x4d2dac,(_0x2e8121,_0x3d3dac)=>{const _0x3d194e=_0x21e934;if(_0x2e8121)return console['log'](_0x3d194e(0x110)),_0x34c70a['json']({'code':0x0});fs['rm'](_0x4d2dac,_0x3f6fa3=>{const _0x4e5c9a=_0x3d194e;if(_0x3f6fa3)return _0x4d4ca1[_0x4e5c9a(0xc1)]['returnErrMsg'](_0x34c70a,_0x34c70a['__'](_0x4e5c9a(0xf5))+_0x4d2dac);return console['log']('封面文件已删除',_0x4d2dac),_0x34c70a[_0x4e5c9a(0x142)]({'code':0x0});});});});}),router['post'](_0x5a8fa1(0xbb),(_0x14ca60,_0x5e69a0,_0x1df206)=>{const _0x5498d9=_0x5a8fa1;let _0x3cc587=_0x14ca60[_0x5498d9(0xee)]['id'],_0x18dd54=_0x14ca60[_0x5498d9(0x82)][_0x5498d9(0xd0)];if(!_0x18dd54)return _0x5e69a0['status'](0x194)[_0x5498d9(0x144)]();return dbBookIndexTable['updateByFiled'](_0x14ca60['app'][_0x5498d9(0x9d)],_0x18dd54,_0x5498d9(0x14d),new Date()['getTime']()),_0x5e69a0[_0x5498d9(0x142)]({'code':0x0});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0x81),(_0x50c8d3,_0x2030ee,_0x5a563c)=>{const _0x40d69d=_0x5a8fa1;let _0x197e05=_0x50c8d3[_0x40d69d(0xee)]['id'];if(!_0x50c8d3[_0x40d69d(0x82)][_0x40d69d(0x8d)]||!_0x50c8d3['body']['filePath']||!_0x50c8d3[_0x40d69d(0x82)]['progress'])return _0x2030ee[_0x40d69d(0x142)]({'code':0x0});let _0xf880a9=_0x50c8d3[_0x40d69d(0x82)][_0x40d69d(0x8d)];_0xf880a9=path[_0x40d69d(0xc2)](_0x50c8d3[_0x40d69d(0x82)][_0x40d69d(0x8d)]);let _0x2bf423=path[_0x40d69d(0xa9)](_0x50c8d3[_0x40d69d(0x82)][_0x40d69d(0xf6)]),_0x3001a0=_0x50c8d3[_0x40d69d(0x82)]['progress'],_0x77c7b=_0x50c8d3[_0x40d69d(0xc1)][_0x40d69d(0x9d)][_0x40d69d(0x94)](_0x40d69d(0xab))[_0x40d69d(0xbc)](_0x197e05,_0xf880a9,_0x2bf423);return _0x77c7b?_0x50c8d3[_0x40d69d(0xc1)][_0x40d69d(0x9d)][_0x40d69d(0x94)]('UPDATE\x20book_read_record\x20SET\x20progress=?,read_time=?\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')['run'](_0x3001a0,Date['now'](),_0x197e05,_0xf880a9,_0x2bf423):_0x50c8d3[_0x40d69d(0xc1)][_0x40d69d(0x9d)][_0x40d69d(0x94)](_0x40d69d(0xda))[_0x40d69d(0x13a)](_0x197e05,_0xf880a9,_0x2bf423,_0x3001a0,Date[_0x40d69d(0xb4)]()),_0x2030ee[_0x40d69d(0x142)]({'code':0x0});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0x8c),(_0x35abdf,_0xa144d6,_0x191559)=>{const _0x57a94a=_0x5a8fa1;let _0x35576e=_0x35abdf['currentUser']['id'],_0xb6a24e=_0x35abdf[_0x57a94a(0xc1)][_0x57a94a(0xb3)][_0x57a94a(0x94)]('SELECT\x20*\x20FROM\x20book_reader_config\x20WHERE\x20uid\x20=\x20?')[_0x57a94a(0xbc)](_0x35576e),_0x3951ee=0x0,_0x591fd2=_0x35abdf['body'][_0x57a94a(0x8d)],_0x1fb8b8=_0x35abdf['body'][_0x57a94a(0xf6)];if(_0x591fd2&&_0x1fb8b8){_0x1fb8b8=path[_0x57a94a(0xa9)](_0x1fb8b8+'');let _0x590cf9=_0x35abdf['app'][_0x57a94a(0x9d)][_0x57a94a(0x94)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20AND\x20book_filename=?\x20AND\x20book_path=?')[_0x57a94a(0xbc)](_0x35576e,_0x591fd2,_0x1fb8b8);_0x590cf9&&(_0x3951ee=_0x590cf9[_0x57a94a(0x9c)]);}return _0xa144d6['json']({'code':0x0,'progress':_0x3951ee,'readerConfig':_0xb6a24e});}),router[_0x5a8fa1(0x12d)]('/setBookType',(_0x26ac3a,_0x2ad098,_0x2fdc59)=>{const _0x369643=_0x5a8fa1;let _0x6acf79=_0x26ac3a['body'][_0x369643(0xf3)],_0x50810f=_0x26ac3a['body']['type'];if(!_0x50810f||!_0x6acf79)return _0x26ac3a[_0x369643(0xc1)][_0x369643(0xa0)](_0x2ad098,_0x369643(0x128));if(_0x50810f!=0x1&&_0x50810f!=0x2)return _0x26ac3a[_0x369643(0xc1)]['returnErrMsg'](_0x2ad098,_0x369643(0x146));let _0x4fb41b=dbBookIndexTable[_0x369643(0x80)](_0x26ac3a[_0x369643(0xc1)][_0x369643(0x9d)],_0x6acf79);if(!_0x4fb41b)return _0x26ac3a['app'][_0x369643(0xa0)](_0x2ad098,_0x369643(0x13f));if(dbUserTable[_0x369643(0xbd)](_0x26ac3a,_0x2ad098,_0x369643(0x149),_0x369643(0x122),_0x4fb41b[_0x369643(0x93)])==!![])return dbBookIndexTable['updateByFiled'](_0x26ac3a[_0x369643(0xc1)][_0x369643(0x9d)],_0x6acf79,_0x369643(0x109),_0x50810f),_0x2ad098[_0x369643(0x142)]({'code':0x0});});function getListByParams(_0xee38c4,_0x1b9795,_0x5a40ed,_0x19cb69,_0x5d1601,_0x249613,_0x36120b,_0x29eefa,_0xb83a77,_0x43d38f,_0x26fb6c,_0x36c70e,_0x2b2092){return new Promise((_0xd4f984,_0x2197e7)=>{const _0x224af4=_0x53d9;let _0x18329b=_0xee38c4[_0x224af4(0xc1)][_0x224af4(0x9d)],_0x5a739a=[];if(_0x19cb69==_0x224af4(0xb2)||_0x19cb69==_0x224af4(0xdb))_0x5a739a=dbBookIndexTable[_0x224af4(0x127)](_0x18329b,_0x5a40ed,_0x5d1601,_0x249613,_0x36120b,_0x29eefa,_0xb83a77,_0x26fb6c,_0x43d38f,_0x36c70e,_0x2b2092);else{if(_0x19cb69=='favorite'){let _0x15afa4='',_0x2958d4=[];_0x15afa4+=_0x224af4(0x91);_0x43d38f&&(_0x43d38f=_0x43d38f[_0x224af4(0xd3)]('\x27','')['replace']('’',''),_0x15afa4+=_0x224af4(0x147),_0x2958d4[_0x224af4(0xba)]('%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%','%'+_0x43d38f+'%'));_0x36c70e&&(_0x15afa4+=_0x224af4(0xeb),_0x2958d4[_0x224af4(0xba)](_0x36c70e,_0x36c70e));if(_0x36120b&&_0x29eefa){if(_0x36120b==_0x224af4(0xbf))_0x15afa4+=_0x224af4(0x14e)+_0x29eefa+_0x224af4(0xe5)+_0x29eefa+'\x20';else{if(_0x36120b==_0x224af4(0xf1))_0x15afa4+='\x20order\x20by\x20f.title_fl\x20'+_0x29eefa+_0x224af4(0xc3)+_0x29eefa+_0x224af4(0x8e)+_0x29eefa+'\x20';else _0x36120b==_0x224af4(0xc7)?_0x15afa4+=_0x224af4(0xcd)+_0x29eefa+'\x20':_0x15afa4+=_0x224af4(0xc0)+_0x36120b+'\x20'+_0x29eefa+'\x20';}}else _0x15afa4+=_0x224af4(0x12f);_0x15afa4+=_0x224af4(0x8b),_0x2958d4[_0x224af4(0xba)](_0x5d1601),_0x2958d4[_0x224af4(0xba)](_0x249613),_0x5a739a=dbBookFavorite[_0x224af4(0x104)](_0xee38c4['app']['dbFileIndex'],_0xee38c4[_0x224af4(0xee)]['id'],_0x15afa4,'*',_0x2958d4);}}setBookListProps(_0xee38c4,_0x5a739a)[_0x224af4(0x84)](_0x4a8289=>{_0xd4f984(_0x4a8289);});});}function setBookListProps(_0x379e23,_0x218473){return new Promise(async(_0x2439d2,_0x2546e9)=>{const _0x1bc384=_0x53d9;for(let _0x5df397 of _0x218473){_0x5df397[_0x1bc384(0x141)]=dbBookFavorite[_0x1bc384(0x133)](_0x379e23['app'][_0x1bc384(0x9d)],_0x5df397['id'],_0x379e23['currentUser']['id'])?'1':'0',_0x5df397[_0x1bc384(0xf6)]=path[_0x1bc384(0xa9)](_0x5df397[_0x1bc384(0x93)],_0x5df397[_0x1bc384(0x117)]),_0x5df397[_0x1bc384(0x11c)]=await getBookSameNameCover(_0x5df397);}_0x2439d2(_0x218473);});}function _0x53d9(_0x41a688,_0x4282c0){const _0x22d2ae=_0x22d2();return _0x53d9=function(_0x53d92c,_0x1f7f9d){_0x53d92c=_0x53d92c-0x7f;let _0x5c9824=_0x22d2ae[_0x53d92c];return _0x5c9824;},_0x53d9(_0x41a688,_0x4282c0);}router[_0x5a8fa1(0x12d)](_0x5a8fa1(0xea),(_0x33a407,_0x4a1714,_0x76b9c6)=>{const _0x3636b7=_0x5a8fa1;let _0x230db8=_0x33a407['body']['count']?_0x33a407[_0x3636b7(0x82)][_0x3636b7(0xde)]:0xc,_0x6006b4=_0x33a407[_0x3636b7(0xee)]['id'],_0x371f07=dbUserTable[_0x3636b7(0xa1)](_0x33a407,_0x3636b7(0x149),_0x3636b7(0x107),!![]);if(_0x33a407[_0x3636b7(0xee)][_0x3636b7(0xdf)]!=0x1&&!_0x371f07)return _0x4a1714[_0x3636b7(0x142)]({'code':0x0,'data':null});let _0x31d077=[],_0x482d6d=_0x33a407['app'][_0x3636b7(0x9d)][_0x3636b7(0x94)]('SELECT\x20*\x20FROM\x20book_read_record\x20WHERE\x20uid=?\x20ORDER\x20BY\x20read_time\x20desc\x20LIMIT\x20?')[_0x3636b7(0xf9)](_0x6006b4,_0x230db8);for(let _0x17b3fa of _0x482d6d){let _0x3f820b=dbBookIndexTable['getBookIndexByFileName'](_0x33a407['app']['dbFileIndex'],_0x17b3fa[_0x3636b7(0x11d)],_0x17b3fa[_0x3636b7(0x100)]);_0x3f820b&&dbUserTable[_0x3636b7(0xbd)](_0x33a407,_0x4a1714,'book',_0x3636b7(0x107),_0x3f820b['path'],!![])==!![]&&(_0x3f820b[_0x3636b7(0x9c)]=_0x17b3fa[_0x3636b7(0x9c)],_0x31d077[_0x3636b7(0xba)](_0x3f820b));}setBookListProps(_0x33a407,_0x31d077)[_0x3636b7(0x84)](_0x41847e=>{const _0x27ab52=_0x3636b7;_0x31d077=_0x41847e,getListByParams(_0x33a407,_0x4a1714,_0x371f07,'list',_0x230db8,0x0,_0x27ab52(0x14d),_0x27ab52(0x96),null,null,null,null,0x1)['then'](_0x9add0c=>{const _0x22a6f8=_0x27ab52;getListByParams(_0x33a407,_0x4a1714,_0x371f07,_0x22a6f8(0xb2),_0x230db8,0x0,_0x22a6f8(0x14d),_0x22a6f8(0x96),null,null,null,null,0x2)[_0x22a6f8(0x84)](_0x58ffd0=>{const _0x168fda=_0x22a6f8;getListByParams(_0x33a407,_0x4a1714,_0x371f07,_0x168fda(0xb2),_0x230db8,0x0,'id',_0x168fda(0x96))[_0x168fda(0x84)](_0x340d81=>{const _0x164751=_0x168fda;let _0x48fe25={};return _0x31d077&&_0x31d077[_0x164751(0x130)]>0x0&&(_0x48fe25[_0x164751(0x121)]=_0x31d077),_0x340d81&&_0x340d81[_0x164751(0x130)]>0x0&&(_0x48fe25['recentAddList']=_0x340d81),_0x9add0c&&_0x9add0c[_0x164751(0x130)]>0x0&&(_0x48fe25[_0x164751(0xdb)]=_0x9add0c),_0x58ffd0&&_0x58ffd0[_0x164751(0x130)]>0x0&&(_0x48fe25['comicList']=_0x58ffd0),_0x4a1714[_0x164751(0x142)]({'code':0x0,'data':_0x48fe25,'platform':os[_0x164751(0x10b)]()});});});});});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0xd1),(_0x1d2e5e,_0x275efb,_0x69b309)=>{const _0x6dbcd6=_0x5a8fa1;let _0x200699=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0xde)]||0x32,_0x2e3a2d=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0x108)]||0x0,_0x436e77=_0x1d2e5e['body'][_0x6dbcd6(0xbf)],_0x3d50b7=_0x1d2e5e[_0x6dbcd6(0x82)]['orderField']||'check_time',_0x46d7b8=_0x1d2e5e[_0x6dbcd6(0x82)]['orderType']||_0x6dbcd6(0x96),_0x2edbeb=[_0x6dbcd6(0xb2),_0x6dbcd6(0x141),_0x6dbcd6(0xdb)],_0x310604=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0xd6)]||_0x6dbcd6(0xb2),_0x42134e=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0x10a)],_0x1552d0=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0x102)],_0x3f3d92=_0x1d2e5e['body'][_0x6dbcd6(0xe7)],_0x3a138f=_0x1d2e5e[_0x6dbcd6(0x82)][_0x6dbcd6(0x109)];if(dbBookIndexTable[_0x6dbcd6(0x95)](_0x1d2e5e,_0x275efb,_0x3d50b7,_0x46d7b8)!==!![])return;if(_0x310604=='bookList'){if(!_0x3f3d92)return _0x1d2e5e[_0x6dbcd6(0xc1)][_0x6dbcd6(0xa0)](_0x275efb,'need\x20bookListId');}!_0x2edbeb['includes'](_0x310604)&&(_0x310604=_0x6dbcd6(0xb2));_0x200699>0x1f4&&(_0x200699=0x1f4);let _0x4ec827=dbUserTable[_0x6dbcd6(0xa1)](_0x1d2e5e,_0x6dbcd6(0x149),_0x6dbcd6(0x107),!![]);if(_0x1d2e5e[_0x6dbcd6(0xee)][_0x6dbcd6(0xdf)]!=0x1&&!_0x4ec827)return _0x275efb[_0x6dbcd6(0x142)]({'code':0x0,'data':null});getListByParams(_0x1d2e5e,_0x275efb,_0x4ec827,_0x310604,_0x200699,_0x2e3a2d,_0x3d50b7,_0x46d7b8,_0x436e77,_0x42134e,_0x3f3d92,_0x1552d0,_0x3a138f)['then'](_0x158349=>{const _0x5911c5=_0x6dbcd6;let _0xef49d9={'code':0x0,'data':_0x158349};if(_0x310604==_0x5911c5(0x141))_0xef49d9['book_count']=dbBookFavorite[_0x5911c5(0xcb)](_0x1d2e5e['app'][_0x5911c5(0x9d)],_0x1d2e5e[_0x5911c5(0xee)]['id']);else{if(_0x310604==_0x5911c5(0xb2))_0xef49d9['book_count']=dbBookIndexTable[_0x5911c5(0xa7)](_0x1d2e5e[_0x5911c5(0xc1)][_0x5911c5(0x9d)],_0x4ec827,_0x436e77,_0x42134e,_0x3a138f);else _0x310604==_0x5911c5(0xdb)&&(_0xef49d9[_0x5911c5(0xe3)]=dbBookListTable[_0x5911c5(0x10f)](_0x1d2e5e[_0x5911c5(0xc1)][_0x5911c5(0x9d)],_0x3f3d92));}return _0x275efb[_0x5911c5(0x142)](_0xef49d9);});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0x124),(_0x488008,_0x139d6c,_0x36f22d)=>{const _0x2e6f0b=_0x5a8fa1;let _0x559495=_0x488008[_0x2e6f0b(0x82)]['id'],_0x82c6f7=dbFileIndexTable[_0x2e6f0b(0x11e)](_0x488008[_0x2e6f0b(0xc1)][_0x2e6f0b(0x9d)],_0x559495,dbFileIndexTable[_0x2e6f0b(0xf7)]);if(!_0x82c6f7)return _0x488008['app'][_0x2e6f0b(0xa0)](_0x139d6c,_0x2e6f0b(0x10e));if(dbUserTable[_0x2e6f0b(0xbd)](_0x488008,_0x139d6c,_0x2e6f0b(0x149),'power_get',_0x82c6f7['path'])==!![]){let _0x37595e=_0x488008[_0x2e6f0b(0xee)]['id'],_0x4eb968=dbBookFavorite[_0x2e6f0b(0xa6)](_0x488008[_0x2e6f0b(0xc1)][_0x2e6f0b(0x9d)],_0x37595e,_0x559495);_0x82c6f7[_0x2e6f0b(0x141)]=_0x4eb968?0x1:0x0,_0x82c6f7[_0x2e6f0b(0xf6)]=path[_0x2e6f0b(0xa9)](_0x82c6f7[_0x2e6f0b(0x93)],_0x82c6f7['filename']);let _0x55a623=dbBookIndexTable[_0x2e6f0b(0x11b)](_0x488008['app'][_0x2e6f0b(0x9d)],_0x82c6f7[_0x2e6f0b(0x93)]);_0x55a623[_0x2e6f0b(0x130)]>0x0?(_0x55a623=arrayUtil[_0x2e6f0b(0xc4)](_0x55a623,_0x2e6f0b(0x117)),setBookListProps(_0x488008,_0x55a623)[_0x2e6f0b(0x84)](_0x584871=>{_0x55a623=_0x584871,_0x23e9f4();})):_0x23e9f4;function _0x23e9f4(){let _0x4cf78c={'code':0x0,'data':_0x82c6f7,'sameFolderBookList':_0x55a623};getBookSameNameCover(_0x82c6f7)['then'](_0x274928=>{const _0x251d5a=_0x53d9;_0x82c6f7[_0x251d5a(0x11c)]=_0x274928;let _0xd84b4e=_0x488008['app'][_0x251d5a(0x9d)][_0x251d5a(0x94)](_0x251d5a(0x12c))['get'](_0x37595e,path['join'](_0x82c6f7[_0x251d5a(0x93)],_0x82c6f7[_0x251d5a(0x117)]),_0x82c6f7[_0x251d5a(0x139)]);_0xd84b4e&&(_0x4cf78c[_0x251d5a(0x9c)]=_0xd84b4e[_0x251d5a(0x9c)]),_0x4cf78c['fileExist']=fs[_0x251d5a(0x119)](_0x82c6f7[_0x251d5a(0xf6)],(_0x583797,_0x4c8eee)=>{const _0x38d567=_0x251d5a;return _0x583797?_0x4cf78c[_0x38d567(0x88)]=0x0:_0x4cf78c[_0x38d567(0x88)]=0x1,_0x139d6c[_0x38d567(0x142)](_0x4cf78c);});});}}}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0xed),(_0x466b41,_0x3405b3,_0x20960c)=>{const _0x31a3a5=_0x5a8fa1;let _0x471796=_0x466b41[_0x31a3a5(0xee)]['id'];function _0x7bca2(_0x3ecbf4){const _0x281caf=_0x31a3a5;let _0x332b71=dbFileIndexTable[_0x281caf(0x11e)](_0x466b41[_0x281caf(0xc1)][_0x281caf(0x9d)],_0x3ecbf4,dbFileIndexTable[_0x281caf(0xf7)]);if(!_0x332b71)return;let _0x3530fd=new Date()[_0x281caf(0x101)]();_0x466b41[_0x281caf(0xc1)][_0x281caf(0x9d)][_0x281caf(0x94)](_0x281caf(0xfa))[_0x281caf(0x13a)](_0x3530fd,_0x3ecbf4),dbBookFavorite[_0x281caf(0x137)](_0x466b41[_0x281caf(0xc1)][_0x281caf(0x9d)],_0x471796,_0x3ecbf4);}if(_0x466b41[_0x31a3a5(0x82)][_0x31a3a5(0xf3)]instanceof Array){let _0x2b638b=_0x466b41['body'][_0x31a3a5(0xae)];if(_0x2b638b==_0x31a3a5(0xfb))for(let _0x273217 of _0x466b41[_0x31a3a5(0x82)][_0x31a3a5(0xf3)]){_0x7bca2(_0x273217);}else{if(_0x2b638b==_0x31a3a5(0x99))for(let _0x5a31d0 of _0x466b41[_0x31a3a5(0x82)][_0x31a3a5(0xf3)]){dbBookFavorite['deleteFavorite'](_0x466b41[_0x31a3a5(0xc1)][_0x31a3a5(0x9d)],_0x471796,_0x5a31d0);}}return _0x3405b3[_0x31a3a5(0x142)]({'code':0x0});}else{let _0x5e9383=parseInt(_0x466b41[_0x31a3a5(0x82)][_0x31a3a5(0xf3)]),_0x5a400d=dbBookFavorite['getFavorite'](_0x466b41[_0x31a3a5(0xc1)][_0x31a3a5(0x9d)],_0x471796,_0x5e9383),_0x5b66e9=0x0;return _0x5a400d?dbBookFavorite[_0x31a3a5(0x90)](_0x466b41[_0x31a3a5(0xc1)][_0x31a3a5(0x9d)],_0x471796,_0x5e9383):(_0x5b66e9=0x1,_0x7bca2(_0x5e9383)),_0x3405b3[_0x31a3a5(0x142)]({'code':0x0,'favorite':_0x5b66e9});}}),router[_0x5a8fa1(0xbc)](_0x5a8fa1(0x12a),(_0x4df1fd,_0x2bc6f9,_0x4f0cca)=>{const _0x3743d2=_0x5a8fa1;let _0x312ff9=_0x4df1fd[_0x3743d2(0xd8)][_0x3743d2(0xf3)],_0x47440c=dbBookIndexTable[_0x3743d2(0x80)](_0x4df1fd[_0x3743d2(0xc1)][_0x3743d2(0x9d)],_0x312ff9),_0x379ee5=_0x4df1fd[_0x3743d2(0xd8)][_0x3743d2(0x139)];!_0x379ee5&&(_0x379ee5=0x200);if(!_0x47440c||_0x47440c&&!_0x47440c[_0x3743d2(0xad)])return _0x2bc6f9[_0x3743d2(0x7f)](0x194)[_0x3743d2(0x144)]();dbUserTable[_0x3743d2(0xbd)](_0x4df1fd,_0x2bc6f9,'book',_0x3743d2(0x107),_0x47440c[_0x3743d2(0x93)])==!![]&&fs[_0x3743d2(0x119)](_0x47440c[_0x3743d2(0xad)],(_0x17b1af,_0x2b17df)=>{const _0x5766c2=_0x3743d2;if(_0x17b1af){let _0x276904=config[_0x5766c2(0x14c)](_0x47440c);bookIndexUtil[_0x5766c2(0x85)](_0x47440c,_0x276904)[_0x5766c2(0x84)](_0x2acaa5=>{const _0x180b20=_0x5766c2;if(_0x2acaa5[_0x180b20(0x9a)])bookIndexUtil['sharpWriteCover'](_0x2acaa5[_0x180b20(0x9a)],_0x276904)['then'](_0x4fa0cb=>{const _0x54d50a=_0x180b20;return console[_0x54d50a(0xaf)](_0x54d50a(0x103),_0x4fa0cb),_0x2bc6f9[_0x54d50a(0x115)](_0x4fa0cb);})[_0x180b20(0xc8)](_0x460b46=>{const _0x19bf18=_0x180b20;return _0x2bc6f9[_0x19bf18(0x7f)](0x194)[_0x19bf18(0x144)]();});else return _0x2bc6f9[_0x180b20(0x7f)](0x194)['end']();})['catch'](_0x53968b=>{const _0x111d72=_0x5766c2;return _0x2bc6f9[_0x111d72(0x7f)](0x194)[_0x111d72(0x144)]();});}else return _0x2bc6f9['sendFile'](_0x47440c[_0x5766c2(0xad)]);});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0xdc),(_0x5298a7,_0x79f017,_0x43f73d)=>{const _0x23b61a=_0x5a8fa1;let _0x41bc16=_0x5298a7[_0x23b61a(0x82)][_0x23b61a(0xde)]||0x32,_0x25246b=_0x5298a7['body'][_0x23b61a(0x108)]||0x0,_0x191a9e=_0x5298a7['body'][_0x23b61a(0xcf)]||_0x23b61a(0xdb),_0x1b5d0a=_0x5298a7[_0x23b61a(0x82)][_0x23b61a(0xfe)]||_0x23b61a(0x14d),_0x289c3e=_0x5298a7['body'][_0x23b61a(0xff)]||_0x23b61a(0x96),_0x56fc99=_0x5298a7['body'][_0x23b61a(0x10a)],_0x38b655=_0x5298a7[_0x23b61a(0x82)]['letterIndex'];if(dbBookIndexTable['checkOrderParams'](_0x5298a7,_0x79f017,_0x1b5d0a,_0x289c3e)!==!![])return;let _0xe38124=[_0x23b61a(0x14d),_0x23b61a(0xd4),'check_time',_0x23b61a(0x117),_0x23b61a(0xf1),'artist',_0x23b61a(0x9e),'id',_0x23b61a(0xf2)],_0x3d7b48=['asc',_0x23b61a(0x96)];if(!_0xe38124['includes'](_0x1b5d0a)||!_0x3d7b48['includes'](_0x289c3e))return _0x5298a7[_0x23b61a(0xc1)][_0x23b61a(0xa0)](_0x79f017,_0x23b61a(0x111),_0x1b5d0a,_0x289c3e);let _0x5e3933=dbUserTable['getUserPathWhere'](_0x5298a7,_0x23b61a(0x149),_0x23b61a(0x107),!![]);if(_0x5298a7[_0x23b61a(0xee)][_0x23b61a(0xdf)]!=0x1&&!_0x5e3933&&_0x191a9e!='bookList')return _0x79f017[_0x23b61a(0x142)]({'code':0x0,'data':null});let _0x347b84=[];if(_0x191a9e==_0x23b61a(0xbf))_0x347b84=dbBookIndexTable['getGroupList'](_0x5298a7[_0x23b61a(0xc1)][_0x23b61a(0x9d)],_0x5e3933,_0x191a9e,_0x41bc16,_0x25246b,_0x1b5d0a,_0x289c3e,_0x56fc99,_0x38b655);else{if(_0x191a9e==_0x23b61a(0xdb)){_0x347b84=dbBookListTable[_0x23b61a(0x116)](_0x5298a7[_0x23b61a(0xc1)][_0x23b61a(0x9d)],_0x5298a7[_0x23b61a(0xee)]['id'],_0x41bc16,_0x25246b,'id',_0x23b61a(0x96),_0x56fc99);for(let _0x34858d of _0x347b84){_0x34858d[_0x23b61a(0xc6)]=dbBookIndexTable[_0x23b61a(0xca)](_0x5298a7['app']['dbFileIndex'],_0x34858d['id']);}}}return _0x79f017[_0x23b61a(0x142)]({'code':0x0,'data':_0x347b84});}),router['post'](_0x5a8fa1(0xa3),(_0x1514b1,_0x1b8864,_0x511704)=>{const _0x1085ac=_0x5a8fa1;let _0x72c711=_0x1514b1[_0x1085ac(0x82)]['name'],_0x4246fd=_0x1514b1['body'][_0x1085ac(0xae)];if(_0x4246fd==_0x1085ac(0xfb)){if(!_0x72c711)return _0x1514b1['app']['returnErrMsg'](_0x1b8864,_0x1085ac(0x86));dbBookListTable[_0x1085ac(0xc9)](_0x1514b1[_0x1085ac(0xc1)]['dbFileIndex'],_0x1514b1[_0x1085ac(0xee)]['id'],_0x72c711);}else{if(_0x4246fd==_0x1085ac(0x126)||_0x4246fd=='delete'){let _0x1e4f88=_0x1514b1[_0x1085ac(0x82)]['bookListId'],_0x5a97e5=dbBookListTable[_0x1085ac(0x9f)](_0x1514b1['app'][_0x1085ac(0x9d)],_0x1e4f88),_0x3d750d=![];(_0x1514b1[_0x1085ac(0xee)]['is_admin']==0x1||_0x5a97e5[_0x1085ac(0x98)]==_0x1514b1[_0x1085ac(0xee)]['id'])&&(_0x3d750d=!![]);if(!_0x3d750d)return _0x1b8864['json']({'code':0x66});if(_0x4246fd=='delete')dbBookListTable[_0x1085ac(0x89)](_0x1514b1[_0x1085ac(0xc1)][_0x1085ac(0x9d)],_0x1e4f88);else{if(_0x4246fd=='edit'){if(!_0x72c711)return _0x1514b1[_0x1085ac(0xc1)][_0x1085ac(0xa0)](_0x1b8864,_0x1085ac(0x86));dbBookListTable[_0x1085ac(0x97)](_0x1514b1[_0x1085ac(0xc1)][_0x1085ac(0x9d)],_0x1e4f88,_0x72c711);}}}else return _0x1514b1[_0x1085ac(0xc1)][_0x1085ac(0xa0)](_0x1b8864,_0x1085ac(0xa5));}return _0x1b8864[_0x1085ac(0x142)]({'code':0x0});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0xb7),(_0x1c03c1,_0x31a1d3,_0x3cd54e)=>{const _0x33ab3c=_0x5a8fa1;let _0x4e0d63=_0x1c03c1[_0x33ab3c(0x82)]['bookIndexId'],_0x21dfe7=_0x1c03c1[_0x33ab3c(0x82)][_0x33ab3c(0xe7)];if(!_0x4e0d63||!_0x21dfe7)return _0x1c03c1[_0x33ab3c(0xc1)][_0x33ab3c(0xa0)](_0x31a1d3,_0x33ab3c(0x138));let _0x194bbc=dbBookListTable[_0x33ab3c(0x9f)](_0x1c03c1[_0x33ab3c(0xc1)]['dbFileIndex'],_0x21dfe7);if(!_0x194bbc)return _0x1c03c1[_0x33ab3c(0xc1)][_0x33ab3c(0xa0)](_0x31a1d3,_0x33ab3c(0x145));let _0x19047b=_0x1c03c1[_0x33ab3c(0x82)][_0x33ab3c(0xae)];if(_0x19047b==_0x33ab3c(0xfb)){function _0xfc7373(_0x4061c8){const _0x39c85f=_0x33ab3c;let _0x29fad8=dbBookIndexTable['getBookIndex'](_0x1c03c1['app'][_0x39c85f(0x9d)],_0x4061c8);if(!_0x29fad8)return;if(_0x29fad8[_0x39c85f(0x132)]==0x1){dbBookListTable[_0x39c85f(0x148)](_0x1c03c1[_0x39c85f(0xc1)][_0x39c85f(0x9d)],_0x4061c8,_0x21dfe7);let _0x471e3a=Date['now']();_0x1c03c1[_0x39c85f(0xc1)][_0x39c85f(0x9d)][_0x39c85f(0x94)](_0x39c85f(0xfa))['run'](_0x471e3a,_0x29fad8['id']);}else{let _0x1fe34c=path[_0x39c85f(0xa9)](_0x29fad8[_0x39c85f(0x93)],_0x29fad8[_0x39c85f(0x117)]),_0x23779e=_0x1c03c1[_0x39c85f(0xc1)][_0x39c85f(0x9d)][_0x39c85f(0x94)](_0x39c85f(0x8f))[_0x39c85f(0xf9)](_0x1fe34c,_0x1fe34c+path[_0x39c85f(0x114)]+'%');for(let _0x6a1e34 of _0x23779e){dbBookListTable[_0x39c85f(0x148)](_0x1c03c1['app'][_0x39c85f(0x9d)],_0x6a1e34['id'],_0x21dfe7);}}}if(_0x4e0d63 instanceof Array)for(let _0x2594aa of _0x4e0d63){_0xfc7373(_0x2594aa);}else _0xfc7373(_0x4e0d63);}else{if(_0x19047b=='delete'){if(_0x4e0d63 instanceof Array)for(let _0xad5136 of _0x4e0d63){dbBookListTable[_0x33ab3c(0x10c)](_0x1c03c1[_0x33ab3c(0xc1)]['dbFileIndex'],_0xad5136,_0x21dfe7);}else dbBookListTable[_0x33ab3c(0x10c)](_0x1c03c1[_0x33ab3c(0xc1)]['dbFileIndex'],_0x4e0d63,_0x21dfe7);}else return _0x1c03c1[_0x33ab3c(0xc1)][_0x33ab3c(0xa0)](_0x31a1d3,_0x33ab3c(0xa5));}return _0x31a1d3['json']({'code':0x0,'data':{}});}),router[_0x5a8fa1(0x12d)](_0x5a8fa1(0x13e),(_0x39a420,_0x49d902,_0x1e6dcf)=>{const _0x546bd7=_0x5a8fa1;let _0x1114e8=_0x39a420[_0x546bd7(0x82)][_0x546bd7(0xa8)],_0x5cba52=_0x39a420[_0x546bd7(0x82)]['searchStr'],_0x16990b=_0x546bd7(0x149);if(dbUserTable[_0x546bd7(0xbd)](_0x39a420,_0x49d902,_0x16990b,_0x546bd7(0x107))==!![]){let _0x3f9e5f=[];if(!_0x1114e8){let _0x5dd3ff=[];_0x39a420[_0x546bd7(0xee)]['is_admin']==0x1?_0x5dd3ff=dbSourceFolderTable[_0x546bd7(0xd9)](_0x39a420['app']['dbOther'],_0x16990b):_0x5dd3ff=dbUserTable[_0x546bd7(0x112)](_0x39a420['app'][_0x546bd7(0xb3)],_0x39a420[_0x546bd7(0xee)][_0x546bd7(0xbe)],_0x16990b);if(_0x5dd3ff)for(let _0x1eab7d=0x0;_0x1eab7d<_0x5dd3ff[_0x546bd7(0x130)];_0x1eab7d++){_0x3f9e5f['push']({'path':_0x5dd3ff[_0x1eab7d][_0x546bd7(0x93)],'is_file':0x0,'filename':path[_0x546bd7(0xc2)](_0x5dd3ff[_0x1eab7d][_0x546bd7(0x93)]),'root':!![]});}}else{let _0x115f76=[];if(_0x39a420[_0x546bd7(0xee)][_0x546bd7(0xdf)]!=0x1){if(dbUserTable['doUserCanGet'](_0x39a420,_0x49d902,_0x16990b,_0x546bd7(0x107),_0x1114e8)!==!![])return;}_0x1114e8=path[_0x546bd7(0xa9)](_0x1114e8);let _0x5c3b6f=_0x546bd7(0xce);_0x115f76['push'](_0x1114e8);if(_0x5cba52){let _0x197ce4=_0x546bd7(0xcc);_0x5c3b6f+=_0x197ce4,_0x115f76[_0x546bd7(0xba)]('%'+_0x5cba52+'%'),_0x115f76[_0x546bd7(0xba)]('%'+_0x5cba52+'%');}let _0x2ad9f5=_0x546bd7(0xa2);_0x3f9e5f=_0x39a420['app']['dbFileIndex'][_0x546bd7(0x94)](_0x546bd7(0x105)+_0x2ad9f5+_0x546bd7(0x11a)+_0x5c3b6f)[_0x546bd7(0xf9)](_0x115f76);}for(let _0x5327ae of _0x3f9e5f){if(_0x5327ae[_0x546bd7(0x132)]==0x0){let _0x2b0e85=path[_0x546bd7(0xa9)](_0x5327ae[_0x546bd7(0x93)],_0x5327ae[_0x546bd7(0x117)]),_0x223bf1=_0x39a420[_0x546bd7(0xc1)]['dbFileIndex'][_0x546bd7(0x94)](_0x546bd7(0x143))['get'](_0x2b0e85);_0x5327ae[_0x546bd7(0xb0)]=_0x223bf1[_0x546bd7(0xde)];}}let _0xa295a=path[_0x546bd7(0x114)],_0x2498bc={'code':0x0,'data':_0x3f9e5f,'sep':_0xa295a};return _0x49d902[_0x546bd7(0x142)](_0x2498bc);}}),router['post'](_0x5a8fa1(0x11f),(_0x2614a2,_0x4bf3a3,_0x2ae81a)=>{const _0x171245=_0x5a8fa1;let _0x57140a=_0x2614a2[_0x171245(0x82)][_0x171245(0xd0)],_0x50d66c=_0x2614a2[_0x171245(0x82)][_0x171245(0xae)];if(!_0x57140a)return _0x2614a2['app'][_0x171245(0xa0)](_0x4bf3a3,'need\x20index\x20id');let _0x34b90b=dbBookIndexTable[_0x171245(0x80)](_0x2614a2[_0x171245(0xc1)]['dbFileIndex'],_0x57140a);if(!_0x34b90b)return _0x2614a2[_0x171245(0xc1)][_0x171245(0xa0)](_0x4bf3a3,_0x171245(0xf0));if(_0x50d66c==_0x171245(0xec)){let _0x8c6df4={'title':_0x2614a2[_0x171245(0x82)][_0x171245(0xf1)],'publish_date':_0x2614a2[_0x171245(0x82)][_0x171245(0xb5)],'year':_0x2614a2[_0x171245(0x82)][_0x171245(0xef)],'isbn':_0x2614a2['body'][_0x171245(0x13d)],'language':_0x2614a2[_0x171245(0x82)][_0x171245(0xe8)],'genre':_0x2614a2['body'][_0x171245(0x14b)],'tag':_0x2614a2['body']['tag'],'publisher':_0x2614a2[_0x171245(0x82)][_0x171245(0xf2)],'artist':_0x2614a2['body'][_0x171245(0xbf)],'introduction':_0x2614a2['body'][_0x171245(0xb8)]},_0x3a6e89=path['join'](_0x34b90b['path'],_0x34b90b[_0x171245(0x117)]);fs[_0x171245(0x119)](_0x3a6e89,(_0xdea325,_0x130b60)=>{const _0xb7126e=_0x171245;if(_0xdea325)return _0x2614a2['app'][_0xb7126e(0xa0)](_0x4bf3a3,_0x4bf3a3['__'](_0xb7126e(0x113))+_0x3a6e89);let _0x2d06a2=_0x3a6e89['substring'](0x0,_0x3a6e89['lastIndexOf']('.'))+'.nfo';nfoUtil[_0xb7126e(0x140)](_0x8c6df4,_0x2d06a2)[_0xb7126e(0x84)](()=>{const _0x3d34d8=_0xb7126e;console[_0x3d34d8(0xaf)](_0x3d34d8(0x14f)),dbBookIndexTable[_0x3d34d8(0x9b)](_0x2614a2['app'][_0x3d34d8(0x9d)],_0x57140a,_0x8c6df4),_0x34b90b=dbBookIndexTable[_0x3d34d8(0x80)](_0x2614a2[_0x3d34d8(0xc1)][_0x3d34d8(0x9d)],_0x57140a),setBookListProps(_0x2614a2,[_0x34b90b])[_0x3d34d8(0x84)](_0x3e813b=>{const _0x750ae7=_0x3d34d8;return _0x4bf3a3[_0x750ae7(0x142)]({'code':0x0,'data':_0x3e813b[0x0]});});})[_0xb7126e(0xc8)](_0x1d1eaa=>{const _0x424c2f=_0xb7126e;return console[_0x424c2f(0xaf)](_0x424c2f(0xe2),_0x1d1eaa),_0x2614a2['app']['returnErrMsg'](_0x4bf3a3,_0x424c2f(0x92));});});}else{if(_0x50d66c==_0x171245(0x99)){let _0x644a80=path[_0x171245(0xa9)](_0x34b90b[_0x171245(0x93)],_0x34b90b[_0x171245(0x117)]),_0x5a26bb=_0x644a80[_0x171245(0x131)](0x0,_0x644a80['lastIndexOf']('.'))+_0x171245(0xb6);fs[_0x171245(0x119)](_0x5a26bb,(_0x27f20e,_0x132706)=>{const _0x5f5cdb=_0x171245;if(_0x27f20e)return _0x2614a2[_0x5f5cdb(0xc1)]['returnErrMsg'](_0x4bf3a3,_0x4bf3a3['__'](_0x5f5cdb(0x113))+_0x5a26bb);fs['rm'](_0x5a26bb,_0x1cc6b6=>{const _0x25c4bf=_0x5f5cdb;if(_0x1cc6b6)return _0x2614a2['app'][_0x25c4bf(0xa0)](_0x4bf3a3,_0x4bf3a3['__'](_0x25c4bf(0xf5))+_0x5a26bb);return dbBookIndexTable[_0x25c4bf(0x9b)](_0x2614a2[_0x25c4bf(0xc1)]['dbFileIndex'],indexId,{}),_0x4bf3a3['json']({'code':0x0});});});}else return _0x2614a2[_0x171245(0xc1)][_0x171245(0xa0)](_0x4bf3a3,_0x171245(0xa5));}}),module[_0x5a8fa1(0xe6)]=router;