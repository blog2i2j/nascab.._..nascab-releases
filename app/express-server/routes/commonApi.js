const _0x3a7355=_0x36e6;(function(_0x40b0c6,_0x3a13eb){const _0x28cb8a=_0x36e6,_0xca6d2=_0x40b0c6();while(!![]){try{const _0x4049af=-parseInt(_0x28cb8a(0x1e0))/0x1*(-parseInt(_0x28cb8a(0x1ea))/0x2)+-parseInt(_0x28cb8a(0x2a8))/0x3+parseInt(_0x28cb8a(0x1cd))/0x4+-parseInt(_0x28cb8a(0x25d))/0x5+parseInt(_0x28cb8a(0x254))/0x6*(parseInt(_0x28cb8a(0x299))/0x7)+parseInt(_0x28cb8a(0x239))/0x8+-parseInt(_0x28cb8a(0x203))/0x9;if(_0x4049af===_0x3a13eb)break;else _0xca6d2['push'](_0xca6d2['shift']());}catch(_0x406ae9){_0xca6d2['push'](_0xca6d2['shift']());}}}(_0x5b19,0x493d7));var express=require(_0x3a7355(0x27b)),router=express[_0x3a7355(0x29c)]();let config=require(_0x3a7355(0x1b8)),dbFileIndexTable=require(_0x3a7355(0x211)),dbConfigTable=require(_0x3a7355(0x276)),dbSourceTable=require('../../db/dbSourceFolderTable'),dbNoticeCenterTable=require(_0x3a7355(0x2af)),netUtils=require(_0x3a7355(0x1df));const dbUserTable=require(_0x3a7355(0x218)),dbBackupTask=require(_0x3a7355(0x24b)),OS=require('os');function _0x36e6(_0x49b7d3,_0x3d4fd9){const _0x5b197c=_0x5b19();return _0x36e6=function(_0x36e6fb,_0x13d8c4){_0x36e6fb=_0x36e6fb-0x1ad;let _0x485f08=_0x5b197c[_0x36e6fb];return _0x485f08;},_0x36e6(_0x49b7d3,_0x3d4fd9);}let path=require(_0x3a7355(0x1b3)),fs=require('fs'),fileUtil=require(_0x3a7355(0x1c3));var package=require(_0x3a7355(0x231));const sqliteUtil=require(_0x3a7355(0x1ca));let nasAccountUtil=require(_0x3a7355(0x1e5));const sharp=require(_0x3a7355(0x24e)),si=require('systeminformation');let tls=require(_0x3a7355(0x234));function _0x5b19(){const _0x20696d=['getAll','copy_size','customHomeBgImage','log','globalIpList','989412WyLWrN','power_get','returnErrMsg','autoLoginClient','/shouldShowTour','excludePathPhoto','app','../../db/dbNoticeCenterTable','autoShowWindow','serverName','userDataFolder','title','/saveConfig','cpuTemperature','path','apiPort','fullPath','showMenuArr','send','../../myConfig/config','ipBan','id3tag','startFaceAiWork','language','operationFail','-----','cacheImageInfo','webDavHttpsKey','need\x20path','/getSystemInfo','../utils/fileUtils','custom','hostname','slow','error\x20keys','checkSqlInjection','/getBgTask','../utils/sqliteUtil','system','json','1701348uGZyHS','run','graphics','version','httpsCert','ipDetection','music','moviePreferLanguage','access','existsSync','end','exec','\x20title\x20in\x20(\x27globalCpuInfo\x27,\x27globalMemInfo\x27,\x27','movieHomeShowHistory','openPath','/vaccumDb','toFile','length','../utils/netUtils','5RUFSJD','onlySupportOnServerApp','findByTitleArr','databaseFolder','defaultTranscodeResolution','../utils/nasAccountUtils','constants','count','INDEX_TABLE_NAME_PHOTO','isVip','217662hkuuaG','cachePathInvalid','wal_checkpoint(RESTART)','getGlobalInfo','movieHomeShowMyMedia','totalmem','appRootPath','INDEX_TABLE_NAME_MOVIE','apiPortHttps','webDavUseApiCert','prepare','/getAllConfig','returnFileError','notSupportForAutoUpdate','/getServerIpAndSign','excludeFilenameMovie','autoLaunch','darwin','movieShowMatchName','Relaunch','movieTmdbApiKey','httpsKey','twoStepLogin','subtitle','isWinDisk','4279689tOgdaB','create','imgFolder','folder','includes','aiSimilarPhotoEnable','startUpdate','\x20title\x20in\x20(\x27apiServer\x27,\x27apiServerHttps\x27,\x27webDavServer\x27,\x27FTPServer\x27,\x27globalIpList\x27)','dbFileIndex','win32','book','vacuum','/deleteBgTask','photo','../../db/dbFileIndexTable','join','CRF:\x201-51','/saveConfigMovie','ipMode','/saveConfigMusic','movieDatabaseType','../../db/dbUserTable','/setLanguage','transCodeReadRate','post','localhost','folderNotExist','networkInterfaces','/saveConfigPhoto','parse','currentUser','ip\x20not\x20allow','shell','value','dbOther','useFolderPictureAsPoster','customLogoImage','createSecureContext','getClientIp','REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tour_record(page,version,username)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,\x20?,?)','then','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','tmdbProxyUrl','defaultWebDavPortHttps','versionInfo','refreshIpList','../../../package.json','/getLanguage','diskLayout','tls','openType','transCodeParams-CoderNameH264','FTPPort','getById','524224YcjrmQ','webDavPort','tokenKeepHour','push','serverType','deleteByTitle','stringify','startClassesAiWork','force','memLayout','exports','all','allConfig','get','stat','type','startsWith','moviePlaylongPressRate','../../db/dbBackupTask','getAllByWhere','defaultFTPPort','sharp','osInfo','fast','battery','webDavPortHttps','findByTitle','36hkTkxg','defaultApiPort','transcodePath','crf','aiFaceMinPhotoCount','movieTmdbLanguage','/resetIndex','rotate','movieHomeShowLibrary','710610IhZlEL','customLoginTitle','taskState','ultrafast','is_admin','getUnReadCount','/getSystemInfomation','SELECT\x20*\x20FROM\x20bg_task\x20WHERE\x20task_state=?\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','webDavHttpsCert','bluetoothDevices','aiClassesEnable','R_OK','apiServerHttps','INDEX_TABLE_NAME_MUSIC','/getVersionInfo','defaultWebDavPort','isAdmin','subtitlePreGen','getIpList','mem','platform','wifiNetworks','keys','mkdir','transcodeSpeed','../../db/dbConfigTable','total_size','customLoginImage','bios','music-TitleType','express','httpsCertError','memTooLess','excludeFilenamePhoto','defaultThreadCount','cpu','W_OK','aiFaceEnable','body','chassis','imgFolderUsable','transCodeCoderNameHevc','globalIndexInfo','medium','getDiskInfo','clearTable','cache','threadCount','autoScanSource','cpus','upload','setting.portInvalid','DELETE\x20FROM\x20bg_task\x20WHERE\x20id=?','filename','excludePathMovie','excludePathFolderBrowser','database','cacheParentPath','unreadMsgCount','subtitleSize','247821vjTmxO','webp','maxThreadCountIs','Router','autoHardAccDecode','proxy.isntVip','customShareUrl','movie','getUpdateInfo','notSupport'];_0x5b19=function(){return _0x20696d;};return _0x5b19();}function testCertAndKeyMatch(_0x5ca417,_0x5d0ff6){const _0x139e01=_0x3a7355;try{return tls[_0x139e01(0x228)]({'cert':_0x5ca417,'key':_0x5d0ff6}),!![];}catch(_0x43892b){return![];}}router[_0x3a7355(0x21b)](_0x3a7355(0x26b),(_0xd6e760,_0x381bb6,_0x1f8821)=>{const _0x2613aa=_0x3a7355;let _0x3585a3=package[_0x2613aa(0x1d0)],_0x6735c8=dbConfigTable[_0x2613aa(0x253)](_0xd6e760['app'][_0x2613aa(0x225)],_0x2613aa(0x22f)),_0x3c5632=dbConfigTable[_0x2613aa(0x253)](_0xd6e760['app'][_0x2613aa(0x225)],_0x2613aa(0x1b6));process[_0x2613aa(0x1b7)]({'type':_0x2613aa(0x1ed),'func':_0x2613aa(0x2a1)}),_0x381bb6['json']({'code':0x0,'showMenuArr':_0x3c5632?JSON[_0x2613aa(0x220)](_0x3c5632[_0x2613aa(0x224)]):'','versionInfo':_0x6735c8?JSON[_0x2613aa(0x220)](_0x6735c8[_0x2613aa(0x224)]):'','currentVersion':_0x3585a3});}),router[_0x3a7355(0x21b)]('/updateNewVersion',(_0x3e8e1a,_0x1e6b74,_0x412142)=>{const _0x36d6af=_0x3a7355;if(OS[_0x36d6af(0x271)]()!=_0x36d6af(0x20c)&&OS['platform']()!=_0x36d6af(0x1fb))return _0x3e8e1a[_0x36d6af(0x2ae)][_0x36d6af(0x2aa)](_0x1e6b74,_0x1e6b74['__'](_0x36d6af(0x1f7)));return process[_0x36d6af(0x1b7)]({'type':_0x36d6af(0x209)}),_0x1e6b74['json']({'code':0x0});}),router[_0x3a7355(0x21b)](_0x3a7355(0x1c9),(_0x49098c,_0x413b0e,_0x19181e)=>{const _0x3e8525=_0x3a7355;let _0x163373=netUtils['getClientIp'](_0x49098c),_0x4c62c6=_0x49098c['body'][_0x3e8525(0x25f)],_0x9774ce=_0x49098c[_0x3e8525(0x283)][_0x3e8525(0x1e7)],_0x573ca0=_0x49098c['body']['offset'],_0x4cfe45=[];if(_0x49098c[_0x3e8525(0x221)][_0x3e8525(0x261)]==0x1){_0x4cfe45=_0x49098c[_0x3e8525(0x2ae)][_0x3e8525(0x225)]['prepare'](_0x3e8525(0x264))[_0x3e8525(0x244)](_0x4c62c6,_0x9774ce,_0x573ca0);let _0x3f9a8f=dbBackupTask['getAllRecordByWhere'](_0x49098c['app'][_0x3e8525(0x225)],_0x3e8525(0x22c),[]);for(let _0x37b585 in _0x3f9a8f){let _0x4a6fd4=_0x3f9a8f[_0x37b585],_0xa591e5=dbBackupTask[_0x3e8525(0x238)](_0x49098c[_0x3e8525(0x2ae)][_0x3e8525(0x225)],_0x4a6fd4['task_id']);_0x4cfe45[_0x3e8525(0x23c)]({'task_type':'BACKUP','task_name':_0xa591e5?_0xa591e5['task_name']:'','size_current':_0x4a6fd4[_0x3e8525(0x2a4)],'size_all':_0x4a6fd4[_0x3e8525(0x277)]});}}let _0x295f14={'code':0x0,'data':_0x4cfe45,'reqIp':_0x163373};return _0x413b0e[_0x3e8525(0x1cc)](_0x295f14);}),router[_0x3a7355(0x21b)](_0x3a7355(0x20f),(_0x3b8791,_0x3a0940,_0x4ac99e)=>{const _0x164cb3=_0x3a7355;let _0x5053a3=_0x3b8791['body']['taskId'];dbUserTable[_0x164cb3(0x26d)](_0x3b8791,_0x3a0940)===!![]&&_0x3b8791[_0x164cb3(0x2ae)][_0x164cb3(0x225)][_0x164cb3(0x1f4)](_0x164cb3(0x291))[_0x164cb3(0x1ce)](_0x5053a3);let _0x4f70b5={'code':0x0};return _0x3a0940[_0x164cb3(0x1cc)](_0x4f70b5);}),router[_0x3a7355(0x21b)](_0x3a7355(0x1dc),(_0x25cf83,_0x3fa53b,_0x39ecab)=>{const _0x3214e3=_0x3a7355;try{return _0x25cf83[_0x3214e3(0x2ae)][_0x3214e3(0x225)]['exec'](_0x3214e3(0x20e)),_0x25cf83['app'][_0x3214e3(0x20b)][_0x3214e3(0x1d8)](_0x3214e3(0x20e)),_0x25cf83[_0x3214e3(0x2ae)][_0x3214e3(0x225)]['pragma'](_0x3214e3(0x1ec)),_0x25cf83[_0x3214e3(0x2ae)][_0x3214e3(0x20b)]['pragma'](_0x3214e3(0x1ec)),_0x3fa53b[_0x3214e3(0x1cc)]({'code':0x0});}catch(_0x2e32a8){return _0x25cf83[_0x3214e3(0x2ae)][_0x3214e3(0x2aa)](_0x3fa53b,_0x3fa53b['__']('operationFail'));}}),router[_0x3a7355(0x21b)](_0x3a7355(0x25a),(_0x3486cf,_0x2e498c,_0x14a2d2)=>{const _0x5eb468=_0x3a7355;if(_0x3486cf[_0x5eb468(0x221)][_0x5eb468(0x261)]!=0x1)return _0x2e498c[_0x5eb468(0x1cc)]({'code':0x66});let _0x35e700=_0x3486cf[_0x5eb468(0x283)][_0x5eb468(0x23d)];dbSourceTable[_0x5eb468(0x28a)](_0x3486cf[_0x5eb468(0x2ae)][_0x5eb468(0x225)],_0x35e700);if(_0x35e700==_0x5eb468(0x2a0))dbFileIndexTable['clearTable'](_0x3486cf[_0x5eb468(0x2ae)]['dbFileIndex'],dbFileIndexTable[_0x5eb468(0x1f1)]);else{if(_0x35e700==_0x5eb468(0x210))dbFileIndexTable[_0x5eb468(0x28a)](_0x3486cf[_0x5eb468(0x2ae)]['dbFileIndex'],dbFileIndexTable[_0x5eb468(0x1e8)]);else{if(_0x35e700==_0x5eb468(0x1d3))dbFileIndexTable[_0x5eb468(0x28a)](_0x3486cf['app'][_0x5eb468(0x20b)],dbFileIndexTable[_0x5eb468(0x26a)]);else _0x35e700==_0x5eb468(0x20d)&&dbFileIndexTable['clearTable'](_0x3486cf[_0x5eb468(0x2ae)][_0x5eb468(0x20b)],dbFileIndexTable['INDEX_TABLE_NAME_BOOK']);}}_0x2e498c[_0x5eb468(0x1cc)]({'code':0x0});}),router['post'](_0x3a7355(0x1f8),(_0xa29862,_0x13ce16,_0x172f54)=>{const _0x49127b=_0x3a7355;process[_0x49127b(0x1b7)]({'type':'getGlobalInfo','func':'getIpList'});let _0x2bd4a6=dbConfigTable['findByTitle'](_0xa29862['app'][_0x49127b(0x225)],_0x49127b(0x2a7)),_0x11a170=dbConfigTable[_0x49127b(0x253)](_0xa29862['app'][_0x49127b(0x225)],'apiServer'),_0x695a48=dbConfigTable[_0x49127b(0x253)](_0xa29862[_0x49127b(0x2ae)][_0x49127b(0x225)],_0x49127b(0x269)),_0x34e8cf={'code':0x0,'ipList':_0x2bd4a6,'apiServer':_0x11a170,'apiServerHttps':_0x695a48,'hostName':OS['hostname']()};return _0x13ce16['json'](_0x34e8cf);}),router['post']('/getServerState',(_0x559034,_0x2238dd,_0xc575f4)=>{const _0x5b0098=_0x3a7355;let _0x42019e=netUtils[_0x5b0098(0x229)](_0x559034),_0x3b32d4=_0x559034['body'][_0x5b0098(0x1ae)],_0x246a4a;_0x3b32d4=='all'?(process[_0x5b0098(0x1b7)]({'type':'getGlobalInfo','func':_0x5b0098(0x26f)}),_0x246a4a=dbConfigTable[_0x5b0098(0x24c)](_0x559034[_0x5b0098(0x2ae)][_0x5b0098(0x225)],_0x5b0098(0x20a))):_0x246a4a=dbConfigTable['findByTitle'](_0x559034[_0x5b0098(0x2ae)]['dbOther'],_0x3b32d4);let _0x177a0c=dbConfigTable[_0x5b0098(0x253)](_0x559034[_0x5b0098(0x2ae)][_0x5b0098(0x225)],'ddnsIpv6Address'),_0x2b5eaf={'code':0x0,'data':_0x246a4a,'hostName':OS[_0x5b0098(0x1c5)](),'reqIp':_0x42019e};_0x177a0c&&_0x177a0c[_0x5b0098(0x224)]&&(_0x2b5eaf['ddnsIpv6Address']=_0x177a0c[_0x5b0098(0x224)]);let _0x26a3b8=dbNoticeCenterTable[_0x5b0098(0x262)](_0x559034[_0x5b0098(0x2ae)]['dbOther']);return _0x2b5eaf[_0x5b0098(0x297)]=_0x26a3b8[_0x5b0098(0x1e7)],_0x2238dd[_0x5b0098(0x1cc)](_0x2b5eaf);}),router[_0x3a7355(0x21b)]('/getSystemState',(_0x358e0f,_0x4a5952,_0x14e261)=>{const _0x32a288=_0x3a7355;let _0x536a13=netUtils['getClientIp'](_0x358e0f),_0x415055=_0x358e0f[_0x32a288(0x283)][_0x32a288(0x241)],_0x49c58d=_0x32a288(0x287)+dbFileIndexTable[_0x32a288(0x1f1)],_0x3f7088=_0x32a288(0x287)+dbFileIndexTable[_0x32a288(0x1e8)];process[_0x32a288(0x1b7)]({'type':_0x32a288(0x1ed),'func':'getAllIndexInfo'}),process[_0x32a288(0x1b7)]({'type':_0x32a288(0x1ed),'func':_0x32a288(0x289),'force':_0x415055}),fs[_0x32a288(0x247)](config[_0x32a288(0x296)],_0x29004a=>{const _0x58a639=_0x32a288;if(_0x29004a)return _0x358e0f['app'][_0x58a639(0x2aa)](_0x4a5952,_0x4a5952['__'](_0x58a639(0x1eb)));else{let _0x446896=dbConfigTable[_0x58a639(0x24c)](_0x358e0f[_0x58a639(0x2ae)][_0x58a639(0x225)],_0x58a639(0x1d9)+_0x49c58d+'\x27,\x27'+_0x3f7088+'\x27,\x27globalDiskInfo\x27)');return _0x4a5952[_0x58a639(0x1cc)]({'code':0x0,'data':_0x446896,'version':package[_0x58a639(0x1d0)],'reqIp':_0x536a13,'platform':OS[_0x58a639(0x271)]()});}});}),router[_0x3a7355(0x21b)](_0x3a7355(0x2ac),(_0x31b6fb,_0x3610cd,_0x4a72cf)=>{const _0x347583=_0x3a7355;let _0x4d73f3=_0x31b6fb['body']['page'],_0x19e0ee=package['version'],_0x2f4c53=_0x31b6fb[_0x347583(0x221)]['username'],_0x10d5ff=_0x31b6fb[_0x347583(0x2ae)]['dbOther']['prepare']('SELECT\x20*\x20from\x20tour_record\x20where\x20page=?\x20and\x20version=?\x20and\x20username=?')[_0x347583(0x246)](_0x4d73f3,_0x19e0ee,_0x2f4c53);if(!_0x10d5ff){const _0x49dcbd=_0x347583(0x22a);_0x31b6fb[_0x347583(0x2ae)][_0x347583(0x225)][_0x347583(0x1f4)](_0x49dcbd)[_0x347583(0x1ce)](_0x4d73f3,_0x19e0ee,_0x2f4c53);}return _0x3610cd[_0x347583(0x1cc)]({'code':0x0,'show':_0x10d5ff?0x0:0x1});}),router['post'](_0x3a7355(0x1f5),(_0x58f6f5,_0x2cecb4,_0x1264e9)=>{const _0x5c3e97=_0x3a7355;let _0x23564b=_0x58f6f5['body'][_0x5c3e97(0x273)],_0x4e0f65;if(_0x23564b&&_0x23564b[_0x5c3e97(0x1de)]>0x0){if(sqliteUtil[_0x5c3e97(0x1c8)](_0x23564b)==!![])return _0x58f6f5[_0x5c3e97(0x2ae)][_0x5c3e97(0x2aa)](_0x2cecb4,_0x5c3e97(0x1c7));_0x4e0f65=dbConfigTable[_0x5c3e97(0x1e2)](_0x58f6f5[_0x5c3e97(0x2ae)][_0x5c3e97(0x225)],_0x23564b);}else _0x4e0f65=dbConfigTable[_0x5c3e97(0x2a3)](_0x58f6f5['app']['dbOther']);for(let _0x3b3337 in _0x4e0f65){let _0x491582=_0x4e0f65[_0x3b3337];(_0x491582['title']=='httpsCert'||_0x491582[_0x5c3e97(0x1b0)]==_0x5c3e97(0x1ff))&&(!_0x491582[_0x5c3e97(0x224)]['startsWith']('-----')&&(_0x491582[_0x5c3e97(0x224)]=''));}let _0x15a046={};_0x15a046[_0x5c3e97(0x255)]=config[_0x5c3e97(0x1b4)],_0x15a046['defaultApiPortHttps']=config[_0x5c3e97(0x1f2)],_0x15a046[_0x5c3e97(0x26c)]=config[_0x5c3e97(0x23a)],_0x15a046[_0x5c3e97(0x22e)]=config[_0x5c3e97(0x252)],_0x15a046[_0x5c3e97(0x24d)]=config['FTPPort'],_0x15a046[_0x5c3e97(0x27f)]=0x2,_0x15a046[_0x5c3e97(0x245)]=_0x4e0f65,nasAccountUtil['isVip'](null,_0x58f6f5[_0x5c3e97(0x2ae)][_0x5c3e97(0x225)])[_0x5c3e97(0x22b)](_0x40d532=>{_0x2cecb4['json']({'code':0x0,'data':_0x15a046,'isVip':_0x40d532});});}),router[_0x3a7355(0x21b)](_0x3a7355(0x232),(_0x542807,_0x2d3d87,_0x19e158)=>{const _0x18c6f0=_0x3a7355;let _0x27c7e5=dbConfigTable['findByTitle'](_0x542807[_0x18c6f0(0x2ae)][_0x18c6f0(0x225)],_0x18c6f0(0x1bc)),_0x3bc139='';_0x27c7e5&&(_0x3bc139=_0x27c7e5['value']),_0x2d3d87[_0x18c6f0(0x1cc)]({'code':0x0,'data':_0x3bc139});}),router[_0x3a7355(0x21b)](_0x3a7355(0x219),(_0x2d4d2b,_0x3d24b1,_0x514844)=>{const _0x4ef51d=_0x3a7355;let _0x366624=netUtils['getClientIp'](_0x2d4d2b);if(_0x366624!=_0x4ef51d(0x21c))return _0x4ef51d(0x222);let _0x3f17c7=_0x2d4d2b[_0x4ef51d(0x283)][_0x4ef51d(0x1bc)];if(!_0x3f17c7)return _0x3d24b1['status'](0x194)[_0x4ef51d(0x1d7)]();return dbConfigTable[_0x4ef51d(0x204)](_0x2d4d2b['app']['dbOther'],{'title':_0x4ef51d(0x1bc),'value':_0x3f17c7}),_0x3d24b1[_0x4ef51d(0x1cc)]({'code':0x0});});function saveConfig(_0xd67099,_0x40118b,_0x267e82){const _0x48a827=_0x3a7355;dbConfigTable[_0x48a827(0x204)](_0xd67099,{'title':_0x40118b,'value':_0x267e82+''});}router[_0x3a7355(0x21b)]('/changeCachePath',(_0x2332d3,_0x5d1ce6,_0x51cbb4)=>{const _0x1f087d=_0x3a7355;let _0x2ae665=_0x2332d3[_0x1f087d(0x283)]['cachePath'];if(_0x2332d3[_0x1f087d(0x221)]['is_admin']!=0x1)return _0x5d1ce6[_0x1f087d(0x1cc)]({'code':0x66});if(_0x2ae665)fs[_0x1f087d(0x1d5)](_0x2ae665,fs[_0x1f087d(0x1e6)][_0x1f087d(0x281)]|fs[_0x1f087d(0x1e6)][_0x1f087d(0x268)],_0x39dbee=>{const _0x35d0a1=_0x1f087d;return!_0x39dbee?(saveConfig(_0x2332d3['app'][_0x35d0a1(0x225)],_0x35d0a1(0x296),_0x2ae665),_0x5d1ce6[_0x35d0a1(0x1cc)]({'code':0x0})):fileUtil[_0x35d0a1(0x1f6)](_0x5d1ce6,_0x39dbee);});else return dbConfigTable[_0x1f087d(0x23e)](_0x2332d3['app'][_0x1f087d(0x225)],_0x1f087d(0x296)),_0x5d1ce6[_0x1f087d(0x1cc)]({'code':0x0});});let forbiddenPorts=[0x1,0x7,0x9,0xb,0xd,0xf,0x11,0x13,0x14,0x15,0x16,0x17,0x19,0x25,0x2a,0x2b,0x35,0x4d,0x4f,0x57,0x5f,0x65,0x66,0x67,0x68,0x6d,0x6e,0x6f,0x71,0x73,0x75,0x77,0x7b,0x87,0x8b,0x8f,0xb3,0x185,0x1d1,0x200,0x201,0x202,0x203,0x20e,0x212,0x213,0x214,0x21c,0x22c,0x233,0x24b,0x259,0x27c,0x3e1,0x3e3,0x801,0xe4b,0xfcd,0x1770,0x1a09,0x1a0a,0x1a0b,0x1a0c,0x1a0d,0xd3d];router[_0x3a7355(0x21b)](_0x3a7355(0x1b1),(_0x573e49,_0x271dff,_0x38824)=>{const _0x10b480=_0x3a7355;let _0x81f659=_0x573e49['body'][_0x10b480(0x1b4)],_0x483c61=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1f2)],_0x125ba4=_0x573e49[_0x10b480(0x283)][_0x10b480(0x23a)],_0x469c09=_0x573e49[_0x10b480(0x283)][_0x10b480(0x252)],_0x38cd04=_0x573e49[_0x10b480(0x283)][_0x10b480(0x237)],_0x1e2d23=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1fa)],_0x541649=_0x573e49[_0x10b480(0x283)]['autoLoginClient'],_0x29b6aa=_0x573e49['body'][_0x10b480(0x1ad)],_0x4d39d2=_0x573e49[_0x10b480(0x283)][_0x10b480(0x28d)],_0x262388=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1ff)],_0x48bb45=_0x573e49['body'][_0x10b480(0x1d1)],_0x3d95fe=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1c0)],_0x435443=_0x573e49[_0x10b480(0x283)]['webDavHttpsCert'],_0x2e0ccf=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1bc)],_0x5bfaa6=_0x573e49[_0x10b480(0x283)][_0x10b480(0x28c)],_0x89de57=_0x573e49[_0x10b480(0x283)]['excludePathMovie'],_0x51c63a=_0x573e49[_0x10b480(0x283)][_0x10b480(0x2ad)],_0x5ccb9b=_0x573e49[_0x10b480(0x283)][_0x10b480(0x294)],_0x594e7a=_0x573e49[_0x10b480(0x283)]['excludeFilenameMovie'],_0x1892ae=_0x573e49[_0x10b480(0x283)][_0x10b480(0x27e)],_0x1fbd94=_0x573e49['body'][_0x10b480(0x1b6)],_0xf3baa5=_0x573e49[_0x10b480(0x283)][_0x10b480(0x23b)],_0x2b5c01=_0x573e49[_0x10b480(0x283)][_0x10b480(0x29f)],_0x1a052f=_0x573e49[_0x10b480(0x283)][_0x10b480(0x1f3)];if(_0x573e49[_0x10b480(0x221)][_0x10b480(0x261)]!=0x1)return _0x271dff[_0x10b480(0x1cc)]({'code':0x66});let _0x3e57ee=0xffdc;if(_0x81f659>_0x3e57ee||_0x125ba4>_0x3e57ee||_0x38cd04>_0x3e57ee||_0x469c09>_0x3e57ee)return _0x271dff[_0x10b480(0x1cc)]({'code':0x1,'message':'port:\x20256-65500'});let _0xda90bc=_0x573e49['app']['dbOther'];_0x1fbd94&&saveConfig(_0xda90bc,_0x10b480(0x1b6),JSON['stringify'](_0x1fbd94));_0x2b5c01&&saveConfig(_0xda90bc,_0x10b480(0x29f),_0x2b5c01);_0x89de57&&saveConfig(_0xda90bc,_0x10b480(0x293),JSON[_0x10b480(0x23f)](_0x89de57));_0xf3baa5&&parseInt(_0xf3baa5)!=NaN&&_0xf3baa5>0x0&&_0xf3baa5<0x5f5e0ff&&saveConfig(_0xda90bc,_0x10b480(0x23b),_0xf3baa5);_0x51c63a&&saveConfig(_0xda90bc,_0x10b480(0x2ad),JSON[_0x10b480(0x23f)](_0x51c63a));if(_0x5ccb9b){let _0x312216=netUtils[_0x10b480(0x229)](_0x573e49);if(_0x312216==_0x10b480(0x21c)){for(let _0x2a1284 in _0x5ccb9b){let _0x37447c=_0x5ccb9b[_0x2a1284],_0x327d28=fs['existsSync'](_0x37447c);if(!_0x327d28)return _0x573e49[_0x10b480(0x2ae)][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x21d))+':'+_0x37447c);fileUtil[_0x10b480(0x202)](_0x37447c)&&(_0x5ccb9b[_0x2a1284]=_0x37447c['toUpperCase']());}saveConfig(_0xda90bc,_0x10b480(0x294),JSON['stringify'](_0x5ccb9b));}else return _0x573e49[_0x10b480(0x2ae)][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x1e1)));}_0x594e7a&&saveConfig(_0xda90bc,_0x10b480(0x1f9),JSON[_0x10b480(0x23f)](_0x594e7a));_0x1892ae&&saveConfig(_0xda90bc,_0x10b480(0x27e),JSON[_0x10b480(0x23f)](_0x1892ae));if(_0x81f659){if(forbiddenPorts['includes'](parseInt(_0x81f659)))return _0x573e49[_0x10b480(0x2ae)][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x290))+':http');saveConfig(_0xda90bc,_0x10b480(0x1b4),parseInt(_0x81f659));}if(_0x483c61){if(forbiddenPorts[_0x10b480(0x207)](parseInt(_0x483c61))||_0x483c61==_0x81f659)return _0x573e49['app'][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x290))+':https');saveConfig(_0xda90bc,_0x10b480(0x1f2),parseInt(_0x483c61));}_0x573e49['body'][_0x10b480(0x1b9)]&&saveConfig(_0xda90bc,_0x10b480(0x1b9),_0x573e49['body'][_0x10b480(0x1b9)]);_0x573e49[_0x10b480(0x283)][_0x10b480(0x215)]&&(saveConfig(_0xda90bc,_0x10b480(0x215),_0x573e49[_0x10b480(0x283)][_0x10b480(0x215)]),_0x573e49['app'][_0x10b480(0x230)]());_0x573e49[_0x10b480(0x283)][_0x10b480(0x1d2)]&&saveConfig(_0xda90bc,_0x10b480(0x1d2),_0x573e49[_0x10b480(0x283)]['ipDetection']);_0x573e49['body'][_0x10b480(0x200)]&&saveConfig(_0xda90bc,_0x10b480(0x200),_0x573e49['body'][_0x10b480(0x200)]);_0x125ba4&&saveConfig(_0xda90bc,_0x10b480(0x23a),parseInt(_0x125ba4));_0x469c09&&saveConfig(_0xda90bc,'webDavPortHttps',parseInt(_0x469c09));_0x38cd04&&saveConfig(_0xda90bc,'FTPPort',parseInt(_0x38cd04));_0x1e2d23&&saveConfig(_0xda90bc,'autoLaunch',_0x1e2d23);_0x541649&&saveConfig(_0xda90bc,_0x10b480(0x2ab),_0x541649);_0x29b6aa&&saveConfig(_0xda90bc,_0x10b480(0x1ad),_0x29b6aa);_0x4d39d2&&saveConfig(_0xda90bc,_0x10b480(0x28d),_0x4d39d2);let _0x137aa4=dbConfigTable['findByTitle'](_0x573e49['app'][_0x10b480(0x225)],'useNasCabCerts');if(!_0x137aa4||_0x137aa4[_0x10b480(0x224)]==0x0){if(_0x262388!='*'&&_0x48bb45!='*'){if(_0x262388&&_0x48bb45){if(!_0x262388[_0x10b480(0x249)](_0x10b480(0x1be))||!_0x48bb45[_0x10b480(0x249)](_0x10b480(0x1be)))return _0x573e49[_0x10b480(0x2ae)][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__']('httpsCertError'));const _0x5c3924=testCertAndKeyMatch(_0x48bb45,_0x262388);if(!_0x5c3924)return _0x573e49['app'][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x27c)));saveConfig(_0xda90bc,_0x10b480(0x1ff),_0x262388),saveConfig(_0xda90bc,_0x10b480(0x1d1),_0x48bb45);}else saveConfig(_0xda90bc,_0x10b480(0x1ff),''),saveConfig(_0xda90bc,'httpsCert','');}}_0x1a052f&&saveConfig(_0xda90bc,_0x10b480(0x1f3),_0x1a052f);_0x1a052f=dbConfigTable[_0x10b480(0x253)](_0x573e49[_0x10b480(0x2ae)]['dbOther'],_0x10b480(0x1f3));if(!_0x1a052f||_0x1a052f[_0x10b480(0x224)]==0x0){if(_0x3d95fe!='*'&&_0x435443!='*'){if(_0x3d95fe&&_0x435443){if(!_0x3d95fe[_0x10b480(0x249)](_0x10b480(0x1be))||!_0x435443[_0x10b480(0x249)](_0x10b480(0x1be)))return _0x573e49[_0x10b480(0x2ae)][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__']('httpsCertError'));const _0x4436c7=testCertAndKeyMatch(_0x3d95fe,_0x435443);if(!_0x4436c7)return _0x573e49['app'][_0x10b480(0x2aa)](_0x271dff,_0x271dff['__'](_0x10b480(0x27c)));saveConfig(_0xda90bc,_0x10b480(0x1c0),_0x3d95fe),saveConfig(_0xda90bc,_0x10b480(0x265),_0x435443);}else saveConfig(_0xda90bc,_0x10b480(0x1c0),''),saveConfig(_0xda90bc,_0x10b480(0x265),'');}}_0x2e0ccf&&saveConfig(_0xda90bc,_0x10b480(0x1bc),_0x2e0ccf);if(_0x5bfaa6){if(_0x5bfaa6>OS[_0x10b480(0x28e)]()[_0x10b480(0x1de)])return _0x573e49[_0x10b480(0x2ae)]['returnErrMsg'](_0x271dff,_0x271dff['__'](_0x10b480(0x29b))+OS[_0x10b480(0x28e)]()[_0x10b480(0x1de)]);saveConfig(_0xda90bc,_0x10b480(0x28c),_0x5bfaa6);}return _0x271dff[_0x10b480(0x1cc)]({'code':0x0});}),router['post'](_0x3a7355(0x21f),(_0x402c4e,_0x448d13,_0x404e76)=>{const _0x4a349a=_0x3a7355;if(_0x402c4e[_0x4a349a(0x221)]['is_admin']!=0x1)return _0x448d13[_0x4a349a(0x1cc)]({'code':0x66});let _0x13896b=_0x402c4e['app']['dbOther'],_0x1ab816=_0x402c4e['body'][_0x4a349a(0x267)],_0x16bc47=_0x402c4e['body'][_0x4a349a(0x282)],_0x336e1b=_0x402c4e['body'][_0x4a349a(0x208)],_0x499cec=_0x402c4e[_0x4a349a(0x283)][_0x4a349a(0x258)];if(_0x1ab816){if(_0x1ab816==0x1){if(OS['totalmem']()/0x400/0x400/0x400<0x3)return _0x402c4e[_0x4a349a(0x2ae)]['returnErrMsg'](_0x448d13,_0x448d13['__'](_0x4a349a(0x27d)));}saveConfig(_0x13896b,_0x4a349a(0x267),_0x1ab816);if(_0x1ab816==0x1)process[_0x4a349a(0x1b7)]({'type':_0x4a349a(0x240)});}_0x499cec&&saveConfig(_0x13896b,_0x4a349a(0x258),_0x499cec);if(_0x16bc47){if(_0x16bc47==0x1){if(OS[_0x4a349a(0x1ef)]()/0x400/0x400/0x400<0x3)return _0x402c4e[_0x4a349a(0x2ae)][_0x4a349a(0x2aa)](_0x448d13,_0x448d13['__']('memTooLess'));}saveConfig(_0x13896b,_0x4a349a(0x282),_0x16bc47);if(_0x16bc47==0x1)process['send']({'type':_0x4a349a(0x1bb)});}if(_0x336e1b){saveConfig(_0x13896b,_0x4a349a(0x208),_0x336e1b);if(_0x336e1b==0x1)process[_0x4a349a(0x1b7)]({'type':'startSimilarPhotoWork'});}return _0x448d13['json']({'code':0x0});}),router['post']('/saveConfigCustom',(_0x5e8394,_0x2c1fbe,_0x1810f5)=>{const _0x3e07d9=_0x3a7355;if(_0x5e8394[_0x3e07d9(0x221)][_0x3e07d9(0x261)]!=0x1)return _0x2c1fbe['json']({'code':0x66});let _0x42482d=_0x5e8394[_0x3e07d9(0x2ae)][_0x3e07d9(0x225)],_0x3fe311=_0x5e8394[_0x3e07d9(0x283)]['customLoginTitle'],_0x1bdd96=_0x5e8394[_0x3e07d9(0x283)][_0x3e07d9(0x227)],_0x5e4c52=_0x5e8394['body']['customLoginImage'],_0x2a8147=_0x5e8394[_0x3e07d9(0x283)][_0x3e07d9(0x2a5)];function _0x5e2801(_0x1cafce,_0x321f26,_0x2e8acc){const _0x1c0d4d=_0x3e07d9;nasAccountUtil['isVip'](null,_0x5e8394['app'][_0x1c0d4d(0x225)])['then'](_0x14c806=>{const _0x760b3e=_0x1c0d4d;if(_0x321f26=='-')return saveConfig(_0x42482d,_0x1cafce,'-'),_0x2c1fbe['json']({'code':0x0});if(!_0x14c806)return _0x5e8394[_0x760b3e(0x2ae)][_0x760b3e(0x2aa)](_0x2c1fbe,_0x2c1fbe['__'](_0x760b3e(0x29e)));if(fs[_0x760b3e(0x1d6)](_0x321f26)){let _0x425f8e=path['join'](config[_0x760b3e(0x1af)],_0x760b3e(0x1c4));function _0x5d26bf(){const _0x35f4d0=_0x760b3e;let _0x470c56=path[_0x35f4d0(0x212)](_0x425f8e,_0x1cafce+'.webp');sharp(path[_0x35f4d0(0x212)](_0x321f26))['resize']({'width':_0x2e8acc,'withoutEnlargement':!![]})[_0x35f4d0(0x25b)]()[_0x35f4d0(0x29a)]()[_0x35f4d0(0x1dd)](_0x470c56)['then'](()=>{return saveConfig(_0x42482d,_0x1cafce,_0x470c56),_0x2c1fbe['json']({'code':0x0});})['catch'](()=>{const _0x12b8f1=_0x35f4d0;return _0x5e8394[_0x12b8f1(0x2ae)][_0x12b8f1(0x2aa)](_0x2c1fbe,_0x2c1fbe['__'](_0x12b8f1(0x1bd)));});}!fs['existsSync'](_0x425f8e)?fs[_0x760b3e(0x274)](_0x425f8e,{'recursive':!![]},_0x303e8f=>{const _0x225d3d=_0x760b3e;if(_0x303e8f)return _0x5e8394[_0x225d3d(0x2ae)][_0x225d3d(0x2aa)](_0x2c1fbe,_0x2c1fbe['__']('operationFail'));_0x5d26bf();}):_0x5d26bf();}else return _0x5e8394[_0x760b3e(0x2ae)][_0x760b3e(0x2aa)](_0x2c1fbe,_0x2c1fbe['__'](_0x760b3e(0x21d))+_0x321f26);});}_0x3fe311&&nasAccountUtil[_0x3e07d9(0x1e9)](null,_0x5e8394[_0x3e07d9(0x2ae)][_0x3e07d9(0x225)])[_0x3e07d9(0x22b)](_0x184940=>{const _0x169a95=_0x3e07d9;if(!_0x184940&&_0x3fe311!='-')return _0x5e8394[_0x169a95(0x2ae)][_0x169a95(0x2aa)](_0x2c1fbe,_0x2c1fbe['__']('proxy.isntVip'));return saveConfig(_0x42482d,_0x169a95(0x25e),_0x3fe311),_0x2c1fbe[_0x169a95(0x1cc)]({'code':0x0});}),_0x1bdd96&&_0x5e2801(_0x3e07d9(0x227),_0x1bdd96,0xc8),_0x5e4c52&&_0x5e2801(_0x3e07d9(0x278),_0x5e4c52,0x3e8),_0x2a8147&&_0x5e2801(_0x3e07d9(0x2a5),_0x2a8147,0xf14);}),router[_0x3a7355(0x21b)](_0x3a7355(0x214),(_0x3ae20a,_0x10eb6b,_0x32618a)=>{const _0xd56598=_0x3a7355;let _0x21ea90=_0x3ae20a['app'][_0xd56598(0x225)],_0x4b1f50=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x298)],_0x29b34f=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x29d)],_0x4c4ad9=_0x3ae20a['body'][_0xd56598(0x286)],_0x25a17b=_0x3ae20a[_0xd56598(0x283)]['transCodeCoderNameH264'],_0x3b37bf=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x21a)],_0x523865=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x256)],_0x49f99b=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x1fc)],_0x2e568e=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x226)],_0x4696e9=_0x3ae20a[_0xd56598(0x283)]['subtitlePreGen'],_0x1021f1=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x275)],_0x558b26=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x1d4)],_0x370dc1=_0x3ae20a['body']['moviePlaylongPressRate'],_0x2f10ef=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x259)],_0xd1489c=_0x3ae20a[_0xd56598(0x283)]['movieTmdbApiUrl'],_0x34a49a=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x1fe)],_0x2da1f0=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x217)],_0x11b60d=_0x3ae20a[_0xd56598(0x283)]['defaultTranscodeResolution'],_0xfe47d2=_0x3ae20a[_0xd56598(0x283)]['tmdbProxyEnable'],_0x6a0933=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x22d)];if(_0x3ae20a[_0xd56598(0x221)][_0xd56598(0x261)]!=0x1)return _0x10eb6b[_0xd56598(0x1cc)]({'code':0x66});_0x2f10ef&&saveConfig(_0x21ea90,_0xd56598(0x259),_0x2f10ef);(_0xfe47d2==0x1||_0xfe47d2==0x0)&&saveConfig(_0x21ea90,'tmdbProxyEnable',_0xfe47d2);_0x6a0933&&saveConfig(_0x21ea90,_0xd56598(0x22d),_0x6a0933?_0x6a0933:'');_0xd1489c!=null&&saveConfig(_0x21ea90,'movieTmdbApiUrl',_0xd1489c?_0xd1489c:'');_0x34a49a!=null&&saveConfig(_0x21ea90,_0xd56598(0x1fe),_0x34a49a?_0x34a49a:'');_0x2da1f0&&saveConfig(_0x21ea90,'movieDatabaseType',_0x2da1f0);_0x370dc1&&saveConfig(_0x21ea90,_0xd56598(0x24a),_0x370dc1);_0x11b60d&&saveConfig(_0x21ea90,_0xd56598(0x1e4),_0x11b60d);let _0x51132b=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x1ee)],_0x5e9d85=_0x3ae20a[_0xd56598(0x283)][_0xd56598(0x1da)],_0x43d10a=_0x3ae20a['body']['movieHomeShowLibrary'];(_0x51132b==0x1||_0x51132b==0x0)&&saveConfig(_0x21ea90,_0xd56598(0x1ee),_0x51132b);(_0x5e9d85==0x1||_0x5e9d85==0x0)&&saveConfig(_0x21ea90,'movieHomeShowHistory',_0x5e9d85);(_0x43d10a==0x1||_0x43d10a==0x0)&&saveConfig(_0x21ea90,_0xd56598(0x25c),_0x43d10a);let _0xd54da7=_0x3ae20a['body']['crf'];if(_0xd54da7&&(_0xd54da7<0x1||_0xd54da7>0x33))return _0x10eb6b['json']({'code':0x1,'message':_0xd56598(0x213)});let _0x1a5ec9=[_0xd56598(0x260),_0xd56598(0x250),_0xd56598(0x288),_0xd56598(0x1c6)];_0x1021f1&&_0x1a5ec9[_0xd56598(0x207)](_0x1021f1)&&saveConfig(_0x21ea90,_0xd56598(0x275),_0x1021f1);_0x49f99b&&saveConfig(_0x21ea90,_0xd56598(0x1fc),_0x49f99b);_0x2e568e&&saveConfig(_0x21ea90,_0xd56598(0x226),_0x2e568e);_0xd54da7&&saveConfig(_0x21ea90,_0xd56598(0x257),parseInt(_0xd54da7));_0x4b1f50&&saveConfig(_0x21ea90,_0xd56598(0x298),_0x4b1f50);_0x558b26&&saveConfig(_0x21ea90,'moviePreferLanguage',_0x558b26);_0x29b34f&&saveConfig(_0x21ea90,_0xd56598(0x29d),_0x29b34f);_0x4c4ad9&&saveConfig(_0x21ea90,'transCodeParams-CoderNameHevc',_0x4c4ad9);_0x25a17b&&saveConfig(_0x21ea90,_0xd56598(0x236),_0x25a17b);if(_0x3b37bf){try{_0x3b37bf=parseInt(_0x3b37bf);if(_0x3b37bf>0x1e)_0x3b37bf=0x1e;if(_0x3b37bf<0x2)_0x3b37bf=0x2;}catch(_0x24b156){_0x3b37bf=0x5;}saveConfig(_0x21ea90,'transCodeParams-readrate',_0x3b37bf);}return _0x4696e9&&(saveConfig(_0x21ea90,_0xd56598(0x26e),_0x4696e9),_0x4696e9=='1'&&process[_0xd56598(0x1b7)]({'type':'START_PRE_GEN_SUBTITLE'})),_0x523865?saveConfig(_0x21ea90,'transcodePath',_0x523865):dbConfigTable[_0xd56598(0x23e)](_0x21ea90,_0xd56598(0x256)),_0x10eb6b['json']({'code':0x0});}),router[_0x3a7355(0x21b)](_0x3a7355(0x216),(_0xd74dee,_0xd82d83,_0xd5bd87)=>{const _0x59e719=_0x3a7355;let _0x4933df=_0xd74dee[_0x59e719(0x2ae)][_0x59e719(0x225)];if(_0xd74dee[_0x59e719(0x221)][_0x59e719(0x261)]!=0x1)return _0xd82d83[_0x59e719(0x1cc)]({'code':0x66});function _0x15de80(){const _0x477cce=_0x59e719;let _0x3446b2=_0xd74dee['body']['musicTitleType']||_0x477cce(0x292),_0x2b9cff=[_0x477cce(0x292),_0x477cce(0x1ba)];return _0x2b9cff[_0x477cce(0x207)](_0x3446b2)&&saveConfig(_0x4933df,_0x477cce(0x27a),_0x3446b2),_0xd82d83[_0x477cce(0x1cc)]({'code':0x0});}_0x15de80();}),router['post'](_0x3a7355(0x1c2),(_0xf9e56,_0xa78867,_0x2b179f)=>{const _0x2d4a6b=_0x3a7355;let _0x34f8f2={};_0x34f8f2[_0x2d4a6b(0x1e3)]=path['join'](config[_0x2d4a6b(0x1af)],_0x2d4a6b(0x295)),_0x34f8f2[_0x2d4a6b(0x205)]=config[_0x2d4a6b(0x296)],fs[_0x2d4a6b(0x1d5)](_0x34f8f2[_0x2d4a6b(0x205)],fs[_0x2d4a6b(0x1e6)][_0x2d4a6b(0x268)]|fs[_0x2d4a6b(0x1e6)]['W_OK'],_0x2b5030=>{const _0x474771=_0x2d4a6b;_0x34f8f2[_0x474771(0x285)]=0x1;_0x2b5030&&(_0x34f8f2['imgFolderUsable']=0x0);let _0x35000f=dbConfigTable['findByTitle'](_0xf9e56[_0x474771(0x2ae)][_0x474771(0x225)],_0x474771(0x1bf));return _0x35000f?_0x34f8f2[_0x474771(0x1bf)]=JSON[_0x474771(0x220)](_0x35000f[_0x474771(0x224)]):_0x34f8f2[_0x474771(0x1bf)]=![],_0x34f8f2[_0x474771(0x1f0)]=config['appRootPath'],_0xa78867[_0x474771(0x1cc)]({'code':0x0,'data':_0x34f8f2});});}),router[_0x3a7355(0x21b)]('/relaunch',(_0x22db3f,_0x414f1b,_0x3fc956)=>{const _0x56dcef=_0x3a7355;if(dbUserTable[_0x56dcef(0x26d)](_0x22db3f,_0x414f1b)!==!![])return;if(OS['platform']()!='win32'&&OS['platform']()!=_0x56dcef(0x1fb))return _0x22db3f[_0x56dcef(0x2ae)]['returnErrMsg'](_0x414f1b,_0x414f1b['__'](_0x56dcef(0x2a2)));return process['send']({'type':_0x56dcef(0x1fd)}),_0x414f1b['json']({'code':0x0});}),router['post']('/clearCache',(_0x486099,_0x4f4e3b,_0x3c45e4)=>{const _0x205a2f=_0x3a7355;if(_0x486099[_0x205a2f(0x221)][_0x205a2f(0x261)]!=0x1)return _0x4f4e3b[_0x205a2f(0x1cc)]({'code':0x66});let _0x2f5420=path[_0x205a2f(0x212)](config[_0x205a2f(0x296)],_0x205a2f(0x28b));fs['stat'](_0x2f5420,(_0xbf5d58,_0x285495)=>{if(_0xbf5d58)return;fs['rm'](_0x2f5420,{'recursive':!![]},_0x26db25=>{const _0x34cbd3=_0x36e6;fs['mkdir'](_0x2f5420,{'recursive':!![]},_0x112a0a=>{const _0x1957a9=_0x36e6;console[_0x1957a9(0x2a6)](_0x112a0a);});if(_0x26db25)return fileUtil[_0x34cbd3(0x1f6)](_0x4f4e3b,_0x26db25);return dbConfigTable[_0x34cbd3(0x23e)](_0x486099[_0x34cbd3(0x2ae)]['dbOther'],_0x34cbd3(0x1bf)),_0x4f4e3b[_0x34cbd3(0x1cc)]({'code':0x0});});});let _0x393352=path[_0x205a2f(0x212)](config[_0x205a2f(0x296)],_0x205a2f(0x201)),_0x288693=path['join'](config['cacheParentPath'],'subtitle',_0x205a2f(0x28f));fs['stat'](_0x393352,(_0x28ef34,_0x18b055)=>{if(_0x28ef34)return;fs['rm'](_0x393352,{'recursive':!![]},_0x230dcd=>{const _0x48f251=_0x36e6;fs[_0x48f251(0x274)](_0x288693,{'recursive':!![]},_0x1f3b81=>{console['log'](_0x1f3b81);});if(_0x230dcd)return fileUtil['returnFileError'](_0x4f4e3b,_0x230dcd);});});}),router[_0x3a7355(0x21b)](_0x3a7355(0x263),(_0x1ba321,_0xaf93c2,_0x2a4da0)=>{const _0x4a0752=_0x3a7355;if(dbUserTable[_0x4a0752(0x26d)](_0x1ba321,_0xaf93c2)!==!![])return;let _0x42b58a=_0x1ba321[_0x4a0752(0x283)][_0x4a0752(0x248)],_0x36c07c=[_0x4a0752(0x1cb),_0x4a0752(0x279),'baseboard',_0x4a0752(0x284),_0x4a0752(0x280),_0x4a0752(0x1b2),_0x4a0752(0x270),_0x4a0752(0x242),_0x4a0752(0x251),_0x4a0752(0x1cf),_0x4a0752(0x24f),_0x4a0752(0x233),'usb','audio',_0x4a0752(0x21e),_0x4a0752(0x272),_0x4a0752(0x266)];if(!_0x36c07c['includes'](_0x42b58a))return _0x1ba321[_0x4a0752(0x2ae)][_0x4a0752(0x2aa)](_0xaf93c2,'type\x20is\x20invalid');si[_0x42b58a](_0x57c5f9=>{try{return _0xaf93c2['json']({'code':0x0,'data':_0x57c5f9});}catch(_0x25678b){console['log']('err',_0x25678b);}});}),router[_0x3a7355(0x21b)]('/openInSystem',(_0x1aa56e,_0x4240f6,_0x261b46)=>{const _0x54b1cf=_0x3a7355;let _0x6a5348=netUtils[_0x54b1cf(0x229)](_0x1aa56e);if(_0x6a5348!='localhost')return _0x1aa56e['app']['returnErrMsg'](_0x4240f6,_0x4240f6['__']('operationFail'));let _0x40599b=_0x1aa56e['body'][_0x54b1cf(0x206)],_0x53d56c=_0x1aa56e[_0x54b1cf(0x283)][_0x54b1cf(0x292)],_0x28dbc2=_0x1aa56e[_0x54b1cf(0x283)][_0x54b1cf(0x1b5)];if(!_0x28dbc2)try{_0x28dbc2=path['join'](_0x40599b,_0x53d56c);}catch(_0x232792){console[_0x54b1cf(0x2a6)](_0x232792);}if(!_0x28dbc2)return _0x1aa56e['app'][_0x54b1cf(0x2aa)](_0x4240f6,_0x54b1cf(0x1c1));if(dbUserTable['doUserCanGet'](_0x1aa56e,_0x4240f6,'folder',_0x54b1cf(0x2a9),'')==!![]){let _0x49a388=_0x1aa56e[_0x54b1cf(0x283)][_0x54b1cf(0x235)]||_0x54b1cf(0x1db);process[_0x54b1cf(0x1b7)]({'type':_0x54b1cf(0x223),'shellType':_0x49a388,'path':_0x28dbc2});let _0x1b56ba={'code':0x0};return _0x4240f6[_0x54b1cf(0x1cc)](_0x1b56ba);}}),module[_0x3a7355(0x243)]=router;