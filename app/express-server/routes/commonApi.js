const _0x339745=_0x5807;(function(_0x2ec55d,_0x436f31){const _0x206047=_0x5807,_0x16024a=_0x2ec55d();while(!![]){try{const _0x238292=parseInt(_0x206047(0x2cc))/0x1*(parseInt(_0x206047(0x21a))/0x2)+-parseInt(_0x206047(0x1ea))/0x3+-parseInt(_0x206047(0x2b8))/0x4+-parseInt(_0x206047(0x1ff))/0x5+parseInt(_0x206047(0x291))/0x6+-parseInt(_0x206047(0x2a9))/0x7*(-parseInt(_0x206047(0x2ad))/0x8)+parseInt(_0x206047(0x2bd))/0x9*(parseInt(_0x206047(0x224))/0xa);if(_0x238292===_0x436f31)break;else _0x16024a['push'](_0x16024a['shift']());}catch(_0x4703a4){_0x16024a['push'](_0x16024a['shift']());}}}(_0x3b4f,0x427ee));var express=require(_0x339745(0x2ba)),router=express[_0x339745(0x208)]();let config=require(_0x339745(0x242)),dbFileIndexTable=require(_0x339745(0x1f2)),dbConfigTable=require('../../db/dbConfigTable'),dbSourceTable=require(_0x339745(0x1f6)),dbNoticeCenterTable=require(_0x339745(0x244)),netUtils=require(_0x339745(0x2bc));const dbUserTable=require(_0x339745(0x204)),dbBackupTask=require(_0x339745(0x260)),OS=require('os');let path=require(_0x339745(0x2b1)),fs=require('fs'),fileUtil=require(_0x339745(0x21e));var package=require('../../../package.json');const sqliteUtil=require(_0x339745(0x1fe));let nasAccountUtil=require('../utils/nasAccountUtils');function _0x5807(_0x4938a7,_0x4c9f34){const _0x3b4ffe=_0x3b4f();return _0x5807=function(_0x5807a3,_0xc62b91){_0x5807a3=_0x5807a3-0x1db;let _0x4e2ac7=_0x3b4ffe[_0x5807a3];return _0x4e2ac7;},_0x5807(_0x4938a7,_0x4c9f34);}const sharp=require(_0x339745(0x2af)),si=require(_0x339745(0x298));let tls=require('tls');function _0x3b4f(){const _0x1c2c84=['openType','ipBan','type','length','/getSystemInfomation','963178FctdkO','/deleteBgTask','getUpdateInfo','isAdmin','../utils/fileUtils','body','total_size','port:\x20256-65500','doUserCanGet','dbFileIndex','254230YWMMJI','maxThreadCountIs','/vaccumDb','deleteByTitle','includes','keys','SELECT\x20*\x20FROM\x20bg_task\x20WHERE\x20task_state=?\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','subtitleSize','aiSimilarPhotoEnable','need\x20path','moviePlaylongPressRate','startsWith','rotate','defaultThreadCount','findByTitleArr',':https','/relaunch','refreshIpList','isVip','W_OK','count','osInfo','INDEX_TABLE_NAME_MOVIE','/clearCache','proxy.isntVip','showMenuArr','bios','resize','/updateNewVersion','webDavHttpsCert','../../myConfig/config','filename','../../db/dbNoticeCenterTable','imgFolderUsable','returnFileError','cachePathInvalid','customLoginImage','DELETE\x20FROM\x20bg_task\x20WHERE\x20id=?','webp','cachePath','is_admin','getAll','hostname','tmdbProxyUrl','error\x20keys','unreadMsgCount','movie','audio','then','/getServerState','transCodeCoderNameHevc','/saveConfig','notSupportForAutoUpdate','/openInSystem','CRF:\x201-51','join','cpuTemperature','cacheImageInfo','getGlobalInfo','movieHomeShowHistory','../../db/dbBackupTask','access','getAllByWhere','-----','end','httpsCert','movieTmdbApiUrl','language','transCodeReadRate','INDEX_TABLE_NAME_BOOK','ipMode','movieTmdbApiKey','folderNotExist','getClientIp','\x20title\x20in\x20(\x27globalCpuInfo\x27,\x27globalMemInfo\x27,\x27','/shouldShowTour','startSimilarPhotoWork','findByTitle','book','/getSystemState','defaultApiPort','/saveConfigMusic','getAllRecordByWhere','taskState','.webp','task_id','memTooLess','apiServer','bluetoothDevices','autoScanSource','stringify','chassis','/resetIndex','cacheParentPath','musicTitleType','appRootPath','apiPortHttps','FTPPort','REPLACE\x20INTO\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tour_record(page,version,username)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES(?,\x20?,?)','apiPort','webDavPort','customLoginTitle','/saveConfigCustom','log','isWinDisk','/getLanguage','autoLoginClient','totalmem','parse','1137966yHFaWn','battery','crf','power_get','subtitle','excludeFilenameMovie','/saveConfigMovie','systeminformation','transcodeSpeed','useFolderPictureAsPoster','wifiNetworks','movieDatabaseType','webDavHttpsKey','fast','create','/saveConfigPhoto','run','twoStepLogin','localhost','system','music','all','usb','defaultTranscodeResolution','26859ASAKcu','getDiskInfo','constants','ddnsIpv6Address','296AnxnKb','type\x20is\x20invalid','sharp','existsSync','path','movieTmdbLanguage','getById','stat','darwin','serverType','aiFaceMinPhotoCount','1059864uREWNN','/getServerIpAndSign','express','push','../utils/netUtils','81EnGtpZ','autoLaunch','getIpList','httpsCertError',':http','apiServerHttps','threadCount','ipDetection','transcodePath','excludePathMovie','ultrafast','app','autoHardAccDecode','globalIndexInfo','mkdir','1svpeBF','excludeFilenamePhoto','excludePathFolderBrowser','startFaceAiWork','defaultWebDavPort','tmdbProxyEnable','autoShowWindow','customHomeBgImage','operationFail','wal_checkpoint(RESTART)','transCodeParams-CoderNameH264','post','webDavUseApiCert','setting.portInvalid','currentUser','pragma','graphics','send','json','prepare','fullPath','getAllIndexInfo','copy_size','music-TitleType','/setLanguage','value','upload','notSupport','exec','id3tag','START_PRE_GEN_SUBTITLE','moviePreferLanguage','626943AxwrCs','shell','httpsKey','transCodeCoderNameH264','\x20status=\x27running\x27\x20or\x20status=\x27waiting\x27','imgFolder','getUnReadCount','\x27,\x27','../../db/dbFileIndexTable','platform','startClassesAiWork','INDEX_TABLE_NAME_MUSIC','../../db/dbSourceFolderTable','customLogoImage','win32','memLayout','dbOther','startUpdate','serverName','aiClassesEnable','../utils/sqliteUtil','1478565VOTxuN','mem','defaultWebDavPortHttps','vacuum','movieShowMatchName','../../db/dbUserTable','clearTable','cpus','returnErrMsg','Router','subtitlePreGen','webDavPortHttps','title','username','userDataFolder','version','folder','INDEX_TABLE_NAME_PHOTO','tokenKeepHour','force','toFile','/getVersionInfo'];_0x3b4f=function(){return _0x1c2c84;};return _0x3b4f();}function testCertAndKeyMatch(_0x48614e,_0x16019b){try{return tls['createSecureContext']({'cert':_0x48614e,'key':_0x16019b}),!![];}catch(_0x3f43bf){return![];}}router[_0x339745(0x2d7)](_0x339745(0x214),(_0x45f134,_0x38dcb7,_0x24c9c1)=>{const _0x5e6c79=_0x339745;let _0x4b6747=package[_0x5e6c79(0x20e)],_0x46d98d=dbConfigTable[_0x5e6c79(0x271)](_0x45f134[_0x5e6c79(0x2c8)][_0x5e6c79(0x1fa)],'versionInfo'),_0x26a901=dbConfigTable[_0x5e6c79(0x271)](_0x45f134[_0x5e6c79(0x2c8)][_0x5e6c79(0x1fa)],'showMenuArr');process[_0x5e6c79(0x1db)]({'type':_0x5e6c79(0x25e),'func':_0x5e6c79(0x21c)}),_0x38dcb7[_0x5e6c79(0x1dc)]({'code':0x0,'showMenuArr':_0x26a901?JSON[_0x5e6c79(0x290)](_0x26a901['value']):'','versionInfo':_0x46d98d?JSON[_0x5e6c79(0x290)](_0x46d98d['value']):'','currentVersion':_0x4b6747});}),router[_0x339745(0x2d7)](_0x339745(0x240),(_0x2e78e0,_0x409b24,_0xfb9d74)=>{const _0x319d20=_0x339745;if(OS['platform']()!='win32'&&OS[_0x319d20(0x1f3)]()!=_0x319d20(0x2b5))return _0x2e78e0[_0x319d20(0x2c8)][_0x319d20(0x207)](_0x409b24,_0x409b24['__'](_0x319d20(0x258)));return process['send']({'type':_0x319d20(0x1fb)}),_0x409b24['json']({'code':0x0});}),router['post']('/getBgTask',(_0x33dcf6,_0x4afd13,_0x288bb3)=>{const _0x994e75=_0x339745;let _0x194aff=netUtils[_0x994e75(0x26d)](_0x33dcf6),_0x3b0d3e=_0x33dcf6[_0x994e75(0x21f)][_0x994e75(0x277)],_0xffbaaa=_0x33dcf6[_0x994e75(0x21f)][_0x994e75(0x238)],_0xf94d23=_0x33dcf6[_0x994e75(0x21f)]['offset'],_0x45b36b=[];if(_0x33dcf6[_0x994e75(0x2da)][_0x994e75(0x24c)]==0x1){_0x45b36b=_0x33dcf6[_0x994e75(0x2c8)][_0x994e75(0x1fa)]['prepare'](_0x994e75(0x22a))[_0x994e75(0x2a6)](_0x3b0d3e,_0xffbaaa,_0xf94d23);let _0x4bec2b=dbBackupTask[_0x994e75(0x276)](_0x33dcf6[_0x994e75(0x2c8)][_0x994e75(0x1fa)],_0x994e75(0x1ee),[]);for(let _0xc704ad in _0x4bec2b){let _0x28500a=_0x4bec2b[_0xc704ad],_0x4baf35=dbBackupTask[_0x994e75(0x2b3)](_0x33dcf6[_0x994e75(0x2c8)][_0x994e75(0x1fa)],_0x28500a[_0x994e75(0x279)]);_0x45b36b[_0x994e75(0x2bb)]({'task_type':'BACKUP','task_name':_0x4baf35?_0x4baf35['task_name']:'','size_current':_0x28500a[_0x994e75(0x1e0)],'size_all':_0x28500a[_0x994e75(0x220)]});}}let _0x18ea74={'code':0x0,'data':_0x45b36b,'reqIp':_0x194aff};return _0x4afd13[_0x994e75(0x1dc)](_0x18ea74);}),router['post'](_0x339745(0x21b),(_0x33626e,_0x104d85,_0x27b5af)=>{const _0x2e6f35=_0x339745;let _0x97960=_0x33626e[_0x2e6f35(0x21f)]['taskId'];dbUserTable[_0x2e6f35(0x21d)](_0x33626e,_0x104d85)===!![]&&_0x33626e['app'][_0x2e6f35(0x1fa)][_0x2e6f35(0x1dd)](_0x2e6f35(0x249))[_0x2e6f35(0x2a1)](_0x97960);let _0xb56769={'code':0x0};return _0x104d85['json'](_0xb56769);}),router['post'](_0x339745(0x226),(_0x891ae4,_0x241647,_0x2c0f5b)=>{const _0x1ecc59=_0x339745;try{return _0x891ae4[_0x1ecc59(0x2c8)][_0x1ecc59(0x1fa)][_0x1ecc59(0x1e6)](_0x1ecc59(0x202)),_0x891ae4[_0x1ecc59(0x2c8)]['dbFileIndex'][_0x1ecc59(0x1e6)](_0x1ecc59(0x202)),_0x891ae4['app'][_0x1ecc59(0x1fa)][_0x1ecc59(0x2db)](_0x1ecc59(0x2d5)),_0x891ae4[_0x1ecc59(0x2c8)][_0x1ecc59(0x223)][_0x1ecc59(0x2db)](_0x1ecc59(0x2d5)),_0x241647[_0x1ecc59(0x1dc)]({'code':0x0});}catch(_0x4d4a4b){return _0x891ae4[_0x1ecc59(0x2c8)][_0x1ecc59(0x207)](_0x241647,_0x241647['__'](_0x1ecc59(0x2d4)));}}),router[_0x339745(0x2d7)](_0x339745(0x280),(_0x20da12,_0x2ae64d,_0x311aa9)=>{const _0x3475e7=_0x339745;if(_0x20da12[_0x3475e7(0x2da)][_0x3475e7(0x24c)]!=0x1)return _0x2ae64d[_0x3475e7(0x1dc)]({'code':0x66});let _0x200009=_0x20da12[_0x3475e7(0x21f)][_0x3475e7(0x2b6)];dbSourceTable[_0x3475e7(0x205)](_0x20da12[_0x3475e7(0x2c8)][_0x3475e7(0x1fa)],_0x200009);if(_0x200009==_0x3475e7(0x252))dbFileIndexTable[_0x3475e7(0x205)](_0x20da12[_0x3475e7(0x2c8)]['dbFileIndex'],dbFileIndexTable['INDEX_TABLE_NAME_MOVIE']);else{if(_0x200009=='photo')dbFileIndexTable['clearTable'](_0x20da12[_0x3475e7(0x2c8)]['dbFileIndex'],dbFileIndexTable[_0x3475e7(0x210)]);else{if(_0x200009==_0x3475e7(0x2a5))dbFileIndexTable[_0x3475e7(0x205)](_0x20da12[_0x3475e7(0x2c8)]['dbFileIndex'],dbFileIndexTable[_0x3475e7(0x1f5)]);else _0x200009==_0x3475e7(0x272)&&dbFileIndexTable[_0x3475e7(0x205)](_0x20da12[_0x3475e7(0x2c8)][_0x3475e7(0x223)],dbFileIndexTable[_0x3475e7(0x269)]);}}_0x2ae64d[_0x3475e7(0x1dc)]({'code':0x0});}),router[_0x339745(0x2d7)](_0x339745(0x2b9),(_0x2ede33,_0x400e02,_0x19963e)=>{const _0x5d90e3=_0x339745;process['send']({'type':_0x5d90e3(0x25e),'func':'getIpList'});let _0x48fcb6=dbConfigTable[_0x5d90e3(0x271)](_0x2ede33[_0x5d90e3(0x2c8)][_0x5d90e3(0x1fa)],'globalIpList'),_0x46719e=dbConfigTable[_0x5d90e3(0x271)](_0x2ede33[_0x5d90e3(0x2c8)][_0x5d90e3(0x1fa)],_0x5d90e3(0x27b)),_0x3ca8d1=dbConfigTable[_0x5d90e3(0x271)](_0x2ede33[_0x5d90e3(0x2c8)][_0x5d90e3(0x1fa)],_0x5d90e3(0x2c2)),_0x2d3755={'code':0x0,'ipList':_0x48fcb6,'apiServer':_0x46719e,'apiServerHttps':_0x3ca8d1,'hostName':OS[_0x5d90e3(0x24e)]()};return _0x400e02[_0x5d90e3(0x1dc)](_0x2d3755);}),router['post'](_0x339745(0x255),(_0x47c5fd,_0xfa0fb6,_0x4374bb)=>{const _0x19215c=_0x339745;let _0x58c4ca=netUtils[_0x19215c(0x26d)](_0x47c5fd),_0xf73de8=_0x47c5fd[_0x19215c(0x21f)][_0x19215c(0x1fc)],_0x424047;_0xf73de8=='all'?(process['send']({'type':_0x19215c(0x25e),'func':_0x19215c(0x2bf)}),_0x424047=dbConfigTable[_0x19215c(0x262)](_0x47c5fd['app']['dbOther'],'\x20title\x20in\x20(\x27apiServer\x27,\x27apiServerHttps\x27,\x27webDavServer\x27,\x27FTPServer\x27,\x27globalIpList\x27)')):_0x424047=dbConfigTable['findByTitle'](_0x47c5fd[_0x19215c(0x2c8)]['dbOther'],_0xf73de8);let _0x1853cc=dbConfigTable[_0x19215c(0x271)](_0x47c5fd[_0x19215c(0x2c8)]['dbOther'],_0x19215c(0x2ac)),_0x44281d={'code':0x0,'data':_0x424047,'hostName':OS[_0x19215c(0x24e)](),'reqIp':_0x58c4ca};_0x1853cc&&_0x1853cc[_0x19215c(0x1e3)]&&(_0x44281d[_0x19215c(0x2ac)]=_0x1853cc[_0x19215c(0x1e3)]);let _0x585daf=dbNoticeCenterTable[_0x19215c(0x1f0)](_0x47c5fd['app'][_0x19215c(0x1fa)]);return _0x44281d[_0x19215c(0x251)]=_0x585daf[_0x19215c(0x238)],_0xfa0fb6[_0x19215c(0x1dc)](_0x44281d);}),router['post'](_0x339745(0x273),(_0x486396,_0x495042,_0x16dced)=>{const _0x211e91=_0x339745;let _0x73f4c2=netUtils[_0x211e91(0x26d)](_0x486396),_0x14bcb5=_0x486396[_0x211e91(0x21f)][_0x211e91(0x212)],_0x49db9a='globalIndexInfo'+dbFileIndexTable[_0x211e91(0x23a)],_0x1bbbf2=_0x211e91(0x2ca)+dbFileIndexTable[_0x211e91(0x210)];process[_0x211e91(0x1db)]({'type':_0x211e91(0x25e),'func':_0x211e91(0x1df)}),process[_0x211e91(0x1db)]({'type':_0x211e91(0x25e),'func':_0x211e91(0x2aa),'force':_0x14bcb5}),fs[_0x211e91(0x2b4)](config[_0x211e91(0x281)],_0x5ab847=>{const _0x588d9e=_0x211e91;if(_0x5ab847)return _0x486396[_0x588d9e(0x2c8)][_0x588d9e(0x207)](_0x495042,_0x495042['__'](_0x588d9e(0x247)));else{let _0x5b421e=dbConfigTable['getAllByWhere'](_0x486396[_0x588d9e(0x2c8)][_0x588d9e(0x1fa)],_0x588d9e(0x26e)+_0x49db9a+_0x588d9e(0x1f1)+_0x1bbbf2+'\x27,\x27globalDiskInfo\x27)');return _0x495042[_0x588d9e(0x1dc)]({'code':0x0,'data':_0x5b421e,'version':package[_0x588d9e(0x20e)],'reqIp':_0x73f4c2,'platform':OS['platform']()});}});}),router[_0x339745(0x2d7)](_0x339745(0x26f),(_0x32abd7,_0x440e20,_0x16ca60)=>{const _0x160272=_0x339745;let _0x4287d3=_0x32abd7['body']['page'],_0x1622c9=package[_0x160272(0x20e)],_0x48e463=_0x32abd7[_0x160272(0x2da)][_0x160272(0x20c)],_0x17a86c=_0x32abd7[_0x160272(0x2c8)][_0x160272(0x1fa)][_0x160272(0x1dd)]('SELECT\x20*\x20from\x20tour_record\x20where\x20page=?\x20and\x20version=?\x20and\x20username=?')['get'](_0x4287d3,_0x1622c9,_0x48e463);if(!_0x17a86c){const _0x2ba54b=_0x160272(0x286);_0x32abd7[_0x160272(0x2c8)]['dbOther'][_0x160272(0x1dd)](_0x2ba54b)[_0x160272(0x2a1)](_0x4287d3,_0x1622c9,_0x48e463);}return _0x440e20[_0x160272(0x1dc)]({'code':0x0,'show':_0x17a86c?0x0:0x1});}),router[_0x339745(0x2d7)]('/getAllConfig',(_0x20a7af,_0x1e39e5,_0x3d2142)=>{const _0x306475=_0x339745;let _0x1b7be0=_0x20a7af['body'][_0x306475(0x229)],_0x953eac;if(_0x1b7be0&&_0x1b7be0[_0x306475(0x218)]>0x0){if(sqliteUtil['checkSqlInjection'](_0x1b7be0)==!![])return _0x20a7af['app'][_0x306475(0x207)](_0x1e39e5,_0x306475(0x250));_0x953eac=dbConfigTable[_0x306475(0x232)](_0x20a7af[_0x306475(0x2c8)]['dbOther'],_0x1b7be0);}else _0x953eac=dbConfigTable[_0x306475(0x24d)](_0x20a7af['app'][_0x306475(0x1fa)]);for(let _0x2517e7 in _0x953eac){let _0xf79743=_0x953eac[_0x2517e7];(_0xf79743[_0x306475(0x20b)]==_0x306475(0x265)||_0xf79743[_0x306475(0x20b)]==_0x306475(0x1ec))&&(!_0xf79743[_0x306475(0x1e3)][_0x306475(0x22f)](_0x306475(0x263))&&(_0xf79743['value']=''));}let _0x4e1268={};_0x4e1268[_0x306475(0x274)]=config['apiPort'],_0x4e1268['defaultApiPortHttps']=config[_0x306475(0x284)],_0x4e1268[_0x306475(0x2d0)]=config[_0x306475(0x288)],_0x4e1268[_0x306475(0x201)]=config[_0x306475(0x20a)],_0x4e1268['defaultFTPPort']=config['FTPPort'],_0x4e1268[_0x306475(0x231)]=0x2,_0x4e1268['allConfig']=_0x953eac,nasAccountUtil['isVip'](null,_0x20a7af['app'][_0x306475(0x1fa)])[_0x306475(0x254)](_0x2c1ce0=>{_0x1e39e5['json']({'code':0x0,'data':_0x4e1268,'isVip':_0x2c1ce0});});}),router['post'](_0x339745(0x28d),(_0x43a5e5,_0x51a6ca,_0x235f10)=>{const _0x20337b=_0x339745;let _0x1fae45=dbConfigTable[_0x20337b(0x271)](_0x43a5e5[_0x20337b(0x2c8)][_0x20337b(0x1fa)],'language'),_0x58e743='';_0x1fae45&&(_0x58e743=_0x1fae45[_0x20337b(0x1e3)]),_0x51a6ca['json']({'code':0x0,'data':_0x58e743});}),router['post'](_0x339745(0x1e2),(_0x44c464,_0x56144d,_0x3e25bd)=>{const _0xab5bf6=_0x339745;let _0x4a9186=netUtils[_0xab5bf6(0x26d)](_0x44c464);if(_0x4a9186!=_0xab5bf6(0x2a3))return'ip\x20not\x20allow';let _0x2e755c=_0x44c464['body'][_0xab5bf6(0x267)];if(!_0x2e755c)return _0x56144d['status'](0x194)[_0xab5bf6(0x264)]();return dbConfigTable[_0xab5bf6(0x29f)](_0x44c464[_0xab5bf6(0x2c8)][_0xab5bf6(0x1fa)],{'title':'language','value':_0x2e755c}),_0x56144d[_0xab5bf6(0x1dc)]({'code':0x0});});function saveConfig(_0x3f626a,_0x1c85aa,_0x48b8c8){const _0x1cbeab=_0x339745;dbConfigTable[_0x1cbeab(0x29f)](_0x3f626a,{'title':_0x1c85aa,'value':_0x48b8c8+''});}router[_0x339745(0x2d7)]('/changeCachePath',(_0x4d8334,_0xdc1ac1,_0x10dcc8)=>{const _0x319a10=_0x339745;let _0x5df376=_0x4d8334[_0x319a10(0x21f)][_0x319a10(0x24b)];if(_0x4d8334[_0x319a10(0x2da)][_0x319a10(0x24c)]!=0x1)return _0xdc1ac1['json']({'code':0x66});if(_0x5df376)fs[_0x319a10(0x261)](_0x5df376,fs[_0x319a10(0x2ab)][_0x319a10(0x237)]|fs[_0x319a10(0x2ab)]['R_OK'],_0xb5d036=>{const _0x1dc96d=_0x319a10;return!_0xb5d036?(saveConfig(_0x4d8334[_0x1dc96d(0x2c8)][_0x1dc96d(0x1fa)],_0x1dc96d(0x281),_0x5df376),_0xdc1ac1[_0x1dc96d(0x1dc)]({'code':0x0})):fileUtil[_0x1dc96d(0x246)](_0xdc1ac1,_0xb5d036);});else return dbConfigTable[_0x319a10(0x227)](_0x4d8334[_0x319a10(0x2c8)][_0x319a10(0x1fa)],'cacheParentPath'),_0xdc1ac1[_0x319a10(0x1dc)]({'code':0x0});});let forbiddenPorts=[0x1,0x7,0x9,0xb,0xd,0xf,0x11,0x13,0x14,0x15,0x16,0x17,0x19,0x25,0x2a,0x2b,0x35,0x4d,0x4f,0x57,0x5f,0x65,0x66,0x67,0x68,0x6d,0x6e,0x6f,0x71,0x73,0x75,0x77,0x7b,0x87,0x8b,0x8f,0xb3,0x185,0x1d1,0x200,0x201,0x202,0x203,0x20e,0x212,0x213,0x214,0x21c,0x22c,0x233,0x24b,0x259,0x27c,0x3e1,0x3e3,0x801,0xe4b,0xfcd,0x1770,0x1a09,0x1a0a,0x1a0b,0x1a0c,0x1a0d,0xd3d];router[_0x339745(0x2d7)](_0x339745(0x257),(_0x1e35a7,_0x41ecc4,_0x3f08b2)=>{const _0x184f5b=_0x339745;let _0x47b30e=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x287)],_0x197c8d=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x284)],_0x11eaea=_0x1e35a7[_0x184f5b(0x21f)]['webDavPort'],_0x433530=_0x1e35a7['body'][_0x184f5b(0x20a)],_0x21bf43=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x285)],_0x15e156=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2be)],_0xd4905=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x28e)],_0x324c8b=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2d2)],_0x4aca5d=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x27d)],_0x1090cc=_0x1e35a7[_0x184f5b(0x21f)]['httpsKey'],_0x52e21f=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x265)],_0x54ffa3=_0x1e35a7[_0x184f5b(0x21f)]['webDavHttpsKey'],_0x3be1bd=_0x1e35a7['body'][_0x184f5b(0x241)],_0x512bae=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x267)],_0x287aa9=_0x1e35a7['body'][_0x184f5b(0x2c3)],_0x4931b5=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2c6)],_0x52852a=_0x1e35a7[_0x184f5b(0x21f)]['excludePathPhoto'],_0x53ef55=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2ce)],_0x5b69c0=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x296)],_0x5b8f6f=_0x1e35a7['body'][_0x184f5b(0x2cd)],_0x3eaa3d=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x23d)],_0xb5d096=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x211)],_0x475cdc=_0x1e35a7[_0x184f5b(0x21f)]['customShareUrl'],_0x325873=_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2d8)];if(_0x1e35a7[_0x184f5b(0x2da)][_0x184f5b(0x24c)]!=0x1)return _0x41ecc4['json']({'code':0x66});let _0x1aaa18=0xffdc;if(_0x47b30e>_0x1aaa18||_0x11eaea>_0x1aaa18||_0x21bf43>_0x1aaa18||_0x433530>_0x1aaa18)return _0x41ecc4[_0x184f5b(0x1dc)]({'code':0x1,'message':_0x184f5b(0x221)});let _0x42f079=_0x1e35a7['app'][_0x184f5b(0x1fa)];_0x3eaa3d&&saveConfig(_0x42f079,_0x184f5b(0x23d),JSON[_0x184f5b(0x27e)](_0x3eaa3d));_0x475cdc&&saveConfig(_0x42f079,'customShareUrl',_0x475cdc);_0x4931b5&&saveConfig(_0x42f079,'excludePathMovie',JSON[_0x184f5b(0x27e)](_0x4931b5));_0xb5d096&&parseInt(_0xb5d096)!=NaN&&_0xb5d096>0x0&&_0xb5d096<0x5f5e0ff&&saveConfig(_0x42f079,'tokenKeepHour',_0xb5d096);_0x52852a&&saveConfig(_0x42f079,'excludePathPhoto',JSON[_0x184f5b(0x27e)](_0x52852a));if(_0x53ef55){let _0x5297ed=netUtils[_0x184f5b(0x26d)](_0x1e35a7);if(_0x5297ed==_0x184f5b(0x2a3)){for(let _0x1807da in _0x53ef55){let _0x20f9a1=_0x53ef55[_0x1807da],_0x4e9f3d=fs[_0x184f5b(0x2b0)](_0x20f9a1);if(!_0x4e9f3d)return _0x1e35a7['app'][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x26c))+':'+_0x20f9a1);fileUtil[_0x184f5b(0x28c)](_0x20f9a1)&&(_0x53ef55[_0x1807da]=_0x20f9a1['toUpperCase']());}saveConfig(_0x42f079,_0x184f5b(0x2ce),JSON['stringify'](_0x53ef55));}else return _0x1e35a7['app']['returnErrMsg'](_0x41ecc4,_0x41ecc4['__']('onlySupportOnServerApp'));}_0x5b69c0&&saveConfig(_0x42f079,_0x184f5b(0x296),JSON[_0x184f5b(0x27e)](_0x5b69c0));_0x5b8f6f&&saveConfig(_0x42f079,_0x184f5b(0x2cd),JSON[_0x184f5b(0x27e)](_0x5b8f6f));if(_0x47b30e){if(forbiddenPorts[_0x184f5b(0x228)](parseInt(_0x47b30e)))return _0x1e35a7[_0x184f5b(0x2c8)]['returnErrMsg'](_0x41ecc4,_0x41ecc4['__']('setting.portInvalid')+_0x184f5b(0x2c1));saveConfig(_0x42f079,_0x184f5b(0x287),parseInt(_0x47b30e));}if(_0x197c8d){if(forbiddenPorts['includes'](parseInt(_0x197c8d))||_0x197c8d==_0x47b30e)return _0x1e35a7[_0x184f5b(0x2c8)][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x2d9))+_0x184f5b(0x233));saveConfig(_0x42f079,_0x184f5b(0x284),parseInt(_0x197c8d));}_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x216)]&&saveConfig(_0x42f079,_0x184f5b(0x216),_0x1e35a7[_0x184f5b(0x21f)]['ipBan']);_0x1e35a7[_0x184f5b(0x21f)]['ipMode']&&(saveConfig(_0x42f079,_0x184f5b(0x26a),_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x26a)]),_0x1e35a7['app'][_0x184f5b(0x235)]());_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2c4)]&&saveConfig(_0x42f079,'ipDetection',_0x1e35a7['body'][_0x184f5b(0x2c4)]);_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2a2)]&&saveConfig(_0x42f079,_0x184f5b(0x2a2),_0x1e35a7[_0x184f5b(0x21f)][_0x184f5b(0x2a2)]);_0x11eaea&&saveConfig(_0x42f079,_0x184f5b(0x288),parseInt(_0x11eaea));_0x433530&&saveConfig(_0x42f079,'webDavPortHttps',parseInt(_0x433530));_0x21bf43&&saveConfig(_0x42f079,'FTPPort',parseInt(_0x21bf43));_0x15e156&&saveConfig(_0x42f079,_0x184f5b(0x2be),_0x15e156);_0xd4905&&saveConfig(_0x42f079,_0x184f5b(0x28e),_0xd4905);_0x324c8b&&saveConfig(_0x42f079,'autoShowWindow',_0x324c8b);_0x4aca5d&&saveConfig(_0x42f079,'autoScanSource',_0x4aca5d);let _0x49baa2=dbConfigTable['findByTitle'](_0x1e35a7[_0x184f5b(0x2c8)]['dbOther'],'useNasCabCerts');if(!_0x49baa2||_0x49baa2['value']==0x0){if(_0x1090cc!='*'&&_0x52e21f!='*'){if(_0x1090cc&&_0x52e21f){if(!_0x1090cc['startsWith'](_0x184f5b(0x263))||!_0x52e21f[_0x184f5b(0x22f)](_0x184f5b(0x263)))return _0x1e35a7[_0x184f5b(0x2c8)][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__']('httpsCertError'));const _0x3ba06d=testCertAndKeyMatch(_0x52e21f,_0x1090cc);if(!_0x3ba06d)return _0x1e35a7[_0x184f5b(0x2c8)][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x2c0)));saveConfig(_0x42f079,_0x184f5b(0x1ec),_0x1090cc),saveConfig(_0x42f079,_0x184f5b(0x265),_0x52e21f);}else saveConfig(_0x42f079,'httpsKey',''),saveConfig(_0x42f079,_0x184f5b(0x265),'');}}_0x325873&&saveConfig(_0x42f079,_0x184f5b(0x2d8),_0x325873);_0x325873=dbConfigTable[_0x184f5b(0x271)](_0x1e35a7['app'][_0x184f5b(0x1fa)],'webDavUseApiCert');if(!_0x325873||_0x325873[_0x184f5b(0x1e3)]==0x0){if(_0x54ffa3!='*'&&_0x3be1bd!='*'){if(_0x54ffa3&&_0x3be1bd){if(!_0x54ffa3[_0x184f5b(0x22f)](_0x184f5b(0x263))||!_0x3be1bd[_0x184f5b(0x22f)](_0x184f5b(0x263)))return _0x1e35a7[_0x184f5b(0x2c8)][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x2c0)));const _0x9f02d0=testCertAndKeyMatch(_0x54ffa3,_0x3be1bd);if(!_0x9f02d0)return _0x1e35a7[_0x184f5b(0x2c8)]['returnErrMsg'](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x2c0)));saveConfig(_0x42f079,'webDavHttpsKey',_0x54ffa3),saveConfig(_0x42f079,'webDavHttpsCert',_0x3be1bd);}else saveConfig(_0x42f079,_0x184f5b(0x29d),''),saveConfig(_0x42f079,'webDavHttpsCert','');}}_0x512bae&&saveConfig(_0x42f079,_0x184f5b(0x267),_0x512bae);if(_0x287aa9){if(_0x287aa9>OS[_0x184f5b(0x206)]()[_0x184f5b(0x218)])return _0x1e35a7[_0x184f5b(0x2c8)][_0x184f5b(0x207)](_0x41ecc4,_0x41ecc4['__'](_0x184f5b(0x225))+OS['cpus']()[_0x184f5b(0x218)]);saveConfig(_0x42f079,_0x184f5b(0x2c3),_0x287aa9);}return _0x41ecc4['json']({'code':0x0});}),router[_0x339745(0x2d7)](_0x339745(0x2a0),(_0x37a2ee,_0x48bd92,_0x1f780e)=>{const _0x57b3ce=_0x339745;if(_0x37a2ee['currentUser'][_0x57b3ce(0x24c)]!=0x1)return _0x48bd92['json']({'code':0x66});let _0x294cd0=_0x37a2ee[_0x57b3ce(0x2c8)][_0x57b3ce(0x1fa)],_0x3b8ead=_0x37a2ee[_0x57b3ce(0x21f)][_0x57b3ce(0x1fd)],_0x4e1e5f=_0x37a2ee[_0x57b3ce(0x21f)]['aiFaceEnable'],_0x31c6c7=_0x37a2ee[_0x57b3ce(0x21f)][_0x57b3ce(0x22c)],_0x1330e5=_0x37a2ee[_0x57b3ce(0x21f)]['aiFaceMinPhotoCount'];if(_0x3b8ead){if(_0x3b8ead==0x1){if(OS[_0x57b3ce(0x28f)]()/0x400/0x400/0x400<0x3)return _0x37a2ee[_0x57b3ce(0x2c8)][_0x57b3ce(0x207)](_0x48bd92,_0x48bd92['__'](_0x57b3ce(0x27a)));}saveConfig(_0x294cd0,_0x57b3ce(0x1fd),_0x3b8ead);if(_0x3b8ead==0x1)process[_0x57b3ce(0x1db)]({'type':_0x57b3ce(0x1f4)});}_0x1330e5&&saveConfig(_0x294cd0,_0x57b3ce(0x2b7),_0x1330e5);if(_0x4e1e5f){if(_0x4e1e5f==0x1){if(OS[_0x57b3ce(0x28f)]()/0x400/0x400/0x400<0x3)return _0x37a2ee[_0x57b3ce(0x2c8)][_0x57b3ce(0x207)](_0x48bd92,_0x48bd92['__']('memTooLess'));}saveConfig(_0x294cd0,'aiFaceEnable',_0x4e1e5f);if(_0x4e1e5f==0x1)process['send']({'type':_0x57b3ce(0x2cf)});}if(_0x31c6c7){saveConfig(_0x294cd0,_0x57b3ce(0x22c),_0x31c6c7);if(_0x31c6c7==0x1)process['send']({'type':_0x57b3ce(0x270)});}return _0x48bd92[_0x57b3ce(0x1dc)]({'code':0x0});}),router[_0x339745(0x2d7)](_0x339745(0x28a),(_0x1f0dc4,_0x14d29c,_0x441600)=>{const _0x164425=_0x339745;if(_0x1f0dc4[_0x164425(0x2da)][_0x164425(0x24c)]!=0x1)return _0x14d29c['json']({'code':0x66});let _0x277cb1=_0x1f0dc4[_0x164425(0x2c8)]['dbOther'],_0x5af7fd=_0x1f0dc4[_0x164425(0x21f)]['customLoginTitle'],_0x116106=_0x1f0dc4[_0x164425(0x21f)][_0x164425(0x1f7)],_0x3a69b9=_0x1f0dc4[_0x164425(0x21f)]['customLoginImage'],_0xda2295=_0x1f0dc4[_0x164425(0x21f)]['customHomeBgImage'];function _0x399cef(_0x530a2a,_0x5a1df9,_0x593598){const _0x5a1b94=_0x164425;nasAccountUtil[_0x5a1b94(0x236)](null,_0x1f0dc4[_0x5a1b94(0x2c8)][_0x5a1b94(0x1fa)])[_0x5a1b94(0x254)](_0x2e9cf3=>{const _0x1e9262=_0x5a1b94;if(_0x5a1df9=='-')return saveConfig(_0x277cb1,_0x530a2a,'-'),_0x14d29c['json']({'code':0x0});if(!_0x2e9cf3)return _0x1f0dc4[_0x1e9262(0x2c8)]['returnErrMsg'](_0x14d29c,_0x14d29c['__'](_0x1e9262(0x23c)));if(fs['existsSync'](_0x5a1df9)){let _0x55c09e=path['join'](config[_0x1e9262(0x20d)],'custom');function _0x5c3edc(){const _0x5276a7=_0x1e9262;let _0x1b1b3f=path[_0x5276a7(0x25b)](_0x55c09e,_0x530a2a+_0x5276a7(0x278));sharp(path[_0x5276a7(0x25b)](_0x5a1df9))[_0x5276a7(0x23f)]({'width':_0x593598,'withoutEnlargement':!![]})[_0x5276a7(0x230)]()[_0x5276a7(0x24a)]()[_0x5276a7(0x213)](_0x1b1b3f)[_0x5276a7(0x254)](()=>{const _0x2a673b=_0x5276a7;return saveConfig(_0x277cb1,_0x530a2a,_0x1b1b3f),_0x14d29c[_0x2a673b(0x1dc)]({'code':0x0});})['catch'](()=>{const _0x125b62=_0x5276a7;return _0x1f0dc4[_0x125b62(0x2c8)]['returnErrMsg'](_0x14d29c,_0x14d29c['__']('operationFail'));});}!fs[_0x1e9262(0x2b0)](_0x55c09e)?fs[_0x1e9262(0x2cb)](_0x55c09e,{'recursive':!![]},_0x46b909=>{const _0x1ab579=_0x1e9262;if(_0x46b909)return _0x1f0dc4[_0x1ab579(0x2c8)][_0x1ab579(0x207)](_0x14d29c,_0x14d29c['__']('operationFail'));_0x5c3edc();}):_0x5c3edc();}else return _0x1f0dc4[_0x1e9262(0x2c8)][_0x1e9262(0x207)](_0x14d29c,_0x14d29c['__'](_0x1e9262(0x26c))+_0x5a1df9);});}_0x5af7fd&&nasAccountUtil['isVip'](null,_0x1f0dc4[_0x164425(0x2c8)]['dbOther'])[_0x164425(0x254)](_0x3bdbbd=>{const _0xef8542=_0x164425;if(!_0x3bdbbd&&_0x5af7fd!='-')return _0x1f0dc4[_0xef8542(0x2c8)][_0xef8542(0x207)](_0x14d29c,_0x14d29c['__'](_0xef8542(0x23c)));return saveConfig(_0x277cb1,_0xef8542(0x289),_0x5af7fd),_0x14d29c['json']({'code':0x0});}),_0x116106&&_0x399cef(_0x164425(0x1f7),_0x116106,0xc8),_0x3a69b9&&_0x399cef(_0x164425(0x248),_0x3a69b9,0x3e8),_0xda2295&&_0x399cef(_0x164425(0x2d3),_0xda2295,0xf14);}),router['post'](_0x339745(0x297),(_0xe4dcad,_0x51da4b,_0xe37965)=>{const _0x341ed0=_0x339745;let _0x321d3e=_0xe4dcad['app']['dbOther'],_0x1a90fe=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x22b)],_0xfce2a0=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x2c9)],_0x54d017=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x256)],_0x1399be=_0xe4dcad['body'][_0x341ed0(0x1ed)],_0x5809cd=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x268)],_0x341ee6=_0xe4dcad[_0x341ed0(0x21f)]['transcodePath'],_0x18d6d2=_0xe4dcad['body'][_0x341ed0(0x203)],_0x20b9aa=_0xe4dcad['body'][_0x341ed0(0x29a)],_0x4aeb1e=_0xe4dcad[_0x341ed0(0x21f)]['subtitlePreGen'],_0x41c648=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x299)],_0x21a7a2=_0xe4dcad[_0x341ed0(0x21f)]['moviePreferLanguage'],_0x16f313=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x22e)],_0x41e1d2=_0xe4dcad['body'][_0x341ed0(0x2b2)],_0x5024e8=_0xe4dcad['body'][_0x341ed0(0x266)],_0x32e7b8=_0xe4dcad['body']['movieTmdbApiKey'],_0x1fc083=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x29c)],_0x201197=_0xe4dcad[_0x341ed0(0x21f)]['defaultTranscodeResolution'],_0x14b249=_0xe4dcad[_0x341ed0(0x21f)]['tmdbProxyEnable'],_0x53f5ea=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x24f)];if(_0xe4dcad[_0x341ed0(0x2da)][_0x341ed0(0x24c)]!=0x1)return _0x51da4b[_0x341ed0(0x1dc)]({'code':0x66});_0x41e1d2&&saveConfig(_0x321d3e,_0x341ed0(0x2b2),_0x41e1d2);(_0x14b249==0x1||_0x14b249==0x0)&&saveConfig(_0x321d3e,_0x341ed0(0x2d1),_0x14b249);_0x53f5ea&&saveConfig(_0x321d3e,_0x341ed0(0x24f),_0x53f5ea?_0x53f5ea:'');_0x5024e8!=null&&saveConfig(_0x321d3e,_0x341ed0(0x266),_0x5024e8?_0x5024e8:'');_0x32e7b8!=null&&saveConfig(_0x321d3e,_0x341ed0(0x26b),_0x32e7b8?_0x32e7b8:'');_0x1fc083&&saveConfig(_0x321d3e,_0x341ed0(0x29c),_0x1fc083);_0x16f313&&saveConfig(_0x321d3e,_0x341ed0(0x22e),_0x16f313);_0x201197&&saveConfig(_0x321d3e,_0x341ed0(0x2a8),_0x201197);let _0x557287=_0xe4dcad[_0x341ed0(0x21f)]['movieHomeShowMyMedia'],_0x7705b1=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x25f)],_0x5614bb=_0xe4dcad['body']['movieHomeShowLibrary'];(_0x557287==0x1||_0x557287==0x0)&&saveConfig(_0x321d3e,'movieHomeShowMyMedia',_0x557287);(_0x7705b1==0x1||_0x7705b1==0x0)&&saveConfig(_0x321d3e,_0x341ed0(0x25f),_0x7705b1);(_0x5614bb==0x1||_0x5614bb==0x0)&&saveConfig(_0x321d3e,'movieHomeShowLibrary',_0x5614bb);let _0x11d712=_0xe4dcad[_0x341ed0(0x21f)][_0x341ed0(0x293)];if(_0x11d712&&(_0x11d712<0x1||_0x11d712>0x33))return _0x51da4b[_0x341ed0(0x1dc)]({'code':0x1,'message':_0x341ed0(0x25a)});let _0x43e846=[_0x341ed0(0x2c7),_0x341ed0(0x29e),'medium','slow'];_0x41c648&&_0x43e846[_0x341ed0(0x228)](_0x41c648)&&saveConfig(_0x321d3e,_0x341ed0(0x299),_0x41c648);_0x18d6d2&&saveConfig(_0x321d3e,_0x341ed0(0x203),_0x18d6d2);_0x20b9aa&&saveConfig(_0x321d3e,_0x341ed0(0x29a),_0x20b9aa);_0x11d712&&saveConfig(_0x321d3e,'crf',parseInt(_0x11d712));_0x1a90fe&&saveConfig(_0x321d3e,_0x341ed0(0x22b),_0x1a90fe);_0x21a7a2&&saveConfig(_0x321d3e,_0x341ed0(0x1e9),_0x21a7a2);_0xfce2a0&&saveConfig(_0x321d3e,_0x341ed0(0x2c9),_0xfce2a0);_0x54d017&&saveConfig(_0x321d3e,'transCodeParams-CoderNameHevc',_0x54d017);_0x1399be&&saveConfig(_0x321d3e,_0x341ed0(0x2d6),_0x1399be);if(_0x5809cd){try{_0x5809cd=parseInt(_0x5809cd);if(_0x5809cd>0x1e)_0x5809cd=0x1e;if(_0x5809cd<0x2)_0x5809cd=0x2;}catch(_0x361698){_0x5809cd=0x5;}saveConfig(_0x321d3e,'transCodeParams-readrate',_0x5809cd);}return _0x4aeb1e&&(saveConfig(_0x321d3e,_0x341ed0(0x209),_0x4aeb1e),_0x4aeb1e=='1'&&process['send']({'type':_0x341ed0(0x1e8)})),_0x341ee6?saveConfig(_0x321d3e,_0x341ed0(0x2c5),_0x341ee6):dbConfigTable[_0x341ed0(0x227)](_0x321d3e,_0x341ed0(0x2c5)),_0x51da4b[_0x341ed0(0x1dc)]({'code':0x0});}),router['post'](_0x339745(0x275),(_0x213214,_0x12be38,_0x1d45ac)=>{const _0x563afd=_0x339745;let _0x1c039d=_0x213214[_0x563afd(0x2c8)][_0x563afd(0x1fa)];if(_0x213214[_0x563afd(0x2da)][_0x563afd(0x24c)]!=0x1)return _0x12be38[_0x563afd(0x1dc)]({'code':0x66});function _0x36aa5a(){const _0x4a13aa=_0x563afd;let _0x15bc2d=_0x213214['body'][_0x4a13aa(0x282)]||'filename',_0x4f37a2=[_0x4a13aa(0x243),_0x4a13aa(0x1e7)];return _0x4f37a2[_0x4a13aa(0x228)](_0x15bc2d)&&saveConfig(_0x1c039d,_0x4a13aa(0x1e1),_0x15bc2d),_0x12be38[_0x4a13aa(0x1dc)]({'code':0x0});}_0x36aa5a();}),router[_0x339745(0x2d7)]('/getSystemInfo',(_0x49b2e7,_0xb05e49,_0x5421d4)=>{const _0x64c01b=_0x339745;let _0x4f0155={};_0x4f0155['databaseFolder']=path[_0x64c01b(0x25b)](config['userDataFolder'],'database'),_0x4f0155['imgFolder']=config[_0x64c01b(0x281)],fs[_0x64c01b(0x261)](_0x4f0155[_0x64c01b(0x1ef)],fs[_0x64c01b(0x2ab)]['R_OK']|fs['constants'][_0x64c01b(0x237)],_0xb08d4b=>{const _0x448b9d=_0x64c01b;_0x4f0155[_0x448b9d(0x245)]=0x1;_0xb08d4b&&(_0x4f0155['imgFolderUsable']=0x0);let _0x138cc3=dbConfigTable[_0x448b9d(0x271)](_0x49b2e7['app']['dbOther'],_0x448b9d(0x25d));return _0x138cc3?_0x4f0155['cacheImageInfo']=JSON[_0x448b9d(0x290)](_0x138cc3['value']):_0x4f0155[_0x448b9d(0x25d)]=![],_0x4f0155[_0x448b9d(0x283)]=config[_0x448b9d(0x283)],_0xb05e49[_0x448b9d(0x1dc)]({'code':0x0,'data':_0x4f0155});});}),router[_0x339745(0x2d7)](_0x339745(0x234),(_0x4707fe,_0x1ec84e,_0x152995)=>{const _0x5294df=_0x339745;if(dbUserTable[_0x5294df(0x21d)](_0x4707fe,_0x1ec84e)!==!![])return;if(OS[_0x5294df(0x1f3)]()!=_0x5294df(0x1f8)&&OS[_0x5294df(0x1f3)]()!=_0x5294df(0x2b5))return _0x4707fe['app'][_0x5294df(0x207)](_0x1ec84e,_0x1ec84e['__'](_0x5294df(0x1e5)));return process['send']({'type':'Relaunch'}),_0x1ec84e['json']({'code':0x0});}),router[_0x339745(0x2d7)](_0x339745(0x23b),(_0x396be0,_0x508ff6,_0x521f16)=>{const _0x50e85b=_0x339745;if(_0x396be0[_0x50e85b(0x2da)][_0x50e85b(0x24c)]!=0x1)return _0x508ff6[_0x50e85b(0x1dc)]({'code':0x66});let _0x375a8b=path[_0x50e85b(0x25b)](config[_0x50e85b(0x281)],'cache');fs[_0x50e85b(0x2b4)](_0x375a8b,(_0x3d5c2b,_0x495a3d)=>{if(_0x3d5c2b)return;fs['rm'](_0x375a8b,{'recursive':!![]},_0x5c18b4=>{const _0x5f2528=_0x5807;fs[_0x5f2528(0x2cb)](_0x375a8b,{'recursive':!![]},_0x3d2eb2=>{const _0x494511=_0x5f2528;console[_0x494511(0x28b)](_0x3d2eb2);});if(_0x5c18b4)return fileUtil[_0x5f2528(0x246)](_0x508ff6,_0x5c18b4);return dbConfigTable[_0x5f2528(0x227)](_0x396be0[_0x5f2528(0x2c8)][_0x5f2528(0x1fa)],_0x5f2528(0x25d)),_0x508ff6[_0x5f2528(0x1dc)]({'code':0x0});});});let _0x16f1b9=path[_0x50e85b(0x25b)](config[_0x50e85b(0x281)],_0x50e85b(0x295)),_0x549497=path['join'](config['cacheParentPath'],'subtitle',_0x50e85b(0x1e4));fs['stat'](_0x16f1b9,(_0x366fee,_0x172646)=>{if(_0x366fee)return;fs['rm'](_0x16f1b9,{'recursive':!![]},_0x3a1632=>{const _0x338405=_0x5807;fs[_0x338405(0x2cb)](_0x549497,{'recursive':!![]},_0x3bf5fe=>{const _0x2795f6=_0x338405;console[_0x2795f6(0x28b)](_0x3bf5fe);});if(_0x3a1632)return fileUtil['returnFileError'](_0x508ff6,_0x3a1632);});});}),router[_0x339745(0x2d7)](_0x339745(0x219),(_0x52913e,_0x1daf20,_0x43e617)=>{const _0x152f27=_0x339745;if(dbUserTable[_0x152f27(0x21d)](_0x52913e,_0x1daf20)!==!![])return;let _0x2bb029=_0x52913e[_0x152f27(0x21f)][_0x152f27(0x217)],_0xaf16=[_0x152f27(0x2a4),_0x152f27(0x23e),'baseboard',_0x152f27(0x27f),'cpu',_0x152f27(0x25c),_0x152f27(0x200),_0x152f27(0x1f9),_0x152f27(0x292),_0x152f27(0x2dc),_0x152f27(0x239),'diskLayout',_0x152f27(0x2a7),_0x152f27(0x253),'networkInterfaces',_0x152f27(0x29b),_0x152f27(0x27c)];if(!_0xaf16[_0x152f27(0x228)](_0x2bb029))return _0x52913e[_0x152f27(0x2c8)][_0x152f27(0x207)](_0x1daf20,_0x152f27(0x2ae));si[_0x2bb029](_0x2e6d44=>{const _0x110912=_0x152f27;try{return _0x1daf20[_0x110912(0x1dc)]({'code':0x0,'data':_0x2e6d44});}catch(_0x3bf24e){console['log']('err',_0x3bf24e);}});}),router[_0x339745(0x2d7)](_0x339745(0x259),(_0x3db840,_0x41a096,_0x2f3d23)=>{const _0x177164=_0x339745;let _0x4da065=netUtils['getClientIp'](_0x3db840);if(_0x4da065!='localhost')return _0x3db840['app'][_0x177164(0x207)](_0x41a096,_0x41a096['__'](_0x177164(0x2d4)));let _0x12edd4=_0x3db840[_0x177164(0x21f)][_0x177164(0x20f)],_0x5f0d22=_0x3db840[_0x177164(0x21f)][_0x177164(0x243)],_0x48a187=_0x3db840[_0x177164(0x21f)][_0x177164(0x1de)];if(!_0x48a187)try{_0x48a187=path[_0x177164(0x25b)](_0x12edd4,_0x5f0d22);}catch(_0x59e6d8){console['log'](_0x59e6d8);}if(!_0x48a187)return _0x3db840['app'][_0x177164(0x207)](_0x41a096,_0x177164(0x22d));if(dbUserTable[_0x177164(0x222)](_0x3db840,_0x41a096,_0x177164(0x20f),_0x177164(0x294),'')==!![]){let _0x29940a=_0x3db840[_0x177164(0x21f)][_0x177164(0x215)]||'openPath';process[_0x177164(0x1db)]({'type':_0x177164(0x1eb),'shellType':_0x29940a,'path':_0x48a187});let _0x2fcedc={'code':0x0};return _0x41a096[_0x177164(0x1dc)](_0x2fcedc);}}),module['exports']=router;