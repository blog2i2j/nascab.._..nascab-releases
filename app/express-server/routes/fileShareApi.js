function _0x1001(){const _0x18151f=['deleteShareUser','globalIpList','http://','FTP','18flMsWJ','currentUser','findByTitle','\x20username,id','webDavHttpsServer','app','parse','is_admin','createShareUser','Invalid\x20path','40JMxcrr','119hOIqUG','1465812OVdsJO','share.samePathSign','5536830WnmrRm','fileShareRestart','path','stat','pathSignNoNull','constants','webdavHttps','\x20id\x20in\x20','send','create','5726130dKanmI','12GXkmKA','length','getSharesUserByShareId','getById','isDirectory','share.alreadyHasOtherFtp','server_type=?\x20order\x20by\x20id\x20desc','11rmmxwv','ftpHttp','/create','user_id','post','json','body','access','find','WebDav','type','port','../../db/dbFileShare','4XyGHmR','noWritePermission','value','dbOther','getByWhere','returnErrMsg','18737693dKohCc','getAllByWhere','258438HWwoFS','webDavServer','update','ftp://','userHasFtp','express','log','webdavHttp','178519BzIPFT','/delete','serverType','users','username','server_type','473250lBJlgH','ipv4','/getById','R_OK','pathSign'];_0x1001=function(){return _0x18151f;};return _0x1001();}const _0x4f4d40=_0x8d20;(function(_0x4c679f,_0x3cdd5e){const _0x32fe39=_0x8d20,_0x3ff935=_0x4c679f();while(!![]){try{const _0x42e922=-parseInt(_0x32fe39(0x1b7))/0x1*(-parseInt(_0x32fe39(0x1c6))/0x2)+-parseInt(_0x32fe39(0x1af))/0x3*(-parseInt(_0x32fe39(0x1a7))/0x4)+-parseInt(_0x32fe39(0x192))/0x5+-parseInt(_0x32fe39(0x1bd))/0x6*(parseInt(_0x32fe39(0x1d1))/0x7)+-parseInt(_0x32fe39(0x1d0))/0x8*(-parseInt(_0x32fe39(0x1d2))/0x9)+-parseInt(_0x32fe39(0x188))/0xa*(parseInt(_0x32fe39(0x19a))/0xb)+parseInt(_0x32fe39(0x193))/0xc*(parseInt(_0x32fe39(0x1ad))/0xd);if(_0x42e922===_0x3cdd5e)break;else _0x3ff935['push'](_0x3ff935['shift']());}catch(_0x46a106){_0x3ff935['push'](_0x3ff935['shift']());}}}(_0x1001,0xdddbe));var express=require(_0x4f4d40(0x1b4)),router=express['Router']();let path=require(_0x4f4d40(0x18a)),fs=require('fs');const dbFileShare=require(_0x4f4d40(0x1a6)),dbUserTable=require('../../db/dbUserTable');function _0x8d20(_0x48ba47,_0x4b635){const _0x1001d8=_0x1001();return _0x8d20=function(_0x8d203a,_0x10fb9b){_0x8d203a=_0x8d203a-0x187;let _0x2cf54f=_0x1001d8[_0x8d203a];return _0x2cf54f;},_0x8d20(_0x48ba47,_0x4b635);}let dbConfigTable=require('../../db/dbConfigTable');router[_0x4f4d40(0x19e)](_0x4f4d40(0x19c),(_0x2b1cec,_0x441c93,_0x130aad)=>{const _0x16000c=_0x4f4d40;if(_0x2b1cec[_0x16000c(0x1c7)][_0x16000c(0x1cd)]!=0x1)return _0x441c93[_0x16000c(0x19f)]({'code':0x66});let _0x7ba06e=_0x2b1cec[_0x16000c(0x1a0)]['type'],_0x1c0fbf=_0x2b1cec['body'][_0x16000c(0x1ba)],_0x4e408c=_0x2b1cec[_0x16000c(0x1a0)][_0x16000c(0x18a)],_0x4df915=_0x2b1cec['body']['serverType'];fs[_0x16000c(0x1a1)](_0x4e408c,fs[_0x16000c(0x18d)]['W_OK']|fs['constants'][_0x16000c(0x1c0)],_0x2daff1=>{const _0x586d61=_0x16000c;if(_0x2daff1)return _0x2b1cec[_0x586d61(0x1cb)][_0x586d61(0x1ac)](_0x441c93,_0x441c93['__'](_0x586d61(0x1a8))+':'+_0x4e408c);let _0x76fdd9=_0x2b1cec[_0x586d61(0x1a0)][_0x586d61(0x1c1)];if(_0x4df915==_0x586d61(0x1a3)){if(!_0x76fdd9)return _0x2b1cec[_0x586d61(0x1cb)][_0x586d61(0x1ac)](_0x441c93,_0x441c93['__'](_0x586d61(0x18c)));else{let _0x2b9391=[_0x76fdd9],_0x5d7bbe='\x20path_sign=?\x20and\x20server_type=\x27WebDav\x27',_0x283bd3=dbFileShare[_0x586d61(0x1ab)](_0x2b1cec['app'][_0x586d61(0x1aa)],_0x5d7bbe,_0x2b9391);if(_0x283bd3){if(_0x7ba06e==_0x586d61(0x191)||_0x7ba06e==_0x586d61(0x1b1)&&_0x283bd3['id']!=_0x2b1cec['body']['id'])return _0x2b1cec['app']['returnErrMsg'](_0x441c93,_0x441c93['__'](_0x586d61(0x187))+':'+_0x76fdd9);}}}fs[_0x586d61(0x18b)](_0x4e408c,(_0x44b509,_0x589a94)=>{const _0x2fe501=_0x586d61;if(_0x44b509)return _0x2b1cec[_0x2fe501(0x1cb)]['returnErrMsg'](_0x441c93,_0x2fe501(0x1cf));if(_0x589a94[_0x2fe501(0x197)]()){let _0x4ba4d8=_0x4e408c,_0x55eb1c='\x20path=?\x20and\x20server_type=?',_0x22fa23=[_0x4ba4d8,_0x4df915],_0x23cc7a=dbFileShare[_0x2fe501(0x1ab)](_0x2b1cec[_0x2fe501(0x1cb)]['dbOther'],_0x55eb1c,_0x22fa23);if(_0x23cc7a){if(_0x7ba06e==_0x2fe501(0x191)||_0x7ba06e==_0x2fe501(0x1b1)&&_0x23cc7a['id']!=_0x2b1cec['body']['id'])return _0x2b1cec[_0x2fe501(0x1cb)][_0x2fe501(0x1ac)](_0x441c93,_0x441c93['__']('share.samePathExist')+':'+_0x4e408c);}if(_0x4df915==_0x2fe501(0x1c5)&&_0x7ba06e=='create')for(let _0x5cc1b2 in _0x1c0fbf){let _0x412478=_0x1c0fbf[_0x5cc1b2]['id'],_0x38f931=dbUserTable[_0x2fe501(0x1a2)](_0x2b1cec[_0x2fe501(0x1cb)]['dbOther'],_0x412478),_0x4381f5=dbFileShare[_0x2fe501(0x1b3)](_0x2b1cec[_0x2fe501(0x1cb)][_0x2fe501(0x1aa)],_0x412478,_0x2fe501(0x1c5));if(_0x4381f5)return _0x2b1cec[_0x2fe501(0x1cb)]['returnErrMsg'](_0x441c93,_0x441c93['__'](_0x2fe501(0x198))+':'+_0x38f931[_0x2fe501(0x1bb)]);}let _0x244b31={'path':_0x4e408c,'path_sign':_0x76fdd9,'server_type':_0x4df915};if(_0x7ba06e==_0x2fe501(0x191)){let _0x1c5265=dbFileShare['create'](_0x2b1cec['app']['dbOther'],_0x244b31),_0x203497=_0x1c5265['lastInsertRowid'];for(let _0x3610e1 in _0x1c0fbf){dbFileShare['createShareUser'](_0x2b1cec[_0x2fe501(0x1cb)]['dbOther'],_0x203497,_0x1c0fbf[_0x3610e1]['id']);}}else{if(_0x7ba06e==_0x2fe501(0x1b1)){let _0x582441=_0x2b1cec['body']['id'];dbFileShare[_0x2fe501(0x1b1)](_0x2b1cec[_0x2fe501(0x1cb)][_0x2fe501(0x1aa)],_0x244b31,_0x582441),dbFileShare[_0x2fe501(0x1c2)](_0x2b1cec['app'][_0x2fe501(0x1aa)],_0x582441);for(let _0x41b640 in _0x1c0fbf){dbFileShare[_0x2fe501(0x1ce)](_0x2b1cec['app'][_0x2fe501(0x1aa)],_0x582441,_0x1c0fbf[_0x41b640]['id']);}}}return process[_0x2fe501(0x190)]({'type':_0x2fe501(0x189),'shareType':_0x4df915}),_0x441c93[_0x2fe501(0x19f)]({'code':0x0});}else return _0x2b1cec['app'][_0x2fe501(0x1ac)](_0x441c93,'\x20path\x20is\x20not\x20directory');});});}),router[_0x4f4d40(0x19e)](_0x4f4d40(0x1b8),(_0x138f0e,_0x4a0206,_0x55e971)=>{const _0x41bcd2=_0x4f4d40;if(_0x138f0e['currentUser']['is_admin']!=0x1)return _0x4a0206[_0x41bcd2(0x19f)]({'code':0x66});let _0x4bedc6=_0x138f0e['body']['id'],_0x373ac2=dbFileShare[_0x41bcd2(0x196)](_0x138f0e[_0x41bcd2(0x1cb)]['dbOther'],_0x4bedc6);dbFileShare['delete'](_0x138f0e[_0x41bcd2(0x1cb)]['dbOther'],_0x4bedc6),process['send']({'type':_0x41bcd2(0x189),'shareType':_0x373ac2[_0x41bcd2(0x1bc)]}),_0x4a0206[_0x41bcd2(0x19f)]({'code':0x0});}),router[_0x4f4d40(0x19e)]('/getAll',(_0x5110c1,_0x2bec90,_0x2d7295)=>{const _0x12ce0d=_0x4f4d40;if(_0x5110c1[_0x12ce0d(0x1c7)][_0x12ce0d(0x1cd)]!=0x1)return _0x2bec90[_0x12ce0d(0x19f)]({'code':0x66});let _0x39229=_0x5110c1[_0x12ce0d(0x1a0)][_0x12ce0d(0x1b9)],_0x5101ae=dbFileShare[_0x12ce0d(0x1ae)](_0x5110c1[_0x12ce0d(0x1cb)][_0x12ce0d(0x1aa)],_0x12ce0d(0x199),[_0x39229]);for(let _0xbfe424 in _0x5101ae){let _0x56aaed=_0x5101ae[_0xbfe424],_0x2abc9a=dbFileShare['getSharesUserByShareId'](_0x5110c1[_0x12ce0d(0x1cb)][_0x12ce0d(0x1aa)],_0x56aaed['id']),_0x1abe31='(';for(let _0x5788e4 in _0x2abc9a){_0x1abe31+=_0x2abc9a[_0x5788e4][_0x12ce0d(0x19d)],_0x5788e4!=_0x2abc9a[_0x12ce0d(0x194)]-0x1&&(_0x1abe31+=',');}_0x1abe31+=')';let _0x4e0ac2=dbUserTable[_0x12ce0d(0x1ae)](_0x5110c1[_0x12ce0d(0x1cb)][_0x12ce0d(0x1aa)],_0x12ce0d(0x18f)+_0x1abe31+'\x20',_0x12ce0d(0x1c9));_0x5101ae[_0xbfe424][_0x12ce0d(0x1ba)]=_0x4e0ac2;}let _0x4a2dd8={'code':0x0,'data':_0x5101ae},_0x319dcf='',_0x50c416='',_0x27ef1='';try{let _0x1bbc1c=dbConfigTable[_0x12ce0d(0x1c8)](_0x5110c1['app'][_0x12ce0d(0x1aa)],_0x12ce0d(0x1b0)),_0x310799=dbConfigTable[_0x12ce0d(0x1c8)](_0x5110c1['app'][_0x12ce0d(0x1aa)],_0x12ce0d(0x1ca)),_0x1cb323=dbConfigTable[_0x12ce0d(0x1c8)](_0x5110c1[_0x12ce0d(0x1cb)]['dbOther'],'FTPServer'),_0x25b408=dbConfigTable[_0x12ce0d(0x1c8)](_0x5110c1[_0x12ce0d(0x1cb)]['dbOther'],_0x12ce0d(0x1c3));if(_0x25b408){_0x25b408=JSON['parse'](_0x25b408[_0x12ce0d(0x1a9)]);for(let _0x360be9 of _0x25b408){if(_0x360be9[_0x12ce0d(0x1a4)]==_0x12ce0d(0x1be)){_0x319dcf=_0x12ce0d(0x1c4)+_0x360be9['ip'],_0x50c416='https://'+_0x360be9['ip'],_0x27ef1=_0x12ce0d(0x1b2)+_0x360be9['ip'];break;}}}_0x1bbc1c&&(_0x1bbc1c=JSON[_0x12ce0d(0x1cc)](_0x1bbc1c[_0x12ce0d(0x1a9)]),_0x319dcf+=':'+_0x1bbc1c[_0x12ce0d(0x1a5)],_0x4a2dd8[_0x12ce0d(0x1b6)]=_0x319dcf),_0x310799&&(_0x310799=JSON[_0x12ce0d(0x1cc)](_0x310799[_0x12ce0d(0x1a9)]),_0x50c416+=':'+_0x310799['port'],_0x4a2dd8[_0x12ce0d(0x18e)]=_0x50c416),_0x1cb323&&(_0x1cb323=JSON[_0x12ce0d(0x1cc)](_0x1cb323[_0x12ce0d(0x1a9)]),_0x27ef1+=':'+_0x1cb323[_0x12ce0d(0x1a5)],_0x4a2dd8[_0x12ce0d(0x19b)]=_0x27ef1);}catch(_0x33c5af){console[_0x12ce0d(0x1b5)](_0x33c5af);}_0x2bec90[_0x12ce0d(0x19f)](_0x4a2dd8);}),router[_0x4f4d40(0x19e)](_0x4f4d40(0x1bf),(_0x3d6232,_0x315b9b,_0x38d0c0)=>{const _0x375819=_0x4f4d40;if(_0x3d6232['currentUser'][_0x375819(0x1cd)]!=0x1)return _0x315b9b[_0x375819(0x19f)]({'code':0x66});let _0x4864aa=_0x3d6232[_0x375819(0x1a0)]['id'],_0xc04448=dbFileShare[_0x375819(0x196)](_0x3d6232['app'][_0x375819(0x1aa)],_0x4864aa),_0x5cfdd6=dbFileShare[_0x375819(0x195)](_0x3d6232[_0x375819(0x1cb)][_0x375819(0x1aa)],_0xc04448['id']),_0x42874d='(';for(let _0x2191a7 in _0x5cfdd6){_0x42874d+=_0x5cfdd6[_0x2191a7][_0x375819(0x19d)],_0x2191a7!=_0x5cfdd6[_0x375819(0x194)]-0x1&&(_0x42874d+=',');}_0x42874d+=')';let _0x69e95e=dbUserTable[_0x375819(0x1ae)](_0x3d6232[_0x375819(0x1cb)][_0x375819(0x1aa)],_0x375819(0x18f)+_0x42874d+'\x20','\x20username,id');_0xc04448[_0x375819(0x1ba)]=_0x69e95e,_0x315b9b[_0x375819(0x19f)]({'code':0x0,'data':_0xc04448});}),module['exports']=router;