const _0x5cd101=_0x2f5b;(function(_0x1ebbec,_0x59a155){const _0x2d9f63=_0x2f5b,_0xf219b1=_0x1ebbec();while(!![]){try{const _0x28cc82=parseInt(_0x2d9f63(0x125))/0x1*(parseInt(_0x2d9f63(0x14c))/0x2)+parseInt(_0x2d9f63(0x83))/0x3+parseInt(_0x2d9f63(0x141))/0x4+parseInt(_0x2d9f63(0xbe))/0x5*(parseInt(_0x2d9f63(0x118))/0x6)+-parseInt(_0x2d9f63(0x108))/0x7+parseInt(_0x2d9f63(0xbf))/0x8*(parseInt(_0x2d9f63(0x135))/0x9)+parseInt(_0x2d9f63(0xab))/0xa*(-parseInt(_0x2d9f63(0x99))/0xb);if(_0x28cc82===_0x59a155)break;else _0xf219b1['push'](_0xf219b1['shift']());}catch(_0x7723a8){_0xf219b1['push'](_0xf219b1['shift']());}}}(_0x3b7b,0x7f134));let sha256=require(_0x5cd101(0x74)),express=require(_0x5cd101(0xe7)),router=express[_0x5cd101(0x14b)](),cryptoUtils=require('../utils/cryptoUtils'),netUtils=require(_0x5cd101(0x9c)),config=require(_0x5cd101(0x131)),pathUtil=require('path'),nasAccountUtil=require(_0x5cd101(0xb2)),checkUtil=require(_0x5cd101(0x136));var package=require('../../../package.json');const OS=require('os'),dbUserTable=require('../../db/dbUserTable'),dbLoginTable=require(_0x5cd101(0x10a)),dbConfigTable=require(_0x5cd101(0x90)),dbNoticeCenterTable=require('../../db/dbNoticeCenterTable'),dbMusicIndexTable=require('../../db/dbMusicIndexTable'),fileUtil=require(_0x5cd101(0xe5)),fs=require('fs'),path=require(_0x5cd101(0x11e)),dbMovieFavorite=require(_0x5cd101(0x110)),dbMusicFavorite=require(_0x5cd101(0xbd));router[_0x5cd101(0xb3)]('/hasAdmin',(_0x4cef24,_0x5bd840,_0x37b5b8)=>{const _0x21bdfa=_0x5cd101;let _0x1dc892=dbUserTable[_0x21bdfa(0x12f)](_0x4cef24['app'][_0x21bdfa(0x9a)]),_0x251b24=dbConfigTable[_0x21bdfa(0xd3)](_0x4cef24[_0x21bdfa(0x7d)][_0x21bdfa(0x9a)],'(\x27customLogoImage\x27,\x27customLoginTitle\x27,\x27customLoginImage\x27,\x27customHomeBgImage\x27)');_0x5bd840[_0x21bdfa(0x104)]({'code':0x0,'hasAdmin':_0x1dc892?'1':'0','customConfig':_0x251b24,'hostName':OS[_0x21bdfa(0x12b)]()});});let banIpList=[];function _0x2f5b(_0x4a43b4,_0x2fcb65){const _0x3b7ba1=_0x3b7b();return _0x2f5b=function(_0x2f5b1c,_0x3f4aca){_0x2f5b1c=_0x2f5b1c-0x71;let _0x5d1fd9=_0x3b7ba1[_0x2f5b1c];return _0x5d1fd9;},_0x2f5b(_0x4a43b4,_0x2fcb65);}router['post']('/login',(_0x16f48b,_0x2929f4,_0x67c535)=>{const _0x496b4b=_0x5cd101;let _0x3e3c7f=_0x16f48b[_0x496b4b(0xfa)][_0x496b4b(0x8e)],_0x2d6bb5=_0x16f48b['body']['password'];if(!_0x3e3c7f||!_0x2d6bb5)return _0x2929f4[_0x496b4b(0x73)](0x194)[_0x496b4b(0x8c)]();_0x2d6bb5=fileUtil[_0x496b4b(0xad)](_0x2d6bb5);let _0x129adf=netUtils[_0x496b4b(0x145)](_0x16f48b),_0x114d6b=![],_0x4f36c7=0x1,_0x2bd740=0x1;if(_0x129adf!=_0x496b4b(0x71)){let _0x238287=dbConfigTable[_0x496b4b(0x111)](_0x16f48b['app']['dbOther'],_0x496b4b(0xf6));_0x238287&&(_0x238287=JSON[_0x496b4b(0x98)](_0x238287[_0x496b4b(0xb6)]),_0x238287&&(_0x238287[_0x496b4b(0xcb)]&&(_0x114d6b=!![]),_0x4f36c7=_0x238287[_0x496b4b(0x143)],_0x2bd740=_0x238287[_0x496b4b(0x92)]));}cryptoUtils[_0x496b4b(0xa6)](config[_0x496b4b(0x14d)],_0x2d6bb5)[_0x496b4b(0xf2)](_0x18c698=>{const _0x4c2864=_0x496b4b;let _0x1070bf=dbUserTable[_0x4c2864(0xc6)](_0x16f48b[_0x4c2864(0x7d)][_0x4c2864(0x9a)],_0x3e3c7f,_0x18c698);if(_0x1070bf){function _0x35d366(){const _0x2f2900=_0x4c2864;if(_0x129adf!=_0x2f2900(0x71)){let _0x2fdab1=dbConfigTable[_0x2f2900(0x111)](_0x16f48b[_0x2f2900(0x7d)][_0x2f2900(0x9a)],_0x2f2900(0x146));if(_0x2fdab1&&_0x2fdab1['value']=='1'){let _0x8427e9=_0x16f48b['body'][_0x2f2900(0x72)];if(_0x8427e9){_0x8427e9=sha256(_0x8427e9);let _0x12b484=dbUserTable[_0x2f2900(0x124)](_0x16f48b[_0x2f2900(0x7d)][_0x2f2900(0x9a)],_0x3e3c7f,_0x8427e9);if(!_0x12b484)return _0x16f48b[_0x2f2900(0x7d)][_0x2f2900(0x11b)](_0x2929f4,_0x2929f4['__']('login.answerIsWrong'));}else return _0x2929f4[_0x2f2900(0x104)]({'code':0x2,'question':_0x1070bf[_0x2f2900(0xce)]});}}dbLoginTable[_0x2f2900(0x8b)](_0x16f48b['app']['dbOther'],_0x2f2900(0xc6),_0x3e3c7f,_0x129adf,_0x16f48b[_0x2f2900(0xfa)][_0x2f2900(0x89)],_0x16f48b[_0x2f2900(0x119)]['user-agent']);let _0x4db6a8=sha256(new Date()[_0x2f2900(0x12c)]()+_0x3e3c7f+_0x18c698);var _0x22655e=_0x16f48b[_0x2f2900(0x119)][_0x2f2900(0x8d)];return dbUserTable[_0x2f2900(0x95)](_0x16f48b[_0x2f2900(0x7d)][_0x2f2900(0x9a)],_0x1070bf['id'],_0x4db6a8,_0x129adf,_0x22655e),_0x1070bf[_0x2f2900(0x128)]='',_0x1070bf[_0x2f2900(0x72)]='',_0x2929f4[_0x2f2900(0x104)]({'code':0x0,'token':_0x4db6a8,'user':_0x1070bf,'version':package[_0x2f2900(0x77)],'reqIp':_0x129adf});}if(_0x1070bf[_0x4c2864(0x114)]!=0x1)nasAccountUtil[_0x4c2864(0x93)](_0x16f48b['app'][_0x4c2864(0x9a)])[_0x4c2864(0xf2)](_0x5aa819=>{const _0x19bae2=_0x4c2864;let _0x2f41f3=dbUserTable[_0x19bae2(0x11f)](_0x16f48b[_0x19bae2(0x7d)][_0x19bae2(0x9a)]);if(!_0x5aa819){if(_0x2f41f3>parseInt(config[_0x19bae2(0x13f)])+0x1)return _0x16f48b[_0x19bae2(0x7d)][_0x19bae2(0x11b)](_0x2929f4,_0x2929f4['__'](_0x19bae2(0xf3)));return _0x35d366();}else return _0x5aa819[_0x19bae2(0x97)]<0x2&&_0x5aa819['sub_account_num']&&_0x2f41f3>parseInt(_0x5aa819['sub_account_num'])+0x1?_0x16f48b[_0x19bae2(0x7d)]['returnErrMsg'](_0x2929f4,_0x2929f4['__'](_0x19bae2(0xf3))):_0x35d366();});else return _0x35d366();}else{if(_0x114d6b){let _0x3927bd=null;for(let _0x2c780a in banIpList){banIpList[_0x2c780a]['ip']==_0x129adf&&(_0x3927bd=banIpList[_0x2c780a],banIpList[_0x2c780a][_0x4c2864(0x143)]+=0x1);}!_0x3927bd&&(_0x3927bd={'ip':_0x129adf,'testCount':0x1},banIpList[_0x4c2864(0x75)](_0x3927bd));if(_0x3927bd[_0x4c2864(0x143)]>=_0x4f36c7){let _0x3326b0=new Date()[_0x4c2864(0x12c)](),_0x4d2f02=_0x3326b0+_0x2bd740*0x3c*0x3e8;dbLoginTable[_0x4c2864(0x126)](_0x16f48b[_0x4c2864(0x7d)][_0x4c2864(0x9a)],_0x4c2864(0xdd),_0x129adf,_0x4d2f02,_0x2929f4['__']('login.pwdErrCountTooMuch')),_0x16f48b[_0x4c2864(0x7d)][_0x4c2864(0xa7)](),dbNoticeCenterTable[_0x4c2864(0xd5)](_0x16f48b[_0x4c2864(0x7d)][_0x4c2864(0x9a)],{'title':_0x2929f4['__'](_0x4c2864(0x96)),'level':'error','content':_0x2929f4['__'](_0x4c2864(0xee))+('['+_0x129adf+']')});for(let _0x27355a in banIpList){banIpList[_0x27355a]['ip']==_0x129adf&&banIpList[_0x4c2864(0xa9)](_0x27355a,0x1);}}}return dbLoginTable[_0x4c2864(0x8b)](_0x16f48b[_0x4c2864(0x7d)][_0x4c2864(0x9a)],_0x2929f4['__'](_0x4c2864(0x127)),_0x3e3c7f,_0x129adf,_0x16f48b['body'][_0x4c2864(0x89)],_0x16f48b[_0x4c2864(0x119)][_0x4c2864(0x8d)]),_0x16f48b['app'][_0x4c2864(0x11b)](_0x2929f4,_0x2929f4['__']('login.wrongNameOrPwd'));}})[_0x496b4b(0xd9)](_0x2a5def=>{const _0x2a8c68=_0x496b4b;return console[_0x2a8c68(0xb7)](_0x2a5def),_0x16f48b[_0x2a8c68(0x7d)][_0x2a8c68(0x11b)](_0x2929f4,_0x2929f4['__'](_0x2a8c68(0xb0)));});}),router[_0x5cd101(0xb3)](_0x5cd101(0xe0),(_0x47b14d,_0x1c5477,_0x596323)=>{const _0x516be6=_0x5cd101;let _0x5aec84=netUtils[_0x516be6(0x145)](_0x47b14d),_0x2b58fa=_0x47b14d['body'][_0x516be6(0x9b)];if(!_0x2b58fa)return _0x47b14d[_0x516be6(0x7d)][_0x516be6(0x11b)](_0x1c5477,_0x516be6(0x14a));let _0x3b3a4b=dbUserTable[_0x516be6(0xd1)](_0x47b14d[_0x516be6(0x7d)][_0x516be6(0x9a)],_0x2b58fa);if(!_0x3b3a4b)return _0x47b14d[_0x516be6(0x7d)][_0x516be6(0x11b)](_0x1c5477,_0x1c5477['__'](_0x516be6(0xe8)));return _0x3b3a4b[_0x516be6(0x128)]='',_0x3b3a4b[_0x516be6(0x72)]='',_0x1c5477[_0x516be6(0x104)]({'code':0x0,'token':_0x2b58fa,'user':_0x3b3a4b,'reqIp':_0x5aec84});}),router[_0x5cd101(0xb3)](_0x5cd101(0x132),(_0x122cfa,_0x20ed31,_0x1a487d)=>{const _0xa74b59=_0x5cd101;let _0x4938bf=_0x122cfa['body'][_0xa74b59(0x128)];if(_0x122cfa['currentUser']&&_0x122cfa['currentUser'][_0xa74b59(0x114)]!=0x1)return _0x20ed31[_0xa74b59(0x104)]({'code':0x66});cryptoUtils['encryptString'](config[_0xa74b59(0x14d)],_0x4938bf)[_0xa74b59(0xf2)](_0x13d161=>{const _0x5c76c8=_0xa74b59;if(_0x122cfa[_0x5c76c8(0x13c)]['password']!=_0x13d161)return _0x20ed31[_0x5c76c8(0x104)]({'code':0x1,'message':_0x20ed31['__']('login.pwdErr')});fs['rm'](path[_0x5c76c8(0x7e)](config['cacheParentPath']),{'recursive':!![]},_0x106be0=>{const _0x39f6d6=_0x5c76c8;if(_0x106be0)return _0x20ed31[_0x39f6d6(0x104)]({'code':0x1,'message':_0x39f6d6(0x8a)});return _0x122cfa['app']['dbOther'][_0x39f6d6(0x106)]('DELETE\x20FROM\x20config')[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20album')[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20backup_task')['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20backup_task_msg')['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20backup_task_record')[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20bg_task')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)](_0x39f6d6(0x105))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbOther'][_0x39f6d6(0x106)](_0x39f6d6(0xf5))[_0x39f6d6(0xac)](),_0x122cfa['app']['dbOther'][_0x39f6d6(0x106)](_0x39f6d6(0x14e))['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)]['prepare'](_0x39f6d6(0x7f))['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)](_0x39f6d6(0xb8))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20login_ip_list')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbOther'][_0x39f6d6(0x106)](_0x39f6d6(0x7b))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbOther'][_0x39f6d6(0x106)]('DELETE\x20FROM\x20notice_center')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20play_record')[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x9a)]['prepare'](_0x39f6d6(0xea))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbOther'][_0x39f6d6(0x106)](_0x39f6d6(0x14f))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)](_0x39f6d6(0x13a))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)](_0x39f6d6(0x8f))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)]['prepare'](_0x39f6d6(0xd4))['run'](),_0x122cfa['app']['dbOther'][_0x39f6d6(0x106)](_0x39f6d6(0xda))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x9a)][_0x39f6d6(0x106)](_0x39f6d6(0x11c))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)]['prepare'](_0x39f6d6(0xdf))['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20ai_classes2index')[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x7c))['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20album_ordinary_index')['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x81))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x79))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0xcc))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x140))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbFileIndex']['prepare']('DELETE\x20FROM\x20photo_faces')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20photo_faces2index')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20movie_keys')['run'](),_0x122cfa['app']['dbFileIndex']['prepare'](_0x39f6d6(0xd2))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbFileIndex'][_0x39f6d6(0x106)](_0x39f6d6(0xfc))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x12d))['run'](),_0x122cfa[_0x39f6d6(0x7d)]['dbFileIndex']['prepare'](_0x39f6d6(0x13d))[_0x39f6d6(0xac)](),_0x122cfa['app'][_0x39f6d6(0x112)]['prepare']('DELETE\x20FROM\x20music_favorite')['run'](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0x147))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)]['prepare'](_0x39f6d6(0xec))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)](_0x39f6d6(0xf7))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)]['dbFileIndex']['prepare'](_0x39f6d6(0xf0))[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20book_list_index')[_0x39f6d6(0xac)](),_0x122cfa[_0x39f6d6(0x7d)][_0x39f6d6(0x112)][_0x39f6d6(0x106)]('DELETE\x20FROM\x20book_read_record')[_0x39f6d6(0xac)](),process[_0x39f6d6(0xd0)]({'type':_0x39f6d6(0x88),'shareType':_0x39f6d6(0xcd)}),process[_0x39f6d6(0xd0)]({'type':'fileShareRestart','shareType':_0x39f6d6(0x134)}),process[_0x39f6d6(0xd0)]({'type':'nasProxyRestart'}),process['send']({'type':'createUserFolder'}),_0x20ed31['json']({'code':0x0});});});}),router[_0x5cd101(0xb3)](_0x5cd101(0x12e),(_0x4cdf2f,_0x3857d5,_0x192c61)=>{const _0xc1e539=_0x5cd101;let _0x3dfb9c=netUtils['getClientIp'](_0x4cdf2f),_0x54537c=dbUserTable['getAdmin'](_0x4cdf2f['app']['dbOther']),_0x45231a={};_0x3dfb9c==_0xc1e539(0x71)&&(_0x45231a['username']=_0x54537c[_0xc1e539(0x8e)]),_0x45231a[_0xc1e539(0xce)]=_0x54537c['question'],_0x3857d5[_0xc1e539(0x104)]({'code':0x0,'data':_0x45231a});}),router['all'](_0x5cd101(0xd6),(_0x59cdc0,_0x300661,_0x355885)=>{const _0x397c48=_0x5cd101;let _0x3a07cc={'code':0x0,'message':_0x397c48(0x12a),'version':package['version'],'hostName':OS[_0x397c48(0x12b)]()},_0x45d0b0=_0x59cdc0[_0x397c48(0xaa)][_0x397c48(0xe9)];if(_0x45d0b0&&_0x45d0b0==0x1)return _0x300661[_0x397c48(0x104)](_0x3a07cc);let _0x2d2013=0x50,_0x3fe49b=dbConfigTable[_0x397c48(0x111)](_0x59cdc0[_0x397c48(0x7d)][_0x397c48(0x9a)],'apiPort');_0x3fe49b&&_0x3fe49b[_0x397c48(0xb6)]&&(_0x2d2013=_0x3fe49b[_0x397c48(0xb6)]);let _0x392c46=0x1bb,_0x2fa323=dbConfigTable[_0x397c48(0x111)](_0x59cdc0[_0x397c48(0x7d)][_0x397c48(0x9a)],'apiPortHttps');_0x2fa323&&_0x2fa323[_0x397c48(0xb6)]&&_0x2fa323[_0x397c48(0xb6)]>0x0&&_0x2fa323[_0x397c48(0xb6)]<0xffff&&(_0x392c46=_0x2fa323[_0x397c48(0xb6)]);let _0xa60b36=0x0,_0x5b99ec=dbConfigTable[_0x397c48(0x111)](_0x59cdc0[_0x397c48(0x7d)][_0x397c48(0x9a)],_0x397c48(0x123));if(_0x5b99ec&&_0x5b99ec[_0x397c48(0xb6)])try{_0x5b99ec=JSON[_0x397c48(0x98)](_0x5b99ec[_0x397c48(0xb6)]),_0x5b99ec[_0x397c48(0xc3)]==_0x397c48(0xac)&&(_0xa60b36=0x1);}catch(_0x4a0e0c){}try{let _0x4cb77d=dbConfigTable['findByTitle'](_0x59cdc0['app'][_0x397c48(0x9a)],_0x397c48(0x144)),_0x3861c6=dbConfigTable[_0x397c48(0x111)](_0x59cdc0['app'][_0x397c48(0x9a)],_0x397c48(0xc5));if(_0x4cb77d){_0x4cb77d=JSON[_0x397c48(0x98)](_0x4cb77d['value']);let _0x61e611=[];if(_0x3861c6&&_0x3861c6[_0x397c48(0xb6)]){for(let _0x5e45c7 in _0x4cb77d){let _0x30ec0f=_0x4cb77d[_0x5e45c7];_0x30ec0f[_0x397c48(0x97)]==_0x397c48(0xc9)&&_0x61e611[_0x397c48(0x75)](_0x30ec0f);}_0x61e611[_0x397c48(0x75)]({'type':_0x397c48(0xfd),'ip':_0x3861c6[_0x397c48(0xb6)],'ddns':0x1}),_0x4cb77d=_0x61e611;}}return _0x3a07cc[_0x397c48(0xbb)]=_0x4cb77d,_0x3a07cc[_0x397c48(0x91)]=parseInt(_0x2d2013),_0x3a07cc[_0x397c48(0xe4)]=parseInt(_0x392c46),_0x3a07cc['httpsIsRunning']=_0xa60b36,_0x300661[_0x397c48(0x104)](_0x3a07cc);}catch(_0x32bab6){return _0x300661[_0x397c48(0x104)](_0x3a07cc);}}),router['post'](_0x5cd101(0x9e),(_0x16a272,_0x255891,_0x203cc0)=>{const _0x543a3d=_0x5cd101;let _0x22dd4=_0x16a272[_0x543a3d(0xfa)][_0x543a3d(0x8e)],_0x19dbf9=_0x16a272[_0x543a3d(0xfa)]['password'],_0x4b83e6=_0x16a272[_0x543a3d(0xfa)]['answer'],_0x192d48=_0x16a272['app'][_0x543a3d(0x9a)]['prepare'](_0x543a3d(0xd7))[_0x543a3d(0x107)](_0x22dd4);if(!_0x192d48)return _0x16a272['app'][_0x543a3d(0x11b)](_0x255891,_0x255891['__'](_0x543a3d(0x100)));try{_0x4b83e6=sha256(_0x4b83e6);let _0x36e367=dbUserTable[_0x543a3d(0x124)](_0x16a272['app']['dbOther'],_0x22dd4,_0x4b83e6);if(_0x36e367)cryptoUtils[_0x543a3d(0xa6)](config[_0x543a3d(0x14d)],_0x19dbf9)[_0x543a3d(0xf2)](_0x1630c9=>{const _0x521382=_0x543a3d;dbUserTable[_0x521382(0x9d)](_0x16a272['app'][_0x521382(0x9a)],_0x22dd4,_0x521382(0x128),_0x1630c9);let _0xeba256=sha256(new Date()['getTime']()+_0x22dd4+_0x19dbf9);dbUserTable['updateByUsername'](_0x16a272['app'][_0x521382(0x9a)],_0x22dd4,'token',_0xeba256),_0x255891[_0x521382(0x104)]({'code':0x0});})[_0x543a3d(0xd9)](_0x56e796=>{const _0x58e775=_0x543a3d;return console[_0x58e775(0xb7)](_0x58e775(0xb1),_0x56e796),_0x16a272[_0x58e775(0x7d)][_0x58e775(0x11b)](_0x255891,_0x255891['__'](_0x58e775(0xb0)));});else return _0x16a272[_0x543a3d(0x7d)][_0x543a3d(0x11b)](_0x255891,_0x255891['__'](_0x543a3d(0x115)));}catch(_0x11682d){return console[_0x543a3d(0xb7)](_0x543a3d(0xa2),_0x11682d),_0x255891['status'](0x194)[_0x543a3d(0x8c)]();}});function newUserCheck(_0x248d03,_0x1a7b5a,_0x4c864a,_0x4470b5,_0x2c57b1,_0x244c01){const _0x59eaf8=_0x5cd101;if(!_0x4470b5||!_0x4c864a||!_0x248d03||!_0x1a7b5a)return _0x2c57b1[_0x59eaf8(0x7d)][_0x59eaf8(0x11b)](_0x244c01,_0x244c01['__'](_0x59eaf8(0x85)));let _0x335630=new RegExp(_0x59eaf8(0x10c));if(!_0x335630['test'](_0x248d03)||_0x248d03==config['publicUserName'])return _0x2c57b1[_0x59eaf8(0x7d)][_0x59eaf8(0x11b)](_0x244c01,_0x244c01['__'](_0x59eaf8(0xf8)));if(_0x248d03==_0x1a7b5a)return _0x2c57b1[_0x59eaf8(0x7d)][_0x59eaf8(0x11b)](_0x244c01,_0x244c01['__'](_0x59eaf8(0xa5)));if(checkUtil[_0x59eaf8(0xc8)](_0x248d03))return _0x2c57b1[_0x59eaf8(0x7d)]['returnErrMsg'](_0x244c01,_0x244c01['__']('usernameTooEasy'));if(_0x4c864a==_0x4470b5)return _0x2c57b1[_0x59eaf8(0x7d)][_0x59eaf8(0x11b)](_0x244c01,_0x244c01['__']('answerQuestionCannotBeSame'));if(checkUtil['isIncludeChinese'](_0x1a7b5a))return _0x2c57b1[_0x59eaf8(0x7d)]['returnErrMsg'](_0x244c01,_0x244c01['__']('pwdCannotBeChinese'));return!![];}router['post'](_0x5cd101(0xca),(_0x452570,_0x25e2fa,_0x549c25)=>{const _0x13cd6b=_0x5cd101;let _0x5550d8=_0x452570['body'][_0x13cd6b(0x8e)],_0x5cfb36=_0x452570[_0x13cd6b(0xfa)]['password'],_0x5bbce1=_0x452570[_0x13cd6b(0xfa)]['question'],_0x57698c=_0x452570[_0x13cd6b(0xfa)][_0x13cd6b(0x72)];if(!_0x57698c||!_0x5bbce1||!_0x5550d8||!_0x5cfb36)return _0x25e2fa['json']({'code':0x1,'message':_0x13cd6b(0x87)});let _0x48fe95=dbUserTable[_0x13cd6b(0x12f)](_0x452570[_0x13cd6b(0x7d)][_0x13cd6b(0x9a)]);if(_0x48fe95)_0x25e2fa[_0x13cd6b(0x104)]({'code':0x1,'message':_0x25e2fa['__']('login.adminExist')});else{if(newUserCheck(_0x5550d8,_0x5cfb36,_0x5bbce1,_0x57698c,_0x452570,_0x25e2fa)!==!![])return;_0x57698c=sha256(_0x57698c),cryptoUtils['encryptString'](config[_0x13cd6b(0x14d)],_0x5cfb36)[_0x13cd6b(0xf2)](_0x14a6d9=>{const _0x2ecf88=_0x13cd6b;let _0x4dfac5=dbUserTable[_0x2ecf88(0xd5)](_0x452570[_0x2ecf88(0x7d)]['dbOther'],{'username':_0x5550d8,'password':_0x14a6d9,'question':_0x5bbce1,'answer':_0x57698c,'is_admin':0x1});if(_0x4dfac5[_0x2ecf88(0xfb)]>0x0){let _0x41878e=dbUserTable[_0x2ecf88(0x12f)](_0x452570[_0x2ecf88(0x7d)][_0x2ecf88(0x9a)]),_0x2ea0c8=sha256(new Date()[_0x2ecf88(0x12c)]()+_0x5550d8+_0x14a6d9),_0x4f06cf=netUtils[_0x2ecf88(0x145)](_0x452570);var _0x2302ae=_0x452570[_0x2ecf88(0x119)][_0x2ecf88(0x8d)];return dbUserTable[_0x2ecf88(0x95)](_0x452570[_0x2ecf88(0x7d)]['dbOther'],_0x41878e['id'],_0x2ea0c8,_0x4f06cf,_0x2302ae),_0x41878e[_0x2ecf88(0x128)]='',_0x25e2fa['json']({'code':0x0,'token':_0x2ea0c8,'user':_0x41878e});}})[_0x13cd6b(0xd9)](_0x5744c7=>{const _0x5fea32=_0x13cd6b;return console['log'](_0x5fea32(0xb1),_0x5744c7),_0x452570[_0x5fea32(0x7d)][_0x5fea32(0x11b)](_0x25e2fa,_0x25e2fa['__'](_0x5fea32(0xb0)));});}}),router[_0x5cd101(0xb3)]('/remarkUser',(_0x5de087,_0x59a095,_0x3a3e4a)=>{const _0x5f30f0=_0x5cd101;if(_0x5de087[_0x5f30f0(0x13c)]['is_admin']!=0x1)return _0x59a095[_0x5f30f0(0x104)]({'code':0x66});let _0x22a945=_0x5de087[_0x5f30f0(0xfa)][_0x5f30f0(0x8e)],_0x1aa0c0=_0x5de087['body'][_0x5f30f0(0x10e)];return _0x22a945&&_0x1aa0c0&&dbUserTable[_0x5f30f0(0xc1)](_0x5de087[_0x5f30f0(0x7d)][_0x5f30f0(0x9a)],_0x22a945,_0x1aa0c0),_0x59a095['json']({'code':0x0});}),router[_0x5cd101(0xb3)](_0x5cd101(0xaf),(_0x35fff5,_0x35c964,_0x20b8e7)=>{const _0x20662b=_0x5cd101;nasAccountUtil[_0x20662b(0x93)](_0x35fff5[_0x20662b(0x7d)][_0x20662b(0x9a)])[_0x20662b(0xf2)](_0x1d8d2e=>{const _0x5156b4=_0x20662b;let _0x1aa56c=dbUserTable[_0x5156b4(0x11f)](_0x35fff5[_0x5156b4(0x7d)][_0x5156b4(0x9a)]);if(!_0x1d8d2e){if(_0x1aa56c>=parseInt(config[_0x5156b4(0x13f)])+0x1){let _0x1cc7ea=dbUserTable[_0x5156b4(0xcf)](_0x35fff5[_0x5156b4(0x7d)][_0x5156b4(0x9a)],_0x35fff5[_0x5156b4(0xfa)][_0x5156b4(0x8e)]);if(!_0x1cc7ea)return _0x35fff5['app']['returnErrMsg'](_0x35c964,_0x35c964['__'](_0x5156b4(0xf3)));}_0x5cea06();}else{if(_0x1d8d2e[_0x5156b4(0x97)]<0x2&&_0x1d8d2e[_0x5156b4(0x139)]&&_0x1aa56c>=parseInt(_0x1d8d2e[_0x5156b4(0x139)])+0x1)return _0x35fff5[_0x5156b4(0x7d)][_0x5156b4(0x11b)](_0x35c964,_0x35c964['__'](_0x5156b4(0xf3)));else _0x5cea06();}function _0x5cea06(){const _0x5b14e9=_0x5156b4;let _0x4ae2f6=_0x35fff5[_0x5b14e9(0xfa)][_0x5b14e9(0x8e)],_0xc2e027=_0x35fff5['body'][_0x5b14e9(0x128)],_0x3b92b4=_0x35fff5[_0x5b14e9(0xfa)][_0x5b14e9(0xce)],_0x5b763c=_0x35fff5[_0x5b14e9(0xfa)][_0x5b14e9(0x72)],_0x41ad60=_0x35fff5[_0x5b14e9(0xfa)][_0x5b14e9(0x10e)];if(newUserCheck(_0x4ae2f6,_0xc2e027,_0x3b92b4,_0x5b763c,_0x35fff5,_0x35c964)!==!![])return;let _0x2aeb18=_0x35fff5[_0x5b14e9(0xfa)]['type'];if(dbUserTable[_0x5b14e9(0xa8)](_0x35fff5,_0x35c964)===!![]){if(_0x2aeb18==_0x5b14e9(0x122)){let _0x5db0ee=dbUserTable[_0x5b14e9(0xb5)](_0x35fff5[_0x5b14e9(0x7d)][_0x5b14e9(0x9a)],_0x4ae2f6);if(_0x5db0ee)return _0x35fff5[_0x5b14e9(0x7d)]['returnErrMsg'](_0x35c964,_0x35c964['__']('login.sameUsernameExist'));}cryptoUtils[_0x5b14e9(0xa6)](config[_0x5b14e9(0x14d)],_0xc2e027)[_0x5b14e9(0xf2)](_0x2195cb=>{const _0x4d995b=_0x5b14e9;let _0x4a45b6=dbUserTable['create'](_0x35fff5[_0x4d995b(0x7d)][_0x4d995b(0x9a)],{'username':_0x4ae2f6,'password':_0x2195cb,'question':_0x3b92b4,'answer':sha256(_0x5b763c),'remark':_0x41ad60});return _0x4a45b6['changes']>=0x1?_0x35c964['json']({'code':0x0}):_0x35fff5[_0x4d995b(0x7d)]['returnErrMsg'](_0x35c964,_0x35c964['__'](_0x4d995b(0xb0)));})[_0x5b14e9(0xd9)](_0x210ff7=>{const _0x5c795c=_0x5b14e9;return console['log'](_0x5c795c(0xb1),_0x210ff7),_0x35fff5['app'][_0x5c795c(0x11b)](_0x35c964,_0x35c964['__'](_0x5c795c(0xb0)));});}}});}),router[_0x5cd101(0xb3)](_0x5cd101(0xc4),(_0x13605a,_0xa339a9,_0x37395e)=>{const _0x1f5e72=_0x5cd101;let _0x45a002=_0x13605a[_0x1f5e72(0xfa)][_0x1f5e72(0x7a)];if(dbUserTable[_0x1f5e72(0xa8)](_0x13605a,_0xa339a9)===!![]){let _0x495127=dbUserTable[_0x1f5e72(0x109)](_0x13605a['app'][_0x1f5e72(0x9a)],_0x45a002);if(_0x495127&&_0x495127[_0x1f5e72(0x114)]==0x1)return _0xa339a9[_0x1f5e72(0x104)]({'code':0x1,'message':_0x1f5e72(0xed)});dbUserTable[_0x1f5e72(0x84)](_0x13605a[_0x1f5e72(0x7d)][_0x1f5e72(0x9a)],_0x495127[_0x1f5e72(0x8e)]),dbMusicIndexTable[_0x1f5e72(0x10d)](_0x13605a[_0x1f5e72(0x7d)]['dbFileIndex'],_0x495127['id']),dbMusicFavorite[_0x1f5e72(0x148)](_0x13605a[_0x1f5e72(0x7d)][_0x1f5e72(0x112)],_0x495127['id']),dbMovieFavorite[_0x1f5e72(0x148)](_0x13605a[_0x1f5e72(0x7d)][_0x1f5e72(0x112)],_0x495127['id']);let _0x50f38b=dbUserTable['delete'](_0x13605a[_0x1f5e72(0x7d)][_0x1f5e72(0x9a)],_0x45a002);return _0x50f38b['changes']>=0x1?_0xa339a9[_0x1f5e72(0x104)]({'code':0x0}):_0x13605a[_0x1f5e72(0x7d)][_0x1f5e72(0x11b)](_0xa339a9,_0xa339a9['__']('operationFail'));}}),router[_0x5cd101(0xb3)]('/getAllUser',(_0x4b2a2e,_0x15764e,_0x5063e9)=>{const _0x1154e7=_0x5cd101;if(dbUserTable['isAdmin'](_0x4b2a2e,_0x15764e)===!![]){let _0x41d433=_0x4b2a2e[_0x1154e7(0xfa)][_0x1154e7(0x129)]||'id',_0x478a55=_0x4b2a2e[_0x1154e7(0xfa)][_0x1154e7(0x76)]||'asc',_0x5b77c9=_0x4b2a2e[_0x1154e7(0xfa)][_0x1154e7(0x142)];(!['id','username',_0x1154e7(0xf9)][_0x1154e7(0xa4)](_0x41d433)||![_0x1154e7(0xfe),_0x1154e7(0x13e)][_0x1154e7(0xa4)](_0x478a55))&&(_0x41d433='id',_0x478a55='asc');let _0x4b70a0=_0x1154e7(0x101),_0x506e8f=[];_0x5b77c9&&(_0x4b70a0+=_0x1154e7(0xb9),_0x506e8f[_0x1154e7(0x75)]('%'+_0x5b77c9+'%','%'+_0x5b77c9+'%'));_0x4b70a0+=_0x1154e7(0x116)+_0x41d433+'\x20'+_0x478a55;let _0x542a7b=_0x4b2a2e['app'][_0x1154e7(0x9a)][_0x1154e7(0x106)](_0x4b70a0)['all'](_0x506e8f);return _0x15764e[_0x1154e7(0x104)]({'code':0x0,'userList':_0x542a7b});}}),router['post']('/getUserPower',(_0x3d5386,_0x2d67f0,_0x39f1d6)=>{const _0x269e9b=_0x5cd101;let _0xe83e4=_0x3d5386['body'][_0x269e9b(0x8e)],_0x286be7=null;if(_0xe83e4!=config[_0x269e9b(0x78)]){_0x286be7=dbUserTable[_0x269e9b(0xcf)](_0x3d5386['app'][_0x269e9b(0x9a)],_0xe83e4);if(!_0x286be7)return _0x3d5386[_0x269e9b(0x7d)][_0x269e9b(0x11b)](_0x2d67f0,_0x269e9b(0x149));}if(dbUserTable['isAdmin'](_0x3d5386,_0x2d67f0)===!![]||_0xe83e4==_0x3d5386[_0x269e9b(0x13c)][_0x269e9b(0x8e)]){let _0x142875=dbUserTable['getUserPower'](_0x3d5386[_0x269e9b(0x7d)][_0x269e9b(0x9a)],_0xe83e4,null,null,!![]),_0x1126c5=0x0;if(_0x142875[_0x269e9b(0xe2)]<0x1)return _0x2d67f0[_0x269e9b(0x104)]({'code':0x0,'userPower':_0x142875,'userMenu':_0x286be7?_0x286be7[_0x269e9b(0x86)]:[]});for(let _0x461b4f=0x0;_0x461b4f<_0x142875[_0x269e9b(0xe2)];_0x461b4f++){let _0x3824ae=_0x142875[_0x461b4f][_0x269e9b(0x11e)];fs[_0x269e9b(0x80)](_0x3824ae,(_0x43ceac,_0x300292)=>{const _0x14a788=_0x269e9b;_0x1126c5+=0x1;_0x43ceac?_0x142875[_0x461b4f][_0x14a788(0xba)]=0x0:_0x142875[_0x461b4f][_0x14a788(0xba)]=0x1;if(_0x1126c5==_0x142875[_0x14a788(0xe2)])return _0x2d67f0[_0x14a788(0x104)]({'code':0x0,'userPower':_0x142875,'userMenu':_0x286be7?_0x286be7[_0x14a788(0x86)]:[]});});}}}),router['post'](_0x5cd101(0xf4),(_0x533014,_0x127d96,_0x5c95e2)=>{const _0x1ceaa1=_0x5cd101;let _0x4d6012=_0x533014['body'][_0x1ceaa1(0x8e)],_0x22c0b9=_0x533014[_0x1ceaa1(0xfa)][_0x1ceaa1(0x11e)],_0x3875a9=_0x533014[_0x1ceaa1(0xfa)]['server_type'];if(!_0x4d6012||!_0x22c0b9||!_0x3875a9)return _0x533014['app'][_0x1ceaa1(0x11b)](_0x127d96,_0x127d96['__'](_0x1ceaa1(0xb0)));let _0x11f674=null;if(_0x4d6012!=config[_0x1ceaa1(0x78)]){_0x11f674=dbUserTable[_0x1ceaa1(0xcf)](_0x533014[_0x1ceaa1(0x7d)][_0x1ceaa1(0x9a)],_0x4d6012);if(!_0x11f674)return _0x533014['app'][_0x1ceaa1(0x11b)](_0x127d96,_0x1ceaa1(0x149));}_0x22c0b9=pathUtil['join'](_0x22c0b9);if(dbUserTable[_0x1ceaa1(0xa8)](_0x533014,_0x127d96)===!![]){let _0x2f5bb9=dbUserTable[_0x1ceaa1(0x103)](_0x533014['app'][_0x1ceaa1(0x9a)],_0x4d6012,_0x3875a9,null,!![]);for(let _0x1f0dfd of _0x2f5bb9){let _0x172c68=_0x1f0dfd['path'];if(_0x22c0b9[_0x1ceaa1(0x82)](pathUtil[_0x1ceaa1(0x7e)](_0x172c68,pathUtil[_0x1ceaa1(0x94)]))&&_0x22c0b9!=_0x172c68)return _0x533014[_0x1ceaa1(0x7d)]['returnErrMsg'](_0x127d96,_0x127d96['__'](_0x1ceaa1(0x117))+_0x172c68,_0x1ceaa1(0x121));if(_0x172c68[_0x1ceaa1(0x82)](pathUtil[_0x1ceaa1(0x7e)](_0x22c0b9,pathUtil[_0x1ceaa1(0x94)]))&&_0x22c0b9!=_0x172c68)return _0x533014[_0x1ceaa1(0x7d)][_0x1ceaa1(0x11b)](_0x127d96,_0x127d96['__'](_0x1ceaa1(0x117))+_0x172c68,'dialog');}let _0x38c924=dbUserTable['createOrUpdatePower'](_0x533014[_0x1ceaa1(0x7d)]['dbOther'],_0x533014['body']);return _0x127d96[_0x1ceaa1(0x104)]({'code':0x0,'result':_0x38c924});}}),router[_0x5cd101(0xb3)]('/setUserMenu',(_0x59946a,_0x458f5f,_0x553fad)=>{const _0xc7deb5=_0x5cd101;let _0xca495b=_0x59946a['body'][_0xc7deb5(0x8e)],_0x131d13=_0x59946a['body'][_0xc7deb5(0x11d)];if(!_0xca495b||!(_0x131d13 instanceof Array))return _0x59946a[_0xc7deb5(0x7d)][_0xc7deb5(0x11b)](_0x458f5f,_0xc7deb5(0xa0));let _0x4e630c=dbUserTable[_0xc7deb5(0xcf)](_0x59946a[_0xc7deb5(0x7d)][_0xc7deb5(0x9a)],_0xca495b);if(!_0x4e630c)return _0x59946a['app'][_0xc7deb5(0x11b)](_0x458f5f,_0xc7deb5(0x149));if(dbUserTable['isAdmin'](_0x59946a,_0x458f5f)===!![])return dbUserTable[_0xc7deb5(0x9d)](_0x59946a[_0xc7deb5(0x7d)]['dbOther'],_0xca495b,_0xc7deb5(0x86),JSON['stringify'](_0x131d13)),_0x458f5f[_0xc7deb5(0x104)]({'code':0x0});}),router[_0x5cd101(0xb3)](_0x5cd101(0xef),(_0x4e7b3e,_0x401dbf,_0x155d90)=>{const _0x59b834=_0x5cd101;let _0x58ce64=dbUserTable['cancelUserPathPower'](_0x4e7b3e[_0x59b834(0x7d)][_0x59b834(0x9a)],_0x4e7b3e[_0x59b834(0xfa)]);return _0x58ce64[_0x59b834(0xfb)]>0x0?_0x401dbf[_0x59b834(0x104)]({'code':0x0}):_0x4e7b3e[_0x59b834(0x7d)][_0x59b834(0x11b)](_0x401dbf,_0x401dbf['__'](_0x59b834(0xb0)));}),router[_0x5cd101(0xb3)](_0x5cd101(0xdb),(_0x3fd2e9,_0x20e5ec,_0x576911)=>{const _0x108b2e=_0x5cd101;let _0x168a3e=_0x3fd2e9[_0x108b2e(0xfa)]['oldPassword'],_0x4533dd=_0x3fd2e9[_0x108b2e(0xfa)][_0x108b2e(0x137)];cryptoUtils[_0x108b2e(0xa6)](config['passwordKey'],_0x168a3e)['then'](_0x3ea0c9=>{const _0x5e58ce=_0x108b2e;if(_0x3fd2e9[_0x5e58ce(0x13c)]['password']!=_0x3ea0c9)return _0x20e5ec[_0x5e58ce(0x104)]({'code':0x2,'message':_0x20e5ec['__'](_0x5e58ce(0x10f))});else cryptoUtils[_0x5e58ce(0xa6)](config['passwordKey'],_0x4533dd)[_0x5e58ce(0xf2)](_0x55d70f=>{const _0x5a9193=_0x5e58ce;dbUserTable[_0x5a9193(0xc7)](_0x3fd2e9[_0x5a9193(0x7d)][_0x5a9193(0x9a)],_0x3fd2e9['currentUser']['id'],_0x5a9193(0x128),_0x55d70f);let _0x52aa22=sha256(new Date()['getTime']()+_0x3fd2e9['currentUser'][_0x5a9193(0x8e)]+_0x3fd2e9[_0x5a9193(0x13c)]['password']);dbUserTable[_0x5a9193(0xc7)](_0x3fd2e9[_0x5a9193(0x7d)][_0x5a9193(0x9a)],_0x3fd2e9[_0x5a9193(0x13c)]['id'],_0x5a9193(0x9b),_0x52aa22);let _0x5001df=netUtils[_0x5a9193(0x145)](_0x3fd2e9);return dbLoginTable['addLoginRecord'](_0x3fd2e9[_0x5a9193(0x7d)][_0x5a9193(0x9a)],_0x5a9193(0xbc),_0x3fd2e9[_0x5a9193(0x13c)]['id'],_0x5001df,_0x3fd2e9['body']['client'],''),_0x20e5ec[_0x5a9193(0x104)]({'code':0x0});})['catch'](_0x49c73e=>{const _0x2ed3f9=_0x5e58ce;return console[_0x2ed3f9(0xb7)](_0x2ed3f9(0xb1),_0x49c73e),_0x3fd2e9[_0x2ed3f9(0x7d)]['returnErrMsg'](_0x20e5ec,_0x20e5ec['__'](_0x2ed3f9(0xb0)));});});}),router[_0x5cd101(0xb3)](_0x5cd101(0x9f),(_0x37a2e5,_0x499428,_0xb3f7ca)=>{const _0x386dfb=_0x5cd101;let _0xe4e52e=_0x37a2e5['body'][_0x386dfb(0xe1)],_0x91fed7=_0x37a2e5[_0x386dfb(0xfa)]['answer'];if(checkUtil[_0x386dfb(0xd8)](_0x91fed7))return _0x37a2e5[_0x386dfb(0x7d)][_0x386dfb(0x11b)](_0x499428,_0x499428['__']('answerNotSeqNumOrChar'));if(_0xe4e52e==_0x91fed7)return _0x37a2e5[_0x386dfb(0x7d)][_0x386dfb(0x11b)](_0x499428,_0x499428['__']('answerQuestionCannotBeSame'));return dbUserTable['updateQuestionById'](_0x37a2e5[_0x386dfb(0x7d)][_0x386dfb(0x9a)],_0x37a2e5[_0x386dfb(0x13c)]['id'],_0xe4e52e,sha256(_0x91fed7)),_0x499428[_0x386dfb(0x104)]({'code':0x0});}),router[_0x5cd101(0xb3)]('/logout',(_0x3de2d6,_0x571cf3,_0xdde65f)=>{const _0x2ae156=_0x5cd101;let _0x5a9ed1=_0x3de2d6[_0x2ae156(0xfa)][_0x2ae156(0x9b)];return _0x5a9ed1&&dbUserTable[_0x2ae156(0x11a)](_0x3de2d6['app'][_0x2ae156(0x9a)],_0x2ae156(0xe6),[_0x5a9ed1]),_0x571cf3[_0x2ae156(0x104)]({'code':0x0});}),router[_0x5cd101(0xb3)](_0x5cd101(0xff),(_0x5125d3,_0x56b2f1,_0x1bff74)=>{const _0x3d735f=_0x5cd101;let _0x358acb=dbUserTable[_0x3d735f(0x109)](_0x5125d3['app'][_0x3d735f(0x9a)],_0x5125d3[_0x3d735f(0x13c)]['id']);return _0x358acb?(_0x358acb['password']='',_0x358acb[_0x3d735f(0x72)]='',_0x56b2f1[_0x3d735f(0x104)]({'code':0x0,'userInfo':_0x358acb})):_0x56b2f1['json']({'code':0x65});}),router[_0x5cd101(0xb3)](_0x5cd101(0xdc),(_0x12321f,_0x493034,_0xb561a5)=>{const _0x5c54ad=_0x5cd101;if(_0x12321f[_0x5c54ad(0x13c)][_0x5c54ad(0x114)]!=0x1)return _0x493034[_0x5c54ad(0x104)]({'code':0x66});let _0x8d9ea=_0x12321f[_0x5c54ad(0xfa)]['ip'];if(_0x8d9ea==_0x5c54ad(0x71)||_0x8d9ea==_0x5c54ad(0x13b))return _0x12321f[_0x5c54ad(0x7d)][_0x5c54ad(0x11b)](_0x493034,_0x493034['__'](_0x5c54ad(0xb4)));let _0x5abd71=_0x12321f[_0x5c54ad(0xfa)][_0x5c54ad(0x97)],_0x459e24=_0x12321f['body']['banTimeStamp'];return dbLoginTable[_0x5c54ad(0x126)](_0x12321f[_0x5c54ad(0x7d)][_0x5c54ad(0x9a)],_0x5abd71,_0x8d9ea,_0x459e24,_0x493034['__'](_0x5c54ad(0x120))),_0x12321f[_0x5c54ad(0x7d)]['refreshIpList'](),_0x493034[_0x5c54ad(0x104)]({'code':0x0});}),router[_0x5cd101(0xb3)](_0x5cd101(0xa1),(_0x4e9019,_0x592f38,_0x516cd3)=>{const _0x2ac00b=_0x5cd101;if(_0x4e9019[_0x2ac00b(0x13c)]['is_admin']!=0x1)return _0x592f38[_0x2ac00b(0x104)]({'code':0x66});let _0x1bcbd6=_0x4e9019['body']['id'];return dbLoginTable[_0x2ac00b(0x150)](_0x4e9019['app'][_0x2ac00b(0x9a)],_0x1bcbd6),_0x4e9019['app']['refreshIpList'](),_0x592f38[_0x2ac00b(0x104)]({'code':0x0});}),router[_0x5cd101(0xb3)]('/getIpList',(_0x3ca0a0,_0x9d751b,_0x5dba6d)=>{const _0x7d4bba=_0x5cd101;let _0x8713a4=_0x3ca0a0['body'][_0x7d4bba(0xc2)],_0x26d84f=_0x3ca0a0[_0x7d4bba(0xfa)][_0x7d4bba(0x113)],_0x4078ff=_0x3ca0a0[_0x7d4bba(0xfa)][_0x7d4bba(0x97)],_0x581aee=new Date()['getTime']();dbLoginTable['deleteIpByWhere'](_0x3ca0a0['app']['dbOther'],'\x20end_timestamp\x20is\x20not\x20null\x20and\x20end_timestamp<'+_0x581aee);let _0x184b46='\x20type=\x27'+_0x4078ff+'\x27',_0x8e96ba=dbLoginTable[_0x7d4bba(0xe3)](_0x3ca0a0[_0x7d4bba(0x7d)][_0x7d4bba(0x9a)],_0x184b46),_0x4206a1=(_0x8713a4-0x1)*_0x26d84f;_0x184b46+=_0x7d4bba(0xde)+_0x26d84f+_0x7d4bba(0xf1)+_0x4206a1;let _0x991381=dbLoginTable['getAllIpListByWhere'](_0x3ca0a0[_0x7d4bba(0x7d)][_0x7d4bba(0x9a)],_0x184b46);return _0x9d751b[_0x7d4bba(0x104)]({'code':0x0,'data':_0x991381,'pageCount':Math['ceil'](_0x8e96ba[_0x7d4bba(0xeb)]/_0x26d84f)});}),router[_0x5cd101(0xb3)](_0x5cd101(0x133),(_0x4b99e6,_0x34208c,_0x4a63eb)=>{const _0x50e6c5=_0x5cd101;if(_0x4b99e6[_0x50e6c5(0x13c)][_0x50e6c5(0x114)]!=0x1)return _0x34208c['json']({'code':0x66});let _0x44f5a0=0x1388,_0x4c1e81=_0x4b99e6[_0x50e6c5(0xfa)][_0x50e6c5(0xc2)],_0x257349=_0x4b99e6[_0x50e6c5(0xfa)][_0x50e6c5(0x113)],_0x55c884=_0x4b99e6[_0x50e6c5(0xfa)][_0x50e6c5(0x97)],_0x2fe3ef='',_0x8f576c=[];_0x55c884?(_0x2fe3ef+=_0x50e6c5(0x10b),_0x8f576c['push'](_0x55c884)):_0x2fe3ef=_0x50e6c5(0x138);let _0xea975d=dbLoginTable[_0x50e6c5(0xa3)](_0x4b99e6[_0x50e6c5(0x7d)][_0x50e6c5(0x9a)],_0x2fe3ef,_0x8f576c)[_0x50e6c5(0xeb)];if(_0xea975d>_0x44f5a0){let _0x6a2c03=0x64,_0x22fd4a=dbLoginTable[_0x50e6c5(0x102)](_0x4b99e6['app'][_0x50e6c5(0x9a)],'\x20id\x20in(SELECT\x20id\x20FROM\x20login_record\x20ORDER\x20BY\x20id\x20LIMIT\x20'+_0x6a2c03+')');_0x22fd4a[_0x50e6c5(0xfb)]>0x0&&(_0xea975d=_0xea975d-_0x22fd4a[_0x50e6c5(0xfb)]);}let _0x16bf8f=(_0x4c1e81-0x1)*_0x257349;_0x2fe3ef+=_0x50e6c5(0xc0),_0x8f576c[_0x50e6c5(0x75)](_0x257349),_0x8f576c[_0x50e6c5(0x75)](_0x16bf8f);let _0x5a969f=dbLoginTable[_0x50e6c5(0xae)](_0x4b99e6['app'][_0x50e6c5(0x9a)],_0x2fe3ef,_0x8f576c);return _0x34208c[_0x50e6c5(0x104)]({'code':0x0,'data':_0x5a969f,'pageCount':Math['ceil'](_0xea975d/_0x257349)});}),module[_0x5cd101(0x130)]=router;function _0x3b7b(){const _0x52168e=['freeVersionSubuserCount','DELETE\x20FROM\x20file_index_book','2779968AsrvXX','searchKey','testCount','globalIpList','getClientIp','twoStepLogin','DELETE\x20FROM\x20music_playlist','deleteFavoriteByUid','username\x20error','Need\x20token','Router','1052iIjTof','passwordKey','DELETE\x20FROM\x20file_record','DELETE\x20FROM\x20private_space_token','deleteIp','localhost','answer','status','sha256','push','orderType','version','publicUserName','DELETE\x20FROM\x20file_index_photo','uid','DELETE\x20FROM\x20login_record','DELETE\x20FROM\x20album_ordinary','app','join','DELETE\x20FROM\x20file_share','stat','DELETE\x20FROM\x20file_index_movie','startsWith','1903515zTBeFN','deletePowerByUsername','newUserParamsNull','menus','params\x20error','fileShareRestart','client','Error','addLoginRecord','end','user-agent','username','DELETE\x20FROM\x20source_folder','../../db/dbConfigTable','apiPort','banTime','getVipInfo','sep','createToken','login.loginFailAlert','type','parse','1344794bhquEt','dbOther','token','../utils/netUtils','updateByUsername','/resetPwd','/changeQuestion','need\x20username/menuList','/removeIp','err','getRecordCountByWhere','includes','usernameAndPwdCannotBeSame','encryptString','refreshIpList','isAdmin','splice','query','200BGfGLc','run','decodeBase64','getAllRecordByWhere','/addUser','operationFail','error','../utils/nasAccountUtils','post','security.thisIpCannotAddList','findByUsername','value','log','DELETE\x20FROM\x20file_share_user','\x20WHERE\x20username\x20like\x20?\x20or\x20user_remark\x20like\x20?','exist','ipList','changePassword','../../db/dbMusicFavorite','75190OxIJBl','8ezFBNQ','\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','updateRemarkByUsername','page','state','/removeUser','ddnsIpv6Address','login','updateById','isEasyUsername','ipv4','/registAdmin','enable','DELETE\x20FROM\x20file_index_music','FTP','question','getUserByUserName','send','getUserByToken','DELETE\x20FROM\x20movie_collection','findByTitleArr','DELETE\x20FROM\x20user','create','/checkIsNasServer','SELECT\x20*\x20FROM\x20user\x20WHERE\x20username=?','isSameStr','catch','DELETE\x20FROM\x20user_token','/changePassword','/addIpToList','black','\x20order\x20by\x20id\x20desc\x20limit\x20','DELETE\x20FROM\x20ai_classes','/tokenLogin','newQuestion','length','getIpListCountByWhere','apiPortHttps','../utils/fileUtils','\x20WHERE\x20token\x20=?','express','TokenExpired','ignoreIp','DELETE\x20FROM\x20private_space','count','DELETE\x20FROM\x20music_playlist_index','You\x20can\x27t\x20delete\x20admin\x20account','login.tooManyPwdTestIpBan','/cancelUserPathPower','DELETE\x20FROM\x20book_list','\x20offset\x20','then','account.subAccountMax','/setUserPower','DELETE\x20FROM\x20file_operation_record','ipBan','DELETE\x20FROM\x20book_favorite','usernameReg','user_remark','body','changes','DELETE\x20FROM\x20movie_history','ipv6','asc','/getCurrentUserInfo','userNotExist','SELECT\x20id,username,is_admin,user_remark\x20FROM\x20user\x20','deleteRecordByWhere','getUserPower','json','DELETE\x20FROM\x20config\x20where\x20title\x20in\x20(\x27nasAccountInfo\x27)','prepare','get','485226evnciV','find','../../db/dbLoginTable','\x20type=?','^[0-9a-zA-Z]*$','removeUserPlayList','remark','login.oldPwdErr','../../db/dbMovieFavorite','findByTitle','dbFileIndex','pageSize','is_admin','login.answerIsWrong','\x20ORDER\x20BY\x20','path.parentPathExist','234AbwCsv','headers','deleteUserTokenByWhere','returnErrMsg','DELETE\x20FROM\x20user_power','menuList','path','getUserCount','login.adminAdded','dialog','add','apiServerHttps','checkAnswer','168pXikVs','addIpToList','login.wrongNameOrPwd','password','orderField','NodeNasServer','hostname','getTime','DELETE\x20FROM\x20movie_library','/resetPwdInfo','getAdmin','exports','../../myConfig/config','/resetSystem','/getRecordList','WebDav','9274959xPtPjK','../utils/checkUtil','newPassword','\x201=1','sub_account_num','DELETE\x20FROM\x20share_temp','127.0.0.1','currentUser','DELETE\x20FROM\x20photo_phash_similar','desc'];_0x3b7b=function(){return _0x52168e;};return _0x3b7b();}