const _0x252e17=_0x24d4;(function(_0xb8c39,_0x32fbe6){const _0x37ca94=_0x24d4,_0x372546=_0xb8c39();while(!![]){try{const _0x507656=parseInt(_0x37ca94(0x1a7))/0x1*(parseInt(_0x37ca94(0x19e))/0x2)+parseInt(_0x37ca94(0x148))/0x3*(-parseInt(_0x37ca94(0x129))/0x4)+-parseInt(_0x37ca94(0x161))/0x5+-parseInt(_0x37ca94(0x160))/0x6*(-parseInt(_0x37ca94(0x1c1))/0x7)+-parseInt(_0x37ca94(0x1a8))/0x8*(parseInt(_0x37ca94(0x18f))/0x9)+-parseInt(_0x37ca94(0x1c0))/0xa+parseInt(_0x37ca94(0x156))/0xb*(parseInt(_0x37ca94(0x154))/0xc);if(_0x507656===_0x32fbe6)break;else _0x372546['push'](_0x372546['shift']());}catch(_0x8ccaa){_0x372546['push'](_0x372546['shift']());}}}(_0x3cdb,0xe7a69));let sha256=require(_0x252e17(0x103)),express=require(_0x252e17(0x17d)),router=express[_0x252e17(0x12c)](),cryptoUtils=require(_0x252e17(0x1d6)),netUtils=require('../utils/netUtils'),config=require(_0x252e17(0x1c6)),pathUtil=require(_0x252e17(0x136)),nasAccountUtil=require('../utils/nasAccountUtils'),checkUtil=require(_0x252e17(0x1b1));var package=require(_0x252e17(0x193));const OS=require('os'),dbUserTable=require('../../db/dbUserTable'),dbLoginTable=require('../../db/dbLoginTable'),dbConfigTable=require('../../db/dbConfigTable'),dbNoticeCenterTable=require('../../db/dbNoticeCenterTable'),dbMusicIndexTable=require('../../db/dbMusicIndexTable'),fileUtil=require(_0x252e17(0x16c)),fs=require('fs'),path=require(_0x252e17(0x136)),dbMovieFavorite=require(_0x252e17(0x122)),dbMusicFavorite=require('../../db/dbMusicFavorite');function _0x3cdb(){const _0x580c63=['3leeHze','freeVersionSubuserCount','getVipInfo','all','deleteFavoriteByUid','usernameReg','findByUsername','length','searchKey','headers','/logout','DELETE\x20FROM\x20movie_keys','996sAGHyX','state','337359jrIYjY','updateQuestionById','/resetPwd','post','findByTitleArr','banTime','error','createUserFolder','username','sep','306RaOYOI','6277640VViNID','pageSize','account.subAccountMax','decodeBase64','isIncludeChinese','You\x20can\x27t\x20delete\x20admin\x20account','json','operationFail','isAdmin','DELETE\x20FROM\x20file_record','DELETE\x20FROM\x20file_operation_record','../utils/fileUtils','/checkIsNasServer','updateByUsername','DELETE\x20FROM\x20file_index_book','banTimeStamp','\x20end_timestamp\x20is\x20not\x20null\x20and\x20end_timestamp<','\x20order\x20by\x20id\x20desc\x20limit\x20?\x20offset\x20?','getClientIp','is_admin','DELETE\x20FROM\x20login_record','DELETE\x20FROM\x20share_temp','dbFileIndex','deleteUserTokenByWhere','FTP','newPassword','/setUserMenu','/cancelUserPathPower','express','DELETE\x20FROM\x20user','apiPortHttps','asc','DELETE\x20FROM\x20album_ordinary','getTime','/setUserPower','\x20type=?','findByTitle','globalIpList','updateById','/login','DELETE\x20FROM\x20music_playlist_index','\x20order\x20by\x20id\x20desc\x20limit\x20','orderField','\x201=1','Error','getAllIpListByWhere','72Yxrwfj','checkAnswer','security.thisIpCannotAddList','removeUserPlayList','../../../package.json','DELETE\x20FROM\x20book_list_index','version','end','publicUserName','testCount','updateRemarkByUsername','/changePassword','token','getUserPower','createToken','2256Nldful','getIpListCountByWhere','DELETE\x20FROM\x20user_token','parse','dbOther','SELECT\x20id,username,is_admin,user_remark\x20FROM\x20user\x20','get','value','status','1382qaFcZi','1121560pEUXWh','login.wrongNameOrPwd','NodeNasServer','push','path.parentPathExist','cancelUserPathPower','sub_account_num','login','enable','../utils/checkUtil','DELETE\x20FROM\x20backup_task_record','menus','deleteIp','answerQuestionCannotBeSame','/getUserPower','exports','/removeIp','prepare','DELETE\x20FROM\x20book_list','/resetSystem','username\x20error','login.sameUsernameExist','hostname','DELETE\x20FROM\x20music_playlist','18802120nQbdif','232680OzoWEr','DELETE\x20FROM\x20ai_classes','join','find','\x20WHERE\x20token\x20=?','../../myConfig/config','\x20offset\x20','catch','cacheParentPath','ignoreIp','DELETE\x20FROM\x20file_index_photo','orderType','DELETE\x20FROM\x20notice_center','newUserParamsNull','DELETE\x20FROM\x20photo_phash_similar','getAdmin','splice','/hasAdmin','desc','newQuestion','stat','../utils/cryptoUtils','create','\x20type=\x27','run','fileShareRestart','login.loginFailAlert','login.pwdErrCountTooMuch','oldPassword','DELETE\x20FROM\x20photo_faces2index','getUserCount','DELETE\x20FROM\x20file_index_music','DELETE\x20FROM\x20private_space','encryptString','currentUser','/getAllUser','localhost','^[0-9a-zA-Z]*$','then','DELETE\x20FROM\x20ai_classes2index','answerNotSeqNumOrChar','sha256','DELETE\x20FROM\x20config','addLoginRecord','err','question','body','returnErrMsg','login.adminAdded','menuList','login.answerIsWrong','dialog','exist','deleteIpByWhere','DELETE\x20FROM\x20user_power','DELETE\x20FROM\x20private_space_token','DELETE\x20FROM\x20movie_library','deletePowerByUsername','DELETE\x20FROM\x20config\x20where\x20title\x20in\x20(\x27nasAccountInfo\x27)','(\x27customLogoImage\x27,\x27customLoginTitle\x27,\x27customLoginImage\x27,\x27customHomeBgImage\x27)','apiPort','client','test','getUserByUserName','answer','changes','127.0.0.1','\x20ORDER\x20BY\x20','DELETE\x20FROM\x20bg_task','ipv6','\x20WHERE\x20username\x20like\x20?\x20or\x20user_remark\x20like\x20?','send','../../db/dbMovieFavorite','delete','count','DELETE\x20FROM\x20file_index_movie','/resetPwdInfo','app','ipList','2374088PSXAcC','DELETE\x20FROM\x20play_record','user-agent','Router','addIpToList','deleteRecordByWhere','password','add','Need\x20token','passwordKey','usernameTooEasy','refreshIpList','type','path','login.oldPwdErr','remark','DELETE\x20FROM\x20book_favorite','/registAdmin','includes','page','DELETE\x20FROM\x20album','black','params\x20error','query','DELETE\x20FROM\x20photo_faces','apiServerHttps','stringify','log','isEasyUsername','getAllRecordByWhere','httpsIsRunning'];_0x3cdb=function(){return _0x580c63;};return _0x3cdb();}router['post'](_0x252e17(0x1d2),(_0x4d8f0b,_0x3e8386,_0x184a33)=>{const _0x10cbbc=_0x252e17;let _0x28653e=dbUserTable[_0x10cbbc(0x1d0)](_0x4d8f0b[_0x10cbbc(0x127)][_0x10cbbc(0x1a2)]),_0x211150=dbConfigTable[_0x10cbbc(0x15a)](_0x4d8f0b['app']['dbOther'],_0x10cbbc(0x115));_0x3e8386[_0x10cbbc(0x167)]({'code':0x0,'hasAdmin':_0x28653e?'1':'0','customConfig':_0x211150,'hostName':OS[_0x10cbbc(0x1be)]()});});let banIpList=[];router[_0x252e17(0x159)](_0x252e17(0x188),(_0x48d508,_0x518600,_0x3624b5)=>{const _0x33e779=_0x252e17;let _0x3aa033=_0x48d508[_0x33e779(0x108)][_0x33e779(0x15e)],_0x302125=_0x48d508[_0x33e779(0x108)]['password'];if(!_0x3aa033||!_0x302125)return _0x518600['status'](0x194)['end']();_0x302125=fileUtil[_0x33e779(0x164)](_0x302125);let _0x2a517f=netUtils[_0x33e779(0x173)](_0x48d508),_0x2d4758=![],_0x3ca309=0x1,_0x5efa03=0x1;if(_0x2a517f!=_0x33e779(0xfe)){let _0x2ff176=dbConfigTable['findByTitle'](_0x48d508[_0x33e779(0x127)][_0x33e779(0x1a2)],'ipBan');_0x2ff176&&(_0x2ff176=JSON['parse'](_0x2ff176[_0x33e779(0x1a5)]),_0x2ff176&&(_0x2ff176[_0x33e779(0x1b0)]&&(_0x2d4758=!![]),_0x3ca309=_0x2ff176[_0x33e779(0x198)],_0x5efa03=_0x2ff176[_0x33e779(0x15b)]));}cryptoUtils[_0x33e779(0xfb)](config[_0x33e779(0x132)],_0x302125)[_0x33e779(0x100)](_0x46957a=>{const _0x352b23=_0x33e779;let _0x1478c4=dbUserTable[_0x352b23(0x1af)](_0x48d508[_0x352b23(0x127)][_0x352b23(0x1a2)],_0x3aa033,_0x46957a);if(_0x1478c4){function _0x3345e0(){const _0xbf30b6=_0x352b23;if(_0x2a517f!='localhost'){let _0x24fc60=dbConfigTable['findByTitle'](_0x48d508[_0xbf30b6(0x127)][_0xbf30b6(0x1a2)],'twoStepLogin');if(_0x24fc60&&_0x24fc60[_0xbf30b6(0x1a5)]=='1'){let _0x436523=_0x48d508['body'][_0xbf30b6(0x11a)];if(_0x436523){_0x436523=sha256(_0x436523);let _0x50d1fa=dbUserTable[_0xbf30b6(0x190)](_0x48d508[_0xbf30b6(0x127)][_0xbf30b6(0x1a2)],_0x3aa033,_0x436523);if(!_0x50d1fa)return _0x48d508[_0xbf30b6(0x127)][_0xbf30b6(0x109)](_0x518600,_0x518600['__'](_0xbf30b6(0x10c)));}else return _0x518600['json']({'code':0x2,'question':_0x1478c4[_0xbf30b6(0x107)]});}}dbLoginTable[_0xbf30b6(0x105)](_0x48d508[_0xbf30b6(0x127)][_0xbf30b6(0x1a2)],'login',_0x3aa033,_0x2a517f,_0x48d508['body'][_0xbf30b6(0x117)],_0x48d508[_0xbf30b6(0x151)][_0xbf30b6(0x12b)]);let _0x52bf85=sha256(new Date()[_0xbf30b6(0x182)]()+_0x3aa033+_0x46957a);var _0x150a72=_0x48d508[_0xbf30b6(0x151)][_0xbf30b6(0x12b)];return dbUserTable[_0xbf30b6(0x19d)](_0x48d508[_0xbf30b6(0x127)][_0xbf30b6(0x1a2)],_0x1478c4['id'],_0x52bf85,_0x2a517f,_0x150a72),_0x1478c4['password']='',_0x1478c4[_0xbf30b6(0x11a)]='',_0x518600[_0xbf30b6(0x167)]({'code':0x0,'token':_0x52bf85,'user':_0x1478c4,'version':package[_0xbf30b6(0x195)],'reqIp':_0x2a517f});}if(_0x1478c4[_0x352b23(0x174)]!=0x1)nasAccountUtil[_0x352b23(0x14a)](_0x48d508[_0x352b23(0x127)][_0x352b23(0x1a2)])[_0x352b23(0x100)](_0x1a831d=>{const _0x5739a2=_0x352b23;let _0x182432=dbUserTable[_0x5739a2(0xf8)](_0x48d508[_0x5739a2(0x127)][_0x5739a2(0x1a2)]);if(!_0x1a831d){if(_0x182432>parseInt(config[_0x5739a2(0x149)])+0x1)return _0x48d508[_0x5739a2(0x127)]['returnErrMsg'](_0x518600,_0x518600['__'](_0x5739a2(0x163)));return _0x3345e0();}else return _0x1a831d[_0x5739a2(0x135)]<0x2&&_0x1a831d[_0x5739a2(0x1ae)]&&_0x182432>parseInt(_0x1a831d[_0x5739a2(0x1ae)])+0x1?_0x48d508[_0x5739a2(0x127)]['returnErrMsg'](_0x518600,_0x518600['__']('account.subAccountMax')):_0x3345e0();});else return _0x3345e0();}else{if(_0x2d4758){let _0x2a67b6=null;for(let _0x13aa3f in banIpList){banIpList[_0x13aa3f]['ip']==_0x2a517f&&(_0x2a67b6=banIpList[_0x13aa3f],banIpList[_0x13aa3f]['testCount']+=0x1);}!_0x2a67b6&&(_0x2a67b6={'ip':_0x2a517f,'testCount':0x1},banIpList[_0x352b23(0x1ab)](_0x2a67b6));if(_0x2a67b6[_0x352b23(0x198)]>=_0x3ca309){let _0x61e085=new Date()[_0x352b23(0x182)](),_0x293da0=_0x61e085+_0x5efa03*0x3c*0x3e8;dbLoginTable[_0x352b23(0x12d)](_0x48d508[_0x352b23(0x127)][_0x352b23(0x1a2)],_0x352b23(0x13e),_0x2a517f,_0x293da0,_0x518600['__'](_0x352b23(0xf5))),_0x48d508[_0x352b23(0x127)][_0x352b23(0x134)](),dbNoticeCenterTable[_0x352b23(0x1d7)](_0x48d508['app'][_0x352b23(0x1a2)],{'title':_0x518600['__'](_0x352b23(0x1db)),'level':_0x352b23(0x15c),'content':_0x518600['__']('login.tooManyPwdTestIpBan')+('['+_0x2a517f+']')});for(let _0x220e3f in banIpList){banIpList[_0x220e3f]['ip']==_0x2a517f&&banIpList[_0x352b23(0x1d1)](_0x220e3f,0x1);}}}return dbLoginTable[_0x352b23(0x105)](_0x48d508[_0x352b23(0x127)][_0x352b23(0x1a2)],_0x518600['__'](_0x352b23(0x1a9)),_0x3aa033,_0x2a517f,_0x48d508[_0x352b23(0x108)][_0x352b23(0x117)],_0x48d508[_0x352b23(0x151)][_0x352b23(0x12b)]),_0x48d508[_0x352b23(0x127)][_0x352b23(0x109)](_0x518600,_0x518600['__'](_0x352b23(0x1a9)));}})[_0x33e779(0x1c8)](_0x1dc850=>{const _0x410571=_0x33e779;return console[_0x410571(0x144)](_0x1dc850),_0x48d508['app']['returnErrMsg'](_0x518600,_0x518600['__']('operationFail'));});}),router[_0x252e17(0x159)]('/tokenLogin',(_0x5d4477,_0x261ce7,_0x123e4e)=>{const _0x2a89a3=_0x252e17;let _0x1ab51a=netUtils['getClientIp'](_0x5d4477),_0x37cea0=_0x5d4477[_0x2a89a3(0x108)][_0x2a89a3(0x19b)];if(!_0x37cea0)return _0x5d4477[_0x2a89a3(0x127)][_0x2a89a3(0x109)](_0x261ce7,_0x2a89a3(0x131));let _0x45b8fc=dbUserTable['getUserByToken'](_0x5d4477['app'][_0x2a89a3(0x1a2)],_0x37cea0);if(!_0x45b8fc)return _0x5d4477[_0x2a89a3(0x127)][_0x2a89a3(0x109)](_0x261ce7,_0x261ce7['__']('TokenExpired'));return _0x45b8fc['password']='',_0x45b8fc['answer']='',_0x261ce7[_0x2a89a3(0x167)]({'code':0x0,'token':_0x37cea0,'user':_0x45b8fc,'reqIp':_0x1ab51a});}),router[_0x252e17(0x159)](_0x252e17(0x1bb),(_0x144030,_0x632491,_0x7b94c)=>{const _0xe6ecc=_0x252e17;let _0x11370b=_0x144030[_0xe6ecc(0x108)][_0xe6ecc(0x12f)];if(_0x144030[_0xe6ecc(0xfc)]&&_0x144030['currentUser']['is_admin']!=0x1)return _0x632491['json']({'code':0x66});cryptoUtils[_0xe6ecc(0xfb)](config['passwordKey'],_0x11370b)[_0xe6ecc(0x100)](_0x1dae5a=>{const _0x10c98c=_0xe6ecc;if(_0x144030[_0x10c98c(0xfc)][_0x10c98c(0x12f)]!=_0x1dae5a)return _0x632491[_0x10c98c(0x167)]({'code':0x1,'message':_0x632491['__']('login.pwdErr')});fs['rm'](path[_0x10c98c(0x1c3)](config[_0x10c98c(0x1c9)]),{'recursive':!![]},_0x210523=>{const _0xa2e10e=_0x10c98c;if(_0x210523)return _0x632491[_0xa2e10e(0x167)]({'code':0x1,'message':_0xa2e10e(0x18d)});return _0x144030[_0xa2e10e(0x127)]['dbOther'][_0xa2e10e(0x1b9)](_0xa2e10e(0x104))[_0xa2e10e(0x1d9)](),_0x144030['app'][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x13d))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20backup_task')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20backup_task_msg')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)]['prepare'](_0xa2e10e(0x1b2))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbOther'][_0xa2e10e(0x1b9)](_0xa2e10e(0x11e))[_0xa2e10e(0x1d9)](),_0x144030['app'][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x114))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x16b))['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)]['prepare'](_0xa2e10e(0x16a))[_0xa2e10e(0x1d9)](),_0x144030['app']['dbOther'][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20file_share')['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20file_share_user')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20login_ip_list')['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x175))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x1cd))['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x12a))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0xfa))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)]['prepare'](_0xa2e10e(0x111))['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)]['prepare'](_0xa2e10e(0x176))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20source_folder')[_0xa2e10e(0x1d9)](),_0x144030['app']['dbOther']['prepare'](_0xa2e10e(0x17e))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbOther'][_0xa2e10e(0x1b9)](_0xa2e10e(0x1a0))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x1a2)][_0xa2e10e(0x1b9)](_0xa2e10e(0x110))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x1c2))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex']['prepare'](_0xa2e10e(0x101))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex'][_0xa2e10e(0x1b9)](_0xa2e10e(0x181))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20album_ordinary_index')['run'](),_0x144030['app'][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x125))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x1cb))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0xf9))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x16f))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)]['prepare'](_0xa2e10e(0x141))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex'][_0xa2e10e(0x1b9)](_0xa2e10e(0xf7))['run'](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex'][_0xa2e10e(0x1b9)](_0xa2e10e(0x153))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20movie_collection')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20movie_history')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex']['prepare'](_0xa2e10e(0x112))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex']['prepare'](_0xa2e10e(0x1cf))['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)]('DELETE\x20FROM\x20music_favorite')[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)]['prepare'](_0xa2e10e(0x1bf))['run'](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x189))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)]['dbFileIndex'][_0xa2e10e(0x1b9)](_0xa2e10e(0x139))[_0xa2e10e(0x1d9)](),_0x144030['app'][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x1ba))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)][_0xa2e10e(0x1b9)](_0xa2e10e(0x194))[_0xa2e10e(0x1d9)](),_0x144030[_0xa2e10e(0x127)][_0xa2e10e(0x177)]['prepare']('DELETE\x20FROM\x20book_read_record')[_0xa2e10e(0x1d9)](),process[_0xa2e10e(0x121)]({'type':_0xa2e10e(0x1da),'shareType':_0xa2e10e(0x179)}),process[_0xa2e10e(0x121)]({'type':_0xa2e10e(0x1da),'shareType':'WebDav'}),process[_0xa2e10e(0x121)]({'type':'nasProxyRestart'}),process[_0xa2e10e(0x121)]({'type':_0xa2e10e(0x15d)}),_0x632491['json']({'code':0x0});});});}),router[_0x252e17(0x159)](_0x252e17(0x126),(_0x1510d3,_0x86e0a2,_0x49f2b7)=>{const _0x1d5bdb=_0x252e17;let _0xaaebb9=netUtils[_0x1d5bdb(0x173)](_0x1510d3),_0x1a6fa9=dbUserTable['getAdmin'](_0x1510d3['app']['dbOther']),_0x4e9bec={};_0xaaebb9==_0x1d5bdb(0xfe)&&(_0x4e9bec['username']=_0x1a6fa9[_0x1d5bdb(0x15e)]),_0x4e9bec[_0x1d5bdb(0x107)]=_0x1a6fa9[_0x1d5bdb(0x107)],_0x86e0a2[_0x1d5bdb(0x167)]({'code':0x0,'data':_0x4e9bec});}),router[_0x252e17(0x14b)](_0x252e17(0x16d),(_0x444064,_0x5d49c4,_0x278a74)=>{const _0x146d6e=_0x252e17;let _0x3b4c56={'code':0x0,'message':_0x146d6e(0x1aa),'version':package[_0x146d6e(0x195)],'hostName':OS[_0x146d6e(0x1be)]()},_0x179ac3=_0x444064[_0x146d6e(0x140)][_0x146d6e(0x1ca)];if(_0x179ac3&&_0x179ac3==0x1)return _0x5d49c4[_0x146d6e(0x167)](_0x3b4c56);let _0x4983ee=0x50,_0x53f120=dbConfigTable['findByTitle'](_0x444064[_0x146d6e(0x127)]['dbOther'],_0x146d6e(0x116));_0x53f120&&_0x53f120['value']&&(_0x4983ee=_0x53f120[_0x146d6e(0x1a5)]);let _0x405a38=0x1bb,_0x5f2757=dbConfigTable[_0x146d6e(0x185)](_0x444064[_0x146d6e(0x127)][_0x146d6e(0x1a2)],_0x146d6e(0x17f));_0x5f2757&&_0x5f2757[_0x146d6e(0x1a5)]&&_0x5f2757['value']>0x0&&_0x5f2757[_0x146d6e(0x1a5)]<0xffff&&(_0x405a38=_0x5f2757[_0x146d6e(0x1a5)]);let _0x339221=0x0,_0x5ebaf1=dbConfigTable[_0x146d6e(0x185)](_0x444064['app'][_0x146d6e(0x1a2)],_0x146d6e(0x142));if(_0x5ebaf1&&_0x5ebaf1[_0x146d6e(0x1a5)])try{_0x5ebaf1=JSON[_0x146d6e(0x1a1)](_0x5ebaf1[_0x146d6e(0x1a5)]),_0x5ebaf1[_0x146d6e(0x155)]==_0x146d6e(0x1d9)&&(_0x339221=0x1);}catch(_0x59e475){}try{let _0x596a36=dbConfigTable['findByTitle'](_0x444064[_0x146d6e(0x127)][_0x146d6e(0x1a2)],_0x146d6e(0x186)),_0x3937df=dbConfigTable[_0x146d6e(0x185)](_0x444064['app'][_0x146d6e(0x1a2)],'ddnsIpv6Address');if(_0x596a36){_0x596a36=JSON[_0x146d6e(0x1a1)](_0x596a36[_0x146d6e(0x1a5)]);let _0x65ba4e=[];if(_0x3937df&&_0x3937df['value']){for(let _0xf92a7b in _0x596a36){let _0x33949e=_0x596a36[_0xf92a7b];_0x33949e['type']=='ipv4'&&_0x65ba4e[_0x146d6e(0x1ab)](_0x33949e);}_0x65ba4e[_0x146d6e(0x1ab)]({'type':_0x146d6e(0x11f),'ip':_0x3937df[_0x146d6e(0x1a5)],'ddns':0x1}),_0x596a36=_0x65ba4e;}}return _0x3b4c56[_0x146d6e(0x128)]=_0x596a36,_0x3b4c56['apiPort']=parseInt(_0x4983ee),_0x3b4c56[_0x146d6e(0x17f)]=parseInt(_0x405a38),_0x3b4c56[_0x146d6e(0x147)]=_0x339221,_0x5d49c4[_0x146d6e(0x167)](_0x3b4c56);}catch(_0x3e4462){return _0x5d49c4[_0x146d6e(0x167)](_0x3b4c56);}}),router['post'](_0x252e17(0x158),(_0x2748ad,_0x3565ca,_0x38b29f)=>{const _0xff0008=_0x252e17;let _0x3717f4=_0x2748ad[_0xff0008(0x108)][_0xff0008(0x15e)],_0xa0eec8=_0x2748ad[_0xff0008(0x108)][_0xff0008(0x12f)],_0x4a307d=_0x2748ad[_0xff0008(0x108)]['answer'],_0x217129=_0x2748ad['app'][_0xff0008(0x1a2)][_0xff0008(0x1b9)]('SELECT\x20*\x20FROM\x20user\x20WHERE\x20username=?')[_0xff0008(0x1a4)](_0x3717f4);if(!_0x217129)return _0x2748ad[_0xff0008(0x127)][_0xff0008(0x109)](_0x3565ca,_0x3565ca['__']('userNotExist'));try{_0x4a307d=sha256(_0x4a307d);let _0x1ad28b=dbUserTable[_0xff0008(0x190)](_0x2748ad[_0xff0008(0x127)]['dbOther'],_0x3717f4,_0x4a307d);if(_0x1ad28b)cryptoUtils['encryptString'](config[_0xff0008(0x132)],_0xa0eec8)[_0xff0008(0x100)](_0x145428=>{const _0x30a56b=_0xff0008;dbUserTable[_0x30a56b(0x16e)](_0x2748ad[_0x30a56b(0x127)][_0x30a56b(0x1a2)],_0x3717f4,_0x30a56b(0x12f),_0x145428);let _0x155260=sha256(new Date()[_0x30a56b(0x182)]()+_0x3717f4+_0xa0eec8);dbUserTable[_0x30a56b(0x16e)](_0x2748ad['app'][_0x30a56b(0x1a2)],_0x3717f4,'token',_0x155260),_0x3565ca[_0x30a56b(0x167)]({'code':0x0});})[_0xff0008(0x1c8)](_0x518880=>{const _0x49943a=_0xff0008;return console[_0x49943a(0x144)](_0x49943a(0x15c),_0x518880),_0x2748ad[_0x49943a(0x127)][_0x49943a(0x109)](_0x3565ca,_0x3565ca['__']('operationFail'));});else return _0x2748ad['app'][_0xff0008(0x109)](_0x3565ca,_0x3565ca['__'](_0xff0008(0x10c)));}catch(_0xc57848){return console[_0xff0008(0x144)](_0xff0008(0x106),_0xc57848),_0x3565ca[_0xff0008(0x1a6)](0x194)[_0xff0008(0x196)]();}});function newUserCheck(_0x5f2bcd,_0x963ed7,_0x35f097,_0x174891,_0x21ec2c,_0x2f6018){const _0x49b867=_0x252e17;if(!_0x174891||!_0x35f097||!_0x5f2bcd||!_0x963ed7)return _0x21ec2c['app']['returnErrMsg'](_0x2f6018,_0x2f6018['__'](_0x49b867(0x1ce)));let _0x56abb0=new RegExp(_0x49b867(0xff));if(!_0x56abb0[_0x49b867(0x118)](_0x5f2bcd)||_0x5f2bcd==config[_0x49b867(0x197)])return _0x21ec2c[_0x49b867(0x127)]['returnErrMsg'](_0x2f6018,_0x2f6018['__'](_0x49b867(0x14d)));if(_0x5f2bcd==_0x963ed7)return _0x21ec2c[_0x49b867(0x127)]['returnErrMsg'](_0x2f6018,_0x2f6018['__']('usernameAndPwdCannotBeSame'));if(checkUtil[_0x49b867(0x145)](_0x5f2bcd))return _0x21ec2c[_0x49b867(0x127)][_0x49b867(0x109)](_0x2f6018,_0x2f6018['__'](_0x49b867(0x133)));if(_0x35f097==_0x174891)return _0x21ec2c[_0x49b867(0x127)][_0x49b867(0x109)](_0x2f6018,_0x2f6018['__'](_0x49b867(0x1b5)));if(checkUtil[_0x49b867(0x165)](_0x963ed7))return _0x21ec2c[_0x49b867(0x127)][_0x49b867(0x109)](_0x2f6018,_0x2f6018['__']('pwdCannotBeChinese'));return!![];}function _0x24d4(_0x134de8,_0x50e362){const _0x3cdbc0=_0x3cdb();return _0x24d4=function(_0x24d4ff,_0x8eb37b){_0x24d4ff=_0x24d4ff-0xf5;let _0xfb78dc=_0x3cdbc0[_0x24d4ff];return _0xfb78dc;},_0x24d4(_0x134de8,_0x50e362);}router[_0x252e17(0x159)](_0x252e17(0x13a),(_0xe7c3b,_0x13f968,_0x37a95a)=>{const _0x38011f=_0x252e17;let _0x1c61ec=_0xe7c3b[_0x38011f(0x108)]['username'],_0x820f7e=_0xe7c3b[_0x38011f(0x108)][_0x38011f(0x12f)],_0x302312=_0xe7c3b[_0x38011f(0x108)]['question'],_0x3e5ad4=_0xe7c3b[_0x38011f(0x108)][_0x38011f(0x11a)];if(!_0x3e5ad4||!_0x302312||!_0x1c61ec||!_0x820f7e)return _0x13f968['json']({'code':0x1,'message':_0x38011f(0x13f)});let _0x817922=dbUserTable['getAdmin'](_0xe7c3b[_0x38011f(0x127)]['dbOther']);if(_0x817922)_0x13f968[_0x38011f(0x167)]({'code':0x1,'message':_0x13f968['__']('login.adminExist')});else{if(newUserCheck(_0x1c61ec,_0x820f7e,_0x302312,_0x3e5ad4,_0xe7c3b,_0x13f968)!==!![])return;_0x3e5ad4=sha256(_0x3e5ad4),cryptoUtils[_0x38011f(0xfb)](config[_0x38011f(0x132)],_0x820f7e)[_0x38011f(0x100)](_0x205c0b=>{const _0x100453=_0x38011f;let _0x50dd98=dbUserTable[_0x100453(0x1d7)](_0xe7c3b[_0x100453(0x127)]['dbOther'],{'username':_0x1c61ec,'password':_0x205c0b,'question':_0x302312,'answer':_0x3e5ad4,'is_admin':0x1});if(_0x50dd98[_0x100453(0x11b)]>0x0){let _0x4f83b2=dbUserTable['getAdmin'](_0xe7c3b[_0x100453(0x127)]['dbOther']),_0x1754f6=sha256(new Date()[_0x100453(0x182)]()+_0x1c61ec+_0x205c0b),_0x448528=netUtils[_0x100453(0x173)](_0xe7c3b);var _0x198c9a=_0xe7c3b[_0x100453(0x151)]['user-agent'];return dbUserTable[_0x100453(0x19d)](_0xe7c3b[_0x100453(0x127)][_0x100453(0x1a2)],_0x4f83b2['id'],_0x1754f6,_0x448528,_0x198c9a),_0x4f83b2[_0x100453(0x12f)]='',_0x13f968['json']({'code':0x0,'token':_0x1754f6,'user':_0x4f83b2});}})[_0x38011f(0x1c8)](_0x17ad6f=>{const _0x4462d9=_0x38011f;return console['log'](_0x4462d9(0x15c),_0x17ad6f),_0xe7c3b[_0x4462d9(0x127)][_0x4462d9(0x109)](_0x13f968,_0x13f968['__']('operationFail'));});}}),router['post']('/remarkUser',(_0x387e42,_0x2c743f,_0x25c4e8)=>{const _0x179a34=_0x252e17;if(_0x387e42[_0x179a34(0xfc)][_0x179a34(0x174)]!=0x1)return _0x2c743f[_0x179a34(0x167)]({'code':0x66});let _0x894c04=_0x387e42[_0x179a34(0x108)][_0x179a34(0x15e)],_0x1aa7c7=_0x387e42[_0x179a34(0x108)][_0x179a34(0x138)];return _0x894c04&&_0x1aa7c7&&dbUserTable[_0x179a34(0x199)](_0x387e42[_0x179a34(0x127)][_0x179a34(0x1a2)],_0x894c04,_0x1aa7c7),_0x2c743f[_0x179a34(0x167)]({'code':0x0});}),router[_0x252e17(0x159)]('/addUser',(_0x1f5458,_0x496a92,_0x3abddf)=>{const _0x1afbf9=_0x252e17;nasAccountUtil[_0x1afbf9(0x14a)](_0x1f5458[_0x1afbf9(0x127)][_0x1afbf9(0x1a2)])[_0x1afbf9(0x100)](_0x32f53c=>{const _0x438379=_0x1afbf9;let _0x5244c4=dbUserTable[_0x438379(0xf8)](_0x1f5458[_0x438379(0x127)][_0x438379(0x1a2)]);if(!_0x32f53c){if(_0x5244c4>=parseInt(config['freeVersionSubuserCount'])+0x1){let _0x167d11=dbUserTable[_0x438379(0x119)](_0x1f5458[_0x438379(0x127)][_0x438379(0x1a2)],_0x1f5458['body'][_0x438379(0x15e)]);if(!_0x167d11)return _0x1f5458[_0x438379(0x127)]['returnErrMsg'](_0x496a92,_0x496a92['__'](_0x438379(0x163)));}_0xf5d0d5();}else{if(_0x32f53c[_0x438379(0x135)]<0x2&&_0x32f53c[_0x438379(0x1ae)]&&_0x5244c4>=parseInt(_0x32f53c[_0x438379(0x1ae)])+0x1)return _0x1f5458['app'][_0x438379(0x109)](_0x496a92,_0x496a92['__'](_0x438379(0x163)));else _0xf5d0d5();}function _0xf5d0d5(){const _0x2800ea=_0x438379;let _0x291eec=_0x1f5458[_0x2800ea(0x108)][_0x2800ea(0x15e)],_0x3c1e40=_0x1f5458[_0x2800ea(0x108)][_0x2800ea(0x12f)],_0x176f0d=_0x1f5458[_0x2800ea(0x108)]['question'],_0x528f74=_0x1f5458[_0x2800ea(0x108)][_0x2800ea(0x11a)],_0x4621ac=_0x1f5458[_0x2800ea(0x108)][_0x2800ea(0x138)];if(newUserCheck(_0x291eec,_0x3c1e40,_0x176f0d,_0x528f74,_0x1f5458,_0x496a92)!==!![])return;let _0x1e006d=_0x1f5458['body'][_0x2800ea(0x135)];if(dbUserTable['isAdmin'](_0x1f5458,_0x496a92)===!![]){if(_0x1e006d==_0x2800ea(0x130)){let _0x4fc3ea=dbUserTable[_0x2800ea(0x14e)](_0x1f5458['app']['dbOther'],_0x291eec);if(_0x4fc3ea)return _0x1f5458[_0x2800ea(0x127)][_0x2800ea(0x109)](_0x496a92,_0x496a92['__'](_0x2800ea(0x1bd)));}cryptoUtils[_0x2800ea(0xfb)](config[_0x2800ea(0x132)],_0x3c1e40)['then'](_0x476408=>{const _0x5c2779=_0x2800ea;let _0x293952=dbUserTable[_0x5c2779(0x1d7)](_0x1f5458['app'][_0x5c2779(0x1a2)],{'username':_0x291eec,'password':_0x476408,'question':_0x176f0d,'answer':sha256(_0x528f74),'remark':_0x4621ac});return _0x293952[_0x5c2779(0x11b)]>=0x1?_0x496a92['json']({'code':0x0}):_0x1f5458[_0x5c2779(0x127)][_0x5c2779(0x109)](_0x496a92,_0x496a92['__'](_0x5c2779(0x168)));})[_0x2800ea(0x1c8)](_0x47c944=>{const _0x412a38=_0x2800ea;return console[_0x412a38(0x144)](_0x412a38(0x15c),_0x47c944),_0x1f5458[_0x412a38(0x127)][_0x412a38(0x109)](_0x496a92,_0x496a92['__'](_0x412a38(0x168)));});}}});}),router['post']('/removeUser',(_0x425d76,_0x2a3217,_0x3c336e)=>{const _0x461540=_0x252e17;let _0x233124=_0x425d76[_0x461540(0x108)]['uid'];if(dbUserTable['isAdmin'](_0x425d76,_0x2a3217)===!![]){let _0x397c55=dbUserTable[_0x461540(0x1c4)](_0x425d76[_0x461540(0x127)][_0x461540(0x1a2)],_0x233124);if(_0x397c55&&_0x397c55[_0x461540(0x174)]==0x1)return _0x2a3217[_0x461540(0x167)]({'code':0x1,'message':_0x461540(0x166)});dbUserTable[_0x461540(0x113)](_0x425d76['app'][_0x461540(0x1a2)],_0x397c55[_0x461540(0x15e)]),dbMusicIndexTable[_0x461540(0x192)](_0x425d76['app']['dbFileIndex'],_0x397c55['id']),dbMusicFavorite[_0x461540(0x14c)](_0x425d76[_0x461540(0x127)][_0x461540(0x177)],_0x397c55['id']),dbMovieFavorite['deleteFavoriteByUid'](_0x425d76[_0x461540(0x127)]['dbFileIndex'],_0x397c55['id']);let _0x219d88=dbUserTable[_0x461540(0x123)](_0x425d76[_0x461540(0x127)][_0x461540(0x1a2)],_0x233124);return _0x219d88[_0x461540(0x11b)]>=0x1?_0x2a3217['json']({'code':0x0}):_0x425d76['app'][_0x461540(0x109)](_0x2a3217,_0x2a3217['__'](_0x461540(0x168)));}}),router[_0x252e17(0x159)](_0x252e17(0xfd),(_0x3257e9,_0x51ae39,_0x55bcee)=>{const _0x229519=_0x252e17;if(dbUserTable[_0x229519(0x169)](_0x3257e9,_0x51ae39)===!![]){let _0x5f1332=_0x3257e9[_0x229519(0x108)][_0x229519(0x18b)]||'id',_0x2e55c1=_0x3257e9[_0x229519(0x108)][_0x229519(0x1cc)]||_0x229519(0x180),_0x4db54a=_0x3257e9['body'][_0x229519(0x150)];(!['id',_0x229519(0x15e),'user_remark'][_0x229519(0x13b)](_0x5f1332)||![_0x229519(0x180),_0x229519(0x1d3)]['includes'](_0x2e55c1))&&(_0x5f1332='id',_0x2e55c1=_0x229519(0x180));let _0x494897=_0x229519(0x1a3),_0x3bfc30=[];_0x4db54a&&(_0x494897+=_0x229519(0x120),_0x3bfc30['push']('%'+_0x4db54a+'%','%'+_0x4db54a+'%'));_0x494897+=_0x229519(0x11d)+_0x5f1332+'\x20'+_0x2e55c1;let _0xd5f820=_0x3257e9[_0x229519(0x127)][_0x229519(0x1a2)][_0x229519(0x1b9)](_0x494897)[_0x229519(0x14b)](_0x3bfc30);return _0x51ae39[_0x229519(0x167)]({'code':0x0,'userList':_0xd5f820});}}),router['post'](_0x252e17(0x1b6),(_0xb20746,_0x52cb88,_0xab15c3)=>{const _0x5225b5=_0x252e17;let _0x3993b6=_0xb20746['body'][_0x5225b5(0x15e)],_0x2482aa=null;if(_0x3993b6!=config['publicUserName']){_0x2482aa=dbUserTable[_0x5225b5(0x119)](_0xb20746['app']['dbOther'],_0x3993b6);if(!_0x2482aa)return _0xb20746[_0x5225b5(0x127)][_0x5225b5(0x109)](_0x52cb88,_0x5225b5(0x1bc));}if(dbUserTable[_0x5225b5(0x169)](_0xb20746,_0x52cb88)===!![]||_0x3993b6==_0xb20746[_0x5225b5(0xfc)][_0x5225b5(0x15e)]){let _0x104065=dbUserTable[_0x5225b5(0x19c)](_0xb20746[_0x5225b5(0x127)][_0x5225b5(0x1a2)],_0x3993b6,null,null,!![]),_0x42cafd=0x0;if(_0x104065[_0x5225b5(0x14f)]<0x1)return _0x52cb88[_0x5225b5(0x167)]({'code':0x0,'userPower':_0x104065,'userMenu':_0x2482aa?_0x2482aa[_0x5225b5(0x1b3)]:[]});for(let _0x31600f=0x0;_0x31600f<_0x104065['length'];_0x31600f++){let _0x21263c=_0x104065[_0x31600f]['path'];fs[_0x5225b5(0x1d5)](_0x21263c,(_0x3d24ab,_0x527870)=>{const _0x47c91b=_0x5225b5;_0x42cafd+=0x1;_0x3d24ab?_0x104065[_0x31600f][_0x47c91b(0x10e)]=0x0:_0x104065[_0x31600f][_0x47c91b(0x10e)]=0x1;if(_0x42cafd==_0x104065[_0x47c91b(0x14f)])return _0x52cb88['json']({'code':0x0,'userPower':_0x104065,'userMenu':_0x2482aa?_0x2482aa[_0x47c91b(0x1b3)]:[]});});}}}),router[_0x252e17(0x159)](_0x252e17(0x183),(_0x3bcf9c,_0x476b8b,_0x175520)=>{const _0x584f2c=_0x252e17;let _0x280cde=_0x3bcf9c[_0x584f2c(0x108)][_0x584f2c(0x15e)],_0x35b413=_0x3bcf9c[_0x584f2c(0x108)][_0x584f2c(0x136)],_0x354b07=_0x3bcf9c[_0x584f2c(0x108)]['server_type'];if(!_0x280cde||!_0x35b413||!_0x354b07)return _0x3bcf9c[_0x584f2c(0x127)][_0x584f2c(0x109)](_0x476b8b,_0x476b8b['__'](_0x584f2c(0x168)));let _0x4a9682=null;if(_0x280cde!=config[_0x584f2c(0x197)]){_0x4a9682=dbUserTable['getUserByUserName'](_0x3bcf9c[_0x584f2c(0x127)][_0x584f2c(0x1a2)],_0x280cde);if(!_0x4a9682)return _0x3bcf9c[_0x584f2c(0x127)][_0x584f2c(0x109)](_0x476b8b,_0x584f2c(0x1bc));}_0x35b413=pathUtil['join'](_0x35b413);if(dbUserTable[_0x584f2c(0x169)](_0x3bcf9c,_0x476b8b)===!![]){let _0x444322=dbUserTable[_0x584f2c(0x19c)](_0x3bcf9c['app'][_0x584f2c(0x1a2)],_0x280cde,_0x354b07,null,!![]);for(let _0x353723 of _0x444322){let _0x2ada02=_0x353723['path'];if(_0x35b413['startsWith'](pathUtil['join'](_0x2ada02,pathUtil[_0x584f2c(0x15f)]))&&_0x35b413!=_0x2ada02)return _0x3bcf9c['app'][_0x584f2c(0x109)](_0x476b8b,_0x476b8b['__'](_0x584f2c(0x1ac))+_0x2ada02,_0x584f2c(0x10d));if(_0x2ada02['startsWith'](pathUtil[_0x584f2c(0x1c3)](_0x35b413,pathUtil['sep']))&&_0x35b413!=_0x2ada02)return _0x3bcf9c[_0x584f2c(0x127)][_0x584f2c(0x109)](_0x476b8b,_0x476b8b['__'](_0x584f2c(0x1ac))+_0x2ada02,'dialog');}let _0x24a560=dbUserTable['createOrUpdatePower'](_0x3bcf9c[_0x584f2c(0x127)][_0x584f2c(0x1a2)],_0x3bcf9c['body']);return _0x476b8b[_0x584f2c(0x167)]({'code':0x0,'result':_0x24a560});}}),router['post'](_0x252e17(0x17b),(_0x375a2b,_0x5aa991,_0x46ff59)=>{const _0x3094af=_0x252e17;let _0x39aa4c=_0x375a2b[_0x3094af(0x108)][_0x3094af(0x15e)],_0x85c05d=_0x375a2b[_0x3094af(0x108)][_0x3094af(0x10b)];if(!_0x39aa4c||!(_0x85c05d instanceof Array))return _0x375a2b[_0x3094af(0x127)][_0x3094af(0x109)](_0x5aa991,'need\x20username/menuList');let _0x1ff304=dbUserTable[_0x3094af(0x119)](_0x375a2b[_0x3094af(0x127)]['dbOther'],_0x39aa4c);if(!_0x1ff304)return _0x375a2b[_0x3094af(0x127)]['returnErrMsg'](_0x5aa991,_0x3094af(0x1bc));if(dbUserTable[_0x3094af(0x169)](_0x375a2b,_0x5aa991)===!![])return dbUserTable[_0x3094af(0x16e)](_0x375a2b['app']['dbOther'],_0x39aa4c,_0x3094af(0x1b3),JSON[_0x3094af(0x143)](_0x85c05d)),_0x5aa991[_0x3094af(0x167)]({'code':0x0});}),router[_0x252e17(0x159)](_0x252e17(0x17c),(_0x57fb2d,_0x43f7f7,_0x240e0a)=>{const _0x445f0e=_0x252e17;let _0x109b0b=dbUserTable[_0x445f0e(0x1ad)](_0x57fb2d[_0x445f0e(0x127)][_0x445f0e(0x1a2)],_0x57fb2d['body']);return _0x109b0b[_0x445f0e(0x11b)]>0x0?_0x43f7f7[_0x445f0e(0x167)]({'code':0x0}):_0x57fb2d[_0x445f0e(0x127)]['returnErrMsg'](_0x43f7f7,_0x43f7f7['__'](_0x445f0e(0x168)));}),router[_0x252e17(0x159)](_0x252e17(0x19a),(_0x400587,_0xf618e2,_0x376e5a)=>{const _0x4088c8=_0x252e17;let _0x3c20b0=_0x400587[_0x4088c8(0x108)][_0x4088c8(0xf6)],_0x5cd3b6=_0x400587[_0x4088c8(0x108)][_0x4088c8(0x17a)];cryptoUtils[_0x4088c8(0xfb)](config[_0x4088c8(0x132)],_0x3c20b0)[_0x4088c8(0x100)](_0x2845b6=>{const _0xdc930a=_0x4088c8;if(_0x400587[_0xdc930a(0xfc)][_0xdc930a(0x12f)]!=_0x2845b6)return _0xf618e2[_0xdc930a(0x167)]({'code':0x2,'message':_0xf618e2['__'](_0xdc930a(0x137))});else cryptoUtils[_0xdc930a(0xfb)](config[_0xdc930a(0x132)],_0x5cd3b6)[_0xdc930a(0x100)](_0x1d0416=>{const _0x55ab6d=_0xdc930a;dbUserTable[_0x55ab6d(0x187)](_0x400587[_0x55ab6d(0x127)]['dbOther'],_0x400587[_0x55ab6d(0xfc)]['id'],_0x55ab6d(0x12f),_0x1d0416);let _0x4955b4=sha256(new Date()[_0x55ab6d(0x182)]()+_0x400587[_0x55ab6d(0xfc)][_0x55ab6d(0x15e)]+_0x400587[_0x55ab6d(0xfc)][_0x55ab6d(0x12f)]);dbUserTable[_0x55ab6d(0x187)](_0x400587[_0x55ab6d(0x127)][_0x55ab6d(0x1a2)],_0x400587[_0x55ab6d(0xfc)]['id'],_0x55ab6d(0x19b),_0x4955b4);let _0x53c897=netUtils[_0x55ab6d(0x173)](_0x400587);return dbLoginTable[_0x55ab6d(0x105)](_0x400587['app'][_0x55ab6d(0x1a2)],'changePassword',_0x400587[_0x55ab6d(0xfc)]['id'],_0x53c897,_0x400587['body'][_0x55ab6d(0x117)],''),_0xf618e2[_0x55ab6d(0x167)]({'code':0x0});})[_0xdc930a(0x1c8)](_0x5e4894=>{const _0x2ba19c=_0xdc930a;return console['log'](_0x2ba19c(0x15c),_0x5e4894),_0x400587[_0x2ba19c(0x127)][_0x2ba19c(0x109)](_0xf618e2,_0xf618e2['__']('operationFail'));});});}),router[_0x252e17(0x159)]('/changeQuestion',(_0x48714f,_0x5ae7a0,_0xca1a15)=>{const _0x209c79=_0x252e17;let _0x1a8510=_0x48714f[_0x209c79(0x108)][_0x209c79(0x1d4)],_0x288bf9=_0x48714f[_0x209c79(0x108)][_0x209c79(0x11a)];if(checkUtil['isSameStr'](_0x288bf9))return _0x48714f[_0x209c79(0x127)][_0x209c79(0x109)](_0x5ae7a0,_0x5ae7a0['__'](_0x209c79(0x102)));if(_0x1a8510==_0x288bf9)return _0x48714f['app'][_0x209c79(0x109)](_0x5ae7a0,_0x5ae7a0['__'](_0x209c79(0x1b5)));return dbUserTable[_0x209c79(0x157)](_0x48714f[_0x209c79(0x127)][_0x209c79(0x1a2)],_0x48714f['currentUser']['id'],_0x1a8510,sha256(_0x288bf9)),_0x5ae7a0[_0x209c79(0x167)]({'code':0x0});}),router[_0x252e17(0x159)](_0x252e17(0x152),(_0x3de654,_0x2a5ab,_0x5cd308)=>{const _0x2acc56=_0x252e17;let _0x42cf6c=_0x3de654[_0x2acc56(0x108)][_0x2acc56(0x19b)];return _0x42cf6c&&dbUserTable[_0x2acc56(0x178)](_0x3de654[_0x2acc56(0x127)]['dbOther'],_0x2acc56(0x1c5),[_0x42cf6c]),_0x2a5ab[_0x2acc56(0x167)]({'code':0x0});}),router['post']('/getCurrentUserInfo',(_0x3ed6dc,_0x4da280,_0x4d8267)=>{const _0x53ea4e=_0x252e17;let _0x141f04=dbUserTable[_0x53ea4e(0x1c4)](_0x3ed6dc[_0x53ea4e(0x127)][_0x53ea4e(0x1a2)],_0x3ed6dc[_0x53ea4e(0xfc)]['id']);return _0x141f04?(_0x141f04['password']='',_0x141f04['answer']='',_0x4da280[_0x53ea4e(0x167)]({'code':0x0,'userInfo':_0x141f04})):_0x4da280[_0x53ea4e(0x167)]({'code':0x65});}),router[_0x252e17(0x159)]('/addIpToList',(_0x4c64cb,_0xd4c575,_0x5c860f)=>{const _0x574765=_0x252e17;if(_0x4c64cb[_0x574765(0xfc)][_0x574765(0x174)]!=0x1)return _0xd4c575[_0x574765(0x167)]({'code':0x66});let _0x626309=_0x4c64cb[_0x574765(0x108)]['ip'];if(_0x626309==_0x574765(0xfe)||_0x626309==_0x574765(0x11c))return _0x4c64cb[_0x574765(0x127)][_0x574765(0x109)](_0xd4c575,_0xd4c575['__'](_0x574765(0x191)));let _0x3db250=_0x4c64cb[_0x574765(0x108)][_0x574765(0x135)],_0x2707e0=_0x4c64cb[_0x574765(0x108)][_0x574765(0x170)];return dbLoginTable['addIpToList'](_0x4c64cb[_0x574765(0x127)][_0x574765(0x1a2)],_0x3db250,_0x626309,_0x2707e0,_0xd4c575['__'](_0x574765(0x10a))),_0x4c64cb[_0x574765(0x127)][_0x574765(0x134)](),_0xd4c575[_0x574765(0x167)]({'code':0x0});}),router[_0x252e17(0x159)](_0x252e17(0x1b8),(_0x49aaf4,_0x3a7365,_0x5218ff)=>{const _0x591ecd=_0x252e17;if(_0x49aaf4['currentUser'][_0x591ecd(0x174)]!=0x1)return _0x3a7365['json']({'code':0x66});let _0x66862a=_0x49aaf4[_0x591ecd(0x108)]['id'];return dbLoginTable[_0x591ecd(0x1b4)](_0x49aaf4[_0x591ecd(0x127)][_0x591ecd(0x1a2)],_0x66862a),_0x49aaf4[_0x591ecd(0x127)][_0x591ecd(0x134)](),_0x3a7365[_0x591ecd(0x167)]({'code':0x0});}),router['post']('/getIpList',(_0x505620,_0x26462e,_0x43a03f)=>{const _0xef4f6e=_0x252e17;let _0x25fb11=_0x505620[_0xef4f6e(0x108)][_0xef4f6e(0x13c)],_0x1f204b=_0x505620[_0xef4f6e(0x108)][_0xef4f6e(0x162)],_0x335088=_0x505620[_0xef4f6e(0x108)][_0xef4f6e(0x135)],_0x53f655=new Date()[_0xef4f6e(0x182)]();dbLoginTable[_0xef4f6e(0x10f)](_0x505620[_0xef4f6e(0x127)][_0xef4f6e(0x1a2)],_0xef4f6e(0x171)+_0x53f655);let _0x1cc068=_0xef4f6e(0x1d8)+_0x335088+'\x27',_0x185d7c=dbLoginTable[_0xef4f6e(0x19f)](_0x505620[_0xef4f6e(0x127)][_0xef4f6e(0x1a2)],_0x1cc068),_0x51e9d2=(_0x25fb11-0x1)*_0x1f204b;_0x1cc068+=_0xef4f6e(0x18a)+_0x1f204b+_0xef4f6e(0x1c7)+_0x51e9d2;let _0x359918=dbLoginTable[_0xef4f6e(0x18e)](_0x505620[_0xef4f6e(0x127)][_0xef4f6e(0x1a2)],_0x1cc068);return _0x26462e['json']({'code':0x0,'data':_0x359918,'pageCount':Math['ceil'](_0x185d7c[_0xef4f6e(0x124)]/_0x1f204b)});}),router['post']('/getRecordList',(_0x5a0a5a,_0x2b54b5,_0x12f1c7)=>{const _0x2e8139=_0x252e17;if(_0x5a0a5a[_0x2e8139(0xfc)]['is_admin']!=0x1)return _0x2b54b5[_0x2e8139(0x167)]({'code':0x66});let _0x4f30ff=0x1388,_0x305c18=_0x5a0a5a[_0x2e8139(0x108)][_0x2e8139(0x13c)],_0x39c76a=_0x5a0a5a[_0x2e8139(0x108)][_0x2e8139(0x162)],_0x4ddef3=_0x5a0a5a[_0x2e8139(0x108)][_0x2e8139(0x135)],_0x4b6818='',_0x212e1e=[];_0x4ddef3?(_0x4b6818+=_0x2e8139(0x184),_0x212e1e['push'](_0x4ddef3)):_0x4b6818=_0x2e8139(0x18c);let _0x5c4a52=dbLoginTable['getRecordCountByWhere'](_0x5a0a5a[_0x2e8139(0x127)][_0x2e8139(0x1a2)],_0x4b6818,_0x212e1e)['count'];if(_0x5c4a52>_0x4f30ff){let _0x4c1680=0x64,_0xc177ae=dbLoginTable[_0x2e8139(0x12e)](_0x5a0a5a[_0x2e8139(0x127)][_0x2e8139(0x1a2)],'\x20id\x20in(SELECT\x20id\x20FROM\x20login_record\x20ORDER\x20BY\x20id\x20LIMIT\x20'+_0x4c1680+')');_0xc177ae['changes']>0x0&&(_0x5c4a52=_0x5c4a52-_0xc177ae['changes']);}let _0x39c235=(_0x305c18-0x1)*_0x39c76a;_0x4b6818+=_0x2e8139(0x172),_0x212e1e[_0x2e8139(0x1ab)](_0x39c76a),_0x212e1e[_0x2e8139(0x1ab)](_0x39c235);let _0x150a0e=dbLoginTable[_0x2e8139(0x146)](_0x5a0a5a[_0x2e8139(0x127)][_0x2e8139(0x1a2)],_0x4b6818,_0x212e1e);return _0x2b54b5[_0x2e8139(0x167)]({'code':0x0,'data':_0x150a0e,'pageCount':Math['ceil'](_0x5c4a52/_0x39c76a)});}),module[_0x252e17(0x1b7)]=router;