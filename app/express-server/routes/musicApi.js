const _0x2e6e3b=_0x1e43;(function(_0x439d2f,_0x232cdd){const _0x3c34b9=_0x1e43,_0x274482=_0x439d2f();while(!![]){try{const _0x1b8fdf=-parseInt(_0x3c34b9(0x207))/0x1*(parseInt(_0x3c34b9(0x26c))/0x2)+parseInt(_0x3c34b9(0x268))/0x3+parseInt(_0x3c34b9(0x222))/0x4+-parseInt(_0x3c34b9(0x21c))/0x5+-parseInt(_0x3c34b9(0x24f))/0x6*(parseInt(_0x3c34b9(0x241))/0x7)+parseInt(_0x3c34b9(0x23e))/0x8*(-parseInt(_0x3c34b9(0x1e4))/0x9)+parseInt(_0x3c34b9(0x215))/0xa*(parseInt(_0x3c34b9(0x1e0))/0xb);if(_0x1b8fdf===_0x232cdd)break;else _0x274482['push'](_0x274482['shift']());}catch(_0x211d97){_0x274482['push'](_0x274482['shift']());}}}(_0x41da,0xe9e68));let express=require('express'),router=express[_0x2e6e3b(0x255)](),config=require(_0x2e6e3b(0x26d)),path=require(_0x2e6e3b(0x1e2)),fs=require('fs'),dbMusicIndexTable=require('../../db/dbMusicIndexTable'),dbFileIndexTable=require(_0x2e6e3b(0x299)),dbMusicPlaylistTable=require(_0x2e6e3b(0x263)),dbMusicFavorite=require('../../db/dbMusicFavorite'),jsmediatags=require(_0x2e6e3b(0x1ff));function _0x41da(){const _0x3e0429=['app','getCoverByField','getById','abs','last_play_time','SELECT\x20id\x20from\x20file_index_music\x20where\x20is_file=1\x20and\x20path\x20=?\x20or\x20path\x20like\x20?','Lyric\x20is\x20null','json','maxPlayMusic','../../db/dbMusicPlaylistTable','count','birthtime','lyricList','need\x20\x27name\x27','1978380OeJxJR','utf-8','\x20order\x20by\x20f.','is_admin','2WxKnhj','../../myConfig/config','includes','\x20(type=3\x20OR\x20is_file=0)','playlistId\x20no\x20exists','playlist','\x20order\x20by\x20f.artist_fl\x20','body','year','trim','\x20order\x20by\x20m.update_time\x20DESC\x20','temp.','searchMusicAlbum','/getMusicDetail','lyric','image','getVipInfo','filename','delete','dbOther','/saveLyric','need\x20musicIndexId\x20and\x20playlistId','../utils/sharpUtils','post','album','\x20order\x20by\x20f.album_fl\x20','albumCount','get','base64','existsSync','getFavorite','getPlaylistCover','genre','name','\x20FROM\x20file_index_music\x20WHERE\x20','artistList',',f.artist\x20','music','music_count','getUserPathWhere','addMusicToPlaylist',',id\x20asc',',f.filename_fl\x20','message','\x20AND\x20(filename\x20like\x20?\x20\x20OR\x20title\x20\x20like\x20?\x20\x20OR\x20genre\x20like\x20?\x20)','../../db/dbFileIndexTable','token','sendFile','need\x20playlistId','../../db/dbUserTable','\x20is_file=1','writeFile','/getMusicList','11paapyD','UPDATE\x20file_index_music\x20set\x20check_time=?\x20WHERE\x20id=?','path','getMusicList','17694asFuQM','userInfo','indexId','tags','log','getPlaylistById','musicIsFavorite','orderType','basename','ORDER\x20BY\x20','genTinyFile','currentUser','\x20order\x20by\x20m.update_time\x20','push','file_cover_path','catch','getMediaCoverCachePath','\x20path=?\x20AND\x20','updateByFiled','query','UPDATE\x20file_index_music\x20set\x20lyrics_get_state=?,\x20lyrics=?\x20WHERE\x20id=?','desc','artist','\x20AND\x20(filename_fl\x20=?\x20or\x20title_fl=?\x20)','getPlaylistMusicCount','getUserInfo',',f.title\x20','jsmediatags','cover_path','INDEX_TABLE_NAME_MUSIC','listType','run','readFile','operation\x20error','length','1409659VrSmty','/searchLyric','recentAddList','groupField','asc','from','edit','\x20LIMIT\x20?\x20OFFSET\x20?\x20','SELECT\x20','parent','stringify','getFavoriteCount','status','APIC','48428540BMkkZV','lyrics','lyrics_get_state','\x20order\x20by\x20f.title_fl\x20','../utils/nasAccountUtils','apiTokenKey','play_count','7325045qTtoxs','addFavorite','favorite','getGroupList','coverList','searchStr','2330660JXyNcZ','recentMusic','is_file','apiMusicInfoUrl','read',',f.album\x20','returnErrMsg','../../db/dbSourceFolderTable','size','lrc','picture','letterIndex','orderField','../../utils/musicUtil','add','data','uid','join','prepare','dbFileIndex','title','exports','getMusicSameNameCover','/operationPlaylistIndex','/getMusicCover','removeMusicFromPlaylist','getMusicIndex','transStringToUtf8','3424HFwUjN','/getMusicIndexFileTree','searchMusicName','21yfbaXB','deleteFavorite','extname','NO\x20MUSIC\x20INDEX','musicIndexId','/musicFavorite','doUserCanGet','username','power_get','getAllFavoriteByWhere','/operationPlaylist','replace','checkOrderParams','end','2821614IULWCD','skipCount','operation','playlistId','list','then','Router','duration','\x20\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20title\x20\x20LIKE\x20?)\x20','removePlaylist','sep'];_0x41da=function(){return _0x3e0429;};return _0x41da();}const dbUserTable=require(_0x2e6e3b(0x29d));let musicUitls=require(_0x2e6e3b(0x22f)),sharpUtil=require(_0x2e6e3b(0x282));const dbSourceFolderTable=require(_0x2e6e3b(0x229));let nasAccountUtil=require(_0x2e6e3b(0x219)),axios=require('axios'),sha256=require('sha256'),os=require('os');function getMusicListByParams(_0x5b3498,_0x15ccc3,_0x13091c,_0x534f32,_0x1f234e,_0x5a089d,_0x29a701,_0x27d5df,_0x4a41ec,_0x11359f,_0x5f24e5,_0x28b40b,_0xda62b4,_0x2562f8,_0x176044){const _0xd437a6=_0x2e6e3b;let _0x56550f=_0x5b3498['app'][_0xd437a6(0x235)],_0x494612=[];if(_0x534f32==_0xd437a6(0x253)||_0x534f32==_0xd437a6(0x271))_0x494612=dbMusicIndexTable[_0xd437a6(0x1e3)](_0x56550f,_0x13091c,_0x1f234e,_0x5a089d,_0x29a701,_0x27d5df,_0x4a41ec,_0x11359f,_0x5f24e5,_0x28b40b,_0x2562f8,_0xda62b4,_0x176044);else{if(_0x534f32==_0xd437a6(0x21e)){let _0x2a51f4='',_0x4a3d6e=[];_0x2a51f4+=_0xd437a6(0x1dd);_0xda62b4&&(_0xda62b4=_0xda62b4[_0xd437a6(0x24c)]('\x27','')[_0xd437a6(0x24c)]('â€™',''),_0x2a51f4+=_0xd437a6(0x298),_0x4a3d6e[_0xd437a6(0x1f1)]('%'+_0xda62b4+'%','%'+_0xda62b4+'%','%'+_0xda62b4+'%'));_0x176044&&(_0x2a51f4+=_0xd437a6(0x1fb),_0x4a3d6e['push'](_0x176044,_0x176044));if(_0x29a701&&_0x27d5df){if(_0x29a701==_0xd437a6(0x1fa))_0x2a51f4+=_0xd437a6(0x272)+_0x27d5df+_0xd437a6(0x290)+_0x27d5df+'\x20';else{if(_0x29a701==_0xd437a6(0x284))_0x2a51f4+=_0xd437a6(0x285)+_0x27d5df+_0xd437a6(0x227)+_0x27d5df+'\x20';else{if(_0x29a701==_0xd437a6(0x236))_0x2a51f4+=_0xd437a6(0x218)+_0x27d5df+_0xd437a6(0x1fe)+_0x27d5df+_0xd437a6(0x296)+_0x27d5df+'\x20';else _0x29a701=='favorite_time'?_0x2a51f4+=_0xd437a6(0x1f0)+_0x27d5df+'\x20':_0x2a51f4+=_0xd437a6(0x26a)+_0x29a701+'\x20'+_0x27d5df+'\x20';}}}else _0x2a51f4+=_0xd437a6(0x276);_0x2a51f4+=_0xd437a6(0x20e),_0x4a3d6e['push'](_0x1f234e),_0x4a3d6e['push'](_0x5a089d),_0x494612=dbMusicFavorite[_0xd437a6(0x24a)](_0x5b3498['app']['dbFileIndex'],_0x5b3498[_0xd437a6(0x1ef)]['id'],_0x2a51f4,'*',_0x4a3d6e);}}for(let _0x1751bf of _0x494612){_0x1751bf['favorite']=dbMusicFavorite[_0xd437a6(0x1ea)](_0x5b3498[_0xd437a6(0x25a)]['dbFileIndex'],_0x1751bf['id'],_0x5b3498[_0xd437a6(0x1ef)]['id'])?'1':'0';if(!_0x1751bf[_0xd437a6(0x200)]){let _0x4d4126=!![];_0x1751bf[_0xd437a6(0x1f2)]&&fs[_0xd437a6(0x289)](_0x1751bf[_0xd437a6(0x1f2)])&&(_0x4d4126=![]),_0x4d4126&&(_0x1751bf['file_cover_path']=musicUitls[_0xd437a6(0x238)](_0x5b3498['app'][_0xd437a6(0x235)],_0x1751bf));}_0x1751bf['filePath']=path['join'](_0x1751bf[_0xd437a6(0x1e2)],_0x1751bf[_0xd437a6(0x27d)]),delete _0x1751bf[_0xd437a6(0x1e2)];}return _0x494612;}router[_0x2e6e3b(0x283)]('/getMusicHomeData',(_0x438a00,_0x305493,_0x45b8ba)=>{const _0x4d2844=_0x2e6e3b;let _0x540019=_0x438a00[_0x4d2844(0x25a)][_0x4d2844(0x235)],_0x410e07=_0x438a00[_0x4d2844(0x273)][_0x4d2844(0x264)]?_0x438a00[_0x4d2844(0x273)][_0x4d2844(0x264)]:0xc,_0x1ae9c7=_0x438a00[_0x4d2844(0x273)][_0x4d2844(0x286)]?_0x438a00[_0x4d2844(0x273)][_0x4d2844(0x286)]:0xc,_0x25075e=dbUserTable[_0x4d2844(0x293)](_0x438a00,_0x4d2844(0x291),_0x4d2844(0x249),!![]);if(_0x438a00[_0x4d2844(0x1ef)]['is_admin']!=0x1&&!_0x25075e)return _0x305493['json']({'code':0x0,'data':null});let _0x321e25=getMusicListByParams(_0x438a00,_0x305493,_0x25075e,'list',_0x410e07,0x0,'last_play_time',_0x4d2844(0x1f9)),_0x3a8e38=getMusicListByParams(_0x438a00,_0x305493,_0x25075e,_0x4d2844(0x253),_0x410e07,0x0,'play_count\x20desc',_0x4d2844(0x295)),_0x495f15=getMusicListByParams(_0x438a00,_0x305493,_0x25075e,_0x4d2844(0x253),_0x410e07,0x0,'id',_0x4d2844(0x1f9)),_0x4b32a0=dbMusicIndexTable[_0x4d2844(0x21f)](_0x540019,_0x25075e,_0x4d2844(0x1fa),_0x1ae9c7,0x0,'last_play_time',_0x4d2844(0x1f9));for(let _0x4c9ba7 of _0x4b32a0){_0x4c9ba7[_0x4d2844(0x220)]=dbMusicIndexTable[_0x4d2844(0x25b)](_0x540019,_0x4d2844(0x1fa),_0x4c9ba7['artist'],0x1,_0x25075e);}let _0xe6cc6e=dbMusicIndexTable['getGroupList'](_0x540019,_0x25075e,_0x4d2844(0x284),_0x1ae9c7,0x0,'play_count','desc');for(let _0x53f914 of _0xe6cc6e){_0x53f914[_0x4d2844(0x220)]=dbMusicIndexTable['getCoverByField'](_0x540019,_0x4d2844(0x284),_0x53f914['album'],0x1,_0x25075e);}let _0x42b334={};return _0x321e25&&_0x321e25[_0x4d2844(0x206)]>0x0&&(_0x42b334[_0x4d2844(0x223)]=_0x321e25),_0x3a8e38&&_0x3a8e38[_0x4d2844(0x206)]>0x0&&(_0x42b334[_0x4d2844(0x262)]=_0x3a8e38),_0x495f15&&_0x495f15[_0x4d2844(0x206)]>0x0&&(_0x42b334[_0x4d2844(0x209)]=_0x495f15),_0x4b32a0&&_0x4b32a0['length']>0x0&&(_0x42b334[_0x4d2844(0x28f)]=_0x4b32a0),_0xe6cc6e&&_0xe6cc6e[_0x4d2844(0x206)]>0x0&&(_0x42b334['albumList']=_0xe6cc6e),_0x305493[_0x4d2844(0x261)]({'code':0x0,'data':_0x42b334,'platform':os['platform']()});}),router[_0x2e6e3b(0x283)](_0x2e6e3b(0x1df),(_0x3c2d70,_0x1bcd36,_0x255bb2)=>{const _0x231749=_0x2e6e3b;let _0x577a3a=_0x3c2d70['body'][_0x231749(0x264)]||0x32,_0x253746=_0x3c2d70['body']['offset']||0x0,_0x4aaede=_0x3c2d70[_0x231749(0x273)]['album'],_0x2d7b8a=_0x3c2d70[_0x231749(0x273)][_0x231749(0x274)],_0x6b8b9a=_0x3c2d70[_0x231749(0x273)]['artist'],_0x164da1=_0x3c2d70['body'][_0x231749(0x28c)],_0x4ada4e=_0x3c2d70[_0x231749(0x273)][_0x231749(0x22e)]||_0x231749(0x25e),_0x1cfa56=_0x3c2d70[_0x231749(0x273)][_0x231749(0x1eb)]||_0x231749(0x1f9),_0x1a159d=[_0x231749(0x253),_0x231749(0x21e),_0x231749(0x271)],_0x3da7d5=_0x3c2d70[_0x231749(0x273)][_0x231749(0x202)]||_0x231749(0x253),_0x233222=_0x3c2d70[_0x231749(0x273)]['search'],_0x422cb2=_0x3c2d70[_0x231749(0x273)][_0x231749(0x22d)],_0x149016=_0x3c2d70[_0x231749(0x273)][_0x231749(0x252)];if(dbMusicIndexTable['checkOrderParams'](_0x3c2d70,_0x1bcd36,_0x4ada4e,_0x1cfa56)!==!![])return;if(_0x3da7d5==_0x231749(0x271)){if(!_0x149016)return _0x3c2d70[_0x231749(0x25a)][_0x231749(0x228)](_0x1bcd36,_0x231749(0x29c));}!_0x1a159d[_0x231749(0x26e)](_0x3da7d5)&&(_0x3da7d5='list');_0x577a3a>0x1f4&&(_0x577a3a=0x1f4);let _0x5ac755=dbUserTable[_0x231749(0x293)](_0x3c2d70,_0x231749(0x291),_0x231749(0x249),!![]);if(_0x3c2d70['currentUser'][_0x231749(0x26b)]!=0x1&&!_0x5ac755)return _0x1bcd36[_0x231749(0x261)]({'code':0x0,'data':null});let _0x4faee4=getMusicListByParams(_0x3c2d70,_0x1bcd36,_0x5ac755,_0x3da7d5,_0x577a3a,_0x253746,_0x4ada4e,_0x1cfa56,_0x4aaede,_0x2d7b8a,_0x6b8b9a,_0x164da1,_0x233222,_0x149016,_0x422cb2),_0x1e840c={'code':0x0,'data':_0x4faee4};if(_0x3da7d5=='favorite')_0x1e840c[_0x231749(0x292)]=dbMusicFavorite[_0x231749(0x212)](_0x3c2d70['app'][_0x231749(0x235)],_0x3c2d70[_0x231749(0x1ef)]['id']);else{if(_0x3da7d5==_0x231749(0x253))_0x1e840c[_0x231749(0x292)]=dbMusicIndexTable['getMusicListCount'](_0x3c2d70[_0x231749(0x25a)][_0x231749(0x235)],_0x5ac755,_0x4aaede,_0x2d7b8a,_0x6b8b9a,_0x164da1);else _0x3da7d5==_0x231749(0x271)&&(_0x1e840c[_0x231749(0x292)]=dbMusicPlaylistTable[_0x231749(0x1fc)](_0x3c2d70[_0x231749(0x25a)][_0x231749(0x235)],_0x149016));}return _0x1bcd36[_0x231749(0x261)](_0x1e840c);}),router[_0x2e6e3b(0x283)](_0x2e6e3b(0x279),(_0x5d70e5,_0x53ca70,_0x2b3e27)=>{const _0x41bca3=_0x2e6e3b;let _0x32b847=_0x5d70e5[_0x41bca3(0x273)]['id'],_0x3bcba3=dbFileIndexTable[_0x41bca3(0x25c)](_0x5d70e5[_0x41bca3(0x25a)][_0x41bca3(0x235)],_0x32b847,dbFileIndexTable[_0x41bca3(0x201)]);if(!_0x3bcba3)return _0x5d70e5[_0x41bca3(0x25a)]['returnErrMsg'](_0x53ca70,_0x41bca3(0x244));if(dbUserTable['doUserCanGet'](_0x5d70e5,_0x53ca70,_0x41bca3(0x291),_0x41bca3(0x249),_0x3bcba3[_0x41bca3(0x1e2)])==!![]){let _0x570520=_0x5d70e5[_0x41bca3(0x1ef)]['id'],_0xa7f35f=dbMusicFavorite[_0x41bca3(0x28a)](_0x5d70e5[_0x41bca3(0x25a)][_0x41bca3(0x235)],_0x570520,_0x32b847);_0x3bcba3['file_cover_path']=musicUitls[_0x41bca3(0x238)](_0x5d70e5[_0x41bca3(0x25a)][_0x41bca3(0x235)],_0x3bcba3),_0x3bcba3[_0x41bca3(0x21e)]=_0xa7f35f?0x1:0x0,getLyrics(_0x3bcba3,_0x2d7e9b=>{const _0xf782b1=_0x41bca3;return _0x3bcba3[_0xf782b1(0x266)]=_0x2d7e9b,_0x53ca70[_0xf782b1(0x261)]({'code':0x0,'data':_0x3bcba3});});}});function updateIndexLyric(_0x5a9680,_0x2dd4ba,_0x1b2ba8,_0x4b57c3){const _0x307f4f=_0x2e6e3b;if(_0x1b2ba8&&_0x1b2ba8[_0x307f4f(0x206)]>0x0){let _0x38c7ec=_0x4b57c3['filename'][_0x307f4f(0x24c)](path[_0x307f4f(0x243)](_0x4b57c3['filename']),''),_0x39089e=_0x38c7ec+'.lrc',_0x1e8a06=path[_0x307f4f(0x233)](_0x4b57c3[_0x307f4f(0x1e2)],_0x39089e);fs[_0x307f4f(0x1de)](_0x1e8a06,_0x1b2ba8,_0x307f4f(0x269),_0x2ab714=>{if(!_0x2ab714){}});}let _0x39b974=JSON[_0x307f4f(0x211)]({'lyrics':_0x1b2ba8?_0x1b2ba8:''});_0x5a9680[_0x307f4f(0x234)](_0x307f4f(0x1f8))['run'](_0x2dd4ba,_0x39b974,_0x4b57c3['id']);}function _0x1e43(_0x4a94eb,_0x488b5e){const _0x41daea=_0x41da();return _0x1e43=function(_0x1e432f,_0x25fb3e){_0x1e432f=_0x1e432f-0x1dd;let _0x1e738b=_0x41daea[_0x1e432f];return _0x1e738b;},_0x1e43(_0x4a94eb,_0x488b5e);}router['post'](_0x2e6e3b(0x280),(_0x2a69c4,_0x563c4a,_0x16dd9a)=>{const _0xb110a4=_0x2e6e3b;let _0x4250f4=_0x2a69c4['body']['id'],_0x53dcf9=_0x2a69c4[_0xb110a4(0x273)][_0xb110a4(0x27a)],_0x9b098d=dbFileIndexTable['getById'](_0x2a69c4['app'][_0xb110a4(0x235)],_0x4250f4,dbFileIndexTable[_0xb110a4(0x201)]);if(!_0x9b098d)return _0x2a69c4[_0xb110a4(0x25a)][_0xb110a4(0x228)](_0x563c4a,_0xb110a4(0x244));if(!_0x53dcf9)return _0x2a69c4['app'][_0xb110a4(0x228)](_0x563c4a,_0xb110a4(0x260));if(dbUserTable[_0xb110a4(0x247)](_0x2a69c4,_0x563c4a,_0xb110a4(0x291),'power_add',_0x9b098d[_0xb110a4(0x1e2)])==!![])return updateIndexLyric(_0x2a69c4[_0xb110a4(0x25a)][_0xb110a4(0x235)],0x1,_0x53dcf9,_0x9b098d),_0x563c4a[_0xb110a4(0x261)]({'code':0x0});}),router[_0x2e6e3b(0x283)](_0x2e6e3b(0x208),(_0x21c1e4,_0x2bbff0,_0x3ca97d)=>{const _0x887040=_0x2e6e3b;let _0x2fa962=_0x21c1e4[_0x887040(0x273)]['id'],_0x14d94c=dbFileIndexTable[_0x887040(0x25c)](_0x21c1e4[_0x887040(0x25a)]['dbFileIndex'],_0x2fa962,dbFileIndexTable[_0x887040(0x201)]);if(!_0x14d94c)return _0x21c1e4[_0x887040(0x25a)][_0x887040(0x228)](_0x2bbff0,_0x887040(0x244));let _0x222503=_0x21c1e4[_0x887040(0x273)][_0x887040(0x240)],_0x2dadac=_0x21c1e4[_0x887040(0x273)]['searchMusicArtist'],_0x3e17a8=_0x21c1e4['body'][_0x887040(0x278)],_0x54638e=_0x21c1e4[_0x887040(0x273)]['isSearch'];if(dbUserTable[_0x887040(0x247)](_0x21c1e4,_0x2bbff0,_0x887040(0x291),_0x887040(0x249),_0x14d94c[_0x887040(0x1e2)])==!![]){nasAccountUtil[_0x887040(0x27c)](_0x21c1e4[_0x887040(0x25a)]['dbOther'])[_0x887040(0x254)](_0x2b0368=>{const _0x238269=_0x887040;if(_0x2b0368)_0x35c429();else return _0x54638e?_0x2bbff0[_0x238269(0x261)]({'code':0xbc}):_0x40b62d();})[_0x887040(0x1f3)](_0xd22c10=>{return _0x40b62d();});function _0x40b62d(){const _0x44fff3=_0x887040;return _0x2bbff0[_0x44fff3(0x261)]({'code':0x0,'data':[]});}function _0x35c429(){const _0x2cb095=_0x887040;if(_0x14d94c[_0x2cb095(0x217)]==0x1&&!_0x54638e)return _0x2bbff0[_0x2cb095(0x261)]({'code':0x0,'data':[_0x14d94c[_0x2cb095(0x216)]]});nasAccountUtil[_0x2cb095(0x1fd)](_0x21c1e4[_0x2cb095(0x25a)]['dbOther'],!![])[_0x2cb095(0x254)](_0x28130b=>{const _0x90d4b4=_0x2cb095;if(!_0x28130b)return _0x2bbff0[_0x90d4b4(0x261)]({'code':0x0,'data':[]});let _0x22c6ef=_0x28130b['userInfo'][_0x90d4b4(0x29a)][_0x28130b[_0x90d4b4(0x1e5)][_0x90d4b4(0x29a)]['length']-0x1],_0x52c82f=_0x21c1e4[_0x90d4b4(0x273)][_0x90d4b4(0x250)]||0x0;if(!_0x222503||!_0x222503[_0x90d4b4(0x275)]())return _0x2bbff0[_0x90d4b4(0x261)]([]);let _0x160e20={'searchMusicName':_0x222503,'searchMusicArtist':_0x2dadac,'searchMusicAlbum':_0x3e17a8,'isSearch':_0x54638e,'skipCount':_0x52c82f,'uniIdToken':_0x22c6ef,'token':sha256(_0x222503+config[_0x90d4b4(0x21a)])};axios['post'](config[_0x90d4b4(0x225)],_0x160e20)[_0x90d4b4(0x254)](_0x314330=>{const _0x24de29=_0x90d4b4;if(_0x314330[_0x24de29(0x231)]){if(_0x314330['data'][_0x24de29(0x206)]>0x0&&!_0x54638e){let _0x2c540b=![],_0x415c39=0x14,_0x19dc9c=0x64,_0x25bd1e=null;for(let _0x4f99fd of _0x314330[_0x24de29(0x231)]){if(_0x4f99fd[_0x24de29(0x256)]){let _0x43b6b9=_0x4f99fd[_0x24de29(0x256)]/0x3e8,_0x967969=Math[_0x24de29(0x25d)](_0x43b6b9-_0x14d94c[_0x24de29(0x256)]);_0x967969<_0x19dc9c&&(_0x19dc9c=_0x967969,_0x25bd1e=_0x4f99fd[_0x24de29(0x22b)]?_0x4f99fd[_0x24de29(0x22b)]:'');}}return _0x19dc9c<_0x415c39?(_0x2c540b=!![],_0x14d94c[_0x24de29(0x216)]=JSON[_0x24de29(0x211)]({'lyrics':_0x25bd1e?_0x25bd1e:''}),updateIndexLyric(_0x21c1e4[_0x24de29(0x25a)][_0x24de29(0x235)],0x1,_0x25bd1e,_0x14d94c)):updateIndexLyric(_0x21c1e4['app'][_0x24de29(0x235)],0x1,'',_0x14d94c),_0x2bbff0['json']({'code':0x0,'data':_0x2c540b&&_0x14d94c['lyrics']?[_0x14d94c['lyrics']]:[]});}else return _0x2bbff0[_0x24de29(0x261)]({'code':0x0,'data':_0x314330['data']});}})['catch'](_0x237da6=>{const _0xadc40f=_0x90d4b4;return _0x21c1e4['app'][_0xadc40f(0x228)](_0x2bbff0,_0x237da6[_0xadc40f(0x297)]);});});}}});function getLyrics(_0x58b150,_0x27619d){const _0x8ac820=_0x2e6e3b;let _0x3c5af5=[];try{_0x58b150[_0x8ac820(0x216)]&&_0x58b150[_0x8ac820(0x216)][_0x8ac820(0x206)]>0xa&&_0x3c5af5['push']({'type':'inner','content':_0x58b150[_0x8ac820(0x216)]});let _0x429e67=_0x58b150['filename'][_0x8ac820(0x24c)](path['extname'](_0x58b150[_0x8ac820(0x27d)]),''),_0x541b8=_0x429e67+'.lrc',_0x63b4da=path[_0x8ac820(0x233)](_0x58b150[_0x8ac820(0x1e2)],_0x541b8);fs[_0x8ac820(0x289)](_0x63b4da)?fs[_0x8ac820(0x204)](_0x63b4da,(_0x15ae0f,_0x3a62ac)=>{const _0x13578f=_0x8ac820;let _0x4451d2=musicUitls[_0x13578f(0x23d)](_0x3a62ac['toString'](),_0x63b4da);_0x3c5af5[_0x13578f(0x1f1)]({'type':'file','filename':_0x541b8,'content':_0x4451d2}),_0x27619d(_0x3c5af5);}):_0x27619d(_0x3c5af5);}catch(_0x39a1c4){console[_0x8ac820(0x1e8)](_0x39a1c4),_0x27619d(_0x3c5af5);}}router[_0x2e6e3b(0x283)](_0x2e6e3b(0x246),(_0x38945f,_0x58208e,_0x23d084)=>{const _0x32a910=_0x2e6e3b;let _0x14d686=_0x38945f['currentUser']['id'];function _0x14d864(_0x307ab2){const _0x7a4c56=_0x1e43;let _0x15b9b6=dbFileIndexTable[_0x7a4c56(0x25c)](_0x38945f[_0x7a4c56(0x25a)][_0x7a4c56(0x235)],_0x307ab2,dbFileIndexTable['INDEX_TABLE_NAME_MUSIC']);if(!_0x15b9b6)return;let _0x1eb9fd=new Date()['getTime']();_0x38945f['app'][_0x7a4c56(0x235)]['prepare'](_0x7a4c56(0x1e1))[_0x7a4c56(0x203)](_0x1eb9fd,_0x307ab2),dbMusicFavorite[_0x7a4c56(0x21d)](_0x38945f[_0x7a4c56(0x25a)]['dbFileIndex'],_0x14d686,_0x307ab2);}if(_0x38945f[_0x32a910(0x273)]['musicIndexId']instanceof Array){let _0x1682b6=_0x38945f[_0x32a910(0x273)][_0x32a910(0x251)];if(_0x1682b6==_0x32a910(0x230))for(let _0x85165 of _0x38945f['body'][_0x32a910(0x245)]){_0x14d864(_0x85165);}else{if(_0x1682b6==_0x32a910(0x27e))for(let _0x1f93d1 of _0x38945f[_0x32a910(0x273)][_0x32a910(0x245)]){dbMusicFavorite[_0x32a910(0x242)](_0x38945f[_0x32a910(0x25a)]['dbFileIndex'],_0x14d686,_0x1f93d1);}}return _0x58208e[_0x32a910(0x261)]({'code':0x0});}else{let _0x1cbc70=parseInt(_0x38945f[_0x32a910(0x273)]['musicIndexId']),_0x9acbfb=dbMusicFavorite[_0x32a910(0x28a)](_0x38945f[_0x32a910(0x25a)]['dbFileIndex'],_0x14d686,_0x1cbc70),_0x25fe42=0x0;return _0x9acbfb?dbMusicFavorite[_0x32a910(0x242)](_0x38945f['app'][_0x32a910(0x235)],_0x14d686,_0x1cbc70):(_0x25fe42=0x1,_0x14d864(_0x1cbc70)),_0x58208e[_0x32a910(0x261)]({'code':0x0,'favorite':_0x25fe42});}}),router[_0x2e6e3b(0x287)](_0x2e6e3b(0x23a),(_0x5b6a86,_0x352ea,_0x5c98e5)=>{const _0x48761a=_0x2e6e3b;let _0x2ac6cd=_0x5b6a86[_0x48761a(0x1f7)][_0x48761a(0x1e6)],_0x5d11f2=dbMusicIndexTable[_0x48761a(0x23c)](_0x5b6a86[_0x48761a(0x25a)]['dbFileIndex'],_0x2ac6cd),_0x4efdec=_0x5b6a86['query'][_0x48761a(0x22a)];!_0x4efdec&&(_0x4efdec=0x200);if(!_0x5d11f2||_0x5d11f2&&!_0x5d11f2[_0x48761a(0x200)])return _0x352ea[_0x48761a(0x213)](0x194)[_0x48761a(0x24e)]();if(dbUserTable[_0x48761a(0x247)](_0x5b6a86,_0x352ea,_0x48761a(0x291),'power_get',_0x5d11f2[_0x48761a(0x1e2)])==!![]){let _0x5d3bc4=path[_0x48761a(0x233)](_0x5d11f2[_0x48761a(0x1e2)],_0x5d11f2[_0x48761a(0x27d)]),_0x48f2ab=config[_0x48761a(0x1f4)](_0x5d11f2,_0x4efdec);if(fs[_0x48761a(0x289)](_0x48f2ab))return _0x352ea[_0x48761a(0x29b)](_0x48f2ab);jsmediatags[_0x48761a(0x226)](_0x5d3bc4,{'onSuccess':function(_0x1e3fa7){const _0x2205ba=_0x48761a;let _0x17b3e4=_0x1e3fa7[_0x2205ba(0x1e7)];var _0x3302c2;_0x17b3e4[_0x2205ba(0x22c)]&&_0x17b3e4[_0x2205ba(0x22c)]['data']&&(_0x3302c2=_0x17b3e4['picture'][_0x2205ba(0x231)]);!_0x3302c2&&_0x17b3e4[_0x2205ba(0x214)]&&_0x17b3e4['APIC'][_0x2205ba(0x231)]&&_0x17b3e4[_0x2205ba(0x214)][_0x2205ba(0x231)][_0x2205ba(0x231)]&&(_0x3302c2=_0x17b3e4[_0x2205ba(0x214)][_0x2205ba(0x231)][_0x2205ba(0x231)]);if(_0x3302c2){let _0xc881d0=path[_0x2205ba(0x233)](path['dirname'](_0x48f2ab),_0x2205ba(0x277)+path[_0x2205ba(0x1ec)](_0x48f2ab));fs['writeFile'](_0xc881d0,Buffer[_0x2205ba(0x20c)](_0x3302c2),{'encoding':_0x2205ba(0x288)},function(_0x183e65){const _0x3cefa6=_0x2205ba;if(!_0x183e65)sharpUtil[_0x3cefa6(0x1ee)](_0xc881d0,path['dirname'](_0x48f2ab),path['basename'](_0x48f2ab),_0x3cefa6(0x27b),null,_0x95a411=>{const _0x3c64d1=_0x3cefa6;return dbMusicIndexTable[_0x3c64d1(0x1f6)](_0x5b6a86[_0x3c64d1(0x25a)][_0x3c64d1(0x235)],_0x5d11f2['id'],_0x3c64d1(0x200),_0x48f2ab),fs['rm'](_0xc881d0,_0x4d4a5a=>{}),_0x352ea[_0x3c64d1(0x29b)](_0x48f2ab);},_0x1d790f=>{const _0x37f108=_0x3cefa6;return _0x352ea[_0x37f108(0x213)](0x194)[_0x37f108(0x24e)]();},_0x4efdec);else return _0x352ea[_0x3cefa6(0x213)](0x194)[_0x3cefa6(0x24e)]();});}else return _0x352ea[_0x2205ba(0x213)](0x194)[_0x2205ba(0x24e)]();},'onError':function(_0x9cc862){const _0x17441d=_0x48761a;return _0x352ea[_0x17441d(0x213)](0x194)[_0x17441d(0x24e)]();}});}}),router[_0x2e6e3b(0x283)]('/getGroupList',(_0x201527,_0xa4e5f4,_0x5e1b84)=>{const _0x3c7f8f=_0x2e6e3b;let _0x48d20e=_0x201527['body'][_0x3c7f8f(0x264)]||0x32,_0x28ca41=_0x201527[_0x3c7f8f(0x273)]['offset']||0x0,_0x4a9365=_0x201527[_0x3c7f8f(0x273)][_0x3c7f8f(0x20a)]||_0x3c7f8f(0x284),_0x5d319f=_0x201527[_0x3c7f8f(0x273)][_0x3c7f8f(0x22e)]||'check_time',_0x133fee=_0x201527[_0x3c7f8f(0x273)][_0x3c7f8f(0x1eb)]||'desc',_0x316016=_0x201527[_0x3c7f8f(0x273)]['search'],_0x1c1c79=_0x201527[_0x3c7f8f(0x273)][_0x3c7f8f(0x22d)];if(dbMusicIndexTable[_0x3c7f8f(0x24d)](_0x201527,_0xa4e5f4,_0x5d319f,_0x133fee)!==!![])return;let _0x160b74=['check_time',_0x3c7f8f(0x21b),'last_play_time',_0x3c7f8f(0x27d),_0x3c7f8f(0x236),'album',_0x3c7f8f(0x1fa),_0x3c7f8f(0x265),'id'],_0x4c128f=[_0x3c7f8f(0x20b),'desc'];if(!_0x160b74[_0x3c7f8f(0x26e)](_0x5d319f)||!_0x4c128f[_0x3c7f8f(0x26e)](_0x133fee))return _0x201527['app'][_0x3c7f8f(0x228)](_0xa4e5f4,'orderField/orderType\x20error',_0x5d319f,_0x133fee);let _0x2a1a93=dbUserTable[_0x3c7f8f(0x293)](_0x201527,_0x3c7f8f(0x291),_0x3c7f8f(0x249),!![]);if(_0x201527[_0x3c7f8f(0x1ef)][_0x3c7f8f(0x26b)]!=0x1&&!_0x2a1a93&&_0x4a9365!=_0x3c7f8f(0x271))return _0xa4e5f4['json']({'code':0x0,'data':null});let _0x5c1ea2=[];if(_0x4a9365==_0x3c7f8f(0x284)||_0x4a9365==_0x3c7f8f(0x1fa)){_0x5c1ea2=dbMusicIndexTable[_0x3c7f8f(0x21f)](_0x201527['app'][_0x3c7f8f(0x235)],_0x2a1a93,_0x4a9365,_0x48d20e,_0x28ca41,_0x5d319f,_0x133fee,_0x316016,_0x1c1c79);for(let _0x59f201 of _0x5c1ea2){_0x59f201[_0x3c7f8f(0x220)]=dbMusicIndexTable['getCoverByField'](_0x201527['app'][_0x3c7f8f(0x235)],_0x4a9365,_0x59f201[_0x4a9365],0x1,_0x2a1a93);}}else{if(_0x4a9365==_0x3c7f8f(0x271)){_0x5c1ea2=dbMusicPlaylistTable['getPlaylistList'](_0x201527[_0x3c7f8f(0x25a)]['dbFileIndex'],_0x201527[_0x3c7f8f(0x1ef)]['id'],_0x48d20e,_0x28ca41,'id',_0x3c7f8f(0x1f9),_0x316016);for(let _0x18a2a6 of _0x5c1ea2){_0x18a2a6[_0x3c7f8f(0x220)]=dbMusicIndexTable[_0x3c7f8f(0x28b)](_0x201527[_0x3c7f8f(0x25a)][_0x3c7f8f(0x235)],_0x18a2a6['id']);}}}return _0xa4e5f4['json']({'code':0x0,'data':_0x5c1ea2});}),router['post'](_0x2e6e3b(0x24b),(_0x161378,_0x1bd7bd,_0x24a0d0)=>{const _0x3e998f=_0x2e6e3b;let _0x3d3340=_0x161378[_0x3e998f(0x273)][_0x3e998f(0x28d)],_0x414f9c=_0x161378[_0x3e998f(0x273)][_0x3e998f(0x251)];if(_0x414f9c==_0x3e998f(0x230)){if(!_0x3d3340)return _0x161378[_0x3e998f(0x25a)][_0x3e998f(0x228)](_0x1bd7bd,_0x3e998f(0x267));dbMusicPlaylistTable['createPlaylist'](_0x161378[_0x3e998f(0x25a)][_0x3e998f(0x235)],_0x161378[_0x3e998f(0x1ef)]['id'],_0x3d3340);}else{if(_0x414f9c==_0x3e998f(0x20d)||_0x414f9c==_0x3e998f(0x27e)){let _0x1ff112=_0x161378[_0x3e998f(0x273)][_0x3e998f(0x252)],_0x853585=dbMusicPlaylistTable[_0x3e998f(0x1e9)](_0x161378[_0x3e998f(0x25a)]['dbFileIndex'],_0x1ff112),_0x3e08e5=![];(_0x161378[_0x3e998f(0x1ef)][_0x3e998f(0x26b)]==0x1||_0x853585[_0x3e998f(0x232)]==_0x161378[_0x3e998f(0x1ef)]['id'])&&(_0x3e08e5=!![]);if(!_0x3e08e5)return _0x1bd7bd[_0x3e998f(0x261)]({'code':0x66});if(_0x414f9c==_0x3e998f(0x27e))dbMusicPlaylistTable[_0x3e998f(0x258)](_0x161378['app'][_0x3e998f(0x235)],_0x1ff112);else{if(_0x414f9c==_0x3e998f(0x20d)){if(!_0x3d3340)return _0x161378[_0x3e998f(0x25a)][_0x3e998f(0x228)](_0x1bd7bd,_0x3e998f(0x267));dbMusicPlaylistTable['updatePlaylist'](_0x161378[_0x3e998f(0x25a)][_0x3e998f(0x235)],_0x1ff112,_0x3d3340);}}}else return _0x161378[_0x3e998f(0x25a)][_0x3e998f(0x228)](_0x1bd7bd,_0x3e998f(0x205));}return _0x1bd7bd[_0x3e998f(0x261)]({'code':0x0});}),router[_0x2e6e3b(0x283)](_0x2e6e3b(0x239),(_0x270ac4,_0x378556,_0x4674f3)=>{const _0x2496cb=_0x2e6e3b;let _0x2d6997=_0x270ac4[_0x2496cb(0x273)]['musicIndexId'],_0x43d131=_0x270ac4[_0x2496cb(0x273)][_0x2496cb(0x252)];if(!_0x2d6997||!_0x43d131)return _0x270ac4[_0x2496cb(0x25a)][_0x2496cb(0x228)](_0x378556,_0x2496cb(0x281));let _0x4909de=dbMusicPlaylistTable[_0x2496cb(0x1e9)](_0x270ac4[_0x2496cb(0x25a)]['dbFileIndex'],_0x43d131);if(!_0x4909de)return _0x270ac4[_0x2496cb(0x25a)][_0x2496cb(0x228)](_0x378556,_0x2496cb(0x270));let _0x3eafb6=_0x270ac4[_0x2496cb(0x273)][_0x2496cb(0x251)];if(_0x3eafb6=='add'){function _0x369674(_0xeaff98){const _0x4e5529=_0x2496cb;let _0x3e5dd1=dbMusicIndexTable[_0x4e5529(0x23c)](_0x270ac4[_0x4e5529(0x25a)][_0x4e5529(0x235)],_0xeaff98);if(!_0x3e5dd1)return;if(_0x3e5dd1[_0x4e5529(0x224)]==0x1){dbMusicPlaylistTable[_0x4e5529(0x294)](_0x270ac4['app']['dbFileIndex'],_0xeaff98,_0x43d131);let _0x2e841b=Date['now']();_0x270ac4[_0x4e5529(0x25a)]['dbFileIndex']['prepare']('UPDATE\x20file_index_music\x20set\x20check_time=?\x20WHERE\x20id=?')[_0x4e5529(0x203)](_0x2e841b,_0x3e5dd1['id']);}else{let _0xc9d333=path[_0x4e5529(0x233)](_0x3e5dd1['path'],_0x3e5dd1[_0x4e5529(0x27d)]),_0x505691=_0x270ac4[_0x4e5529(0x25a)][_0x4e5529(0x235)][_0x4e5529(0x234)](_0x4e5529(0x25f))['all'](_0xc9d333,_0xc9d333+path['sep']+'%');for(let _0x3ad76f of _0x505691){dbMusicPlaylistTable['addMusicToPlaylist'](_0x270ac4['app'][_0x4e5529(0x235)],_0x3ad76f['id'],_0x43d131);}}}if(_0x2d6997 instanceof Array)for(let _0x1efd8d of _0x2d6997){_0x369674(_0x1efd8d);}else _0x369674(_0x2d6997);}else{if(_0x3eafb6==_0x2496cb(0x27e)){if(_0x2d6997 instanceof Array)for(let _0x24404b of _0x2d6997){dbMusicPlaylistTable[_0x2496cb(0x23b)](_0x270ac4[_0x2496cb(0x25a)][_0x2496cb(0x235)],_0x24404b,_0x43d131);}else dbMusicPlaylistTable[_0x2496cb(0x23b)](_0x270ac4[_0x2496cb(0x25a)][_0x2496cb(0x235)],_0x2d6997,_0x43d131);}else return _0x270ac4['app'][_0x2496cb(0x228)](_0x378556,_0x2496cb(0x205));}return _0x378556[_0x2496cb(0x261)]({'code':0x0,'data':{}});}),router[_0x2e6e3b(0x283)](_0x2e6e3b(0x23f),(_0x5a2a73,_0x11e884,_0x2fdc72)=>{const _0x2f5994=_0x2e6e3b;let _0x321cff=_0x5a2a73[_0x2f5994(0x273)][_0x2f5994(0x210)],_0x3bcbb4=_0x5a2a73[_0x2f5994(0x273)][_0x2f5994(0x221)],_0x442b30=_0x2f5994(0x291),_0x2dd361=_0x5a2a73[_0x2f5994(0x273)][_0x2f5994(0x22e)]??_0x2f5994(0x27d),_0x17d388=_0x5a2a73[_0x2f5994(0x273)][_0x2f5994(0x1eb)]??_0x2f5994(0x20b);if(dbMusicIndexTable[_0x2f5994(0x24d)](_0x5a2a73,_0x11e884,_0x2dd361,_0x17d388)!==!![])return;if(dbUserTable['doUserCanGet'](_0x5a2a73,_0x11e884,_0x442b30,_0x2f5994(0x249))==!![]){let _0x1281c8=[];if(!_0x321cff){let _0x2a1353=[];_0x5a2a73[_0x2f5994(0x1ef)]['is_admin']==0x1?_0x2a1353=dbSourceFolderTable['getPathByType'](_0x5a2a73[_0x2f5994(0x25a)][_0x2f5994(0x27f)],_0x442b30):_0x2a1353=dbUserTable['getUserPower'](_0x5a2a73[_0x2f5994(0x25a)][_0x2f5994(0x27f)],_0x5a2a73[_0x2f5994(0x1ef)][_0x2f5994(0x248)],_0x442b30);if(_0x2a1353)for(let _0xb4974e=0x0;_0xb4974e<_0x2a1353[_0x2f5994(0x206)];_0xb4974e++){_0x1281c8['push']({'path':_0x2a1353[_0xb4974e]['path'],'is_file':0x0,'filename':path[_0x2f5994(0x1ec)](_0x2a1353[_0xb4974e][_0x2f5994(0x1e2)]),'root':!![]});}}else{let _0x30a0f8=[];if(_0x5a2a73[_0x2f5994(0x1ef)][_0x2f5994(0x26b)]!=0x1){if(dbUserTable[_0x2f5994(0x247)](_0x5a2a73,_0x11e884,_0x442b30,_0x2f5994(0x249),_0x321cff)!==!![])return;}_0x321cff=path[_0x2f5994(0x233)](_0x321cff);let _0x495986=_0x2f5994(0x1f5);_0x30a0f8[_0x2f5994(0x1f1)](_0x321cff),_0x495986+=_0x2f5994(0x26f);if(_0x3bcbb4){let _0x35520b=_0x2f5994(0x257);_0x495986+=_0x35520b,_0x30a0f8[_0x2f5994(0x1f1)]('%'+_0x3bcbb4+'%'),_0x30a0f8[_0x2f5994(0x1f1)]('%'+_0x3bcbb4+'%');}let _0x550bde='\x20is_file,id,path,filename,type,duration,size,title,album,artist,year,genre';_0x495986+=_0x2f5994(0x1ed)+_0x2dd361+'\x20'+_0x17d388,_0x1281c8=_0x5a2a73[_0x2f5994(0x25a)][_0x2f5994(0x235)][_0x2f5994(0x234)](_0x2f5994(0x20f)+_0x550bde+_0x2f5994(0x28e)+_0x495986)['all'](_0x30a0f8);}for(let _0x527889 of _0x1281c8){_0x527889[_0x2f5994(0x21e)]=dbMusicFavorite[_0x2f5994(0x1ea)](_0x5a2a73[_0x2f5994(0x25a)][_0x2f5994(0x235)],_0x527889['id'],_0x5a2a73['currentUser']['id'])?'1':'0';}let _0x57781b=path[_0x2f5994(0x259)],_0xcead1d={'code':0x0,'data':_0x1281c8,'sep':_0x57781b};return _0x11e884['json'](_0xcead1d);}}),module[_0x2e6e3b(0x237)]=router;