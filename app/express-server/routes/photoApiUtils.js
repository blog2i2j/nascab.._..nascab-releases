const _0xe6b7a7=_0x1d10;(function(_0x2ae682,_0x15069c){const _0x20f61e=_0x1d10,_0x3d79e0=_0x2ae682();while(!![]){try{const _0x49bdb3=-parseInt(_0x20f61e(0x215))/0x1*(parseInt(_0x20f61e(0x1f2))/0x2)+parseInt(_0x20f61e(0x20f))/0x3+parseInt(_0x20f61e(0x21c))/0x4+parseInt(_0x20f61e(0x1e7))/0x5+parseInt(_0x20f61e(0x21b))/0x6+parseInt(_0x20f61e(0x200))/0x7+-parseInt(_0x20f61e(0x224))/0x8*(parseInt(_0x20f61e(0x22e))/0x9);if(_0x49bdb3===_0x15069c)break;else _0x3d79e0['push'](_0x3d79e0['shift']());}catch(_0xa1c146){_0x3d79e0['push'](_0x3d79e0['shift']());}}}(_0x4141,0x60f38));let photoApiUtil={};function _0x1d10(_0x22ab96,_0x4d3fc4){const _0x414153=_0x4141();return _0x1d10=function(_0x1d10d9,_0x4e295d){_0x1d10d9=_0x1d10d9-0x1e3;let _0x5f0537=_0x414153[_0x1d10d9];return _0x5f0537;},_0x1d10(_0x22ab96,_0x4d3fc4);}const dbFileIndexTable=require(_0xe6b7a7(0x230)),dbSourceFolderTable=require(_0xe6b7a7(0x216));let checkUtil=require(_0xe6b7a7(0x201));const dbUserTable=require(_0xe6b7a7(0x1e6)),dbAlbumTable=require(_0xe6b7a7(0x1fb));function _0x4141(){const _0x507372=['\x20LIMIT\x20?','exports','INDEX_TABLE_NAME_PHOTO','Params\x20error\x20:\x20count','libraryId','\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)','getAllByWhereAndFieldFromAiClassesToIndex','fileType','dbOther','raw_filename','\x20AND\x20in_trash=1','\x20f.id,path,is_livephoto,is_raw,raw_filename,check_time,original_time,in_trash_time,original_date,filename,ext,type,f.width,f.height,duration,size,latitude,longitude,geohash,mode,tiny_path','\x20AND\x20','1035657SyippC','\x20>\x200','is_livephoto','\x20AND\x20is_livephoto=1','asc','aiClassId','4241SzXLvU','../../db/dbSourceFolderTable','\x20ORDER\x20BY\x20','\x20AND\x20is_show=1','timeType','sortType','4736022QVZuQp','334492suRHFe','getAllByWhereAndField','photo','parse','albumId','checkOrderParams','app','log','259432GEMoGW','length','timestamp','push','prepare','trash','>=?','\x20\x20AND\x20is_file=1\x20\x20','dbFileIndex','\x20AND\x20f.id\x20NOT\x20IN\x20(','378eAUWNP','sortField','../../db/dbFileIndexTable','Params\x20error\x20:\x20sortType','path','body','excludeIds','<=?\x20AND\x20','getAlbumWhereStr','doUserCanGet','../../db/dbUserTable','910580islbUa','get','faceId','Params\x20error\x20:\x20timestamp\x20/\x20timeType','power_get','getUserPathWhere','isNumber','getRawImageIndex','path_list','\x20AND\x20(type=?\x20\x20and\x20is_livephoto!=1)','filename','36jVKpzm','\x20GROUP\x20BY\x20f.id','Params\x20error\x20:\x20albumId','getPathWhere','getAllByWhereAndFieldFromFaceIndex','ordinaryAlbumId','\x20AND\x20in_trash=0','is_raw','Params\x20error\x20:\x20fileType','../../db/dbAlbumTable','getExcludePathWhereStr','livephotoIndex','searchStr','rawImageIndex','3046211hEAvFS','../utils/checkUtil'];_0x4141=function(){return _0x507372;};return _0x4141();}photoApiUtil['getPhotoByParams']=function(_0x2ab2c8,_0x1db194){const _0x1bfe99=_0xe6b7a7;if(dbUserTable[_0x1bfe99(0x1e5)](_0x2ab2c8,_0x1db194,'photo',_0x1bfe99(0x1eb),'',!![])!=!![])return[];let _0x3aed2d=_0x2ab2c8[_0x1bfe99(0x233)]['sourceFolderList'],_0x245dd7=dbUserTable[_0x1bfe99(0x1ec)](_0x2ab2c8,_0x1bfe99(0x21e),_0x1bfe99(0x1eb),!![],_0x3aed2d),_0xc20cb5=_0x1bfe99(0x20d),_0x5a3b3b=_0x2ab2c8['body'][_0x1bfe99(0x226)],_0x315576=_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x219)],_0x122f23=_0x2ab2c8[_0x1bfe99(0x233)]['count'],_0x565f54=_0x2ab2c8['body'][_0x1bfe99(0x209)],_0x4d3524=_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x229)],_0x226b33=_0x2ab2c8['body'][_0x1bfe99(0x22f)],_0x3d528=_0x2ab2c8['body'][_0x1bfe99(0x21a)],_0x54b33c=_0x2ab2c8[_0x1bfe99(0x233)]['geohash'],_0x2ee013=_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x1fe)],_0x1fec59=_0x2ab2c8['body'][_0x1bfe99(0x206)];if(dbFileIndexTable[_0x1bfe99(0x221)](_0x2ab2c8,_0x1db194,_0x226b33,_0x3d528)!==!![])return[];if(!checkUtil['arrayInCheck']([_0x1bfe99(0x213),'desc'],_0x3d528))return console['log'](_0x1bfe99(0x231)),[];if(!checkUtil[_0x1bfe99(0x1ed)](_0x5a3b3b)||!checkUtil['isNumber'](_0x315576))return console[_0x1bfe99(0x223)](_0x1bfe99(0x1ea)),[];let _0x1b06b1=_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x234)];if(!_0x315576||!_0x5a3b3b)return[];let _0x5662f2='',_0xe3e426=[];_0x315576==0x1?(_0x5662f2+='\x20'+_0x226b33+_0x1bfe99(0x1e3)+_0x226b33+_0x1bfe99(0x210),_0xe3e426[_0x1bfe99(0x227)](_0x5a3b3b)):(_0x5662f2+='\x20'+_0x226b33+_0x1bfe99(0x22a),_0xe3e426[_0x1bfe99(0x227)](_0x5a3b3b));let _0x47d691=_0x2ab2c8[_0x1bfe99(0x233)]['excludeIdsJson'];if(_0x47d691)try{_0x1b06b1=JSON[_0x1bfe99(0x21f)](_0x47d691);}catch(_0x17f4ef){console['log'](_0x17f4ef);}if(_0x1b06b1&&_0x1b06b1['length']>0x0){_0x5662f2+=_0x1bfe99(0x22d);for(let _0x85a434=0x0;_0x85a434<_0x1b06b1[_0x1bfe99(0x225)];_0x85a434++){_0x5662f2+=_0x1b06b1[_0x85a434],_0x85a434!=_0x1b06b1[_0x1bfe99(0x225)]-0x1&&(_0x5662f2+=',');}_0x5662f2+=')';}_0x54b33c&&(_0x5662f2+='\x20AND\x20geohash\x20LIKE\x20?\x20',_0xe3e426['push'](_0x54b33c+'%'));let _0x5243b7=dbSourceFolderTable[_0x1bfe99(0x1fc)](_0x2ab2c8[_0x1bfe99(0x222)]['dbOther'],_0x1bfe99(0x232),'excludePathPhoto');_0x5243b7&&(_0x5662f2+='\x20AND\x20'+_0x5243b7);let _0x1542b6=dbSourceFolderTable[_0x1bfe99(0x1fc)](_0x2ab2c8[_0x1bfe99(0x222)][_0x1bfe99(0x20a)],_0x1bfe99(0x1f1),'excludeFilenamePhoto');_0x1542b6&&(_0x5662f2+=_0x1bfe99(0x20e)+_0x1542b6);if(_0x565f54==0x0||!_0x565f54)_0x5662f2+='\x20AND\x20(type=1\x20or\x20type=2)';else{if(_0x565f54==0x1||_0x565f54==0x2){if(!checkUtil[_0x1bfe99(0x1ed)](_0x565f54))return console[_0x1bfe99(0x223)](_0x1bfe99(0x1fa)),[];_0x5662f2+=_0x1bfe99(0x1f0),_0xe3e426[_0x1bfe99(0x227)](_0x565f54);}else _0x565f54==0x3&&(_0x5662f2+=_0x1bfe99(0x212));}_0x2ee013&&(_0x5662f2+=_0x1bfe99(0x207),_0xe3e426[_0x1bfe99(0x227)]('%'+_0x2ee013+'%'),_0xe3e426[_0x1bfe99(0x227)]('%'+_0x2ee013+'%'));!_0x4d3524||_0x4d3524==0x0?(_0x5662f2+=_0x1bfe99(0x1f8),_0x5662f2+=_0x1bfe99(0x218)):_0x5662f2+=_0x1bfe99(0x20c);if(_0x1fec59){let _0x1ac096=_0x2ab2c8[_0x1bfe99(0x222)]['dbFileIndex'][_0x1bfe99(0x228)]('SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?')[_0x1bfe99(0x1e8)](_0x1fec59);if(_0x1ac096)try{let _0x3dd82d=JSON[_0x1bfe99(0x21f)](_0x1ac096[_0x1bfe99(0x1ef)]),_0x50ac6d=dbUserTable[_0x1bfe99(0x1f5)](!![],_0x3dd82d);_0x5662f2+=_0x50ac6d;}catch(_0x79eb38){console[_0x1bfe99(0x223)](_0x79eb38);}}if(_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x220)]){if(!checkUtil[_0x1bfe99(0x1ed)](_0x2ab2c8[_0x1bfe99(0x233)]['albumId']))return console[_0x1bfe99(0x223)](_0x1bfe99(0x1f4)),[];let _0x14573f=dbAlbumTable[_0x1bfe99(0x1e4)](_0x2ab2c8[_0x1bfe99(0x222)][_0x1bfe99(0x20a)],_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x220)]);_0x14573f&&(_0x5662f2+=_0x1bfe99(0x20e)+_0x14573f);}_0x5662f2+=_0x245dd7,_0x5662f2+=_0x1bfe99(0x22b);(_0x2ab2c8['body']['aiClassId']||_0x2ab2c8[_0x1bfe99(0x233)]['faceId'])&&(_0x5662f2+=_0x1bfe99(0x1f3));_0x5662f2+=_0x1bfe99(0x217)+_0x226b33+'\x20'+_0x3d528;!_0x122f23&&(_0x122f23=0x32);if(!checkUtil[_0x1bfe99(0x1ed)](_0x122f23))return console[_0x1bfe99(0x223)](_0x1bfe99(0x205)),[];_0x5662f2+=_0x1bfe99(0x202),_0xe3e426[_0x1bfe99(0x227)](_0x122f23);let _0x1570ac=[];if(_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x1f7)])_0x1570ac=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbum'](_0x2ab2c8['app']['dbFileIndex'],_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x1f7)],_0x5662f2,_0xc20cb5,_0xe3e426);else{if(_0x2ab2c8[_0x1bfe99(0x233)]['aiClassId'])_0x1570ac=dbFileIndexTable[_0x1bfe99(0x208)](_0x2ab2c8[_0x1bfe99(0x222)][_0x1bfe99(0x22c)],_0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x214)],_0x5662f2,_0xc20cb5,_0xe3e426);else _0x2ab2c8[_0x1bfe99(0x233)][_0x1bfe99(0x1e9)]?_0x1570ac=dbFileIndexTable[_0x1bfe99(0x1f6)](_0x2ab2c8['app'][_0x1bfe99(0x22c)],_0x2ab2c8[_0x1bfe99(0x233)]['faceId'],_0x5662f2,_0xc20cb5,_0xe3e426):_0x1570ac=dbFileIndexTable[_0x1bfe99(0x21d)](_0x2ab2c8[_0x1bfe99(0x222)][_0x1bfe99(0x22c)],_0x5662f2,_0xc20cb5,dbFileIndexTable[_0x1bfe99(0x204)],_0xe3e426);}if(_0x1570ac&&_0x1570ac[_0x1bfe99(0x225)]>0x0)for(let _0x3df1a5 in _0x1570ac){_0x1570ac[_0x3df1a5][_0x1bfe99(0x211)]==0x1&&(_0x1570ac[_0x3df1a5][_0x1bfe99(0x1fd)]=dbFileIndexTable['getLivePhotoIndex'](_0x2ab2c8['app'][_0x1bfe99(0x22c)],_0x1570ac[_0x3df1a5],_0xc20cb5));if(_0x1570ac[_0x3df1a5][_0x1bfe99(0x1f9)]==0x0&&_0x1570ac[_0x3df1a5][_0x1bfe99(0x20b)]!=null&&_0x1570ac[_0x3df1a5][_0x1bfe99(0x20b)]!=''){let _0x48c872=dbFileIndexTable[_0x1bfe99(0x1ee)](_0x2ab2c8[_0x1bfe99(0x222)][_0x1bfe99(0x22c)],_0x1570ac[_0x3df1a5],_0xc20cb5);_0x48c872&&(_0x1570ac[_0x3df1a5][_0x1bfe99(0x1ff)]=_0x48c872);}}return _0x1570ac;},module[_0xe6b7a7(0x203)]=photoApiUtil;