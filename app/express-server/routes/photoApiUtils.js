const _0x3369a4=_0x3823;(function(_0x5e713c,_0x2c62d0){const _0x1cbf6d=_0x3823,_0x31fad5=_0x5e713c();while(!![]){try{const _0x3337e7=parseInt(_0x1cbf6d(0x10f))/0x1*(parseInt(_0x1cbf6d(0xef))/0x2)+-parseInt(_0x1cbf6d(0x125))/0x3*(-parseInt(_0x1cbf6d(0xea))/0x4)+-parseInt(_0x1cbf6d(0x120))/0x5*(-parseInt(_0x1cbf6d(0xe8))/0x6)+-parseInt(_0x1cbf6d(0x112))/0x7+-parseInt(_0x1cbf6d(0xe4))/0x8*(parseInt(_0x1cbf6d(0x11f))/0x9)+-parseInt(_0x1cbf6d(0x11a))/0xa*(parseInt(_0x1cbf6d(0x110))/0xb)+parseInt(_0x1cbf6d(0xe6))/0xc;if(_0x3337e7===_0x2c62d0)break;else _0x31fad5['push'](_0x31fad5['shift']());}catch(_0x3f0972){_0x31fad5['push'](_0x31fad5['shift']());}}}(_0x4ea2,0x709bb));let photoApiUtil={};const dbFileIndexTable=require('../../db/dbFileIndexTable'),dbSourceFolderTable=require(_0x3369a4(0x122));function _0x3823(_0x1e39fd,_0x1f3d46){const _0x4ea21f=_0x4ea2();return _0x3823=function(_0x3823da,_0x48c2c6){_0x3823da=_0x3823da-0xdf;let _0x3f4b25=_0x4ea21f[_0x3823da];return _0x3f4b25;},_0x3823(_0x1e39fd,_0x1f3d46);}function _0x4ea2(){const _0x2a48ae=['8QYNIRk','\x20f.id,path,is_livephoto,is_raw,raw_filename,check_time,original_time,in_trash_time,original_date,filename,ext,type,f.width,f.height,duration,size,latitude,longitude,geohash,mode,tiny_path','app','albumId','rawImageIndex','16wpcUoN','Params\x20error\x20:\x20sortType','>=?','desc','dbFileIndex','is_livephoto','ordinaryAlbumId','excludePathPhoto','\x20ORDER\x20BY\x20','\x20AND\x20(type=1\x20or\x20type=2)','dbOther','\x20>\x200','getPhotoByParams','getAllByWhereAndFieldFromOrdinaryAlbum','push','faceId','getPathWhere','doUserCanGet','\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)','photo','path','getAllByWhereAndFieldFromFaceIndex','\x20AND\x20is_livephoto=1','getUserPathWhere','filename','../utils/checkUtil','\x20LIMIT\x20?','getExcludePathWhereStr','exports','get','parse','body','95983FtVFPr','1204522XYMdYC','sortType','5230575UnxtNX','raw_filename','sourceFolderList','getRawImageIndex','\x20AND\x20in_trash=1','<=?\x20AND\x20','excludeIdsJson','excludeFilenamePhoto','20CdhKBq','geohash','arrayInCheck','timestamp','\x20AND\x20geohash\x20LIKE\x20?\x20','6651IFwClo','55GhajQn','count','../../db/dbSourceFolderTable','getAlbumWhereStr','Params\x20error\x20:\x20count','1382424RtWGAD','\x20AND\x20(type=?\x20\x20and\x20is_livephoto!=1)','prepare','\x20AND\x20f.id\x20NOT\x20IN\x20(','\x20AND\x20','../../db/dbUserTable','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','livephotoIndex','../../db/dbAlbumTable','log','power_get','getAllByWhereAndField','isNumber','checkOrderParams','length','8656NPnQwW','aiClassId','453792MEtRVO','getAllByWhereAndFieldFromAiClassesToIndex','272604vCmmVY','Params\x20error\x20:\x20timestamp\x20/\x20timeType'];_0x4ea2=function(){return _0x2a48ae;};return _0x4ea2();}let checkUtil=require(_0x3369a4(0x108));const dbUserTable=require(_0x3369a4(0x12a)),dbAlbumTable=require(_0x3369a4(0x12d));photoApiUtil[_0x3369a4(0xfb)]=function(_0x3c3cc4,_0xf21e03){const _0x422c99=_0x3369a4;if(dbUserTable[_0x422c99(0x100)](_0x3c3cc4,_0xf21e03,_0x422c99(0x102),'power_get','',!![])!=!![])return[];let _0x188a83=_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0x114)],_0x3dafe6=dbUserTable[_0x422c99(0x106)](_0x3c3cc4,_0x422c99(0x102),_0x422c99(0xdf),!![],_0x188a83),_0x16744=_0x422c99(0xeb),_0x961476=_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0x11d)],_0x5e912b=_0x3c3cc4[_0x422c99(0x10e)]['timeType'],_0x267e54=_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0x121)],_0x1f3543=_0x3c3cc4[_0x422c99(0x10e)]['fileType'],_0x2c5eaa=_0x3c3cc4[_0x422c99(0x10e)]['trash'],_0x47f9cf=_0x3c3cc4[_0x422c99(0x10e)]['sortField'],_0x3f6848=_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0x111)],_0x40a0ed=_0x3c3cc4['body'][_0x422c99(0x11b)],_0x28d6d4=_0x3c3cc4[_0x422c99(0x10e)]['searchStr'],_0x1a199e=_0x3c3cc4[_0x422c99(0x10e)]['libraryId'];if(dbFileIndexTable[_0x422c99(0xe2)](_0x3c3cc4,_0xf21e03,_0x47f9cf,_0x3f6848)!==!![])return[];if(!checkUtil[_0x422c99(0x11c)](['asc',_0x422c99(0xf2)],_0x3f6848))return console[_0x422c99(0x12e)](_0x422c99(0xf0)),[];if(!checkUtil[_0x422c99(0xe1)](_0x961476)||!checkUtil['isNumber'](_0x5e912b))return console[_0x422c99(0x12e)](_0x422c99(0xe9)),[];let _0x381489=_0x3c3cc4[_0x422c99(0x10e)]['excludeIds'];if(!_0x5e912b||!_0x961476)return[];let _0x404516='',_0x3a597d=[];_0x5e912b==0x1?(_0x404516+='\x20'+_0x47f9cf+_0x422c99(0x117)+_0x47f9cf+_0x422c99(0xfa),_0x3a597d[_0x422c99(0xfd)](_0x961476)):(_0x404516+='\x20'+_0x47f9cf+_0x422c99(0xf1),_0x3a597d[_0x422c99(0xfd)](_0x961476));let _0x59a9e6=_0x3c3cc4['body'][_0x422c99(0x118)];if(_0x59a9e6)try{_0x381489=JSON['parse'](_0x59a9e6);}catch(_0x12e6f1){console[_0x422c99(0x12e)](_0x12e6f1);}if(_0x381489&&_0x381489[_0x422c99(0xe3)]>0x0){_0x404516+=_0x422c99(0x128);for(let _0x22c735=0x0;_0x22c735<_0x381489[_0x422c99(0xe3)];_0x22c735++){_0x404516+=_0x381489[_0x22c735],_0x22c735!=_0x381489['length']-0x1&&(_0x404516+=',');}_0x404516+=')';}_0x40a0ed&&(_0x404516+=_0x422c99(0x11e),_0x3a597d[_0x422c99(0xfd)](_0x40a0ed+'%'));let _0x12c3a8=dbSourceFolderTable[_0x422c99(0x10a)](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf9)],_0x422c99(0x103),_0x422c99(0xf6));_0x12c3a8&&(_0x404516+=_0x422c99(0x129)+_0x12c3a8);let _0x1ae809=dbSourceFolderTable['getExcludePathWhereStr'](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf9)],_0x422c99(0x107),_0x422c99(0x119));_0x1ae809&&(_0x404516+='\x20AND\x20'+_0x1ae809);if(_0x1f3543==0x0||!_0x1f3543)_0x404516+=_0x422c99(0xf8);else{if(_0x1f3543==0x1||_0x1f3543==0x2){if(!checkUtil[_0x422c99(0xe1)](_0x1f3543))return console[_0x422c99(0x12e)]('Params\x20error\x20:\x20fileType'),[];_0x404516+=_0x422c99(0x126),_0x3a597d[_0x422c99(0xfd)](_0x1f3543);}else _0x1f3543==0x3&&(_0x404516+=_0x422c99(0x105));}_0x28d6d4&&(_0x404516+=_0x422c99(0x101),_0x3a597d[_0x422c99(0xfd)]('%'+_0x28d6d4+'%'),_0x3a597d[_0x422c99(0xfd)]('%'+_0x28d6d4+'%'));!_0x2c5eaa||_0x2c5eaa==0x0?(_0x404516+='\x20AND\x20in_trash=0',_0x404516+='\x20AND\x20is_show=1'):_0x404516+=_0x422c99(0x116);if(_0x1a199e){let _0x1675c4=_0x3c3cc4[_0x422c99(0xec)]['dbFileIndex'][_0x422c99(0x127)](_0x422c99(0x12b))[_0x422c99(0x10c)](_0x1a199e);if(_0x1675c4)try{let _0x8ca4d2=JSON[_0x422c99(0x10d)](_0x1675c4['path_list']),_0x3b82e6=dbUserTable[_0x422c99(0xff)](!![],_0x8ca4d2);_0x404516+=_0x3b82e6;}catch(_0x3be4e2){console[_0x422c99(0x12e)](_0x3be4e2);}}if(_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xed)]){if(!checkUtil[_0x422c99(0xe1)](_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xed)]))return console[_0x422c99(0x12e)]('Params\x20error\x20:\x20albumId'),[];let _0x320725=dbAlbumTable[_0x422c99(0x123)](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf9)],_0x3c3cc4['body']['albumId']);_0x320725&&(_0x404516+=_0x422c99(0x129)+_0x320725);}_0x404516+=_0x3dafe6,_0x404516+='\x20\x20AND\x20is_file=1\x20\x20';(_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xe5)]||_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xfe)])&&(_0x404516+='\x20GROUP\x20BY\x20f.id');_0x404516+=_0x422c99(0xf7)+_0x47f9cf+'\x20'+_0x3f6848;!_0x267e54&&(_0x267e54=0x32);if(!checkUtil[_0x422c99(0xe1)](_0x267e54))return console[_0x422c99(0x12e)](_0x422c99(0x124)),[];_0x404516+=_0x422c99(0x109),_0x3a597d[_0x422c99(0xfd)](_0x267e54);let _0x1243e2=[];if(_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xf5)])_0x1243e2=dbFileIndexTable[_0x422c99(0xfc)](_0x3c3cc4['app'][_0x422c99(0xf3)],_0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xf5)],_0x404516,_0x16744,_0x3a597d);else{if(_0x3c3cc4[_0x422c99(0x10e)]['aiClassId'])_0x1243e2=dbFileIndexTable[_0x422c99(0xe7)](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf3)],_0x3c3cc4[_0x422c99(0x10e)]['aiClassId'],_0x404516,_0x16744,_0x3a597d);else _0x3c3cc4[_0x422c99(0x10e)][_0x422c99(0xfe)]?_0x1243e2=dbFileIndexTable[_0x422c99(0x104)](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf3)],_0x3c3cc4['body']['faceId'],_0x404516,_0x16744,_0x3a597d):_0x1243e2=dbFileIndexTable[_0x422c99(0xe0)](_0x3c3cc4[_0x422c99(0xec)][_0x422c99(0xf3)],_0x404516,_0x16744,dbFileIndexTable['INDEX_TABLE_NAME_PHOTO'],_0x3a597d);}if(_0x1243e2&&_0x1243e2[_0x422c99(0xe3)]>0x0)for(let _0x18da4b in _0x1243e2){_0x1243e2[_0x18da4b][_0x422c99(0xf4)]==0x1&&(_0x1243e2[_0x18da4b][_0x422c99(0x12c)]=dbFileIndexTable['getLivePhotoIndex'](_0x3c3cc4[_0x422c99(0xec)]['dbFileIndex'],_0x1243e2[_0x18da4b],_0x16744));if(_0x1243e2[_0x18da4b]['is_raw']==0x0&&_0x1243e2[_0x18da4b][_0x422c99(0x113)]!=null&&_0x1243e2[_0x18da4b][_0x422c99(0x113)]!=''){let _0x4c5953=dbFileIndexTable[_0x422c99(0x115)](_0x3c3cc4[_0x422c99(0xec)]['dbFileIndex'],_0x1243e2[_0x18da4b],_0x16744);_0x4c5953&&(_0x1243e2[_0x18da4b][_0x422c99(0xee)]=_0x4c5953);}}return _0x1243e2;},module[_0x3369a4(0x10b)]=photoApiUtil;