const _0x269677=_0x5126;(function(_0x3f40d3,_0x3a28bc){const _0x31741c=_0x5126,_0x539d0a=_0x3f40d3();while(!![]){try{const _0x47df7e=parseInt(_0x31741c(0x1e6))/0x1*(parseInt(_0x31741c(0x222))/0x2)+-parseInt(_0x31741c(0x1e2))/0x3*(-parseInt(_0x31741c(0x210))/0x4)+parseInt(_0x31741c(0x221))/0x5*(parseInt(_0x31741c(0x1ff))/0x6)+-parseInt(_0x31741c(0x1f8))/0x7*(parseInt(_0x31741c(0x223))/0x8)+parseInt(_0x31741c(0x1e9))/0x9+-parseInt(_0x31741c(0x217))/0xa*(parseInt(_0x31741c(0x205))/0xb)+-parseInt(_0x31741c(0x1ef))/0xc;if(_0x47df7e===_0x3a28bc)break;else _0x539d0a['push'](_0x539d0a['shift']());}catch(_0x4a7c17){_0x539d0a['push'](_0x539d0a['shift']());}}}(_0x4eda,0xbe2b7));let photoApiUtil={};const dbFileIndexTable=require('../../db/dbFileIndexTable'),dbSourceFolderTable=require('../../db/dbSourceFolderTable');let checkUtil=require(_0x269677(0x1d5));function _0x4eda(){const _0xad7f4c=['aiClassId','geohash','albumId','excludeIdsJson','SELECT\x20*\x20FROM\x20photo_library\x20WHERE\x20id=?','>=?','searchStr','\x20AND\x20(type=?\x20\x20and\x20is_livephoto!=1)','680uwVsqz','434ugFyeE','2752iCBeQn','<=?\x20AND\x20','doUserCanGet','path_list','\x20AND\x20geohash\x20LIKE\x20?\x20','../utils/checkUtil','getUserPathWhere','Params\x20error\x20:\x20timestamp\x20/\x20timeType','push','dbOther','path','\x20AND\x20f.id\x20NOT\x20IN\x20(','get','fileType','../../db/dbAlbumTable','desc','getLivePhotoIndex','\x20ORDER\x20BY\x20','6wPwAZv','timeType','getRawImageIndex','\x20AND\x20','521zUZcse','\x20GROUP\x20BY\x20f.id','isNumber','13647573ydCKUY','count','app','sourceFolderList','power_get','length','11650788FHAYAQ','asc','getAlbumWhereStr','body','is_livephoto','\x20LIMIT\x20?','\x20\x20AND\x20is_file=1\x20\x20','\x20AND\x20in_trash=0','faceId','20755FJopFx','\x20>\x200','excludePathPhoto','getAllByWhereAndFieldFromFaceIndex','prepare','\x20AND\x20in_trash=1','ordinaryAlbumId','25050hYaZht','is_raw','getAllByWhereAndFieldFromAiClassesToIndex','getPathWhere','dbFileIndex','arrayInCheck','264sGUJwX','filename','\x20f.id,path,is_livephoto,is_raw,raw_filename,check_time,original_time,in_trash_time,original_date,filename,ext,type,f.width,f.height,duration,size,latitude,longitude,geohash,mode,tiny_path','log','Params\x20error\x20:\x20count','excludeIds','Params\x20error\x20:\x20sortType','../../db/dbUserTable','Params\x20error\x20:\x20fileType','libraryId','timestamp','2298664hWSMaN','sortField','photo','parse','\x20AND\x20is_show=1','trash','raw_filename','240330HDFBKb','getExcludePathWhereStr'];_0x4eda=function(){return _0xad7f4c;};return _0x4eda();}const dbUserTable=require(_0x269677(0x20c)),dbAlbumTable=require(_0x269677(0x1de));function _0x5126(_0xa5c91d,_0x32d86f){const _0x4edac3=_0x4eda();return _0x5126=function(_0x5126ac,_0x5f4edc){_0x5126ac=_0x5126ac-0x1d1;let _0xee8ac8=_0x4edac3[_0x5126ac];return _0xee8ac8;},_0x5126(_0xa5c91d,_0x32d86f);}photoApiUtil['getPhotoByParams']=function(_0x3bad8f,_0x4de75c){const _0x283546=_0x269677;if(dbUserTable[_0x283546(0x1d2)](_0x3bad8f,_0x4de75c,_0x283546(0x212),_0x283546(0x1ed),'',!![])!=!![])return[];let _0x390258=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x1ec)],_0x41ee39=dbUserTable[_0x283546(0x1d6)](_0x3bad8f,_0x283546(0x212),'power_get',!![],_0x390258),_0x531cc5=_0x283546(0x207),_0x3fc42d=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x20f)],_0x56b5c8=_0x3bad8f['body'][_0x283546(0x1e3)],_0x310cf4=_0x3bad8f['body'][_0x283546(0x1ea)],_0x41caa3=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x1dd)],_0x531402=_0x3bad8f['body'][_0x283546(0x215)],_0x5ce5bb=_0x3bad8f['body'][_0x283546(0x211)],_0x1aba74=_0x3bad8f['body']['sortType'],_0x822aa4=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x21a)],_0x1f8d77=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x21f)],_0x271918=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x20e)];if(dbFileIndexTable['checkOrderParams'](_0x3bad8f,_0x4de75c,_0x5ce5bb,_0x1aba74)!==!![])return[];if(!checkUtil[_0x283546(0x204)]([_0x283546(0x1f0),_0x283546(0x1df)],_0x1aba74))return console[_0x283546(0x208)](_0x283546(0x20b)),[];if(!checkUtil[_0x283546(0x1e8)](_0x3fc42d)||!checkUtil['isNumber'](_0x56b5c8))return console[_0x283546(0x208)](_0x283546(0x1d7)),[];let _0x458b9f=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x20a)];if(!_0x56b5c8||!_0x3fc42d)return[];let _0x4147e='',_0x3892c8=[];_0x56b5c8==0x1?(_0x4147e+='\x20'+_0x5ce5bb+_0x283546(0x1d1)+_0x5ce5bb+_0x283546(0x1f9),_0x3892c8[_0x283546(0x1d8)](_0x3fc42d)):(_0x4147e+='\x20'+_0x5ce5bb+_0x283546(0x21e),_0x3892c8['push'](_0x3fc42d));let _0x3d9a47=_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x21c)];if(_0x3d9a47)try{_0x458b9f=JSON[_0x283546(0x213)](_0x3d9a47);}catch(_0x55dd15){console[_0x283546(0x208)](_0x55dd15);}if(_0x458b9f&&_0x458b9f[_0x283546(0x1ee)]>0x0){_0x4147e+=_0x283546(0x1db);for(let _0x3fce7d=0x0;_0x3fce7d<_0x458b9f[_0x283546(0x1ee)];_0x3fce7d++){_0x4147e+=_0x458b9f[_0x3fce7d],_0x3fce7d!=_0x458b9f[_0x283546(0x1ee)]-0x1&&(_0x4147e+=',');}_0x4147e+=')';}_0x822aa4&&(_0x4147e+=_0x283546(0x1d4),_0x3892c8[_0x283546(0x1d8)](_0x822aa4+'%'));let _0x30e85e=dbSourceFolderTable[_0x283546(0x218)](_0x3bad8f['app'][_0x283546(0x1d9)],_0x283546(0x1da),_0x283546(0x1fa));_0x30e85e&&(_0x4147e+=_0x283546(0x1e5)+_0x30e85e);let _0x3ef058=dbSourceFolderTable[_0x283546(0x218)](_0x3bad8f['app'][_0x283546(0x1d9)],_0x283546(0x206),'excludeFilenamePhoto');_0x3ef058&&(_0x4147e+=_0x283546(0x1e5)+_0x3ef058);if(_0x41caa3==0x0||!_0x41caa3)_0x4147e+='\x20AND\x20(type=1\x20or\x20type=2)';else{if(_0x41caa3==0x1||_0x41caa3==0x2){if(!checkUtil[_0x283546(0x1e8)](_0x41caa3))return console[_0x283546(0x208)](_0x283546(0x20d)),[];_0x4147e+=_0x283546(0x220),_0x3892c8['push'](_0x41caa3);}else _0x41caa3==0x3&&(_0x4147e+='\x20AND\x20is_livephoto=1');}_0x1f8d77&&(_0x4147e+='\x20AND\x20(filename\x20LIKE\x20?\x20OR\x20mode\x20\x20LIKE\x20?)',_0x3892c8[_0x283546(0x1d8)]('%'+_0x1f8d77+'%'),_0x3892c8[_0x283546(0x1d8)]('%'+_0x1f8d77+'%'));!_0x531402||_0x531402==0x0?(_0x4147e+=_0x283546(0x1f6),_0x4147e+=_0x283546(0x214)):_0x4147e+=_0x283546(0x1fd);if(_0x271918){let _0x136c88=_0x3bad8f['app']['dbFileIndex'][_0x283546(0x1fc)](_0x283546(0x21d))[_0x283546(0x1dc)](_0x271918);if(_0x136c88)try{let _0x48b2d0=JSON[_0x283546(0x213)](_0x136c88[_0x283546(0x1d3)]),_0x5a0650=dbUserTable[_0x283546(0x202)](!![],_0x48b2d0);_0x4147e+=_0x5a0650;}catch(_0x559f81){console['log'](_0x559f81);}}if(_0x3bad8f['body'][_0x283546(0x21b)]){if(!checkUtil[_0x283546(0x1e8)](_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x21b)]))return console[_0x283546(0x208)]('Params\x20error\x20:\x20albumId'),[];let _0x362706=dbAlbumTable[_0x283546(0x1f1)](_0x3bad8f[_0x283546(0x1eb)][_0x283546(0x1d9)],_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x21b)]);_0x362706&&(_0x4147e+=_0x283546(0x1e5)+_0x362706);}_0x4147e+=_0x41ee39,_0x4147e+=_0x283546(0x1f5);(_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x219)]||_0x3bad8f['body'][_0x283546(0x1f7)])&&(_0x4147e+=_0x283546(0x1e7));_0x4147e+=_0x283546(0x1e1)+_0x5ce5bb+'\x20'+_0x1aba74;!_0x310cf4&&(_0x310cf4=0x32);if(!checkUtil['isNumber'](_0x310cf4))return console['log'](_0x283546(0x209)),[];_0x4147e+=_0x283546(0x1f4),_0x3892c8['push'](_0x310cf4);let _0xee6afa=[];if(_0x3bad8f[_0x283546(0x1f2)]['ordinaryAlbumId'])_0xee6afa=dbFileIndexTable['getAllByWhereAndFieldFromOrdinaryAlbum'](_0x3bad8f[_0x283546(0x1eb)]['dbFileIndex'],_0x3bad8f['body'][_0x283546(0x1fe)],_0x4147e,_0x531cc5,_0x3892c8);else{if(_0x3bad8f[_0x283546(0x1f2)][_0x283546(0x219)])_0xee6afa=dbFileIndexTable[_0x283546(0x201)](_0x3bad8f[_0x283546(0x1eb)][_0x283546(0x203)],_0x3bad8f[_0x283546(0x1f2)]['aiClassId'],_0x4147e,_0x531cc5,_0x3892c8);else _0x3bad8f[_0x283546(0x1f2)]['faceId']?_0xee6afa=dbFileIndexTable[_0x283546(0x1fb)](_0x3bad8f[_0x283546(0x1eb)][_0x283546(0x203)],_0x3bad8f['body'][_0x283546(0x1f7)],_0x4147e,_0x531cc5,_0x3892c8):_0xee6afa=dbFileIndexTable['getAllByWhereAndField'](_0x3bad8f['app'][_0x283546(0x203)],_0x4147e,_0x531cc5,dbFileIndexTable['INDEX_TABLE_NAME_PHOTO'],_0x3892c8);}if(_0xee6afa&&_0xee6afa['length']>0x0)for(let _0x490215 in _0xee6afa){_0xee6afa[_0x490215][_0x283546(0x1f3)]==0x1&&(_0xee6afa[_0x490215]['livephotoIndex']=dbFileIndexTable[_0x283546(0x1e0)](_0x3bad8f[_0x283546(0x1eb)][_0x283546(0x203)],_0xee6afa[_0x490215],_0x531cc5));if(_0xee6afa[_0x490215][_0x283546(0x200)]==0x0&&_0xee6afa[_0x490215][_0x283546(0x216)]!=null&&_0xee6afa[_0x490215][_0x283546(0x216)]!=''){let _0x16b185=dbFileIndexTable[_0x283546(0x1e4)](_0x3bad8f[_0x283546(0x1eb)][_0x283546(0x203)],_0xee6afa[_0x490215],_0x531cc5);_0x16b185&&(_0xee6afa[_0x490215]['rawImageIndex']=_0x16b185);}}return _0xee6afa;},module['exports']=photoApiUtil;