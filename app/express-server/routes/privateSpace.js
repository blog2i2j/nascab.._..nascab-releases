const _0x35d1b7=_0x5360;(function(_0x58393f,_0xcacda4){const _0x285041=_0x5360,_0x4be42c=_0x58393f();while(!![]){try{const _0x3e0882=parseInt(_0x285041(0x256))/0x1+-parseInt(_0x285041(0x29c))/0x2+parseInt(_0x285041(0x247))/0x3+-parseInt(_0x285041(0x2b6))/0x4*(-parseInt(_0x285041(0x26f))/0x5)+parseInt(_0x285041(0x20c))/0x6*(parseInt(_0x285041(0x233))/0x7)+parseInt(_0x285041(0x293))/0x8*(parseInt(_0x285041(0x276))/0x9)+parseInt(_0x285041(0x29b))/0xa*(-parseInt(_0x285041(0x209))/0xb);if(_0x3e0882===_0xcacda4)break;else _0x4be42c['push'](_0x4be42c['shift']());}catch(_0x5c9e52){_0x4be42c['push'](_0x4be42c['shift']());}}}(_0x1ac5,0x85467));let express=require(_0x35d1b7(0x2ad)),router=express[_0x35d1b7(0x24b)]();const Database=require('better-sqlite3');let dbPrivateSpaceTable=require('../../db/dbPrivateSpaceTable'),path=require('path'),fs=require('fs'),cryptoUtils=require(_0x35d1b7(0x286));const config=require(_0x35d1b7(0x254));let privateSpaceUtils=require(_0x35d1b7(0x244));var faststart=require(_0x35d1b7(0x26d)),exifUtil=require(_0x35d1b7(0x2aa));let uploadUtil=require(_0x35d1b7(0x215));const PassThrough=require(_0x35d1b7(0x295))['PassThrough'],{Readable}=require(_0x35d1b7(0x295));let sha256=require(_0x35d1b7(0x230));const videoStreamUtil=require(_0x35d1b7(0x264));let fileUtil=require(_0x35d1b7(0x228));const folderSignString=_0x35d1b7(0x1fa),folderSignFileName='nascabconfigenc',configFolderName=_0x35d1b7(0x1fb),noCheckFileList=[_0x35d1b7(0x22a)];let FFmpeg=require(_0x35d1b7(0x258))[_0x35d1b7(0x226)];const uploadPrivateUtil=require('../utils/uploadPrivateUtils'),privateSharpUtil=require(_0x35d1b7(0x244)),sharpUtil=require(_0x35d1b7(0x24e)),transCodeUtil=require('../../utils/transCodeUtil');let dbArr=[];function checkSpaceId(_0x5a946e,_0x208ee2){const _0x126213=_0x35d1b7;let _0xfbca=_0x5a946e[_0x126213(0x2b7)]['spaceId']||_0x5a946e[_0x126213(0x20a)][_0x126213(0x262)];if(!_0xfbca)return _0x5a946e['app'][_0x126213(0x255)](_0x208ee2,_0x126213(0x1fd));let _0x1ba191=dbPrivateSpaceTable[_0x126213(0x26e)](_0x5a946e[_0x126213(0x234)][_0x126213(0x240)],_0xfbca);if(!_0x1ba191)return _0x5a946e[_0x126213(0x234)]['returnErrMsg'](_0x208ee2,_0x126213(0x26b));return!![];}function checkSpaceName(_0x356552,_0x5f0588,_0x58c884){const _0x3d8adf=_0x35d1b7;if(!_0x58c884)return _0x356552[_0x3d8adf(0x234)][_0x3d8adf(0x255)](_0x5f0588,_0x5f0588['__'](_0x3d8adf(0x22d)));if(_0x58c884[_0x3d8adf(0x236)]>0x1e)return _0x356552[_0x3d8adf(0x234)][_0x3d8adf(0x255)](_0x5f0588,_0x5f0588['__'](_0x3d8adf(0x1fc)));return!![];}function getPrivateIndexDb(_0x527bbe){const _0x5f5956=_0x35d1b7;let _0x3b9e3d=config[_0x5f5956(0x2a1)](_0x527bbe);for(let _0x100e0a in dbArr){if(dbArr[_0x100e0a][_0x5f5956(0x246)]==_0x3b9e3d)return dbArr[_0x100e0a]['db'];}let _0x40a793=new Database(_0x3b9e3d,{});return _0x40a793['pragma'](_0x5f5956(0x279)),dbArr[_0x5f5956(0x26a)]({'dbPath':_0x3b9e3d,'db':_0x40a793}),_0x40a793;}router[_0x35d1b7(0x225)]('/addPrivateSpace',(_0x3b775e,_0x28dc73,_0x3fb313)=>{const _0x494fea=_0x35d1b7;let _0x145f4d=_0x3b775e[_0x494fea(0x2b7)][_0x494fea(0x252)],_0x31e11a=_0x3b775e[_0x494fea(0x2b7)]['spaceName'],_0x5a4a71=_0x3b775e['currentUser'],_0x483cb8=_0x3b775e['body']['spacePwd'];if(checkSpaceName(_0x3b775e,_0x28dc73,_0x31e11a)!==!![])return;if(!_0x483cb8||_0x483cb8['length']<0x4)return _0x3b775e[_0x494fea(0x234)][_0x494fea(0x255)](_0x28dc73,_0x28dc73['__'](_0x494fea(0x2a2)));function _0x5c545f(){return new Promise((_0x17f5a2,_0x4df2db)=>{const _0x385bbd=_0x5360;fs[_0x385bbd(0x206)](_0x145f4d,(_0x3d9ea8,_0xd1839)=>{const _0x1f3f62=_0x385bbd;if(_0x3d9ea8)return _0x4df2db(_0x28dc73['__'](_0x1f3f62(0x29f)));if(_0xd1839[_0x1f3f62(0x24f)]>0x400*0x400*0x400)return _0x3b775e[_0x1f3f62(0x234)][_0x1f3f62(0x255)](_0x28dc73,_0x28dc73['__']('needEmptyFolderPrivateSpace'));fs[_0x1f3f62(0x290)](_0x145f4d,(_0x3c154e,_0x53d6b5)=>{const _0x4fa95c=_0x1f3f62;for(let _0xd6278b of _0x53d6b5){if(noCheckFileList[_0x4fa95c(0x20d)](_0xd6278b)||_0xd6278b['startsWith']('.')||_0xd6278b['startsWith']('@'))continue;return _0x4df2db(_0x28dc73['__'](_0x4fa95c(0x29f)));}_0x17f5a2();});});});}fs[_0x494fea(0x260)](_0x145f4d,fs[_0x494fea(0x2b9)][_0x494fea(0x28a)]|fs[_0x494fea(0x2b9)][_0x494fea(0x27c)],_0x28cded=>{const _0xc5d961=_0x494fea;if(_0x28cded)return _0x3b775e[_0xc5d961(0x234)][_0xc5d961(0x255)](_0x28dc73,_0x28dc73['__'](_0xc5d961(0x200)));_0x5c545f()[_0xc5d961(0x2a5)](()=>{const _0x1ed4ed=_0xc5d961;let _0x23a49a=dbPrivateSpaceTable['getBySpaceName'](_0x3b775e[_0x1ed4ed(0x234)]['dbOther'],_0x31e11a);if(_0x23a49a)return _0x3b775e[_0x1ed4ed(0x234)][_0x1ed4ed(0x255)](_0x28dc73,_0x28dc73['__'](_0x1ed4ed(0x202)));let _0x10be9a=path[_0x1ed4ed(0x220)](_0x145f4d,configFolderName);fs[_0x1ed4ed(0x229)](_0x10be9a,{'recursive':!![]},_0x5dadee=>{const _0x2b7b59=_0x1ed4ed;if(_0x5dadee)return _0x3b775e[_0x2b7b59(0x234)][_0x2b7b59(0x255)](_0x28dc73,_0x28dc73['__'](_0x2b7b59(0x22e))+JSON[_0x2b7b59(0x297)](_0x5dadee));let _0x3cff3e=getPrivateIndexDb(_0x145f4d);dbPrivateSpaceTable[_0x2b7b59(0x20e)](_0x3cff3e,_0x145f4d),cryptoUtils[_0x2b7b59(0x214)](_0x483cb8,folderSignString)[_0x2b7b59(0x2a5)](_0xece3a=>{const _0x2d3163=_0x2b7b59;let _0x44749c=path['join'](_0x10be9a,folderSignFileName);fs[_0x2d3163(0x2b3)](_0x44749c,_0xece3a,_0xac7455=>{const _0x31b1c4=_0x2d3163;if(_0xac7455)return _0x3b775e[_0x31b1c4(0x234)][_0x31b1c4(0x255)](_0x28dc73,_0x28dc73['__'](_0x31b1c4(0x22e))+JSON[_0x31b1c4(0x297)](_0xac7455));return dbPrivateSpaceTable[_0x31b1c4(0x21f)](_0x3b775e['app'][_0x31b1c4(0x240)],{'folder_path':_0x145f4d,'space_name':_0x31e11a,'create_uid':_0x5a4a71['id']}),_0x28dc73['json']({'code':0x0});});})[_0x2b7b59(0x203)](_0x3c899c=>{const _0x2ea958=_0x2b7b59;return console[_0x2ea958(0x283)](_0x2ea958(0x207),_0x3c899c),_0x3b775e[_0x2ea958(0x234)]['returnErrMsg'](_0x28dc73,_0x28dc73['__']('operationFail')+JSON['stringify'](_0x3c899c));});});})['catch'](_0x84b8d3=>{const _0x22f727=_0xc5d961;return _0x3b775e[_0x22f727(0x234)][_0x22f727(0x255)](_0x28dc73,_0x84b8d3);});});}),router[_0x35d1b7(0x225)](_0x35d1b7(0x243),(_0x453f42,_0x509018,_0x5cc31e)=>{const _0x5d687d=_0x35d1b7;let _0x229919=[];return _0x453f42[_0x5d687d(0x28c)][_0x5d687d(0x268)]==0x1?_0x229919=dbPrivateSpaceTable['getAll'](_0x453f42[_0x5d687d(0x234)]['dbOther']):_0x229919=dbPrivateSpaceTable[_0x5d687d(0x242)](_0x453f42[_0x5d687d(0x234)][_0x5d687d(0x240)],_0x453f42[_0x5d687d(0x28c)]['id']),_0x509018[_0x5d687d(0x28e)]({'code':0x0,'data':_0x229919});});function checkSpacePwd(_0x5c6171,_0xbcb9c8,_0x51cd07){return new Promise((_0x59ffb4,_0x48c7a6)=>{const _0x8ecebc=_0x5360;_0xbcb9c8=Buffer[_0x8ecebc(0x275)](_0xbcb9c8,_0x8ecebc(0x289))[_0x8ecebc(0x212)]();let _0x4c2ef8=path[_0x8ecebc(0x220)](_0x51cd07,configFolderName,folderSignFileName);fs[_0x8ecebc(0x206)](_0x4c2ef8,(_0x4fe617,_0x3f2304)=>{if(_0x4fe617)return _0x48c7a6(_0x5c6171['__']('private.configFileReadFail'));fs['readFile'](_0x4c2ef8,'utf-8',(_0x10fb09,_0x11af97)=>{const _0x2c2790=_0x5360;if(_0x10fb09)return _0x48c7a6(_0x5c6171['__']('private.configFileReadFail'));else cryptoUtils[_0x2c2790(0x1f6)](_0xbcb9c8,_0x11af97)[_0x2c2790(0x2a5)](_0x2c8333=>{const _0x5ef243=_0x2c2790;return _0x2c8333==folderSignString?_0x59ffb4(_0xbcb9c8):_0x48c7a6(_0x5c6171['__'](_0x5ef243(0x271)));})[_0x2c2790(0x203)](_0x2b9b7f=>{const _0x2301b9=_0x2c2790;return console['log']('error',_0x2b9b7f),_0x48c7a6(_0x5c6171['__'](_0x2301b9(0x271)));});});});});}function _0x5360(_0x3ac321,_0x1ff0ed){const _0x1ac5ba=_0x1ac5();return _0x5360=function(_0x5360bd,_0x1963a2){_0x5360bd=_0x5360bd-0x1f3;let _0x182c9b=_0x1ac5ba[_0x5360bd];return _0x182c9b;},_0x5360(_0x3ac321,_0x1ff0ed);}router[_0x35d1b7(0x225)](_0x35d1b7(0x222),(_0x1183f9,_0x53c814,_0x786121)=>{const _0x62650f=_0x35d1b7;let _0x572578=_0x1183f9[_0x62650f(0x2b7)][_0x62650f(0x210)],_0x9e19a1=_0x1183f9[_0x62650f(0x2b7)]['spaceId'],_0x43edc1=dbPrivateSpaceTable[_0x62650f(0x26e)](_0x1183f9[_0x62650f(0x234)][_0x62650f(0x240)],_0x9e19a1);if(!_0x43edc1)return _0x1183f9[_0x62650f(0x234)][_0x62650f(0x255)](_0x53c814,_0x62650f(0x25c));fs[_0x62650f(0x206)](_0x43edc1[_0x62650f(0x25a)],(_0x3be050,_0x5551f2)=>{const _0x25add4=_0x62650f;if(_0x3be050)return _0x1183f9[_0x25add4(0x234)][_0x25add4(0x255)](_0x53c814,_0x53c814['__'](_0x25add4(0x1f7)));checkSpacePwd(_0x53c814,_0x572578,_0x43edc1[_0x25add4(0x25a)])[_0x25add4(0x2a5)](_0x27f734=>{const _0x59a2c6=_0x25add4;let _0x5c6422=sha256(new Date()[_0x59a2c6(0x245)]()+_0x9e19a1+_0x27f734);cryptoUtils['encryptString'](config[_0x59a2c6(0x223)],_0x27f734)[_0x59a2c6(0x2a5)](_0x54e351=>{const _0x3a759e=_0x59a2c6;return dbPrivateSpaceTable[_0x3a759e(0x29d)](_0x1183f9[_0x3a759e(0x234)][_0x3a759e(0x240)],{'space_id':_0x9e19a1,'pwd':_0x54e351,'token':_0x5c6422}),_0x53c814[_0x3a759e(0x28e)]({'code':0x0,'token':_0x5c6422});});})[_0x25add4(0x203)](_0xff471c=>{const _0x56f1d2=_0x25add4;return console['log'](_0x56f1d2(0x207),_0xff471c),_0x1183f9[_0x56f1d2(0x234)]['returnErrMsg'](_0x53c814,_0xff471c);});});});function ffprobeSync(_0x1082e4){return new Promise((_0x15b2d3,_0x164b7b)=>{const _0x12c4e0=_0x5360;try{FFmpeg(transCodeUtil[_0x12c4e0(0x231)](_0x1082e4))[_0x12c4e0(0x28b)]((_0x5bfd16,_0x15d8ff)=>{_0x5bfd16?_0x164b7b(_0x5bfd16):_0x15b2d3(_0x15d8ff);});}catch(_0x8158cb){console[_0x12c4e0(0x283)](_0x12c4e0(0x207),_0x8158cb),_0x164b7b(_0x8158cb);}});}function deleteFile(_0x44291f){fs['rm'](_0x44291f,{'maxRetries':0xa,'retryDelay':0x3e8},_0x138602=>{});}function _0x1ac5(){const _0x1bb85b=['journal_mode\x20=\x20WAL','spaceName','/getFileList','W_OK','updateIndexField','count','extname','other','tiny_path','UPDATE\x20private_space_index\x20SET\x20original_time=?,duration=?,size=?,stream_info=?\x20where\x20id=?','log','fileType','transSpcielFormatFromBuffer','../utils/cryptoUtils','concat','createIndex','base64','R_OK','ffprobe','currentUser','exports','json','changes','readdir','videoTypeList','savePath','64ucxvoH','CreateDate','stream','indexId','stringify','encodeFilename','uploadFile','getVideoOriginalTime','61670nPRKLv','873424Gralbj','createToken','ids','needEmptyFolderPrivateSpace','run','getPrivateDbPath','private.spacePwdGtFour','streams','spaceToken','then','undefined','status','\x27\x20where\x20id=','orderField','exifr','streamToBuffer','deleteIndex','express','string','rawImgTypeList','imgTypeList','/getDecodeFile*','DateTimeOriginal','writeFile','setHeader','message','347344apqqrs','body','pwd','constants','filename','getAllIndexByWhere','destination','\x20WHERE\x20file_type=\x27','decryptString','private.spaceFolderNotExist','encryptFileFromInputPipe','prepare','nascabisthebest','nascabconfig','private.spaceNameTooLong','space\x20id\x20is\x20null','/deleteSpaceFiles','sharpDealImg','noWritePermission','/exitSpaceId','private.hasSameNameSpace','catch','spacePwd','delete','stat','error','\x20order\x20by\x20','1804FwUGNp','query','.mp4','798pQCyXS','includes','createIndexDb','pipe','checkStr','space/index\x20id\x20is\x20null','toString','privateSpaceKey','encryptString','../utils/uploadUtils','private.spaceConfigFileBroken','space_token','over','updateSpaceName','tiny','/updateSpaceName','tiny-','UPDATE\x20private_space_index\x20SET\x20tiny_path=\x27','ext','create','join','end','/checkPwd','tokenPwdEncryptKey','\x20limit\x20','post','FFmpeg','/deleteSpace','../utils/fileUtils','mkdir','.DS_Store','folderNotExist','toLowerCase','private.spaceNameCantNull','operationFail','desc','sha256','dealFFmpegPath','getBySpaceName','14427XlFgNS','app','space_id','length','video','check_time','Content-Disposition','orderType','private.onlyAdminCanDelete','temp','unlink','getIndexByWhere','ifExtIsSpecialFormat','dbOther','/exportSpace','getAllByUid','/getAllSpace','../utils/privateSpaceUtils','getTime','dbPath','2381751sdfJao','replace','destroy','encryptFile','Router','/regularUpload','decodePath','../utils/sharpUtils','size','\x20offset\x20','image','folderPath','filename_enc','../../myConfig/config','returnErrMsg','118289lDaKTo','data','../../libs/nasTrans','download','folder_path','getTokenObjByToken','error\x20space\x20id','decryptFileGetStream','parse','headers','access','sendFile','spaceId','create_uid','../../utils/videoStreamUtil','.mov','err','deleteSpaceToken','is_admin','send','push','space\x20id\x20is\x20invalid','START_WORKER_BG_TASK','../utils/faststart','getById','25BYDkky','attachment;\x20filename*=UTF-8\x27\x27','private.passwordIncorrect','offsetCount','genImageTinyFile','close','from','420183sTdJyV','getIndexByFileName','get'];_0x1ac5=function(){return _0x1bb85b;};return _0x1ac5();}function uploadFail(_0x5419e6,_0x31815f,_0x364f55,_0x461ff0){const _0x1eb802=_0x35d1b7;return deleteFile(_0x31815f),_0x364f55[_0x1eb802(0x234)][_0x1eb802(0x255)](_0x461ff0,_0x461ff0['__']('private.uploadErrTryAgain'));}function dealUploadImageOrFile(_0x59817c,_0x5b5b70,_0xc6288b,_0x309799,_0x38d8b3,_0x2967fc,_0x4322c2,_0x5e069c,_0x53fbf9){const _0x55119e=_0x35d1b7;uploadPrivateUtil[_0x55119e(0x299)](_0xc6288b,_0x309799,_0x38d8b3,_0x2967fc,_0x49e5d0=>{const _0x568459=_0x55119e;let _0x530a09=_0x49e5d0['path'],_0x3a1410=cryptoUtils[_0x568459(0x25d)](_0x2967fc,_0x530a09),_0x24cf77=dbPrivateSpaceTable[_0x568459(0x288)](_0x59817c,{'filename':new Buffer['from'](_0x5e069c)[_0x568459(0x212)](_0x568459(0x289)),'filename_enc':_0x38d8b3,'file_type':_0x4322c2,'ext':_0x53fbf9});if(_0x24cf77[_0x568459(0x28f)]<0x1)return uploadFail(_0x59817c,_0x530a09,_0xc6288b,_0x309799);let _0x4ac84d=_0x24cf77['lastInsertRowid'];_0x309799[_0x568459(0x28e)]({'code':0x0});let _0x59e9e5=new Date()[_0x568459(0x245)]();if(_0x4322c2==_0x568459(0x251)){var _0x3479e5=[];let _0x21b80a=new PassThrough()[_0x568459(0x20f)](_0x3a1410);_0x21b80a['on'](_0x568459(0x257),function(_0x1cef01){_0x3479e5['push'](_0x1cef01);}),_0x21b80a['on'](_0x568459(0x221),function(){const _0x3e4c0a=_0x568459;var _0x377163=Buffer[_0x3e4c0a(0x287)](_0x3479e5);function _0x8cdf68(){const _0x132948=_0x3e4c0a;exifUtil['parse'](_0x377163)['then'](_0x12b1d9=>{const _0x537f38=_0x5360;if(_0x12b1d9){let _0x740dc5=_0x12b1d9[_0x537f38(0x2b2)];_0x12b1d9[_0x537f38(0x294)]&&!_0x740dc5&&(_0x740dc5=_0x12b1d9['CreateDate']),_0x740dc5&&(_0x59e9e5=new Date(_0x740dc5)[_0x537f38(0x245)](),_0x59817c[_0x537f38(0x1f9)]('UPDATE\x20private_space_index\x20SET\x20original_time=\x27'+_0x59e9e5+'\x27\x20where\x20id='+_0x4ac84d)[_0x537f38(0x2a0)]());}})[_0x132948(0x203)](_0x34ce67=>{});}privateSpaceUtils[_0x3e4c0a(0x273)](_0x53fbf9,_0x377163,_0x4302b9=>{const _0x5d8bf6=_0x3e4c0a,_0x3bd679=Readable[_0x5d8bf6(0x275)](_0x4302b9);let _0x5ab8ce=path['join'](_0x5b5b70,_0x38d8b3);cryptoUtils['encryptFileFromInputPipe'](_0x2967fc,_0x3bd679,_0x5ab8ce)[_0x5d8bf6(0x2a5)](_0x2d357b=>{const _0x2d4645=_0x5d8bf6;let _0x2ebec7=path['join'](configFolderName,_0x2d4645(0x21a),_0x38d8b3);_0x59817c[_0x2d4645(0x1f9)]('UPDATE\x20private_space_index\x20SET\x20tiny_path=\x27'+_0x2ebec7+_0x2d4645(0x2a8)+_0x4ac84d)[_0x2d4645(0x2a0)](),_0x8cdf68();});},_0x1d17b8=>{_0x8cdf68();});});}});}function dealUploadVideo(_0x362b26,_0xc0ee25,_0x4c705a,_0x596010,_0x594fda,_0x274199,_0x593e4d,_0x29439b,_0x3bff11,_0x2d7f47,_0x593899){const _0xd69d4f=_0x35d1b7;_0x594fda[_0xd69d4f(0x20a)]['savePath']=_0x596010,_0x594fda['query']['overMode']=_0xd69d4f(0x218),uploadUtil[_0xd69d4f(0x299)](_0x594fda,_0x274199,![],!![],![],_0x5a564d=>{const _0x3822e5=_0xd69d4f;let _0x42f548=_0x5a564d['path'],_0x3673cc=path[_0x3822e5(0x220)](_0x5a564d[_0x3822e5(0x1f4)]);function _0x4b34df(_0x1f5213){const _0x54111c=_0x3822e5;ffprobeSync(_0x42f548)[_0x54111c(0x2a5)](_0x12ee1c=>{const _0x2db5f4=_0x54111c;let _0x31d986=0x0;_0x31d986=videoStreamUtil['getDurationFromStream'](_0x12ee1c);let _0x14bd3a=JSON[_0x2db5f4(0x297)](_0x12ee1c[_0x2db5f4(0x2a3)]),_0x3d24dd=videoStreamUtil[_0x2db5f4(0x29a)](_0x12ee1c);fs[_0x2db5f4(0x206)](_0x42f548,(_0xec2dda,_0x26872b)=>{const _0x2463ef=_0x2db5f4;if(_0xec2dda){deleteFile(_0x42f548);return;}let _0x53a148=_0x2463ef(0x282);_0x362b26[_0x2463ef(0x1f9)](_0x53a148)['run'](_0x3d24dd,parseInt(_0x31d986),_0x26872b['size'],_0x14bd3a,_0x1f5213);let _0x272790=_0x2463ef(0x21c)+Buffer[_0x2463ef(0x275)](_0x2d7f47)['toString'](_0x2463ef(0x289));privateSpaceUtils['genVideoTinyFile'](_0x42f548,_0x3673cc,_0x272790,_0x1c5db8=>{const _0x474329=_0x2463ef;fs[_0x474329(0x206)](_0x1c5db8,(_0x1af83c,_0x1de14f)=>{const _0xf56d55=_0x474329;if(_0x1af83c){deleteFile(_0x42f548);return;}let _0x27abb2=path[_0xf56d55(0x220)](_0x4c705a,_0x593e4d);cryptoUtils[_0xf56d55(0x24a)](_0x29439b,_0x1c5db8,_0x27abb2)[_0xf56d55(0x2a5)](_0x23136a=>{const _0x33ecbd=_0xf56d55;let _0x455db1=path[_0x33ecbd(0x220)](configFolderName,_0x33ecbd(0x21a),_0x593e4d);_0x362b26['prepare'](_0x33ecbd(0x21d)+_0x455db1+_0x33ecbd(0x2a8)+_0x1f5213)[_0x33ecbd(0x2a0)](),deleteFile(_0x1c5db8),deleteFile(_0x42f548);});});},_0x8d8dd2=>{deleteFile(_0x42f548);});});})[_0x54111c(0x203)](_0x11e366=>{deleteFile(_0x42f548);});}function _0x5dc89c(){const _0x16433c=_0x3822e5;let _0x2dd25a=dbPrivateSpaceTable[_0x16433c(0x288)](_0x362b26,{'filename':new Buffer[(_0x16433c(0x275))](_0x2d7f47)['toString']('base64'),'filename_enc':_0x593e4d,'file_type':_0x3bff11,'ext':_0x593899});return _0x2dd25a[_0x16433c(0x28f)]<0x1?uploadFail(_0x362b26,_0x42f548,_0x594fda,_0x274199):(_0x4b34df(_0x2dd25a['lastInsertRowid']),_0x274199['json']({'code':0x0}));}function _0xd42901(_0x1ee643,_0x3ab6d7,_0x2bda70){const _0x7b616=_0x3822e5;cryptoUtils[_0x7b616(0x24a)](_0x29439b,_0x1ee643,_0x3ab6d7)['then'](_0x44c07a=>{_0x2bda70(_0x44c07a);})[_0x7b616(0x203)](_0x2abf09=>{const _0x5a14a6=_0x7b616;console[_0x5a14a6(0x283)](_0x2abf09),uploadFail(_0x362b26,_0x1ee643,_0x594fda,_0x274199);});}let _0x98fef=path[_0x3822e5(0x220)](_0xc0ee25[_0x3822e5(0x25a)],_0x593e4d);if(_0x593899==_0x3822e5(0x20b)||_0x593899==_0x3822e5(0x265)){var _0x35a5fa=faststart['createReadStream'](_0x42f548,{'errorCallBack':_0x3c0e64=>{_0xd42901(_0x42f548,_0x98fef,_0x5dc89c);}});_0x35a5fa['on'](_0x3822e5(0x274),function(){const _0x1b80fb=_0x3822e5;_0x35a5fa[_0x1b80fb(0x249)]();}),cryptoUtils[_0x3822e5(0x1f8)](_0x29439b,_0x35a5fa,_0x98fef)['then'](_0x20e8bb=>{_0x5dc89c();})['catch'](_0x1e09fa=>{const _0x24f4ee=_0x3822e5;console[_0x24f4ee(0x283)](_0x24f4ee(0x207),_0x1e09fa),uploadFail(_0x362b26,_0x42f548,_0x594fda,_0x274199);});}else _0xd42901(_0x42f548,_0x98fef,_0x5dc89c);});}router[_0x35d1b7(0x225)](_0x35d1b7(0x24c),function(_0xc9cc4,_0x22409a,_0xefd1c){const _0x181e85=_0x35d1b7;let _0x5cb819=_0xc9cc4[_0x181e85(0x20a)]['spaceId']||_0xc9cc4['body']['spaceId']||_0xc9cc4[_0x181e85(0x25f)][_0x181e85(0x235)],_0x3b4ad3=_0xc9cc4[_0x181e85(0x20a)]['filename']||_0xc9cc4[_0x181e85(0x25f)][_0x181e85(0x2ba)],_0xa9d224=decodeURIComponent(_0x3b4ad3);_0xc9cc4['query'][_0x181e85(0x298)]&&(_0xa9d224=fileUtil[_0x181e85(0x24d)](_0xc9cc4['query'][_0x181e85(0x298)])),getPwdFromToken(_0xc9cc4,_0x22409a,_0x3e509a=>{const _0x28b58f=_0x181e85;let _0x3b873f=dbPrivateSpaceTable[_0x28b58f(0x26e)](_0xc9cc4[_0x28b58f(0x234)][_0x28b58f(0x240)],_0x5cb819);if(!_0x3b873f)return _0xc9cc4['app'][_0x28b58f(0x255)](_0x22409a,_0x22409a['__']('private.noExist'));_0xc9cc4[_0x28b58f(0x20a)][_0x28b58f(0x292)]=_0x3b873f['folder_path'];let _0x5046f9=getPrivateIndexDb(_0x3b873f[_0x28b58f(0x25a)]),_0x53f48c=dbPrivateSpaceTable[_0x28b58f(0x277)](_0x5046f9,new Buffer['from'](_0xa9d224)[_0x28b58f(0x212)](_0x28b58f(0x289)));if(_0x53f48c)return _0xc9cc4[_0x28b58f(0x234)][_0x28b58f(0x255)](_0x22409a,_0x22409a['__']('private.alreadyHasSameNameFile'));let _0x50859f=path[_0x28b58f(0x27f)](_0xa9d224)?path[_0x28b58f(0x27f)](_0xa9d224)['toLowerCase']():null,_0x2ddc06=_0x28b58f(0x280);if(_0x50859f){if(config[_0x28b58f(0x2b0)][_0x28b58f(0x20d)](_0x50859f[_0x28b58f(0x22c)]())||config[_0x28b58f(0x2af)][_0x28b58f(0x20d)](_0x50859f[_0x28b58f(0x22c)]()))_0x2ddc06=_0x28b58f(0x251);else config[_0x28b58f(0x291)][_0x28b58f(0x20d)](_0x50859f[_0x28b58f(0x22c)]())&&(_0x2ddc06=_0x28b58f(0x237));}let _0x5c723f=path[_0x28b58f(0x220)](_0x3b873f['folder_path'],configFolderName,_0x28b58f(0x21a)),_0x2f119e=path[_0x28b58f(0x220)](_0x3b873f[_0x28b58f(0x25a)],configFolderName,_0x28b58f(0x23c));function _0x33041b(){const _0x43293f=_0x28b58f;cryptoUtils[_0x43293f(0x214)](_0x3e509a,_0xa9d224)['then'](_0x3cf221=>{const _0x4b34ed=_0x43293f;if(_0x3cf221[_0x4b34ed(0x236)]>0xf0)return _0xc9cc4[_0x4b34ed(0x234)][_0x4b34ed(0x255)](_0x22409a,_0x22409a['__']('private.fileNameTooLong'));_0x2ddc06=='video'?dealUploadVideo(_0x5046f9,_0x3b873f,_0x5c723f,_0x2f119e,_0xc9cc4,_0x22409a,_0x3cf221,_0x3e509a,_0x2ddc06,_0xa9d224,_0x50859f):dealUploadImageOrFile(_0x5046f9,_0x5c723f,_0xc9cc4,_0x22409a,_0x3cf221,_0x3e509a,_0x2ddc06,_0xa9d224,_0x50859f);});}fs[_0x28b58f(0x206)](_0x5c723f,(_0x293306,_0x100b3a)=>{function _0x5893ab(){const _0x38ca64=_0x5360;fs[_0x38ca64(0x206)](_0x2f119e,(_0x1a3e71,_0x3d2757)=>{const _0x4b46e0=_0x38ca64;_0x1a3e71?fs[_0x4b46e0(0x229)](_0x2f119e,{'recursive':!![]},_0x4241af=>{_0x33041b();}):_0x33041b();});}_0x293306?fs['mkdir'](_0x5c723f,{'recursive':!![]},_0x461c16=>{_0x5893ab();}):_0x5893ab();});});}),router[_0x35d1b7(0x225)]('/importSpace',(_0x5ff375,_0x288384,_0x98405e)=>{const _0x30bc60=_0x35d1b7;let _0x41e304=_0x5ff375[_0x30bc60(0x2b7)][_0x30bc60(0x252)],_0x175c1e=_0x5ff375[_0x30bc60(0x2b7)][_0x30bc60(0x27a)],_0x43fcc6=_0x5ff375[_0x30bc60(0x28c)],_0x23abf0=_0x5ff375[_0x30bc60(0x2b7)]['spacePwd'];if(!_0x175c1e)return _0x5ff375['app'][_0x30bc60(0x255)](_0x288384,_0x288384['__'](_0x30bc60(0x22d)));let _0x5d2c94=dbPrivateSpaceTable[_0x30bc60(0x232)](_0x5ff375[_0x30bc60(0x234)]['dbOther'],_0x175c1e);if(_0x5d2c94)return _0x5ff375['app'][_0x30bc60(0x255)](_0x288384,_0x288384['__'](_0x30bc60(0x202)));if(!_0x23abf0)return _0x5ff375[_0x30bc60(0x234)][_0x30bc60(0x255)](_0x288384,_0x288384['__'](_0x30bc60(0x2a2)));fs[_0x30bc60(0x260)](_0x41e304,_0x10c0ba=>{const _0x4bf74f=_0x30bc60;if(_0x10c0ba)return _0x5ff375[_0x4bf74f(0x234)][_0x4bf74f(0x255)](_0x288384,_0x288384['__'](_0x4bf74f(0x200)));checkSpacePwd(_0x288384,_0x23abf0,_0x41e304)['then'](()=>{const _0x1cea3a=_0x4bf74f;let _0x5494a9=config['getPrivateDbPath'](_0x41e304);fs[_0x1cea3a(0x206)](_0x5494a9,(_0x1ca570,_0x5878ce)=>{const _0x476db1=_0x1cea3a;if(_0x1ca570)return _0x5ff375['app'][_0x476db1(0x255)](_0x288384,_0x288384['__'](_0x476db1(0x216)));return dbPrivateSpaceTable[_0x476db1(0x21f)](_0x5ff375[_0x476db1(0x234)][_0x476db1(0x240)],{'folder_path':_0x41e304,'space_name':_0x175c1e,'create_uid':_0x43fcc6['id']}),_0x288384[_0x476db1(0x28e)]({'code':0x0});});})[_0x4bf74f(0x203)](_0x102afc=>{const _0x15583f=_0x4bf74f;return _0x5ff375[_0x15583f(0x234)][_0x15583f(0x255)](_0x288384,_0x102afc);});});}),router[_0x35d1b7(0x225)](_0x35d1b7(0x241),(_0x532ab8,_0x2265d3,_0xf9eaa4)=>{const _0x3cdd9e=_0x35d1b7;let _0x3d44a1=_0x532ab8['body'][_0x3cdd9e(0x252)],_0x1c2573=_0x532ab8['body'][_0x3cdd9e(0x204)],_0x1f70bc=_0x532ab8[_0x3cdd9e(0x2b7)]['targetFolderPath'];if(!_0x1c2573)return _0x532ab8[_0x3cdd9e(0x234)][_0x3cdd9e(0x255)](_0x2265d3,_0x2265d3['__']('private.spacePwdGtFour'));fs['access'](_0x3d44a1,fs[_0x3cdd9e(0x2b9)]['R_OK'],_0x156716=>{const _0x149702=_0x3cdd9e;if(_0x156716)return _0x532ab8[_0x149702(0x234)][_0x149702(0x255)](_0x2265d3,_0x2265d3['__'](_0x149702(0x200)));fs[_0x149702(0x260)](_0x1f70bc,fs[_0x149702(0x2b9)][_0x149702(0x27c)],_0x242c8c=>{const _0x280aa9=_0x149702;if(_0x242c8c)return _0x532ab8[_0x280aa9(0x234)]['returnErrMsg'](_0x2265d3,_0x2265d3['__'](_0x280aa9(0x200)));function _0x1144aa(_0x421c2){const _0x28ab86=_0x280aa9;cryptoUtils['encryptString'](config[_0x28ab86(0x213)],_0x1c2573)[_0x28ab86(0x2a5)](_0x40cafd=>{const _0x2a2eeb=_0x28ab86;return _0x421c2[_0x2a2eeb(0x234)][_0x2a2eeb(0x240)]['prepare']('INSERT\x20INTO\x20bg_task(task_type,task_json)\x20VALUES(?,?)')['run']('EXPORT_PRIVATE_SPACE',JSON[_0x2a2eeb(0x297)]({'folderPath':_0x3d44a1,'targetFolderPath':_0x1f70bc,'spacePwd':_0x40cafd})),process[_0x2a2eeb(0x269)]({'type':_0x2a2eeb(0x26c)}),_0x2265d3[_0x2a2eeb(0x28e)]({'code':0x0});});}let _0x2a026c=path['join'](_0x3d44a1,configFolderName,folderSignFileName);fs[_0x280aa9(0x206)](_0x2a026c,(_0x3c3d91,_0x5bdc93)=>{const _0x167074=_0x280aa9;_0x3c3d91?_0x1144aa(_0x532ab8):checkSpacePwd(_0x2265d3,_0x1c2573,_0x3d44a1)[_0x167074(0x2a5)](()=>{_0x1144aa(_0x532ab8);})[_0x167074(0x203)](_0x5d9f09=>{const _0x5f338f=_0x167074;return console[_0x5f338f(0x283)](_0x5d9f09),_0x532ab8['app'][_0x5f338f(0x255)](_0x2265d3,_0x2265d3['__'](_0x5f338f(0x271)));});});});});}),router[_0x35d1b7(0x225)](_0x35d1b7(0x1fe),(_0x2c459b,_0x2c9f43,_0x4032cf)=>{const _0x5ae4c5=_0x35d1b7;let _0x2579a5=_0x2c459b[_0x5ae4c5(0x2b7)][_0x5ae4c5(0x262)],_0xec731f=_0x2c459b['body'][_0x5ae4c5(0x29e)];if(!_0xec731f||_0xec731f['length']<0x1)return _0x2c9f43[_0x5ae4c5(0x2a7)](0x194)[_0x5ae4c5(0x221)]();let _0x5bd8ab=dbPrivateSpaceTable['getById'](_0x2c459b[_0x5ae4c5(0x234)][_0x5ae4c5(0x240)],_0x2579a5);if(!_0x5bd8ab)return _0x2c9f43[_0x5ae4c5(0x2a7)](0x194)['end']();if(_0x2c459b[_0x5ae4c5(0x28c)][_0x5ae4c5(0x268)]!=0x1){if(_0x5bd8ab[_0x5ae4c5(0x263)]!=_0x2c459b['currentUser']['id'])return _0x2c9f43[_0x5ae4c5(0x28e)]({'code':0x1,'message':_0x2c9f43['__'](_0x5ae4c5(0x23b))});}try{let _0x3d5e49=getPrivateIndexDb(_0x5bd8ab['folder_path']),_0x501195=JSON[_0x5ae4c5(0x25e)](_0xec731f),_0x1004a8=0x0,_0x71c4e7=[],_0x36935b=0x0,_0x5132a9=0x0;if(_0x501195[_0x5ae4c5(0x236)]<0x1)return _0x2c9f43['json']({'code':0x0,'deleteList':_0x71c4e7,'deleteCount':_0x1004a8,'errCount':_0x36935b});for(let _0x1d472f=0x0;_0x1d472f<_0x501195[_0x5ae4c5(0x236)];_0x1d472f++){let _0x2043b7=dbPrivateSpaceTable[_0x5ae4c5(0x23e)](_0x3d5e49,'\x20id='+_0x501195[_0x1d472f]);if(!_0x2043b7)return _0x2c459b[_0x5ae4c5(0x234)][_0x5ae4c5(0x255)](_0x2c9f43,_0x2c9f43['__'](_0x5ae4c5(0x22b)));let _0x1b88bb=path[_0x5ae4c5(0x220)](_0x5bd8ab[_0x5ae4c5(0x25a)],_0x2043b7[_0x5ae4c5(0x253)]);if(_0x2043b7[_0x5ae4c5(0x281)]&&_0x2043b7[_0x5ae4c5(0x281)]!=_0x5ae4c5(0x2a6)){let _0x2bd5d2=path[_0x5ae4c5(0x220)](_0x5bd8ab['folder_path'],_0x2043b7[_0x5ae4c5(0x281)]);try{fs[_0x5ae4c5(0x23d)](_0x2bd5d2,_0x452006=>{});}catch(_0x3f2d55){}}fs['unlink'](_0x1b88bb,_0x3c277f=>{const _0x46cf0f=_0x5ae4c5;_0x5132a9+=0x1;_0x3c277f?(console[_0x46cf0f(0x283)](_0x46cf0f(0x266),_0x3c277f[_0x46cf0f(0x2b5)]),_0x36935b+=0x1):(_0x1004a8+=0x1,_0x71c4e7['push'](_0x501195[_0x1d472f]));dbPrivateSpaceTable[_0x46cf0f(0x2ac)](_0x3d5e49,_0x501195[_0x1d472f]);if(_0x5132a9==_0x501195[_0x46cf0f(0x236)])return _0x2c9f43[_0x46cf0f(0x28e)]({'code':0x0,'deleteList':_0x71c4e7,'deleteCount':_0x1004a8,'errCount':_0x36935b});});}}catch(_0x5dbd3f){return console[_0x5ae4c5(0x283)](_0x5ae4c5(0x207),_0x5dbd3f),_0x2c9f43[_0x5ae4c5(0x28e)]({'code':0x1,'message':JSON['stringify'](_0x5dbd3f)});}}),router[_0x35d1b7(0x225)](_0x35d1b7(0x227),(_0x34362a,_0x3eaa8c,_0x2b8295)=>{const _0xe05ff7=_0x35d1b7;if(checkSpaceId(_0x34362a,_0x3eaa8c)!==!![])return;let _0x544128=_0x34362a[_0xe05ff7(0x2b7)][_0xe05ff7(0x262)],_0x33f8c9=dbPrivateSpaceTable[_0xe05ff7(0x26e)](_0x34362a[_0xe05ff7(0x234)][_0xe05ff7(0x240)],_0x544128);if(_0x34362a[_0xe05ff7(0x28c)]['is_admin']!=0x1){if(_0x33f8c9[_0xe05ff7(0x263)]!=_0x34362a[_0xe05ff7(0x28c)]['id'])return _0x3eaa8c['json']({'code':0x1,'message':_0x3eaa8c['__'](_0xe05ff7(0x23b))});}return dbPrivateSpaceTable[_0xe05ff7(0x205)](_0x34362a[_0xe05ff7(0x234)][_0xe05ff7(0x240)],_0x544128),_0x3eaa8c[_0xe05ff7(0x28e)]({'code':0x0});}),router[_0x35d1b7(0x225)](_0x35d1b7(0x21b),(_0x298ae5,_0x3bbad4,_0x4c1fdb)=>{const _0x43c327=_0x35d1b7;let _0x8e4bc7=_0x298ae5['body'][_0x43c327(0x27a)],_0x4b4a57=_0x298ae5[_0x43c327(0x2b7)][_0x43c327(0x262)];if(checkSpaceId(_0x298ae5,_0x3bbad4)!==!![])return;if(checkSpaceName(_0x298ae5,_0x3bbad4,_0x8e4bc7)!==!![])return;let _0x298db0=dbPrivateSpaceTable[_0x43c327(0x26e)](_0x298ae5[_0x43c327(0x234)]['dbOther'],_0x4b4a57);if(_0x298ae5[_0x43c327(0x28c)][_0x43c327(0x268)]!=0x1){if(_0x298db0['create_uid']!=_0x298ae5[_0x43c327(0x28c)]['id'])return _0x3bbad4[_0x43c327(0x28e)]({'code':0x1,'message':_0x3bbad4['__']('private.onlyAdminCanDelete')});}return dbPrivateSpaceTable[_0x43c327(0x219)](_0x298ae5[_0x43c327(0x234)][_0x43c327(0x240)],_0x8e4bc7,_0x4b4a57),_0x3bbad4[_0x43c327(0x28e)]({'code':0x0});}),router[_0x35d1b7(0x225)](_0x35d1b7(0x27b),(_0xb8d127,_0x69d178,_0x2c4873)=>{const _0x2980c6=_0x35d1b7;let _0x2077c=_0xb8d127[_0x2980c6(0x2b7)][_0x2980c6(0x262)];if(!_0x2077c)return _0xb8d127[_0x2980c6(0x234)][_0x2980c6(0x255)](_0x69d178,'space\x20id\x20is\x20null');let _0x515df8=dbPrivateSpaceTable['getById'](_0xb8d127[_0x2980c6(0x234)][_0x2980c6(0x240)],_0x2077c);if(!_0x515df8)return _0xb8d127[_0x2980c6(0x234)][_0x2980c6(0x255)](_0x69d178,_0x2980c6(0x26b));let _0x4d1de1=config[_0x2980c6(0x2a1)](_0x515df8[_0x2980c6(0x25a)]);fs[_0x2980c6(0x206)](_0x4d1de1,(_0x4b04d6,_0x36361c)=>{const _0x366860=_0x2980c6;if(_0x4b04d6)return _0xb8d127['app']['returnErrMsg'](_0x69d178,_0x69d178['__']('private.spaceConfigFileBroken'));let _0x39f77a=_0xb8d127['body'][_0x366860(0x27e)]||0x64,_0x56add3=_0xb8d127['body'][_0x366860(0x272)]||0x0,_0x51c5bf=_0xb8d127[_0x366860(0x2b7)][_0x366860(0x2a9)]||'id',_0x1dd524=_0xb8d127['body'][_0x366860(0x23a)]||_0x366860(0x22f),_0x25a007=_0xb8d127['body'][_0x366860(0x284)],_0x52f83a=getPrivateIndexDb(_0x515df8[_0x366860(0x25a)]),_0x1694c0='';_0x25a007&&_0x25a007!='all'&&(_0x1694c0+=_0x366860(0x1f5)+_0x25a007+'\x27');_0x1694c0+=_0x366860(0x208)+_0x51c5bf+'\x20'+_0x1dd524+_0x366860(0x224)+_0x39f77a+_0x366860(0x250)+_0x56add3;let _0x4eb9be=dbPrivateSpaceTable[_0x366860(0x1f3)](_0x52f83a,_0x1694c0);return _0x69d178[_0x366860(0x28e)]({'code':0x0,'data':_0x4eb9be});});});function getPwdFromToken(_0x48d45e,_0x403baf,_0x235bf6){const _0xfb9335=_0x35d1b7;let _0x230ded=_0x48d45e[_0xfb9335(0x20a)][_0xfb9335(0x2a4)]||_0x48d45e[_0xfb9335(0x2b7)][_0xfb9335(0x2a4)]||_0x48d45e[_0xfb9335(0x25f)][_0xfb9335(0x217)],_0x1d1ab3=dbPrivateSpaceTable[_0xfb9335(0x25b)](_0x48d45e[_0xfb9335(0x234)][_0xfb9335(0x240)],_0x230ded);if(!_0x1d1ab3)return _0x403baf[_0xfb9335(0x28e)]({'code':0x68});let _0x54d29f=_0x1d1ab3[_0xfb9335(0x2b8)];cryptoUtils[_0xfb9335(0x1f6)](config[_0xfb9335(0x223)],_0x54d29f)[_0xfb9335(0x2a5)](_0x33cf7f=>{_0x235bf6(_0x33cf7f);})['catch'](_0x544732=>{const _0x74418f=_0xfb9335;console[_0x74418f(0x283)](_0x544732);});}router[_0x35d1b7(0x278)](_0x35d1b7(0x2b1),(_0x8fbb68,_0x3d0bf1,_0xc176ee)=>{const _0x2fd433=_0x35d1b7;try{let _0x406a43=_0x8fbb68[_0x2fd433(0x20a)][_0x2fd433(0x262)],_0x3677ec=_0x8fbb68[_0x2fd433(0x20a)][_0x2fd433(0x296)],_0x4f789a=_0x8fbb68[_0x2fd433(0x20a)][_0x2fd433(0x259)],_0x1aae7e=_0x8fbb68[_0x2fd433(0x20a)]['type'];if(!_0x406a43||!_0x3677ec)return _0x8fbb68[_0x2fd433(0x234)]['returnErrMsg'](_0x3d0bf1,_0x2fd433(0x211));let _0x5bff60=dbPrivateSpaceTable[_0x2fd433(0x26e)](_0x8fbb68[_0x2fd433(0x234)][_0x2fd433(0x240)],_0x406a43);if(!_0x5bff60)return _0x8fbb68[_0x2fd433(0x234)][_0x2fd433(0x255)](_0x3d0bf1,'space\x20id\x20is\x20invalid');getPwdFromToken(_0x8fbb68,_0x3d0bf1,_0x20176d=>{const _0xfa5e9=_0x2fd433;let _0x507f5c=getPrivateIndexDb(_0x5bff60[_0xfa5e9(0x25a)]),_0x134d19=dbPrivateSpaceTable['getIndexById'](_0x507f5c,_0x3677ec);if(!_0x134d19)return _0x3d0bf1[_0xfa5e9(0x2a7)](0x194)[_0xfa5e9(0x221)]();let _0x29a329='';_0x1aae7e==_0xfa5e9(0x21a)?_0x29a329=path[_0xfa5e9(0x220)](_0x5bff60['folder_path'],_0x134d19[_0xfa5e9(0x281)]):_0x29a329=path[_0xfa5e9(0x220)](_0x5bff60[_0xfa5e9(0x25a)],_0x134d19[_0xfa5e9(0x253)]);if(_0x4f789a==0x1)try{let _0x2cab73=Buffer[_0xfa5e9(0x275)](_0x134d19[_0xfa5e9(0x2ba)],_0xfa5e9(0x289))[_0xfa5e9(0x212)]();const _0xf4d123=encodeURIComponent(_0x2cab73)[_0xfa5e9(0x248)](/%([0-9A-F]{2})/g,(_0x42da17,_0x593462)=>'%'+_0x593462['toUpperCase']());_0x3d0bf1[_0xfa5e9(0x2b4)](_0xfa5e9(0x239),_0xfa5e9(0x270)+_0xf4d123);}catch(_0x3058b2){console['log'](_0x3058b2);}fs[_0xfa5e9(0x206)](_0x29a329,(_0x1942da,_0x259cbc)=>{const _0x463665=_0xfa5e9;if(_0x1942da)return _0x3d0bf1[_0x463665(0x2a7)](0x194)['end']();if(_0x29a329['indexOf'](_0x463665(0x21a))==-0x1){let _0x2ad57d=dbPrivateSpaceTable[_0x463665(0x27d)](_0x507f5c,_0x463665(0x238),new Date()[_0x463665(0x245)](),_0x3677ec);}if(sharpUtil[_0x463665(0x23f)](_0x134d19[_0x463665(0x21e)])&&_0x1aae7e!='tiny'){let _0x5c7e0e=cryptoUtils[_0x463665(0x25d)](_0x20176d,_0x29a329);fileUtil[_0x463665(0x2ab)](_0x5c7e0e)[_0x463665(0x2a5)](_0x537f67=>{const _0x47f833=_0x463665;sharpUtil[_0x47f833(0x285)](_0x134d19['ext'],_0x537f67,(_0x4b2490,_0x57428e,_0xfd24c5)=>{const _0x7effc7=_0x47f833;sharpUtil[_0x7effc7(0x23f)](_0x134d19[_0x7effc7(0x21e)]['toLowerCase']())?sharpUtil[_0x7effc7(0x1ff)](_0x4b2490,null,![],null,'buffer',null,_0x191e35=>{const _0x4db66d=_0x7effc7;_0x3d0bf1[_0x4db66d(0x269)](Buffer[_0x4db66d(0x275)](_0x191e35));},_0x2933f6=>{const _0x456ad0=_0x7effc7;return console[_0x456ad0(0x283)](_0x2933f6),_0x3d0bf1[_0x456ad0(0x2a7)](0x194)[_0x456ad0(0x221)]();},_0x57428e,_0xfd24c5):typeof _0x4b2490==_0x7effc7(0x2ae)?(_0x3d0bf1[_0x7effc7(0x261)](_0x4b2490),_0x3d0bf1['on'](_0x7effc7(0x274),()=>{_0x57428e&&fs['rm'](_0x4b2490,_0x572d5d=>{});})):_0x3d0bf1[_0x7effc7(0x269)](_0x4b2490);});});}else cryptoUtils['decryptFile'](_0x20176d,_0x29a329,_0x3d0bf1,_0x3d0bf1);return;});});}catch(_0xbf15d8){return console[_0x2fd433(0x283)](_0xbf15d8),_0x3d0bf1['status'](0x194)['end']();}}),router[_0x35d1b7(0x225)](_0x35d1b7(0x201),(_0x8afdd6,_0x55f47e,_0x137e20)=>{const _0x4cd6bf=_0x35d1b7;try{return dbPrivateSpaceTable[_0x4cd6bf(0x267)](_0x8afdd6['app'][_0x4cd6bf(0x240)],_0x8afdd6['body'][_0x4cd6bf(0x262)]),_0x55f47e[_0x4cd6bf(0x2a7)](0xc8)[_0x4cd6bf(0x221)]();}catch(_0x4ccab4){return console[_0x4cd6bf(0x283)](_0x4ccab4),_0x55f47e[_0x4cd6bf(0x2a7)](0x194)[_0x4cd6bf(0x221)]();}}),module[_0x35d1b7(0x28d)]=router;